<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.519">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>beforerr</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">beforerr</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../docs/research/index.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-others" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Others</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-others">    
        <li>
    <a class="dropdown-item" href="../../../docs/blog/index.html">
 <span class="dropdown-text">Blog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../docs/courses/index.html">
 <span class="dropdown-text">Courses</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../docs/projects/index.html">
 <span class="dropdown-text">Projects</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
    <a href="https://github.com/Beforerr/beforerr" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#quasi-periodic-electron-precipitation-driven-by-ulf-waves-evidence-from-elfin-observations." id="toc-quasi-periodic-electron-precipitation-driven-by-ulf-waves-evidence-from-elfin-observations." class="nav-link active" data-scroll-target="#quasi-periodic-electron-precipitation-driven-by-ulf-waves-evidence-from-elfin-observations.">Quasi-periodic electron precipitation driven by ULF waves: evidence from ELFIN observations.</a>
  <ul class="collapse">
  <li><a href="#abstract" id="toc-abstract" class="nav-link" data-scroll-target="#abstract">Abstract</a></li>
  <li><a href="#background-and-motivation" id="toc-background-and-motivation" class="nav-link" data-scroll-target="#background-and-motivation">Background and Motivation</a></li>
  <li><a href="#proposed-data-and-questions" id="toc-proposed-data-and-questions" class="nav-link" data-scroll-target="#proposed-data-and-questions">Proposed Data and Questions</a>
  <ul class="collapse">
  <li><a href="#case-studies" id="toc-case-studies" class="nav-link" data-scroll-target="#case-studies">Case studies</a></li>
  <li><a href="#comparing-the-spatial-scales" id="toc-comparing-the-spatial-scales" class="nav-link" data-scroll-target="#comparing-the-spatial-scales">Comparing the spatial scales</a></li>
  <li><a href="#discussion-and-future-work" id="toc-discussion-and-future-work" class="nav-link" data-scroll-target="#discussion-and-future-work">Discussion and future work</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/Beforerr/beforerr/blob/main/docs/blog/phd/proposal_EMIC copy.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/Beforerr/beforerr/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="quasi-periodic-electron-precipitation-driven-by-ulf-waves-evidence-from-elfin-observations." class="level1">
<h1>Quasi-periodic electron precipitation driven by ULF waves: evidence from ELFIN observations.</h1>
<section id="abstract" class="level2">
<h2 class="anchored" data-anchor-id="abstract">Abstract</h2>
<p>Ultra-low frequency (ULF) waves can cause dynamic variations of the electron flux in the equatorial inner magnetosphere. Spacecraft observations have revealed that ULF waves are able to modulate intensity of very-low-frequency (VLF) waves such as whistler waves, whereas resonant scattering of energetic electrons by such modulated whistler waves may further lead to modulated electron precipitation. However, near-equatorial spacecraft measurements cannot resolve the loss cone and hence cannot directly confirm the electron precipitation likely driven by these modulated whistler waves. Understanding the underlying mechanisms and drivers of the electron precipitation in the inner magnetosphere are important for modeling Earth’s outer radiation belt dynamics and magnetosphere-ionosphere coupling. In the proposed study, we will use ELFIN low-altitude observations of precipitating electrons to show evidence of quasi-periodic electron precipitation driven by ULF waves. With observations from two ELFIN satellites, we intend to demonstrate that the spatial periodicity of the electron precipitation is likely due to the spatial distribution of the ULF fields in L-shell. The results open new ways to characterize the spatial distribution of ULF waves and the contribution of these waves to precipitation.</p>
</section>
<section id="background-and-motivation" class="level2">
<h2 class="anchored" data-anchor-id="background-and-motivation">Background and Motivation</h2>
<p>Ultra-low frequency (ULF) waves can be generated by sources external (magnetopause interaction with solar wind transients) or internal (resonant generation by injected energetic ions) to Earth’s magnetosphere and occur in frequencies ranging from 1 mHz to 1 Hz [McPherron, 2005]. ULF waves can interact (resonantly or adiabatically) with both high and low-energy electrons and they can also be coupled with very-low-frequency (VLF) whistler waves in Earth’s magnetosphere [Li et al., 2011; Zhang et al., 2019]. Whistler-mode chorus waves are one of the most intense type of VLF waves in the inner magnetosphere. They have a typical frequency range 0.1-0.8 f_ce (electron cyclotron frequency) [Tsurutani and Smith, 1977]. Previous studies have shown periodic excitation of chorus waves by electron populations modulated by ULF waves across a spatial scale of several Earth radii [e.g., Manninen et al., 2010; Motoba et al., 2015; Xia et al., 2016]. Li et al.&nbsp;[2011] demonstrated that chorus waves can be modulated by compressional Pc4-5 ULF waves exhibiting an anti-correlation between electron density and magnetic field intensity. Zhang et al.&nbsp;[2019] showed that the ULF waves modulate both chorus and electron cyclotron harmonic (ECH) waves over a large spatial scale. They proposed that the periodic excitation of chorus waves is accomplished by ULF modulation of the hot electron drift paths resulting in the perpendicular anisotropy that excites the wave.
The electron precipitation are attributed mainly to the interaction between electrons and whistler-mode chorus waves near the magnetospheric equator. After chorus waves are generated at the equator, they interact with bouncing electrons in both hemispheres [Kasahara et al., 2018]. Some scattered electrons become nearly aligned with the magnetic field and fill the loss cone. The electrons in the loss cone will then precipitate into the upper atmosphere. Chorus waves play an important role in both electron acceleration and loss. Resonant interaction with lower-band (&lt;0.5 f_ce) chorus waves leads to precipitation of &gt;10s keV electrons [e.g., Li et al., 2009, 2010]. Therefore, ULF waves modulating chorus wave generation could drive energetic (&gt;10 keV) electron precipitation across a large spatial region. The ULF modulated generation of chorus waves does not relate to plasma sheet injections, which is the most traditional source of free energy for wave generation, but represents an alternative free energy source. Thus, it is important to reveal the relative contribution of these modulated whistlers to the resonant electron scattering leading to energetic (&gt;10 keV) electrons precipitation across a large spatial region. Such large-scale precipitation can alter ionospheric properties and reduce the flux of seed electrons available for further acceleration to relativistic energies. For example, the precipitation of energetic electrons owing to whistler-mode wave-particle interactions can cause pulsating aurora [e.g., Sandahl, 1984; Miyoshi et al., 2010]. Therefore, understanding the hot electron precipitation in the inner magnetosphere is important for studying Earth’s radiation belt, an important aspect of understanding and predicting space weather. Investigation of electron precipitation requires resolving electron distributions within the loss cone, which is almost impossible near the equator due to the smallness of the loss cone there. However, the much larger loss cone size at low altitudes allows polar-orbiting ionospheric spacecraft to independently measure electron fluxes within the loss cone in-situ, and together with magnetically conjugate equatorial spacecraft and ground-based stations to unravel magnetospheric drivers of electron precipitation such as ULF waves. In the proposed study, we will use conjugate ground and space observations to reveal evidence of periodic electron precipitation and provide further evidence that it is driven by ULF waves. The primary objective of the proposed research is to present and detail such evidence of the loss process of hot electrons by ULF waves. This will advance our understanding of how electron fluxes vary in the inner magnetosphere and potentially also provide a research tool for studying the ULF waves themselves.</p>
</section>
<section id="proposed-data-and-questions" class="level2">
<h2 class="anchored" data-anchor-id="proposed-data-and-questions">Proposed Data and Questions</h2>
<section id="case-studies" class="level3">
<h3 class="anchored" data-anchor-id="case-studies">Case studies</h3>
<p>We first present two case studies to demonstrate that magnetically conjugate ground and space observations can provide evidence of ULF-driven electron precipitation. The proposed work will refine this evidence and quantify its importance on a case-by-case basis. Future work can expand on this loss mechanism.</p>
<p>Ground-based observations of ULF waves will be obtained from Ground Magnetometer (GMAG) stations from &gt;100 sites worldwide [Russell et al., 2008]. The main advance of ground-based observations is the absence of spatio-temporal ambiguity, which is characteristic of spacecraft measurements. Such ground-based ULF observations will be supplemented by equatorial THEMIS [Angelopoulos, 2008] measurements of ULF and VLF fields. The THEMIS FGM instrument [Auster et al., 2008] measures and stores the magnetic field with a 1/128s, 1/4s or 3s (spin period) sampling rate (depending on data product), whereas the THEMIS SCM instrument [Le Contel et al., 2008] provides &lt; 8kHz wave measurements that are further converted to the FFF spectra data with a frequency resolution of 32 or 64 frequency bands [Cully et al., 2008]. ELFIN’s low-altitude observations are used to analyze the energetic (&gt;50keV) electron precipitation. The pair of identical ELFIN satellites are on a polar, low-Earth orbit and can reveal the specific L-shell (and L-shell range) where ULF-driven precipitation happens. Also, the two ELFIN satellites may pass over the same magnetic longitude with a time separation of 0-60 minutes, and therefore allow disambiguation of the spatial and temporal evolution of electron precipitation [Angelopoulos, Tsai and Bingley et al.&nbsp;2020]. With two ELFIN satellites, we would then be sure that the periodicity of electron flux precipitation is due to ELFIN crossing different ULF peaks at different L-shells, rather than global temporal variations of the equatorial flux; this can further determine the spatial scale of the electron precipitation.</p>
<p>The first event we use to is on May 13, 2021(Figure 1).</p>
<ol type="1">
<li>Conjunction (locations)</li>
<li>ELFIN observed periodic electron precipitation</li>
<li>ULF waves are observed</li>
<li>Whistler waves are associated with ULF waves</li>
</ol>
<p>Two ground stations (kian and fykn) and three THEMIS satellites all located within the same MLT and L-shell range, observed similar ULF waves with frequency ranging from 3 mHz to 5 mHz. Figures 1f-1h show the wavelet analysis of the parallel component (z component) of the magnetic field in field-aligned coordinates (the magnetic field variation in the other two directions is nearly 0).</p>
<p>In this case, three THEMIS satellites (TH-A, TH-D, and TH-E) observed ULF waves and quasi-periodic whistler waves, and TH-E’s measurements are shown in Figure 1 (h-k). The periodic variation of electron density is shown in Figure 1a, indicating that the observed ULF waves are compressional. Figure 1(b, c) shows the wavelet analysis of the parallel component (z component) of the magnetic field in field-aligned coordinates (the magnetic field variation in the other two directions is nearly 0). The ground station LRV( Leirvogur, Iceland) is close to the ground track of ELFIN’s trajectory. Both the ground station and THEMIS observed the ULF waves with frequency ranging from 2 mHz to 10 mHz. The power of ULF waves peaks at ~9 mHz and ~3 mHz. Figure 1d shows the magnetic field power spectrum from the SCM instrument. It enables us to identify the periodic whistler waves at a frequency between the low hybrid frequency and half the electron cyclotron frequency. The periodic whistler wave is observed from 05:40 UT to 09:00UT and covers an L shell range from 4-9 (the L shells here are calculated by using the T89 model [Tsyganenko, 1989]). The peaks of whistler wave intensity are correlated with the 8-10 mHz ULF wave (Figure 1e,f,g).</p>
<p>During this event, ELFIN-B is conjugate to THEMIS. The time when ELFIN-B passed over is indicated by the red line in Figure 1. ELFIN-B quickly crossed a large range of L-shells and captured quasi-periodic precipitation of 10s of keV electrons, as shown in Figure 2. ELFIN -B observed six main peaks of precipitation within L=4-9 (Figure 2f). The average distance between major peaks is ~0.8 R_E. It is evident that these periodic peaks contribute to most of the precipitating flux observed during this ELFIN orbit within L=4-8. This indicates that such periodic precipitations can play a major role in energetic electron losses. These precipitations are very likely due to near-equatorial electron scattering by whistler waves driven by compressional ULF waves, because these periodic precipitations are observed within the same L range (L=4-8) as the equatorial ULF/VLF waves.</p>
<p>The second event (May 14, 2021) is shown in Figures 3 and 4 in a similar format. The two ELFIN satellites are conjugate to the near-equatorial THEMIS satellites and ground-based stations. The THEMIS-E and ELFIN satellites are located within the MLT range 4-7. In this case, ELFIN does not have such a good conjunction with THEMIS but ELFIN A and ELFIN B observed quasi-periodic precipitations. Figure 3 shows wave observations of ULF and whistler waves. The periodic whistler waves are observed at L=6-12. There are two regions of periodic whistler waves. From 20:00 to 20:40 UT, the whistler waves are likely modulated by ~4 mHz ULF waves. From 21:40 to 22:00 UT the whistler waves are likely modulated by ~1.5mHz ULF waves. The time when ELFIN-A passed by is indicated by the blue line in Figure 3. ELFIN-B moves along the same orbit, but with a time lag of ~12 minutes. Both ELFIN-A and ELFIN-B quickly crossed a large range of L-shells and captured quasi-periodic precipitation (J_loss/J_trap) of 10s of keV electrons, as shown in Figure 4. Both ELFIN-A and ELFIN-B observed 5-6 main peaks of precipitation within L=6-12, which indicates that the observed periodicity of precipitation is not due to a temporal effect. The average distances between major peaks of electron precipitations are ~1.1 R_E and ~1.01R_E for ELFIN-A and ELFIN-B respectively.</p>
</section>
<section id="comparing-the-spatial-scales" class="level3">
<h3 class="anchored" data-anchor-id="comparing-the-spatial-scales">Comparing the spatial scales</h3>
<p>To further confirm that the periodic electron precipitation is driven by ULF waves, we will compare the spatial scale of periodic precipitation peaks and ULF waves. During these two events, the geomagnetic longitude of the ELFIN satellites is nearly unchanged. Therefore, they measure the quasi-periodic precipitations along an approximately radial direction, when mapped to the equator. The δL between major peaks is ~0.8 R_E and ~1 R_E in event 1 and event 2, respectively (ELFIN time-series of precipitation were transferred to L-shell profiles of precipitation using the T89 magnetic field model). If the precipitation is driven by modulated whistler waves (due to ULF waves), then these δL should be comparable to the ULF wavelength in the radial direction (or, more precisely, the ULF wave periodicity in the radial direction). The wavelength in the radial direction can be calculated by comparing ULF fields measured from two THEMIS satellites separated in the radial direction. If they are radially separated by a distance r and the ULF waves (at frequency f) measured by the two satellites has a phase difference dϕ, then the wavelength can be calculated as λ/2π=r/dϕ. In the first case, THEMIS-A, THEMIS-D, and THEMIS-E are distributed along the radial direction over distances that are comparable with the expected wavelength. We examined the phase difference of 8-10 mHz ULF waves between THEMIS-A and THEMIS-D and found that the estimated wavelength is ~0.7 R_E, which is very close to the δL~0.8R_E. In the second case, the estimated wavelength is also close to the δL observed by ELFIN-A and ELFIN-B. This provides further support for our hypothesis that the periodic precipitation is likely driven by ULF waves.
In the proposed work, we will investigate further these and other potential candidates of periodic precipitation. Numerous opportunities for dual ELFIN event collections (one-after-another) in close proximity (&lt;10min) exist in the upcoming year (several collected already in the month of January 2022). We expect at least a dozen conjunction events to be available for such studies. Our proposed work will therefore also establish an approximate estimate of how frequently periodic precipitation (likely ULF driven) is observed when the observing conditions are favorable.</p>
</section>
<section id="discussion-and-future-work" class="level3">
<h3 class="anchored" data-anchor-id="discussion-and-future-work">Discussion and future work</h3>
<p>In this study, we will focus on the ULF modulated chorus and study how much the modulated whistlers can contribute to the electron precipitation in a large spatial scale. Resonant interaction with whistler waves is not the only cause of electron precipitation. ULF waves can also directly lead to electron precipitation due to lowering of electrons mirror point [Brito et al., 2012]. However, lowering the mirror altitude by the ULF wave interaction applies to all energies. It is simply due to the ULF compressional component changing the equatorial field and transporting electrons inward or outward. When electrons are transported inward, they are on a shorter field line which lowers the mirror points in order to conserve the second adiabatic invariant. Therefore, electron precipitations caused by ULF waves should not have strong energy dependence. However, in our cases, the strong precipitation peaks mainly appear at lower energies (&lt; 500 keV), which seems consistent with the resonant energy of whistler waves but inconsistent with precipitation driven by ULF waves. In the future (beyond the present proposal), we may also conduct a more comprehensive statistical analysis of THEMIS/ELFIN comparisons which includes a larger statistical database of events, and further investigation of whether the observed whistler wave characteristics and background magnetic field/plasma conditions are consistent with energies of precipitating electrons (resonant condition) and the intensity of precipitation (diffusion rate estimates).</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>In this proposal, we will examine and present clear evidence of quasi-periodic electron precipitation driven by ULF waves. We will also examine the potential contribution of ULF driven precipitation for the overall precipitation under similar conditions from a few cases to examine whether such events have the potential to contribute to energetic electron losses. Using conjugate ground-based and space observations, we will show that ULF waves can modulate quasi-periodic whistler-mode chorus waves, such that the modulated chorus waves can result in spatial periodicities of the electron precipitation over a large spatial scale (across the entire auroral zone). The two ELFIN satellites enable us to separate the spatial and temporal effects of electron precipitation. In addition, THEMIS satellites or a ground-based station arrays can be used to compare the L of electron precipitations with the spatial period of ULF waves. Future work can then examine this phenomenon statistically, with more data and more quantitative tests of the wave-particle interactions. This line of research will help us better understand the electron precipitation process in the Earth’s magnetosphere.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../../about.html">
<p>About</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>