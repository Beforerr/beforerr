{
  "hash": "93c15a224bd8baaa5a8a17edcd29d88f",
  "result": {
    "engine": "julia",
    "markdown": "---\ntitle: Problem Set 6\nsubtitle: Electron-scale measurements of magnetic reconnection in space\nengine: julia\n---\n\n## MMS Science event: magnetopause reconnection at the electron diffusion region\n\n> Obtain and analyze plasma data, including spectra, for the first MMS Science event (Burch et al., Science 2016, link here) showing magnetopause reconnection at the electron diffusion region on 2016/10/16 13:07:02.2 UT. Start by using Hwk06_mpause_RX.pro, provided.  The objective of this exercise is to introduce plasma distributions from MMS (electrons and ions) and create burst spectra. In the process also create plasma moments and the plasma current and plot these along E and B. You are requested to create Figure 2 of Burch et al. plus the 3 bottom (electron) spectrograms from Figure 3 of the same paper (panels 3G, 3H and 3I). Your figure should look like the one shown on the next page, but using burst mode data in order to make it look like in Burch et al. You are requested to plot this figure at 2 time scales: the overview (2 min) timescale as in Fig. 2 of Burch et al. [â€˜13:05:30â€™,â€™13:07:30â€™] and  the zoom-in (3 sec) timescale as in Fig. 3 of Burch et al. ['13:07:00.5','13:07:03.5']. Notice that the clean and fast mâ€™pause crossing was at 13:05:40UT, and this is used to determine N. In Fig. 2K of Burch et al. (the right-hand side of Fig. 2, the pictorial view of the MMS trajectory for the 2min interval) this initial mâ€™pause crossing was near the start of the trajectory. The trajectory crosses the X-point at the 3 seconds of the zoom-in interval.\n\n::: {#2 .cell execution_count=1}\n``` {.julia .cell-code}\nusing Speasy\nusing DimensionalData\nusing SPEDAS\nusing SPEDAS.MMS\nusing SPEDAS: dimarrayify\n# using GLMakie\nusing Unitful\nusing CairoMakie\n\nupdate_theme!(colormap=:rainbow1)\nSPEDAS.DEFAULTS.add_title = true;\n```\n:::\n\n\n\n### Overview plot\n\n#### Minimum Variance Analysis\n\n::: {#4 .cell execution_count=1}\n``` {.julia .cell-code}\ntrange = (\"2015-10-16T13:05:35\", \"2015-10-16T13:07:25\")\ntr_mpause = (\"2015-10-16T13:05:40\", \"2015-10-16T13:06:09\")\n\nprobe = 2\n\ntvars = [\n    \"cda/MMS2_FGM_SRVY_L2/mms2_fgm_b_gse_srvy_l2_clean\",\n    \"cda/MMS2_EDP_FAST_L2_DCE/mms2_edp_dce_gse_fast_l2\",\n]\nB_gse, edp_dce_gse = get_data(tvars, trange) .|> DimArray\nrotMat = mva_mat(tclip(B_gse[:, 1:3], tr_mpause))\nB_LMN = rotate(B_gse[:, 1:3], rotMat) |> set_coord(\"LMN\") |> set_coord(\"Boundary-normal coordinates\"; old_coords=[\"Geocentric Solar Ecliptic\"])\nE_LMN = rotate(edp_dce_gse, rotMat) |> set_coord(\"LMN\")\n\nrotMat\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCan't get MMS2_FGM_SRVY_L2/mms2_fgm_b_gse_srvy_l2_clean without web service, switching to web service\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=1}\n```\nLinearAlgebra.Eigen{Float32, Quantity{Float32, ğŒÂ² ğˆâ»Â² ğ“â»â´, Unitful.FreeUnits{(nTÂ²,), ğŒÂ² ğˆâ»Â² ğ“â»â´, nothing}}, Matrix{Float32}, Vector{Quantity{Float32, ğŒÂ² ğˆâ»Â² ğ“â»â´, Unitful.FreeUnits{(nTÂ²,), ğŒÂ² ğˆâ»Â² ğ“â»â´, nothing}}}}\nvalues:\n3-element Vector{Quantity{Float32, ğŒÂ² ğˆâ»Â² ğ“â»â´, Unitful.FreeUnits{(nTÂ²,), ğŒÂ² ğˆâ»Â² ğ“â»â´, nothing}}}:\n 501.50833f0 nTÂ²\n  32.28409f0 nTÂ²\n  13.2533245f0 nTÂ²\nvectors:\n3Ã—3 Matrix{Float32}:\n  0.368873   0.571604   0.73294\n -0.122903  -0.75163    0.648034\n  0.921318  -0.329122  -0.207004\n```\n:::\n:::\n\n\n\nThe direction obtained from the Minimum Variance Analysis (MVA) in our study closely aligns with the direction reported in the literature.\n\n> The (x, y, z) GSE components of the L, M, and N axes are L = (0.3665, â€“0.1201, 0.9226) GSE, M = (0.5694, â€“0.7553, â€“0.3245) GSE, and N = (0.7358, 0.6443, â€“0.2084) GSE\n\n#### Plasma data\n\n::: {#6 .cell execution_count=1}\n``` {.julia .cell-code}\ndata_rate = \"brst\"\nfpi_des_ds = FPIDataSet(; probe, data_rate, data_type=\"des\")\nfpi_dis_ds = FPIDataSet(; probe, data_rate, data_type=\"dis\")\n\ndes_data = get_data(NamedTuple, fpi_des_ds, trange) |> dimarrayify\ndis_data = get_data(NamedTuple, fpi_dis_ds, trange) |> dimarrayify\n\ndes_n = modify_meta(des_data.numberdensity[:, 1], label=\"Ne\")\ndis_bulkv_lmn = rotate(dis_data.bulkv_gse, rotMat) |> set_coord(\"LMN\")\ndes_bulkv_lmn = rotate(des_data.bulkv_gse, rotMat) |> set_coord(\"LMN\")\ndis_n = modify_meta(dis_data.numberdensity[:, 1], label=\"Ni\")\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-black-fg\">â”Œ </span><span style=\"color:rgb(255,135,95)\">733-element </span>DimArray{Unitful.Quantity{Float32, ğ‹â»Â³, Unitful.FreeUnits{(cmâ»Â³,), ğ‹â»Â³, nothing}}, 1}<span style=\"color:rgb(0,175,175)\"> mms2_dis_numberdensity_brst</span><span class=\"ansi-bright-black-fg\"> â”</span>\n<span class=\"ansi-bright-black-fg\">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ dims â”¤</span>\n  <span style=\"color:rgb(255,135,95)\">â†“ </span><span style=\"color:rgb(255,135,95)\">Ti</span> Sampled{NanoDates.NanoDate} <span style=\"color:rgb(255,135,95)\">[2015-10-16T13:05:35.144103, â€¦, 2015-10-16T13:07:24.945661]</span> <span style=\"color:rgb(128,128,128)\">ForwardOrdered</span> <span style=\"color:rgb(128,128,128)\">Irregular</span> <span style=\"color:rgb(128,128,128)\">Points</span>\n<span class=\"ansi-bright-black-fg\">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ metadata â”¤</span>\n  Dict{Any, Any} with 17 entries:\n  \"SCALETYP\"        =&gt; \"linear\"\n  \"FILLVAL\"         =&gt; Any[-1.0e31]\n  \"DEPEND_0\"        =&gt; \"Epoch\"\n  \"FIELDNAM\"        =&gt; \"MMS2 FPI/DIS number density\"\n  \"SI_CONVERSION\"   =&gt; \"1e6&gt;m^-3\"\n  \"VALIDMAX\"        =&gt; Any[100000.0]\n  \"axes\"            =&gt; VariableAxis[Speasy.VariableAxis(<span style=\"color:rgb(0,175,175)\">time</span>, Units: ns, Shape:â€¦\n  :label            =&gt; \"Ni\"\n  \"DELTA_MINUS_VAR\" =&gt; \"mms2_dis_numberdensity_err_brst\"\n  \"FORMAT\"          =&gt; \"E12.2\"\n  \"VAR_TYPE\"        =&gt; \"data\"\n  \"CATDESC\"         =&gt; \"MMS2 FPI/DIS ion number density during this burst\"\n  \"LABLAXIS\"        =&gt; \"N\"\n  \"DELTA_PLUS_VAR\"  =&gt; \"mms2_dis_numberdensity_err_brst\"\n  \"DISPLAY_TYPE\"    =&gt; \"time_series\"\n  \"VALIDMIN\"        =&gt; Any[0.001]\n  \"UNITS\"           =&gt; \"cm^-3\"\n<span class=\"ansi-bright-black-fg\">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>\n â‹®      â‹±  </pre>\n```\n:::\n\n:::\n:::\n\n\n\n#### Magnitudes of electron and ion convection velocities\n\n::: {#8 .cell execution_count=1}\n``` {.julia .cell-code}\nVi_perp_mag, Ve_perp_mag = let Vi = dis_data.bulkv_gse, Ve = des_data.bulkv_gse, B = B_gse\n    Vi_clip = tclip(Vi, B)\n    Ve_clip = tclip(Ve, B)\n\n    B_int_Vi = tinterp(B, Vi_clip)[:, 1:3]\n    B_int_Ve = tinterp(B, Ve_clip)[:, 1:3]\n    Vi_perp_mag = toproj(Vi_clip, B_int_Vi) |> tnorm\n    Ve_perp_mag = toproj(Ve_clip, B_int_Ve) |> tnorm\n\n    modify_meta(Vi_perp_mag, ylabel=\"Viper_t\"),\n    modify_meta(Ve_perp_mag, ylabel=\"Veper_t\")\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```\n(Quantity{Float32, ğ‹ ğ“â»Â¹, Unitful.FreeUnits{(km, sâ»Â¹), ğ‹ ğ“â»Â¹, nothing}}[16.370079f0 km sâ»Â¹, 39.085266f0 km sâ»Â¹, 18.779638f0 km sâ»Â¹, 36.385616f0 km sâ»Â¹, 28.834595f0 km sâ»Â¹, 31.232655f0 km sâ»Â¹, 21.860336f0 km sâ»Â¹, 25.042305f0 km sâ»Â¹, 19.904325f0 km sâ»Â¹, 3.4641075f0 km sâ»Â¹  â€¦  54.85829f0 km sâ»Â¹, 52.70736f0 km sâ»Â¹, 43.587467f0 km sâ»Â¹, 37.50158f0 km sâ»Â¹, 32.17601f0 km sâ»Â¹, 29.35025f0 km sâ»Â¹, 22.573784f0 km sâ»Â¹, 23.164637f0 km sâ»Â¹, 26.775894f0 km sâ»Â¹, 33.856136f0 km sâ»Â¹], Quantity{Float32, ğ‹ ğ“â»Â¹, Unitful.FreeUnits{(km, sâ»Â¹), ğ‹ ğ“â»Â¹, nothing}}[179.42912f0 km sâ»Â¹, 65.0223f0 km sâ»Â¹, 95.883736f0 km sâ»Â¹, 80.23359f0 km sâ»Â¹, 31.386843f0 km sâ»Â¹, 176.10416f0 km sâ»Â¹, 21.706324f0 km sâ»Â¹, 53.19559f0 km sâ»Â¹, 126.49119f0 km sâ»Â¹, 102.77765f0 km sâ»Â¹  â€¦  42.916084f0 km sâ»Â¹, 72.56186f0 km sâ»Â¹, 39.36531f0 km sâ»Â¹, 40.899796f0 km sâ»Â¹, 34.341866f0 km sâ»Â¹, 35.257183f0 km sâ»Â¹, 31.910067f0 km sâ»Â¹, 45.77481f0 km sâ»Â¹, 69.921875f0 km sâ»Â¹, 93.31721f0 km sâ»Â¹])\n```\n:::\n:::\n\n\n\n#### Current density\n\n::: {#10 .cell execution_count=1}\n``` {.julia .cell-code}\nJ = begin\n    Vi = dis_bulkv_lmn\n    Ve = des_bulkv_lmn\n    n = dis_n\n    Ve_clip = tclip(Ve, Vi)\n    Vi_interp = tinterp(Vi, Ve_clip)\n    n_interp = tinterp(n, Ve_clip)\n    J = mapslices(Vi_interp - Ve_clip; dims=Ti) do V_diff_i\n        @. Unitful.q * V_diff_i * n_interp |> u\"Î¼A*m^-2\"\n    end\n    modify_meta(J, labels=[\"j_L\", \"j_M\", \"j_N\"])\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-black-fg\">â”Œ </span><span style=\"color:rgb(255,135,95)\">3661</span>Ã—<span style=\"color:rgb(0,135,215)\">3</span> DimArray{Unitful.Quantity{Float64, ğˆ ğ‹â»Â², Unitful.FreeUnits{(Î¼A, mâ»Â²), ğˆ ğ‹â»Â², nothing}}, 2}<span class=\"ansi-bright-black-fg\"> â”</span>\n<span class=\"ansi-bright-black-fg\">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ dims â”¤</span>\n  <span style=\"color:rgb(255,135,95)\">â†“ </span><span style=\"color:rgb(255,135,95)\">Ti     </span> Sampled{NanoDates.NanoDate} <span style=\"color:rgb(255,135,95)\">[2015-10-16T13:05:35.144103, â€¦, 2015-10-16T13:07:24.945661]</span> <span style=\"color:rgb(128,128,128)\">ForwardOrdered</span> <span style=\"color:rgb(128,128,128)\">Irregular</span> <span style=\"color:rgb(128,128,128)\">Points</span>,\n  <span style=\"color:rgb(0,135,215)\">â†’ </span><span style=\"color:rgb(0,135,215)\">AnonDim</span> Sampled{Int64} <span style=\"color:rgb(0,135,215)\">[1, 2, 3]</span> <span style=\"color:rgb(128,128,128)\">ForwardOrdered</span> <span style=\"color:rgb(128,128,128)\">Irregular</span> <span style=\"color:rgb(128,128,128)\">Points</span>\n<span class=\"ansi-bright-black-fg\">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ metadata â”¤</span>\n  Dict{Any, Any} with 20 entries:\n  \"UNITS\"             =&gt; \"km/s\"\n  \"SCALETYP\"          =&gt; \"linear\"\n  \"FILLVAL\"           =&gt; Any[-1.0e31]\n  \"DEPEND_0\"          =&gt; \"Epoch\"\n  \"FIELDNAM\"          =&gt; \"MMS2 FPI/DIS LMN bulk v\"\n  \"SI_CONVERSION\"     =&gt; \"1.0e3&gt;m s^-1\"\n  \"VALIDMAX\"          =&gt; Any[110000.0]\n  \"LABL_PTR_1\"        =&gt; [\"Vx_LMN\", \"Vy_LMN\", \"Vz_LMN\"]\n  \"TENSOR_ORDER\"      =&gt; Any[1]\n  \"axes\"              =&gt; VariableAxis[Speasy.VariableAxis(<span style=\"color:rgb(0,175,175)\">time</span>, Units: ns, Shapâ€¦\n  \"COORDINATE_SYSTEM\" =&gt; \"LMN\"\n  \"DELTA_MINUS_VAR\"   =&gt; \"mms2_dis_bulkv_err_brst\"\n  \"FORMAT\"            =&gt; \"E12.2\"\n  \"VAR_TYPE\"          =&gt; \"data\"\n  \"CATDESC\"           =&gt; \"MMS2 FPI/DIS ion bulk-velocity LMN vector during thisâ€¦\n  :labels             =&gt; [\"j_L\", \"j_M\", \"j_N\"]\n  \"DELTA_PLUS_VAR\"    =&gt; \"mms2_dis_bulkv_err_brst\"\n  \"DISPLAY_TYPE\"      =&gt; \"time_series\"\n  \"VALIDMIN\"          =&gt; Any[-110000.0]\n  \"REPRESENTATION_1\"  =&gt; \"mms2_dis_cartrep_brst\"\n<span class=\"ansi-bright-black-fg\">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>\n â‹®      â‹±  </pre>\n```\n:::\n\n:::\n:::\n\n\n\n#### Para, perp and anti-parallel spectra of electrons\n\n::: {#12 .cell execution_count=1}\n``` {.julia .cell-code}\ndes_energyspectr_tvars = [\n    \"cda/MMS2_FPI_BRST_L2_DES-MOMS/mms$(probe)_des_energyspectr_par_$(data_rate)\",\n    \"cda/MMS2_FPI_BRST_L2_DES-MOMS/mms$(probe)_des_energyspectr_perp_$(data_rate)\",\n    \"cda/MMS2_FPI_BRST_L2_DES-MOMS/mms$(probe)_des_energyspectr_anti_$(data_rate)\"\n]\n\ndes_energyspectr = get_data(des_energyspectr_tvars, trange) .|> DimArray\ndes_energyspectr = replace.(des_energyspectr, 0 => NaN)\ndes_energyspectr_ratio = des_energyspectr[1] ./ des_energyspectr[2]\ndes_energyspectr = modify_meta.(des_energyspectr, colorrange=(1e5, 1e9))\ndes_energyspectr_ratio = modify_meta(des_energyspectr_ratio,\n    colorrange=(1e-1, 1e1), title=\"Ratio (Para/Perp)\"\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-cyan-fg ansi-bold\">[ </span><span class=\"ansi-cyan-fg ansi-bold\">Info: </span>Cannot parse unit \n<span class=\"ansi-cyan-fg ansi-bold\">[ </span><span class=\"ansi-cyan-fg ansi-bold\">Info: </span>Cannot parse unit \n<span class=\"ansi-cyan-fg ansi-bold\">[ </span><span class=\"ansi-cyan-fg ansi-bold\">Info: </span>Cannot parse unit \n</pre>\n```\n:::\n\n:::\n\n::: {.cell-output .cell-output-display execution_count=1}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-black-fg\">â”Œ </span><span style=\"color:rgb(255,135,95)\">3666</span>Ã—<span style=\"color:rgb(0,135,215)\">32</span> DimArray{Float64, 2}<span class=\"ansi-bright-black-fg\"> â”</span>\n<span class=\"ansi-bright-black-fg\">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ dims â”</span>\n  <span style=\"color:rgb(255,135,95)\">â†“ </span><span style=\"color:rgb(255,135,95)\">Ti</span> Sampled{NanoDates.NanoDate} <span style=\"color:rgb(255,135,95)\">[2015-10-16T13:05:35.024103, â€¦, 2015-10-16T13:07:24.975661]</span> <span style=\"color:rgb(128,128,128)\">ForwardOrdered</span> <span style=\"color:rgb(128,128,128)\">Irregular</span> <span style=\"color:rgb(128,128,128)\">Points</span>,\n  <span style=\"color:rgb(0,135,215)\">â†’ </span><span style=\"color:rgb(0,135,215)\">Y </span> Sampled{Int64} <span style=\"color:rgb(0,135,215)\">1:32</span> <span style=\"color:rgb(128,128,128)\">ForwardOrdered</span> <span style=\"color:rgb(128,128,128)\">Regular</span> <span style=\"color:rgb(128,128,128)\">Points</span>\n<span class=\"ansi-bright-black-fg\">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ metadata â”¤</span>\n  Dict{Any, Any} with 19 entries:\n  \"VAR_NOTES\"    =&gt; \"Counts, summed within 30 degrees parallel bentPipe magnetiâ€¦\n  \"SCALETYP\"     =&gt; \"log\"\n  \"FILLVAL\"      =&gt; Any[-1.0e31]\n  \"DEPEND_0\"     =&gt; \"Epoch\"\n  \"FIELDNAM\"     =&gt; \"MMS2 FPI/DES energySpectr_par\"\n  \"VALIDMAX\"     =&gt; Any[1.0e30]\n  \"axes\"         =&gt; VariableAxis[Speasy.VariableAxis(<span style=\"color:rgb(0,175,175)\">time</span>, Units: ns, Shape: (3â€¦\n  :colorrange    =&gt; (0.1, 10.0)\n  \"DEPEND_1\"     =&gt; \"mms2_des_energy_brst\"\n  :yscale        =&gt; \"log\"\n  \"FORMAT\"       =&gt; \"E12.2\"\n  :ylabel        =&gt; \"energy\"\n  \"VAR_TYPE\"     =&gt; \"data\"\n  \"CATDESC\"      =&gt; \"MMS2 FPI/DES electron energy parallel spectrum 30 degrees â€¦\n  \"LABLAXIS\"     =&gt; \"FPI1/DES EnSpectr, Parallel\"\n  :title         =&gt; \"Ratio (Para/Perp)\"\n  \"DISPLAY_TYPE\" =&gt; \"spectrogram\"\n  \"VALIDMIN\"     =&gt; Any[-1.0e30]\n  :yunit         =&gt; \"eV\"\n<span class=\"ansi-bright-black-fg\">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>\n â‹®      â‹±  </pre>\n```\n:::\n\n:::\n:::\n\n\n\n#### Summary data plot\n\n> In 1 paragraph (10 lines) explain what each panel represents for this reconnection interval.\n\nFrom top to bottom, the panels represent the following: \n1. the magnetic field vectors in LMN coordinate system;\n2. energy times spectrogram of ion energy flux;\n3. energy times spectrogram of electron energy flux;\n4. plasma density (ion and electron);\n5. ion flow velocity vectors in LMN coordinate system;\n6. magnitudes of electron and ion convection velocities;\n7. current density;\n8. electron parallel and perpendicular temperatures;\n9. electric field vectors in LMN coordinate system;\n10-12. electron spectrograms (parallel, perpendicular, anti-parallel);\n13. electron spectrogram ratio (para/perp).\n\n\n::: {#14 .cell execution_count=1}\n``` {.julia .cell-code}\ntvars2plot = [\n    B_LMN,\n    [dis_n, des_n],\n    dis_data.energyspectr_omni,\n    des_data.energyspectr_omni,\n    dis_bulkv_lmn,\n    [Vi_perp_mag, Ve_perp_mag],\n    E_LMN,\n    des_energyspectr...,\n    des_energyspectr_ratio\n]\nfaxes = tplot(tvars2plot)\ntlines!(faxes, \"2015-10-16T13:05:52\")\ntlines!(faxes, [\"2015-10-16T13:05:44\", \"2015-10-16T13:06:00\"])\ntlines!(faxes, [\"2015-10-16T13:06:46\", \"2015-10-16T13:07:12\"])\nylims!.(faxes.axes[end-3:end], 1e1, 1e3)\nfaxes\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n![](ps6_files/figure-html/cell-8-output-1.svg){}\n:::\n:::\n\n\n\n### Zoom-in electron spectrograms\n\n> Explain in 1 paragraph what the perpendicular electrons show.\n\nZoom in on the electron spectrograms\n\n::: {#16 .cell execution_count=1}\n``` {.julia .cell-code}\ntBurchFig4 = (\"2015-10-16T13:07:00.5\", \"2015-10-16T13:07:03.5\")\ntlims!(tBurchFig4)\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n![](ps6_files/figure-html/cell-9-output-1.svg){}\n:::\n:::\n\n\n\nThe electron flow speed perpendicular to the magnetic field significantly exceeds the ion flow speed in the vicinity of the X-line, leading to a much stronger current near the X-line compared to the exhaust region. In contrast, the current closely follows the perpendicular ion speed within the magnetosheath and exhaust regions.\n\nFurthermore, as illustrated in the figure below, reconnection dissipation is driven by the intense negative $J_M$ current and negative $E_M$ electric field, both perpendicular to the magnetic field $B$ in the dissipation region. This condition preferentially accelerates electrons in the perpendicular direction, thereby reducing the ratio of electron parallel-to-perpendicular temperature. This effect is clearly demonstrated in the bottom panel of the figure above (compared to the magnetosheath and exhaust regions)\n\n### Dissipation quantity (J Â· E')\n\n::: {#18 .cell execution_count=1}\n``` {.julia .cell-code}\nB_interp = tinterp(B_LMN, J)\nE_LMN_interp = tinterp(E_LMN, J)\nJ_dot_E = tdot(J, E_LMN_interp) |> modify_meta(label=\"j â‹… E\")\nE_parp = tsproj(E_LMN_interp, B_interp) |> modify_meta(label=\"Eâˆ¥\")\nJ_parp = tsproj(J, B_interp)\nJ_dot_E_para = tdot(J_parp, E_parp) |> modify_meta(label=\"jâˆ¥ â‹… Eâˆ¥\")\nJ_dot_E_perp = tdot(toproj(J, B_interp), toproj(E_LMN_interp, B_interp)) |> modify_meta(label=\"jâŠ¥ â‹… EâŠ¥\")\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-bright-black-fg\">â”Œ </span><span style=\"color:rgb(255,135,95)\">3661-element </span>DimArray{Unitful.Quantity{Float64, ğŒ ğ‹â»Â¹ ğ“â»Â³, Unitful.FreeUnits{(Î¼A, mâ»Â³, mV), ğŒ ğ‹â»Â¹ ğ“â»Â³, nothing}}, 1}<span class=\"ansi-bright-black-fg\"> â”</span>\n<span class=\"ansi-bright-black-fg\">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ dims â”¤</span>\n  <span style=\"color:rgb(255,135,95)\">â†“ </span><span style=\"color:rgb(255,135,95)\">Ti</span> Sampled{NanoDates.NanoDate} <span style=\"color:rgb(255,135,95)\">[2015-10-16T13:05:35.144103, â€¦, 2015-10-16T13:07:24.945661]</span> <span style=\"color:rgb(128,128,128)\">ForwardOrdered</span> <span style=\"color:rgb(128,128,128)\">Irregular</span> <span style=\"color:rgb(128,128,128)\">Points</span>\n<span class=\"ansi-bright-black-fg\">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ metadata â”¤</span>\n  Dict{Any, Any} with 1 entry:\n  :label =&gt; \"jâŠ¥ â‹… EâŠ¥\"\n<span class=\"ansi-bright-black-fg\">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>\n <span style=\"color:rgb(255,135,95)\">2015-10-16T13:05:35.144103</span>  -0.0151287 Î¼A mV mâ»Â³\n <span style=\"color:rgb(255,135,95)\">2015-10-16T13:05:35.174103</span>  -0.00870461 Î¼A mV mâ»Â³\n <span style=\"color:rgb(255,135,95)\">2015-10-16T13:05:35.204103</span>   0.0100068 Î¼A mV mâ»Â³\n <span style=\"color:rgb(255,135,95)\">2015-10-16T13:05:35.234103</span>  -0.0133396 Î¼A mV mâ»Â³\n â‹®                           \n <span style=\"color:rgb(255,135,95)\">2015-10-16T13:07:24.885661</span>   0.00910274 Î¼A mV mâ»Â³\n <span style=\"color:rgb(255,135,95)\">2015-10-16T13:07:24.915661</span>   0.0203747 Î¼A mV mâ»Â³\n <span style=\"color:rgb(255,135,95)\">2015-10-16T13:07:24.945661</span>   0.0440117 Î¼A mV mâ»Â³</pre>\n```\n:::\n\n:::\n:::\n\n\n\nJ Â· E is the total energy transfer (energy conversion) rate, which is a key quantity in reconnection studies. Since reconnection is known to be a dissipative process that converts magnetic energy to heat and particle kinetic energy, the dissipation quantity could help identify a physically relevant, small-scale region surrounding the reconnection.\n\n::: {#20 .cell execution_count=1}\n``` {.julia .cell-code}\ntvars2plot = [\n    B_interp,\n    J,\n    E_LMN,\n    E_parp,\n    [J_dot_E, J_dot_E_para, J_dot_E_perp],\n]\nfaxes = tplot(tvars2plot)\ntlines!(faxes, \"2015-10-16T13:05:52\")\ntlines!(faxes, [\"2015-10-16T13:05:44\", \"2015-10-16T13:06:00\"])\ntlines!(faxes, [\"2015-10-16T13:06:46\", \"2015-10-16T13:07:12\"])\nfaxes\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n![](ps6_files/figure-html/cell-11-output-1.svg){}\n:::\n:::\n\n\n\nZoom-in on the dissipation region\n\n::: {#22 .cell execution_count=1}\n``` {.julia .cell-code}\ntlims!(tBurchFig4)\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n![](ps6_files/figure-html/cell-12-output-1.svg){}\n:::\n:::\n\n\n\n",
    "supporting": [
      "ps6_files/figure-html"
    ],
    "filters": [],
    "includes": {}
  }
}