{
  "hash": "a8f087083c7576f923b36ac05526583b",
  "result": {
    "engine": "julia",
    "markdown": "---\ntitle: Problem Set 1\nnumber-sections: true\n---\n\n## AE, Dst, Kp\n\n> Obtain and plot the AE [1min resolution] and Dst [1hr resolution] indices directly from their official site, WDC-C in Kyoto, and Kp [3hr resolution] index from its official site, GFZ Potsdam, the entire month of March 2015.\n> Download ASCII and plot using your own tools which are not SPEDAS. Note itâ€™s easier to download in IAGA-2002 format for AE and Dst and to use the ftp directory download for kp.\n\n### AE and Dst indices\n\n> [a] In a short paragraph explain: What is AE index, and Dst index, and how are they derived? How did you download and plot? Show some lines of the ascii data.\n\nThe AE index (Auroral Electrojet index) and Dst index (Disturbance Storm-Time index) are geomagnetic indices used to measure different aspects of Earthâ€™s magnetic activity. The AE index quantifies the intensity of auroral electrojets, currents flowing in the auroral regions, and is derived from horizontal magnetic field variations measured by magnetometers distributed around the auroral zone. It provides insight into substorm activity and is calculated using the difference between maximum and minimum horizontal components recorded at these stations. The Dst index, on the other hand, measures the intensity of the ring current, a system of charged particles trapped in Earthâ€™s magnetosphere. It is derived from the average horizontal magnetic field variations observed by low-latitude magnetometers. The Dst index is commonly used to assess geomagnetic storms, with negative values indicating stronger disturbances.\n\nWe can use julia to download and plot the AE and Dst indices directly from their official site, WDC-C in Kyoto. \n\n- https://wdc.kugi.kyoto-u.ac.jp/aeasy/index.html\n\n- https://wdc.kugi.kyoto-u.ac.jp/dstae/index.html / http://wdc.kugi.kyoto-u.ac.jp/dst_final/201503\n\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\ndir = \"docs/courses/epss261/homework\"\nif isdir(dir)\n    cd(dir)\n    Pkg.activate(\".\")\n    Pkg.resolve()\n    Pkg.instantiate()\nend\n\nusing DataDeps\nusing Dates\nusing CairoMakie, SpacePhysicsMakie\nusing DimensionalData\nusing CSV, DataFrames\n```\n:::\n\n\n\nFirst we register and download the data dependencies using the `DataDeps` package.\n\n```julia\nusing CSV, DelimitedFiles\nusing TimeSeries\n\nregister(DataDep(\"AE Index\",\n    \"\"\"\n    Dataset: AE Index\n    Website: https://wdc.kugi.kyoto-u.ac.jp/aeasy/index.html\n    \"\"\",\n    \"https://wdc.kugi.kyoto-u.ac.jp///aeasy///wwwtmp/WWW_aeasy04087001.dat\"\n))\n\nregister(DataDep(\"Dst Index\",\n    \"\"\"\n    Dataset: Dst Index\n    Website: https://wdc.kugi.kyoto-u.ac.jp/dstae/index.html\n    \"\"\",\n    \"https://wdc.kugi.kyoto-u.ac.jp///dstae///wwwtmp/WWW_dstae04096902.dat\"\n))\n\n# Step 1: Download data\nae_file = readdir(datadep\"AE Index\", join=true)[1]\ndst_file = readdir(datadep\"Dst Index\", join=true)[1]\n```\n\nThe data is downloaded as text files in IAGA-2002 format. Sample data looks like this:\n\n```{txt}\nDATE       TIME         DOY     AE        AU        AL        AO     |\n2015-03-01 00:00:00.000 060       245.00    122.00   -123.00     -1.00\n2015-03-01 00:01:00.000 060       253.00    125.00   -128.00     -2.00\n2015-03-01 00:02:00.000 060       235.00    122.00   -113.00      5.00\n2015-03-01 00:03:00.000 060       225.00    120.00   -105.00      8.00\n```\n\n```{txt}\nDATE       TIME         DOY     DST                                  |\n2015-03-01 00:00:00.000 060       -34.00\n2015-03-01 01:00:00.000 060       -44.00\n2015-03-01 02:00:00.000 060       -30.00\n2015-03-01 03:00:00.000 060       -31.00\n```\n\nSince the above url is not persistent, we use `CDAWeb.jl` to download the data.\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nusing CDAWeb\n\nstart_time = \"2015-03-01T00:00:00\"\nend_time = \"2015-03-31T23:59:59\"\n\ndataset = CDAWeb.get_data(\"OMNI2_H0_MRG1HR\", start_time, end_time; clip=true)\nae_data = dataset[\"AE\"] |> DimArray\ndst_data = dataset[\"DST\"] |> DimArray\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nPrecompiling packages...\n   9507.0 ms  âœ“ CDFDatasets â†’ CDFDatasetsSpacePhysicsMakieExt\n  1 dependency successfully precompiled in 11 seconds. 316 already precompiled.\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=1}\n```\nâ”Œ 744-element DimArray{Int32, 1} DST â”\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ dims â”\n  â†“ Ti Sampled{CommonDataFormat.Epoch} [2015-03-01T00:00:00, â€¦, 2015-03-31T23:00:00] ForwardOrdered Irregular Points\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ metadata â”¤\n  CommonDataModel.Attributes{CDFDatasets.ConcatCDFVariable{Int32, 1, DiskArrays.ConcatDiskArray{Int32, 1, Vector{CommonDataFormat.CDFVariable{Int32, 1, CommonDataFormat.rVDR{Int64}, CommonDataFormat.CDFDataset{CommonDataFormat.NoCompression, Int64}}}, DiskArrays.GridChunks{1, Tuple{DiskArrays.RegularChunks}}, DiskArrays.Chunked{DiskArrays.SubRanges{DiskArrays.NoStepRange}}}, Nothing}} with 14 entries:\n  \"FILLVAL\"      => Int32[99999]\n  \"FIELDNAM\"     => \"Dst Index (1-h)\"\n  \"VALIDMAX\"     => Int32[500]\n  \"SCALEMAX\"     => Int32[500]\n  \"CATDESC\"      => \"Dst - 1-hour Dst index, from WDC Kyoto\"\n  \"VALIDMIN\"     => Int32[-800]\n  \"DISPLAY_TYPE\" => \"time_series\"\n  \"UNITS\"        => \"nT\"\n  \"DEPEND_0\"     => \"Epoch\"\n  \"BIN_LOCATION\" => \"0.0\"\n  \"FORMAT\"       => \"I5\"\n  \"VAR_TYPE\"     => \"data\"\n  \"SCALEMIN\"     => Int32[-800]\n  \"LABLAXIS\"     => \"1-h Dst\"\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n â‹®      â‹±  \n```\n:::\n:::\n\n\n\nPlot the data using CairoMakie.\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nf = tplot([ae_data, dst_data])\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n![](ps1_files/figure-typst/cell-4-output-1.png){width=800 height=600}\n:::\n:::\n\n\n\n\n### Kp index\n\n> In a second paragraph do the same as above but for Kp. What is Kp index? And how is it derived?\n\nThe Kp index is a global geomagnetic activity index that quantifies disturbances in Earthâ€™s magnetic field caused by solar activity. Kp is calculated from the K values or the geomagnetic recordings of 13 mid-latitude geomagnetic observatories.\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nusing SpaceWeather\n\nkp_data = SpaceWeather.Kp(start_time, end_time)\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```\n1-dimensional KeyedArray(NamedDimsArray(...)) with keys:\nâ†“   time âˆˆ 248-element StepRange{Dates.DateTime,...}\nAnd data, 248-element reshape(adjoint(::Matrix{Union{Missing, Float64}}), 248) with eltype Union{Missing, Float64}:\n  DateTime(\"2015-03-01T01:30:00\")   5.0\n  DateTime(\"2015-03-01T04:30:00\")   5.0\n  DateTime(\"2015-03-01T07:30:00\")   5.3\n  DateTime(\"2015-03-01T10:30:00\")   3.7\n  DateTime(\"2015-03-01T13:30:00\")   2.0\n  DateTime(\"2015-03-01T16:30:00\")   1.3\n  DateTime(\"2015-03-01T19:30:00\")   2.3\n  DateTime(\"2015-03-01T22:30:00\")   2.7\n  â‹®                                 \n  DateTime(\"2015-03-31T04:30:00\")   0.7\n  DateTime(\"2015-03-31T07:30:00\")   2.3\n  DateTime(\"2015-03-31T10:30:00\")   2.3\n  DateTime(\"2015-03-31T13:30:00\")   3.0\n  DateTime(\"2015-03-31T16:30:00\")   3.0\n  DateTime(\"2015-03-31T19:30:00\")   2.7\n  DateTime(\"2015-03-31T22:30:00\")   2.0\n```\n:::\n:::\n\n\n\n### Plot\n\n> [c] Plot all 3 indices in a single plot with common time, UT in usual units [2015-03-01 00:00]. If you cannot plot in this format, simply plot in decimal day or decimal hour.\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nf = tplot([ae_data, dst_data, identity.(kp_data)])\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n![](ps1_files/figure-typst/cell-6-output-1.png){width=800 height=600}\n:::\n:::\n\n\n\n## Galileo Magnetometer PDS\n\n> Obtain and plot the Galileo magnetometer flyby #8 data of Ganymede from the Planetary Data System (PDS). This is the NASA data repository of Planetary missions, the counterpart of SPDF (Space Physics Data Facility) used for Heliophysics missions. Note that planetary magnetospheric quantities are stored in both. UCLA is the central â€œnodeâ€ for PDS with Prof. Walker the PI of that program. Use your own tools such as Excel (but not SPEDAS) to do this (you are welcome to use SPLASH if on Windows (download it from PDS)).\n\n### Coordinate system\n\n> In a short paragraph explain: What is the coordinate system and how did you download and plot?\n\nDataset about Galileo (https://pds-ppi.igpp.ucla.edu/mission/Galileo) flyby of Ganymede is available in the Planetary Data System (PDS) https://pds-ppi.igpp.ucla.edu/collection/urn:nasa:pds:galileo-mag-jup-calibrated:data-highres-ganymede [@kivelsonGalileoJupiterMAG2022]. Galileo calibrated MAG high-resolution magnetic field and trajectory data from the Ganymede 8 orbit Ganymede flyby cover 1997-05-07T15:36:00 to 1997-05-07T16:22:00.\n\nThe dataset contains data in the following coordinate systems:\n\n- Ganymede Phi-Omega (GPHIO) coordinates https://pds-ppi.igpp.ucla.edu/item/urn:nasa:pds:galileo-mag-jup-calibrated:data-highres-ganymede:orb08_gan_gphio::1.0 [@kivelsonGalileoJupiterMAG2022].\n- Ganymede-centered 'planetocentric' right-handed (GSPRH) coordinates https://pds-ppi.igpp.ucla.edu/item/urn:nasa:pds:galileo-mag-jup-calibrated:data-highres-ganymede:orb08_gan_gsprh::1.0\n- Despun Spacecraft (IRC) coordinates https://pds-ppi.igpp.ucla.edu/item/urn:nasa:pds:galileo-mag-jup-calibrated:data-highres-ganymede:orb08_gan_irc::1.0\n- System III [1965] (SYS3) coordinates https://pds-ppi.igpp.ucla.edu/item/urn:nasa:pds:galileo-mag-jup-calibrated:data-highres-ganymede:orb08_gan_sys3::1.0\n\nThe data is downloaded as CSV format, read and plot using Julia.\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nregister(DataDep(\"ORB08_GAN_GPHIO\",\n    \"\"\"\n    Dataset: ORB08_GAN_GPHIO\n    Website: https://pds-ppi.igpp.ucla.edu/mission/Galileo\n    \"\"\",\n    \"https://pds-ppi.igpp.ucla.edu/ditdos/write?id=urn:nasa:pds:galileo-mag-jup-calibrated:data-highres-ganymede:orb08_gan_gphio::1.1&f=csv\"\n))\n\nGAN_file = readdir(datadep\"ORB08_GAN_GPHIO\", join=true)[1]\n\ndata = CSV.File(GAN_file) |> DataFrame\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<div><div style = \"float: left;\"><span>8187Ã—8 DataFrame</span></div><div style = \"float: right;\"><span style = \"font-style: italic;\">8162 rows omitted</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">SPACECRAFT EVENT TIME</th><th style = \"text-align: left;\">BX</th><th style = \"text-align: left;\">BY</th><th style = \"text-align: left;\">BZ</th><th style = \"text-align: left;\">B-FIELD MAGNITUDE</th><th style = \"text-align: left;\">X</th><th style = \"text-align: left;\">Y</th><th style = \"text-align: left;\">Z</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"Dates.DateTime\" style = \"text-align: left;\">DateTime</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">1997-05-07T15:36:55.133</td><td style = \"text-align: right;\">-8.36</td><td style = \"text-align: right;\">-25.04</td><td style = \"text-align: right;\">-85.24</td><td style = \"text-align: right;\">89.23</td><td style = \"text-align: right;\">-1.57456</td><td style = \"text-align: right;\">-3.67635</td><td style = \"text-align: right;\">0.6489</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">1997-05-07T15:36:55.467</td><td style = \"text-align: right;\">-8.38</td><td style = \"text-align: right;\">-25.16</td><td style = \"text-align: right;\">-85.22</td><td style = \"text-align: right;\">89.25</td><td style = \"text-align: right;\">-1.57452</td><td style = \"text-align: right;\">-3.67527</td><td style = \"text-align: right;\">0.64893</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">1997-05-07T15:36:55.800</td><td style = \"text-align: right;\">-8.41</td><td style = \"text-align: right;\">-25.09</td><td style = \"text-align: right;\">-85.24</td><td style = \"text-align: right;\">89.25</td><td style = \"text-align: right;\">-1.57448</td><td style = \"text-align: right;\">-3.6742</td><td style = \"text-align: right;\">0.64897</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">1997-05-07T15:36:56.133</td><td style = \"text-align: right;\">-8.44</td><td style = \"text-align: right;\">-25.08</td><td style = \"text-align: right;\">-85.27</td><td style = \"text-align: right;\">89.28</td><td style = \"text-align: right;\">-1.57445</td><td style = \"text-align: right;\">-3.67313</td><td style = \"text-align: right;\">0.649</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: left;\">1997-05-07T15:36:56.467</td><td style = \"text-align: right;\">-8.5</td><td style = \"text-align: right;\">-25.16</td><td style = \"text-align: right;\">-85.19</td><td style = \"text-align: right;\">89.23</td><td style = \"text-align: right;\">-1.57441</td><td style = \"text-align: right;\">-3.67206</td><td style = \"text-align: right;\">0.64904</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">6</td><td style = \"text-align: left;\">1997-05-07T15:36:56.800</td><td style = \"text-align: right;\">-8.47</td><td style = \"text-align: right;\">-25.18</td><td style = \"text-align: right;\">-85.18</td><td style = \"text-align: right;\">89.23</td><td style = \"text-align: right;\">-1.57437</td><td style = \"text-align: right;\">-3.67098</td><td style = \"text-align: right;\">0.64907</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">7</td><td style = \"text-align: left;\">1997-05-07T15:36:57.133</td><td style = \"text-align: right;\">-8.6</td><td style = \"text-align: right;\">-25.2</td><td style = \"text-align: right;\">-85.18</td><td style = \"text-align: right;\">89.25</td><td style = \"text-align: right;\">-1.57434</td><td style = \"text-align: right;\">-3.66991</td><td style = \"text-align: right;\">0.64911</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8</td><td style = \"text-align: left;\">1997-05-07T15:36:57.467</td><td style = \"text-align: right;\">-8.47</td><td style = \"text-align: right;\">-25.04</td><td style = \"text-align: right;\">-85.12</td><td style = \"text-align: right;\">89.13</td><td style = \"text-align: right;\">-1.5743</td><td style = \"text-align: right;\">-3.66884</td><td style = \"text-align: right;\">0.64914</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">9</td><td style = \"text-align: left;\">1997-05-07T15:36:57.800</td><td style = \"text-align: right;\">-8.44</td><td style = \"text-align: right;\">-25.04</td><td style = \"text-align: right;\">-85.17</td><td style = \"text-align: right;\">89.17</td><td style = \"text-align: right;\">-1.57426</td><td style = \"text-align: right;\">-3.66777</td><td style = \"text-align: right;\">0.64918</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">10</td><td style = \"text-align: left;\">1997-05-07T15:36:58.133</td><td style = \"text-align: right;\">-8.41</td><td style = \"text-align: right;\">-25.3</td><td style = \"text-align: right;\">-85.06</td><td style = \"text-align: right;\">89.14</td><td style = \"text-align: right;\">-1.57423</td><td style = \"text-align: right;\">-3.66669</td><td style = \"text-align: right;\">0.64921</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">11</td><td style = \"text-align: left;\">1997-05-07T15:36:58.467</td><td style = \"text-align: right;\">-8.39</td><td style = \"text-align: right;\">-25.27</td><td style = \"text-align: right;\">-85.0</td><td style = \"text-align: right;\">89.08</td><td style = \"text-align: right;\">-1.57419</td><td style = \"text-align: right;\">-3.66562</td><td style = \"text-align: right;\">0.64925</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">12</td><td style = \"text-align: left;\">1997-05-07T15:36:58.800</td><td style = \"text-align: right;\">-8.37</td><td style = \"text-align: right;\">-25.01</td><td style = \"text-align: right;\">-85.09</td><td style = \"text-align: right;\">89.09</td><td style = \"text-align: right;\">-1.57415</td><td style = \"text-align: right;\">-3.66455</td><td style = \"text-align: right;\">0.64928</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">13</td><td style = \"text-align: left;\">1997-05-07T15:36:59.133</td><td style = \"text-align: right;\">-8.37</td><td style = \"text-align: right;\">-24.98</td><td style = \"text-align: right;\">-85.12</td><td style = \"text-align: right;\">89.11</td><td style = \"text-align: right;\">-1.57411</td><td style = \"text-align: right;\">-3.66348</td><td style = \"text-align: right;\">0.64932</td></tr><tr><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td><td style = \"text-align: right;\">&vellip;</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8176</td><td style = \"text-align: left;\">1997-05-07T16:22:20.132</td><td style = \"text-align: right;\">-10.75</td><td style = \"text-align: right;\">17.76</td><td style = \"text-align: right;\">-86.47</td><td style = \"text-align: right;\">88.93</td><td style = \"text-align: right;\">-1.00607</td><td style = \"text-align: right;\">5.14564</td><td style = \"text-align: right;\">0.79636</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8177</td><td style = \"text-align: left;\">1997-05-07T16:22:20.465</td><td style = \"text-align: right;\">-10.86</td><td style = \"text-align: right;\">17.67</td><td style = \"text-align: right;\">-86.62</td><td style = \"text-align: right;\">89.06</td><td style = \"text-align: right;\">-1.00598</td><td style = \"text-align: right;\">5.1467</td><td style = \"text-align: right;\">0.79637</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8178</td><td style = \"text-align: left;\">1997-05-07T16:22:20.799</td><td style = \"text-align: right;\">-10.95</td><td style = \"text-align: right;\">17.63</td><td style = \"text-align: right;\">-86.69</td><td style = \"text-align: right;\">89.14</td><td style = \"text-align: right;\">-1.00589</td><td style = \"text-align: right;\">5.14777</td><td style = \"text-align: right;\">0.79637</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8179</td><td style = \"text-align: left;\">1997-05-07T16:22:21.132</td><td style = \"text-align: right;\">-10.91</td><td style = \"text-align: right;\">17.59</td><td style = \"text-align: right;\">-86.88</td><td style = \"text-align: right;\">89.32</td><td style = \"text-align: right;\">-1.00579</td><td style = \"text-align: right;\">5.14884</td><td style = \"text-align: right;\">0.79638</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8180</td><td style = \"text-align: left;\">1997-05-07T16:22:21.465</td><td style = \"text-align: right;\">-10.86</td><td style = \"text-align: right;\">17.93</td><td style = \"text-align: right;\">-86.6</td><td style = \"text-align: right;\">89.1</td><td style = \"text-align: right;\">-1.0057</td><td style = \"text-align: right;\">5.1499</td><td style = \"text-align: right;\">0.79638</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8181</td><td style = \"text-align: left;\">1997-05-07T16:22:21.799</td><td style = \"text-align: right;\">-10.97</td><td style = \"text-align: right;\">17.63</td><td style = \"text-align: right;\">-86.44</td><td style = \"text-align: right;\">88.9</td><td style = \"text-align: right;\">-1.00561</td><td style = \"text-align: right;\">5.15097</td><td style = \"text-align: right;\">0.79639</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8182</td><td style = \"text-align: left;\">1997-05-07T16:22:22.132</td><td style = \"text-align: right;\">-11.01</td><td style = \"text-align: right;\">17.53</td><td style = \"text-align: right;\">-86.46</td><td style = \"text-align: right;\">88.9</td><td style = \"text-align: right;\">-1.00551</td><td style = \"text-align: right;\">5.15204</td><td style = \"text-align: right;\">0.79639</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8183</td><td style = \"text-align: left;\">1997-05-07T16:22:22.465</td><td style = \"text-align: right;\">-10.98</td><td style = \"text-align: right;\">17.45</td><td style = \"text-align: right;\">-86.38</td><td style = \"text-align: right;\">88.81</td><td style = \"text-align: right;\">-1.00542</td><td style = \"text-align: right;\">5.1531</td><td style = \"text-align: right;\">0.7964</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8184</td><td style = \"text-align: left;\">1997-05-07T16:22:22.799</td><td style = \"text-align: right;\">-11.05</td><td style = \"text-align: right;\">17.35</td><td style = \"text-align: right;\">-86.41</td><td style = \"text-align: right;\">88.82</td><td style = \"text-align: right;\">-1.00533</td><td style = \"text-align: right;\">5.15417</td><td style = \"text-align: right;\">0.7964</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8185</td><td style = \"text-align: left;\">1997-05-07T16:22:23.132</td><td style = \"text-align: right;\">-11.07</td><td style = \"text-align: right;\">17.39</td><td style = \"text-align: right;\">-86.42</td><td style = \"text-align: right;\">88.84</td><td style = \"text-align: right;\">-1.00523</td><td style = \"text-align: right;\">5.15524</td><td style = \"text-align: right;\">0.79641</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8186</td><td style = \"text-align: left;\">1997-05-07T16:22:23.465</td><td style = \"text-align: right;\">-11.17</td><td style = \"text-align: right;\">17.37</td><td style = \"text-align: right;\">-86.27</td><td style = \"text-align: right;\">88.71</td><td style = \"text-align: right;\">-1.00514</td><td style = \"text-align: right;\">5.1563</td><td style = \"text-align: right;\">0.79641</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">8187</td><td style = \"text-align: left;\">1997-05-07T16:22:23.465</td><td style = \"text-align: right;\">-11.17</td><td style = \"text-align: right;\">17.37</td><td style = \"text-align: right;\">-86.27</td><td style = \"text-align: right;\">88.71</td><td style = \"text-align: right;\">-1.00514</td><td style = \"text-align: right;\">5.1563</td><td style = \"text-align: right;\">0.79641</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n\n### Plot\n\n> Plot XYZ components and magnitude of the field in four panels. Use a 5th panel in the same plot to show all four traces with different colors, say: Blue, Green, Red, Black for X,Y,Z,T.\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\n# Create the plot with multiple panels\nfig = Figure(; size=(600, 600))\n\ntime = data.\"SPACECRAFT EVENT TIME\"\n\n# Panel for BX\nax1 = Axis(fig[1, 1], title=\"BX Component\", xlabel=\"Time\", ylabel=\"BX (nT)\")\nlines!(ax1, time, data[!, \"BX\"], color=:blue)\n\n# Panel for BY\nax2 = Axis(fig[2, 1], title=\"BY Component\", xlabel=\"Time\", ylabel=\"BY (nT)\")\nlines!(ax2, time, data[!, \"BY\"], color=:green)\n\n# Panel for BZ\nax3 = Axis(fig[3, 1], title=\"BZ Component\", xlabel=\"Time\", ylabel=\"BZ (nT)\")\nlines!(ax3, time, data[!, \"BZ\"], color=:red)\n\n# Panel for B-FIELD MAGNITUDE\nax4 = Axis(fig[4, 1], title=\"B-Field Magnitude\", xlabel=\"Time\", ylabel=\"Magnitude (nT)\")\nlines!(ax4, time, data[!, \"B-FIELD MAGNITUDE\"], color=:black)\n\n# Panel for all traces\nax5 = Axis(fig[5, 1], title=\"All Components\", xlabel=\"Time\", ylabel=\"B (nT)\")\nlines!(ax5, time, data[!, \"BX\"], color=:blue, label=\"BX\")\nlines!(ax5, time, data[!, \"BY\"], color=:green, label=\"BY\")\nlines!(ax5, time, data[!, \"BZ\"], color=:red, label=\"BZ\")\nlines!(ax5, time, data[!, \"B-FIELD MAGNITUDE\"], color=:black, label=\"Magnitude\")\n\nfor ax in [ax1, ax2, ax3, ax4]\n    hidexdecorations!(ax, grid=false)\nend\n\nlinkxaxes!(ax1, ax2, ax3, ax4, ax5)\naxislegend(ax5)\n\nfig\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n![](ps1_files/figure-typst/cell-8-output-1.png){width=600 height=600}\n:::\n:::\n\n\n\n## Voyager 2 Heliospheric termination shock\n\n> Voyager 2 crossed the Heliospheric termination shock and entered the heliosheath in Aug. 2007.  \n\n### Plot and analysis\n\n> [a] Plot the shock crossing in CDAWeb using their own plotting resources. In particular plot the total and RTN components of the magnetic field, flow speed, proton density N, and temperature T. In a short paragraph explain: what is the RTN system and how did you create the plot? In a second paragraph explain if the changes in the above parameters are consistent with shock crossings.\n\nThe RTN (Radial-Tangential-Normal) coordinate system is a heliocentric coordinate system used to describe the position in relation to the Sun fixed at a spacecraft (or the planet): The R axis is  directed radially away from the Sun, the T axis is the cross product of the solar rotation axis and the R axis, and the N axis is the cross product of R and T. \n\n![](figures/VOYAGER2_COHO1HR_MERGED_MAG_PLASMA_1657876_000.png){width=63%}\n\nWe utilize the combined COHOWeb dataset (VOYAGER2_COHO1HR_MERGED_MAG_PLASMA, https://cdaweb.gsfc.nasa.gov/misc/NotesV.html#VOYAGER2_COHO1HR_MERGED_MAG_PLASMA) [@nessVoyager2Hourly2023]. The plot was generated using \"CDAWeb Data Explorer\" by selecting the â€œPlot Dataâ€ option and choosing the appropriate data variable. We select time range from 2007/08/01 00:00:00.000 to 2007/09/30 00:00:00.000.\n\nAround the end of August 31, we observe a significant decrease in bulk flow velocity accompanied by increases in proton density and temperature, corresponding to the shock crossing. Additionally, the magnetic field exhibits a slight increase. These changes are consistent with shock crossings, as shocks typically cause reductions in downstream flow velocity and simultaneous enhancements in plasma density, temperature, and magnetic field strength.\n\n> [b] What is the change in pressure, including dynamic pressure, across the shock (assume the crossing is along the shock normal)? To do this also ignore the electron thermal pressure (just use ion thermal pressure) and plot the quantity: N*V^2 + Pt, where Pt is the sum of magnetic and thermal pressures. Do this using your own tools (not SPEDAS) after downloading the data from SPDF.\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nusing CDAWeb\nusing SpaceDataModel: setmeta\nusing Unitful\nusing Unitful: Î¼0, k, mp\n\nt0 = \"2007-08-01\"\nt1 = \"2007-09-30\"\ndataset = CDAWeb.get_data(\"VOYAGER2_COHO1HR_MERGED_MAG_PLASMA\", t0, t1)\nN = DimArray(dataset[\"protonDensity\"]) * u\"cm^-3\"\nV = DimArray(dataset[\"V\"]) * u\"km/s\"\nB = DimArray(dataset[\"ABS_B\"]) * u\"nT\"\nT = DimArray(dataset[\"protonTemp\"]) * u\"K\"\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```\nâ”Œ 1464-element DimArray{Unitful.Quantity{Float32, ðš¯, Unitful.FreeUnits{(K,), ðš¯, nothing}}, 1} â”\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ dims â”¤\n  â†“ Ti Sampled{CommonDataFormat.Epoch} [2007-08-01T00:00:00, â€¦, 2007-09-30T23:00:00] ForwardOrdered Irregular Points\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ metadata â”¤\n  CommonDataModel.Attributes{CDFDatasets.ConcatCDFVariable{Float32, 1, DiskArrays.ConcatDiskArray{Float32, 1, Vector{CommonDataFormat.CDFVariable{Float32, 1, CommonDataFormat.VDR{Int64}, CommonDataFormat.CDFDataset{CommonDataFormat.NoCompression, Int64}}}, DiskArrays.GridChunks{1, Tuple{DiskArrays.IrregularChunks}}, DiskArrays.Chunked{DiskArrays.SubRanges{DiskArrays.NoStepRange}}}, Nothing}} with 11 entries:\n  \"FILLVAL\"      => Float32[-1.0f31]\n  \"FIELDNAM\"     => \"Proton temperature\"\n  \"VALIDMAX\"     => Float32[1.0f7]\n  \"CATDESC\"      => \"Proton Temperature (calculated from thermal speed width T=â€¦\n  \"VALIDMIN\"     => Float32[0.0]\n  \"DISPLAY_TYPE\" => \"time_series\"\n  \"UNITS\"        => \"deg k\"\n  \"DEPEND_0\"     => \"Epoch\"\n  \"FORMAT\"       => \"f9.0\"\n  \"VAR_TYPE\"     => \"data\"\n  \"LABLAXIS\"     => \"Radial_proton_temp\"\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n â‹®      â‹±  \n```\n:::\n:::\n\n\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\n# Calculate the pressure\npB = @. B^2 / Î¼0 / 2 / 1u\"nPa\" |> NoUnits\npT = @. k * N * T / u\"nPa\" |> NoUnits\npRam = @. mp * N * V^2 / u\"nPa\" |> NoUnits\nbeta = pT ./ pB\n\npB = setmeta(pB, \"LABL_PTR_1\" => \"Magnetic Pressure\")\npT = setmeta(pT, \"LABL_PTR_1\" => \"Thermal Pressure\")\npRam = setmeta(pRam, \"LABL_PTR_1\" => \"Ram Pressure\")\npressure = setmeta(pRam .+ pB .+ pT, \"LABL_PTR_1\" => \"Total Pressure\")\nbeta = setmeta(beta, \"UNITS\" => \"\", \"LABLAXIS\" => \"Beta\")\ntplot([[pRam, pB, pT, pressure], beta]; plottype=ScatterLines)\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n![](ps1_files/figure-typst/cell-10-output-1.png){width=800 height=600}\n:::\n:::\n\n\n\n## Archived code\n\nParsing the data into TimeSeries using `DelimitedFiles` and `TimeSeries`.\n\n```julia\nfunction load_ae_data(filename)\n    meta = Dict(\n        \"unit\" => \"nT\",\n        \"label\" => \"AE Index\"\n    )\n\n    # Skip the header lines (first 14 lines)\n    data, header = readdlm(filename, skipstart=14, header=true)\n\n    # Convert date and time columns to DateTime\n    datetime = DateTime.(data[:, 1] .* \"T\" .* data[:, 2])\n\n    TimeArray(datetime, data[:, 4:7], header[4:7], meta)\nend\n\nfunction load_dst_data(filename)\n    meta = Dict(\n        \"unit\" => \"nT\",\n        \"label\" => \"Dst Index\"\n    )\n\n    # Skip the header lines (first 17 lines)\n    data, header = readdlm(filename, skipstart=17, header=true)\n\n    # Convert date and time columns to DateTime\n    datetime = DateTime.(data[:, 1] .* \"T\" .* data[:, 2])\n\n    TimeArray(datetime, data[:, 4:4], header[4:4], meta)\nend\n\nae_data = load_ae_data(ae_file)\ndst_data = load_dst_data(dst_file)\n```\n\nUsing a web service client to load the data (https://kp.gfz-potsdam.de/en/data) from json format into the TimeArray.\n\n```julia\nusing JSON3\n\n\"\"\"\nDownload 'Kp', 'ap', 'Ap', 'Cp', 'C9', 'Hp30', 'Hp60', 'ap30', 'ap60', 'SN', 'Fobs' or 'Fadj' index data from kp.gfz-potsdam.de\n\n# Notes\n- 'start_time' and 'end_time': date format 'YYYY-MM-DDThh:mm:ss'\n\"\"\"\nfunction load_Kp_data(start_time, end_time, index=:Kp)\n    url = \"https://kp.gfz-potsdam.de/app/json/?start=$(start_time)Z&end=$(end_time)Z&index=$(index)\"\n    data = JSON3.read(download(url))\n    datetime = DateTime.(data[:datetime], \"yyyy-mm-ddTHH:MM:SSZ\")\n    TimeArray(datetime, Float64.(data[index]), [index], Dict(\"unit\" => \"\", \"label\" => string(index)))\nend\n\nkp_data = load_Kp_data(start_time, end_time)\n```\n\nUsing a web service client to load the data (https://cdaweb.gsfc.nasa.gov/misc/NotesV.html#VOYAGER2_COHO1HR_MERGED_MAG_PLASMA) from csv format.\n\n```julia\nusing Unitful\nusing Unitful: Î¼0, k, mp\n\nregister(DataDep(\"VOYAGER2_COHO1HR_MERGED_MAG_PLASMA\",\n    \"\"\"\n    Dataset: VOYAGER2_COHO1HR_MERGED_MAG_PLASMA\n    Website: https://cdaweb.gsfc.nasa.gov/misc/NotesV.html#VOYAGER2_COHO1HR_MERGED_MAG_PLASMA\n    \"\"\",\n    \"https://cdaweb.gsfc.nasa.gov/tmp/cweb_B6vad1PhkF/VOYAGER2_COHO1HR_MERGED_MAG_PLASMA_1663093.csv\"\n))\n\n# Read the CSV file\nVIM_file = readdir(datadep\"VOYAGER2_COHO1HR_MERGED_MAG_PLASMA\", join=true)[1]\ndata = CSV.File(VIM_file; comment=\"#\") |> DataFrame\n\nallowmissing!(data)\ndata[!, \"time\"] = DateTime.(data.\"EPOCH_yyyy-mm-ddThh:mm:ss.sssZ\", \"yyyy-mm-ddTHH:MM:SS.sssZ\")\nfor c âˆˆ eachcol(data)\n    replace!(c, -1.0e31 => missing)\nend\ndropmissing!(data)\n\nN = data[!, \"SW_PROTON_DENS_n/cc\"] * u\"cm^-3\"\nV = data[!, \"BULK_FLOW_SPEED_km/s\"] * u\"km/s\"\nB = data[!, \"FIELD_MAGNITUDE_AVG._nT\"] * u\"nT\"\nT = data[!, \"RADIAL_PROTON_TEMP_deg_k\"] * u\"K\"\n```\n\n",
    "supporting": [
      "ps1_files/figure-typst"
    ],
    "filters": []
  }
}