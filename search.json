[
  {
    "objectID": "courses/epss265/homeworks/epss265_hw03.html",
    "href": "courses/epss265/homeworks/epss265_hw03.html",
    "title": "03 - SCM Noise Curves",
    "section": "",
    "text": "NASA’s Science Mission Directorate (SMD) held its Fall Quarterly town hall meeting with the public. The event was led by NASA’s Associate Administrator for Science, Dr. Nicky Fox, and representatives of all SMD Divisions who answered questions submitted by the public on October 19. This one-hour event was advertised in advance at smd@listsrv2.nasaprs.com (enlist if you like). Watch the recorded video from that here.\n\nHow does NASA deal with starts for new missions, like UOP, if budgets are tight?\nHow does NASA deal with continuing resolutions (CRs) and with government shutdowns?\nHow will NASA/Biological Physical sciences respond to its recent NAS Decadal Survey?\nWhat are the 2 most interesting science highlights presented by the various divisions?\n\n\n\nGenerally, NASA will reallocate budget: it may adjust its portfolio to prioritize high-priority missions. This could mean delaying or scaling back other projects or seeking additional funds specifically earmarked for the mission. For Uranus Orbiter and Probe (UOP) specifically, NASA most likely will not initialize it in the next few years.\nDuring a Continuing Resolution, NASA can generally continue its operations at funding levels approved in the previous fiscal year but cannot start new projects and pend the amount of fundings. In the case of a government shutdown, non-essential operations are suspended, and only critical mission operations, like support for the International Space Station and maintaining mission properties. Scheduled launches will be postponed and administrative functions will be suspended.\nNASA’s Biological and Physical Sciences division would typically use the recommendations from the National Academies of Sciences (NAS) Decadal Survey to shape its research agenda. The division will hold a townhall which shares and discusses their responds. The survey is influential in determining funding priorities and research directions. The agency may: adjust its research priorities, reallocate resources and personnel as identified in the survey.\nHighlights\n\nAstro highlight:\n\nWebb Discovers Methane, Carbon Dioxide in Atmosphere of K2-18 b\nLaunch of XRISM and Euclid missions\n\nBiological and Physical Sciences highlight:\n\nGene transcription (gravity variable)\n\nPlanetary highlight:\n\nSample return OSIRIS-REx and first analysis\nCelebration of DART success\nLaunch of Psyche mission\nDinkinesh Flyby of Lucy mission\n\nHeliophysics highlight:\n\nHeliophysics Big Year, a global celebration of solar science\nSolar Eclipse\nLaunch of AWE (Atmospheric Waves Experiment) mission\n\nEarth highlight:\n\nLaunch of TEMPO (Tropospheric Emissions: Monitoring of Pollution) mission\nLaunch of Earth Surface Mineral Dust Source Investigation (EMIT) and OCO-3 instruments",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "03 - SCM Noise Curves"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw03.html#question-1",
    "href": "courses/epss265/homeworks/epss265_hw03.html#question-1",
    "title": "03 - SCM Noise Curves",
    "section": "",
    "text": "NASA’s Science Mission Directorate (SMD) held its Fall Quarterly town hall meeting with the public. The event was led by NASA’s Associate Administrator for Science, Dr. Nicky Fox, and representatives of all SMD Divisions who answered questions submitted by the public on October 19. This one-hour event was advertised in advance at smd@listsrv2.nasaprs.com (enlist if you like). Watch the recorded video from that here.\n\nHow does NASA deal with starts for new missions, like UOP, if budgets are tight?\nHow does NASA deal with continuing resolutions (CRs) and with government shutdowns?\nHow will NASA/Biological Physical sciences respond to its recent NAS Decadal Survey?\nWhat are the 2 most interesting science highlights presented by the various divisions?\n\n\n\nGenerally, NASA will reallocate budget: it may adjust its portfolio to prioritize high-priority missions. This could mean delaying or scaling back other projects or seeking additional funds specifically earmarked for the mission. For Uranus Orbiter and Probe (UOP) specifically, NASA most likely will not initialize it in the next few years.\nDuring a Continuing Resolution, NASA can generally continue its operations at funding levels approved in the previous fiscal year but cannot start new projects and pend the amount of fundings. In the case of a government shutdown, non-essential operations are suspended, and only critical mission operations, like support for the International Space Station and maintaining mission properties. Scheduled launches will be postponed and administrative functions will be suspended.\nNASA’s Biological and Physical Sciences division would typically use the recommendations from the National Academies of Sciences (NAS) Decadal Survey to shape its research agenda. The division will hold a townhall which shares and discusses their responds. The survey is influential in determining funding priorities and research directions. The agency may: adjust its research priorities, reallocate resources and personnel as identified in the survey.\nHighlights\n\nAstro highlight:\n\nWebb Discovers Methane, Carbon Dioxide in Atmosphere of K2-18 b\nLaunch of XRISM and Euclid missions\n\nBiological and Physical Sciences highlight:\n\nGene transcription (gravity variable)\n\nPlanetary highlight:\n\nSample return OSIRIS-REx and first analysis\nCelebration of DART success\nLaunch of Psyche mission\nDinkinesh Flyby of Lucy mission\n\nHeliophysics highlight:\n\nHeliophysics Big Year, a global celebration of solar science\nSolar Eclipse\nLaunch of AWE (Atmospheric Waves Experiment) mission\n\nEarth highlight:\n\nLaunch of TEMPO (Tropospheric Emissions: Monitoring of Pollution) mission\nLaunch of Earth Surface Mineral Dust Source Investigation (EMIT) and OCO-3 instruments",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "03 - SCM Noise Curves"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw03.html#question-2",
    "href": "courses/epss265/homeworks/epss265_hw03.html#question-2",
    "title": "03 - SCM Noise Curves",
    "section": "Question 2",
    "text": "Question 2\n\nFor a day/time of interestNote1 from THEMIS or MMS, based on your perusal of the overview plots at the mission website, and using standard tools:\n\nPlot SCM time-series data in 2 different coordinate systems: one that you introduce from L2 files and one you create by rotating the data using cotrans (e.g., GSE and SM coord’s).\nDo a time-series spectrogram of a SCM component in some geophysical coordinates in survey and burst mode up to a high frequency, several kHz (use waveburst from THEMIS or “hb” from MMS).\nSelect a time when the geophysical signal (plasma waves) is at minimum (a quiet period) by looking at the dynamic power spectrum first. Compare the quiet time spectrum (a line spectrum) plot with published instrument noise curves: Point out the characteristic noise curve, a decreasing noise density as a function of frequency at low frequencies, a minimum near the resonance, and an increasing noise level at high frequencies – does it match expectation? Can you point out the plasma waves in the dynamic power spectrum?\n\nNote1: A good day for THEMIS is the first results Space Sci. Rev. paper (2007-03-23 13-16UT,) or the first Science paper (2008-02-26 4- 6UT) from any THEMIS spacecraft. A good day for MMS is the first Science paper (2015-10-16 13:00-14:00UT) from any MMS spacecraft.\n\nWe choose MMS for this question. And the data is from 2015-10-16 13:00-14:00UT.\nIts overall summary plot together with SCM quicklook plots are shown below.\n\n\n\n\n\n\n\n\nMMS Overall Summary\n\n\n\n\n\nMMS Overall Summary\n\n\n\n\n\n\n\n\n\n\n\n\nMMS SCM L2 SURVEY SCSRV\n\n\n\n\n\nMMS SCM L2 BRST SCB\n\n\n\n\nReferences:\n\nLe Contel, O., P. Leroy, A. Roux, C. Coillot, D. Alison, A. Bouabdellah, L. Mirioni, et al. “The Search-Coil Magnetometer for MMS.” Space Science Reviews 199, no. 1 (March 1, 2016): 257–82. https://doi.org/10.1007/s11214-014-0096-9.\nLPP - Laboratoire de Physique des Plasmas - UMR 7648 - MMS/SCM\nMMS SCM Quicklooks webpage\n\n\nTransforming coordinates\n\n\nCode\nimport pyspedas\nfrom pytplot import tplot, get_data\n\n\n\n\nCode\ntime_range = ['2015-10-16T13:05:30', '2015-10-16T13:07:30']\n\ntvars = pyspedas.mms.scm(trange=time_range, data_rate='brst', time_clip=True, probe='1')\ntplot(tvars)\n\n\n03-Nov-23 23:04:53: Loading /Users/zijin/data/mms/mms1/scm/brst/l2/schb/2015/10/16/mms1_scm_brst_l2_schb_20151016130524_v2.2.0.cdf\n03-Nov-23 23:04:53: Loading /Users/zijin/data/mms/mms1/scm/brst/l2/scb/2015/10/16/mms1_scm_brst_l2_scb_20151016130524_v2.2.0.cdf\n03-Nov-23 23:04:57: Time clip was applied to: mms1_scm_acb_gse_scb_brst_l2\n03-Nov-23 23:04:57: Time clip was applied to: mms1_scm_acb_gse_schb_brst_l2\n03-Nov-23 23:04:57: Loaded variables:\n03-Nov-23 23:04:57: mms1_scm_acb_gse_scb_brst_l2\n03-Nov-23 23:04:57: mms1_scm_acb_gse_schb_brst_l2\n\n\n\n\n\n\n\n\n\n\n\nCode\ntvars_sm = []\ncoord_out = 'sm'\nfor tvar in tvars:\n    pyspedas.cotrans(tvar, coord_out=coord_out)\n    tvar_sm = tvar + '_' + coord_out\n    tvars_sm.append(tvar_sm)\n\ntplot(tvars_sm)\n\n\n03-Nov-23 23:04:58: ['gse', 'gsm', 'sm']\n03-Nov-23 23:05:01: Running transformation: subgse2gsm\n03-Nov-23 23:05:03: Running transformation: subgsm2sm\n03-Nov-23 23:05:03: Output variable: mms1_scm_acb_gse_scb_brst_l2_sm\n03-Nov-23 23:05:03: ['gse', 'gsm', 'sm']\n03-Nov-23 23:05:04: Running transformation: subgse2gsm\n03-Nov-23 23:05:05: Running transformation: subgsm2sm\n03-Nov-23 23:05:05: Output variable: mms1_scm_acb_gse_schb_brst_l2_sm\n\n\n\n\n\n\n\n\n\n\n\nSpectrogram\n\n\nCode\ntvar_tdpwrspc = pyspedas.tdpwrspc('mms1_scm_acb_gse_schb_brst_l2_sm')\ntplot(tvar_tdpwrspc[0])\n\ntvar_tdpwrspc = pyspedas.tdpwrspc('mms1_scm_acb_gse_scb_brst_l2_sm')\ntplot(tvar_tdpwrspc)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nQuiet time spectrum\n\nThe SCM provides the three components of the magnetic fluctuations in the 1 Hz – 6 kHz nominal frequency range. The noise equivalent magnetic induction (NEMI or sensitivity) of the search-coil antenna is less than or equal to : 2 pT/sqrt(Hz) at 10 Hz, 0.3 pT/sqrt(Hz) at 100 Hz and 0.05 pT/sqrt(Hz) at 1 kHz (Fig. 6). The SCM resolution at 1k Hz is 0.15pT.\n\n\n\n\n\n\n\n\n\nFigure 6. Noise curve in magnetic field (” NEMI “) of each axis of the triaxe fluxmeter.\n\n\n\n\n\n\n\n\n\nCode\nimport matplotlib.pyplot as plt\nimport numpy as np\n\n\nFrom quickplot, we visually find the quiet time is around 2015-10-16T13:06:16. It mathchs expectation and looks quite like the NEMI from publications : resonance near 1kz with minimum noise level, together with a decreasing noise density at low frequencies, and an increasing noise level at high frequencies.\nFrom the quickplot spectrum, we can see there are some waves of 50-200 Hz between 13:06:50 and 13:07:00. Also observed is weak wave near 800 hz before 13:05:40.\n\n\nCode\ndata = get_data(tvar_tdpwrspc[0], xarray=True)\nquiet_time_data = data.sel(time='2015-10-16T13:06:16')\n\nfig, ax = plt.subplots()\n\nax.loglog(quiet_time_data.spec_bins.data[0], np.sqrt(quiet_time_data.data[0])*1000)\n\nax.set_xlabel(\"Freq (Hz)\")\nax.set_ylabel(\"NEMI (pT/sqrt(Hz))\")\nplt.show()",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "03 - SCM Noise Curves"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw02.html",
    "href": "courses/epss265/homeworks/epss265_hw02.html",
    "title": "02 - FGM Basics",
    "section": "",
    "text": "Obtain FGM data from THM (Level 1) or MMS (L2) or from ground based magnetometers (gmags) and plot it using SPEDAS (cmd line or gui, IDL or python).\nIf you are unsure which date to pick you can use:\n\nFor THEMIS data: 2008-02-26/04-06 UT (P3-5 or D,E,A) [see plots here]\nFor ground-based magnetometer data: same as above (e.g., stations Gillam, or Carson City, NV) [plots here]\nFor MMS data: 2015-10-16/08-14 UT (MMS1-4) [see plot here]\n\n\n\n\nCode\nimport pyspedas\nfrom pytplot import tplot, get_data, store_data, options\nfrom pipe import select\n\n\n\n\nCode\ntrange = ['2008-02-26T04:00', '2008-02-26T06:00']\nprobes = ['d', 'e', 'a']\n\npyspedas.themis.fgm(trange=trange, probe=probes, level='l1', time_clip=True)\n\n\n\n\nCode\ndatatype = 'fgl'\ntvar_format = \"th{probe}_{datatype}\"\ntvars =  list(probes | select(lambda x: tvar_format.format(probe=x, datatype=datatype)))\n\ntplot(tvars)",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "02 - FGM Basics"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw02.html#question-1",
    "href": "courses/epss265/homeworks/epss265_hw02.html#question-1",
    "title": "02 - FGM Basics",
    "section": "",
    "text": "Obtain FGM data from THM (Level 1) or MMS (L2) or from ground based magnetometers (gmags) and plot it using SPEDAS (cmd line or gui, IDL or python).\nIf you are unsure which date to pick you can use:\n\nFor THEMIS data: 2008-02-26/04-06 UT (P3-5 or D,E,A) [see plots here]\nFor ground-based magnetometer data: same as above (e.g., stations Gillam, or Carson City, NV) [plots here]\nFor MMS data: 2015-10-16/08-14 UT (MMS1-4) [see plot here]\n\n\n\n\nCode\nimport pyspedas\nfrom pytplot import tplot, get_data, store_data, options\nfrom pipe import select\n\n\n\n\nCode\ntrange = ['2008-02-26T04:00', '2008-02-26T06:00']\nprobes = ['d', 'e', 'a']\n\npyspedas.themis.fgm(trange=trange, probe=probes, level='l1', time_clip=True)\n\n\n\n\nCode\ndatatype = 'fgl'\ntvar_format = \"th{probe}_{datatype}\"\ntvars =  list(probes | select(lambda x: tvar_format.format(probe=x, datatype=datatype)))\n\ntplot(tvars)",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "02 - FGM Basics"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw02.html#question-2",
    "href": "courses/epss265/homeworks/epss265_hw02.html#question-2",
    "title": "02 - FGM Basics",
    "section": "Question 2",
    "text": "Question 2\n\nProcess your data: compute the total field from its components and plot it in the same panel as the three components using colors b/g/r/black for x/y/z/t.\n\n\n\nCode\nfrom xarray_einstats import linalg\nfrom pytplot import split_vec, join_vec\n\n\nWe define a utility function to compute the total field from its components, see below\n\n\nCode\n\ndef _tvectot(tvar: str, new_name: str, join_component: bool):\n    data = get_data(tvar, xarray=True)\n    new_data = linalg.norm(data, dims=\"v_dim\")\n    store_data(new_name, new_data, xarray=True)\n    \n    if join_vec:\n        join_vec(split_vec(tvar)+[new_name], new_name)\n        options(new_name, 'legend_names', ['x', 'y', 'z', 'Magnitude'])\n    else:\n        options(new_name, 'legend_names', 'Magnitude')\n    return new_name\n\ndef tvectot(tvars: str | list[str], newnames: str | list[str] = None, suffix=\"_mag\", join_component=False) -&gt; str | list[str]:\n    \"\"\"\n    Computes the magnitude of a vector time series.\n\n    Parameters\n    ----------\n    - tvars : Names of the tplot variables.\n    - new_names: Names for the resultant magnitude tplot variables. If not provided, it appends the suffix to `tvars`.\n    - suffix: The suffix to append to tensor_names to form new_names if new_names is not provided.\n    - join_component: If True, the magnitude tplot variable is joined with the component tplot variables.\n\n    Returns\n    -------\n    Names of the magnitude tplot variables.\n    \"\"\"\n    tvars_type = type(tvars)\n    if tvars_type == str:\n        tvars = [tvars]\n    if join_vec:\n        suffix = \"_tot\"\n\n    if newnames is None:\n        newnames = [tvar + suffix for tvar in tvars]\n\n    for tvar, newname in zip(tvars, newnames):\n        _tvectot(tvar, newname, join_component)\n    \n    if tvars_type == str:\n        return newnames[0]\n    else:\n        return newnames\n\n\n\n\nCode\ntvar_tots = tvectot(tvars, join_component=True)\ntplot(tvar_tots)",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "02 - FGM Basics"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw02.html#question-3",
    "href": "courses/epss265/homeworks/epss265_hw02.html#question-3",
    "title": "02 - FGM Basics",
    "section": "Question 3",
    "text": "Question 3\n\nShow the locations of the spacecraft or the ground-based station you used above in relevant geophysical coordinates (GSE, GSM, MAG, …) from a webbased tool (tipsod or other) or plot it in SPEDAS (you can find cribs for that).\n\nTHEMIS website provides good summary plot of the spacecraft locations in various coordinate systems, see here\nIt is also possible to use SSC Locator Graphics, which is also more general.",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "02 - FGM Basics"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/index.html",
    "href": "courses/epss265/homeworks/index.html",
    "title": "Homework",
    "section": "",
    "text": "02 - FGM Basics\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n03 - SCM Noise Curves\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n04 - EFI Calibration\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n05 - LEP Principles\n\n\nLow Energy Plasma Instruments\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n06 - FPI\n\n\nFast Plasma Investigation\n\n\n\n\n\n\n\n\n\n\n\n\nNo matching items",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework"
    ]
  },
  {
    "objectID": "courses/phys231/index.html",
    "href": "courses/phys231/index.html",
    "title": "PHYSICS 231A",
    "section": "",
    "text": "In this course, we will cover a selection of analytic methods useful in a wide variety of physics topics. This includes complex analysis, asymptotic approximation of integrals, summing divergent series, manifold topology and de Rham cohomology, Fourier analysis, linear differential equations and Green’s functions, and perturbation theory for nonlinear problems.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A"
    ]
  },
  {
    "objectID": "courses/phys231/index.html#about",
    "href": "courses/phys231/index.html#about",
    "title": "PHYSICS 231A",
    "section": "",
    "text": "In this course, we will cover a selection of analytic methods useful in a wide variety of physics topics. This includes complex analysis, asymptotic approximation of integrals, summing divergent series, manifold topology and de Rham cohomology, Fourier analysis, linear differential equations and Green’s functions, and perturbation theory for nonlinear problems.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A"
    ]
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "🪐 A graduate student at UCLA, majoring in space science & planetary science."
  },
  {
    "objectID": "about.html#education",
    "href": "about.html#education",
    "title": "About",
    "section": "Education",
    "text": "Education\nUniversity of California, Los Angeles | Los Angeles, CA\nPhD in Planetary Science | Sept 2022 - Present"
  },
  {
    "objectID": "projects/index.html",
    "href": "projects/index.html",
    "title": "Projects",
    "section": "",
    "text": "Evolution of solar wind discontinuities over radial distance\nEnergetic ion scattering by solar wind discontinuities\nRelativistic electron flux decay and recovery: relative role of EMIC waves, whistler-mode waves, and plasmasheet injections\nThe kinetic simulation of the interaction between the Moon’s magnetic anomalies and the solar wind - Undergraduate thesis\n\nFINESST",
    "crumbs": [
      "Projects"
    ]
  },
  {
    "objectID": "projects/index.html#research-projects",
    "href": "projects/index.html#research-projects",
    "title": "Projects",
    "section": "",
    "text": "Evolution of solar wind discontinuities over radial distance\nEnergetic ion scattering by solar wind discontinuities\nRelativistic electron flux decay and recovery: relative role of EMIC waves, whistler-mode waves, and plasmasheet injections\nThe kinetic simulation of the interaction between the Moon’s magnetic anomalies and the solar wind - Undergraduate thesis\n\nFINESST",
    "crumbs": [
      "Projects"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "beforerr",
    "section": "",
    "text": "Form is emptiness, emptiness is form"
  },
  {
    "objectID": "courses/phys231/phys231_hw02.html",
    "href": "courses/phys231/phys231_hw02.html",
    "title": "Homework 02",
    "section": "",
    "text": "Mathematica notebook",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 02"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw02.html#power-series",
    "href": "courses/phys231/phys231_hw02.html#power-series",
    "title": "Homework 02",
    "section": "5. Power series",
    "text": "5. Power series\n\nConsider a power series of the form\n\\[\na=1+ \\sum_{n=1}^{\\infty} a_n z^n\n\\]\nShow that there is another power series\n\\[\nb = \\sum_{n=0}^{\\infty} b_n z^n\n\\]\nsuch that, as a formal expression\n\\[\nab = 1\n\\]\nDo this by giving a recurrence relation for the coefficients \\(b_n\\). Solve this recurrence relation for \\(1/e^z\\) and show it gives the power series for \\(e^{−z}\\).\n\nThe product \\(ab\\) can be written as:\n\\[\nab = \\left(1 + \\sum_{n=1}^{\\infty} a_n z^n \\right) \\left( \\sum_{n=0}^{\\infty} b_n z^n \\right) = 1\n\\]\nBy expanding, we get:\n\\[\nab = b_0 + (b_1 + a_1 b_0) z + (b_2 + a_1 b_1 + a_2 b_0) z^2 + \\dots + \\left( \\sum_{k=0}^{n} a_k b_{n-k} \\right) z^n + \\dots\n\\]\nFor \\(ab = 1\\), all the coefficients of \\(z^n\\) (for \\(n \\geq 1\\)) must be zero, and the constant term (the coefficient of \\(z^0\\)) must be 1. This gives us the following conditions:\n\n\\(b_0 = 1\\) (since the constant term of \\(ab\\) must be 1).\nFor \\(n \\geq 1\\), we have \\(\\sum_{k=0}^{n} a_k b_{n-k} = 0\\).\n\nFor \\(a_k\\), we have \\(a_0 = 1\\) and \\(a_n\\) for \\(n \\geq 1\\). Thus, the recurrence relation for \\(b_n\\) becomes:\n\\[\nb_n = -\\sum_{k=1}^{n} a_k b_{n-k} \\quad \\text{for } n \\geq 1\n\\]\nFor \\(a = e^z\\). The power series for \\(b= 1/e^z\\) is given by:\n\n\\(b_0 = 1\\) (from the initial condition).\nFor \\(n \\geq 1\\):\n\n\\[\nb_n = -\\sum_{k=1}^{n} \\frac{1}{k!} b_{n-k}\n\\]\nAnd if \\(b_n = \\frac{(-1)^n}{n!}\\). Then, it is exactly the power series for \\(e^{-z}\\):\n\\[\ne^{-z} = \\sum_{n=0}^{\\infty} \\frac{(-z)^n}{n!}\n\\]\nTo prove \\(b_n = \\frac{(-1)^n}{n!}\\), we use induction method. Suppose it is true for \\(n\\), then using\n\\[\n(1 + (-1))^{n+1} = \\sum C_{k}^{n+1}(-1)^{n+1-k} = (n+1)! \\sum_{k=0}^{n+1} \\frac{(-1)^{n+1-k}}{k! (n+1-k)!}\n\\]\nBy substituting \\(b_k = \\frac{(-1)^k}{k!}\\) for \\(k \\le n\\), we have\n\\[\n(-1)^{n+1} / (n+1)~! = -\\sum_{k=1}^{n+1} \\frac{1}{k!} b_{n-k}\n\\]\nSo \\(b_{n+1} = \\frac{(-1)^{n+1}}{(n+1)!}\\). Q.E.D",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 02"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw02.html#expansion-near-pole",
    "href": "courses/phys231/phys231_hw02.html#expansion-near-pole",
    "title": "Homework 02",
    "section": "6. Expansion near pole",
    "text": "6. Expansion near pole\n\nAssuming the result of problem 5 and the bonus problem, show that if \\(f (z) = g(z)/h(z)\\) has a pole at \\(z = 0\\), that we can expand \\(f(z)\\) in a series\n\\[\nf (z) = \\sum_{n=-m}^{\\infty} a_n z^n\n\\]\nfor some \\(m\\), and that this converges in a “punctured disc” \\(\\{ z | |z| &lt; R, z \\ne 0 \\}\\). Make such an expansion for \\(f (z) = z/(1 + z^2)\\) around \\(z = i\\) (hint: for this example we use tricks with geometric series, we don’t need the general recurrence relation).\n\nSince \\(f(z)\\) has a pole at \\(z = 0\\), \\(h(z)\\) must have a zero of order \\(m\\) at \\(z = 0\\)\nGiven this, \\(h(z)\\) can be written as \\(z^m k(z)\\) where \\(k(z)\\) is analytic and non-zero at \\(z = 0\\). Therefore, \\(f(z)\\) can be written as:\n\\[\nf(z) = \\frac{g(z)}{z^m k(z)}\n\\]\nSince \\(k(z)\\) is analytic and non-zero at \\(z = 0\\), there exists a power series \\(\\sum_{n=0}^{\\infty} b_n z^n\\) such that \\(\\frac{1}{k(z)} = \\sum_{n=0}^{\\infty} b_n z^n\\) . This leads to:\n\\[\nf(z) = \\frac{g(z)}{z^m} \\sum_{n=0}^{\\infty} b_n z^n = \\sum_{n=0}^{\\infty} b_n g(z) z^{n-m}\n\\]\nfor \\(z \\ne 0\\). As \\(g(z)\\) is analytic at \\(z = 0\\), it can also be expanded into a power series around \\(z = 0\\). Thus, the product of these two series results in a series of the form:\n\\[\nf(z) = \\sum_{n=-m}^{\\infty} a_n z^n\n\\]\nThis series converges in some punctured disc \\(\\{ z \\,|\\, |z| &lt; R, z \\ne 0 \\}\\) because it is the product of two convergent power series in that region.\nFor the specific function \\(f(z) = \\frac{z}{1 + z^2}\\), we want to expand around \\(z = i\\)\n\\[\nf(z) = \\frac{z}{(z - i)(z + i)}\n\\]\nTo expand around \\(z = i\\), let’s set \\(w = z - i\\), so \\(z = w + i\\). Then:\n\\[\nf(w + i) = \\frac{w + i}{ w (w + 2i)}\n\\]\nNow, observe that:\n\\[\n\\frac{1}{w + 2i} = \\frac{1}{2i} \\cdot \\frac{1}{1 + \\frac{w}{2i}}\n\\]\nSince \\(|\\frac{w}{2i}| &lt; 1\\) for \\(|w| &lt; 2\\), we can use the geometric series expansion:\n\\[\n\\frac{1}{1 + \\frac{w}{2i}} = \\sum_{n=0}^{\\infty} \\left(-\\frac{w}{2i}\\right)^n\n\\]\nThus, we get:\n\\[\nf(z) = \\frac{w + i}{2i w } \\cdot \\sum_{n=0}^{\\infty} \\left(-\\frac{w}{2i}\\right)^n\n\\]\nwhich will be valid in a punctured disc around \\(z = i\\), specifically for \\(|z - i| &lt; 2\\) (or \\(|w| &lt; 2\\)).",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 02"
    ]
  },
  {
    "objectID": "courses/epss265/project/project.html",
    "href": "courses/epss265/project/project.html",
    "title": "Objective",
    "section": "",
    "text": "If a thin Aluminum layer is deposited over a solid-state detector active area, the energy loss by the particle in that Al layer will not be recorded. The shorter the range of a particle the more the relative energy that will be missed. The range depends on mass near the last portion of the flight: heavier ions stop earlier. Two detectors, a bare one and one with an Al layer, measuring the same beam could give very different results for He+ or O+.\nPlot the energy recorded (past the Al) versus the incident energy, for beams of various energies, and for different thickness (10nm, 100nm, …). Use H+, He+, O+. Demonstrate that with a sufficient number of detectors you could differentiate monoenergetic protons, He+ and O+. Use SPENVIS or GEANT-4 for your modeling.\nBonus: simulate the number of detectors required to deconvolve the effects of a single, thermalized (not beam) distribution with dE/E~100%.\n\nDirections\nThis will be done by creating a plot of energy deposited in Si as function of input energy. You will use freeware Geant-4 which simulates particle interaction with matter, through a portal: SPENVIS. Various models exist there (very useful site!).\nFirst you have to register, then create a project, then input your model input and output parameters, then make a run and get results one-energy-at-a-time. Once you know how to do that, then you must create an array of inputs and outputs outside of SPENVIS in your favorite plotting package (e.g., excel, python or other). You will then record those results and plot them, one array for protons, another for He+ and another for O+. You can try other species as well, for example O2+ which may be present in the low altitude ionosphere.\n\nAssume monoenergetic beams. The program allows you to use a simple ion spectrum. (For the bonus question you have to make a guess on the instrument response function, model it in a simple analytical form, then prove it can be done using Geant-4. You do not have to do the bonus.)\n\nFor your outline, make sure you can obtain results, understand the problem enough to present the requested report structure, before actually doing the plots. Present a statement of task, the process and the expected results to be plotted.\nFor your report, you should not repeat the steps I mention below, but just execute your outline above and go right to the findings, plots and discussion. In the discussion explain how you use the model to design a detector system (how many detectors, thicknesses, orientations etc) that does the job.\n\nOn SPENVIS after registration, name your project and proceed to use Geant-4 “MULASSIS”. You can save your run, and come back to it later.\nYour system will be a 3 layer system, where the first layer is air, the second Al of variable thickness and the third Silicon of a mm or two... enough to stop the highest energy of interest. You shoot some particles (10,000 is a good number), and record how much energy is deposited in Si. Excluding losses in the Si (phonons) the lost energy is mainly due to losses in the Aluminum. Pick the source parameters: How many/which ions, charge angle (-22 deg -&gt; 22 deg).\nFor Geometry you pick the layers above, and for Al choose 0, 1, 10 100 nm, one thickness at a time.\nSpecify the input as monoenergetic beam.\nSpecify analysis parameters as mean energy (the mean energy deposited based on the 10,000 particle run)\nCreate a macro (a bunch of commands that tell Geant-4 what to do) and Run.\nSee the plot\nOutput results (2 numbers) into your program next to input energy to build the in/out energy curve.\nRepeat, one point at a time.\nPlot results for one species and then (in different color) for other species.\nRepeat for different Al thicknesses.\n\n\n\nGeometry Definition\nSource particles\n\nHe+\n\nAtomic number: 2\nNucleon number: 4\n\n\nMaterial Definition\nhttps://www.spenvis.oma.be/restricted/load_result.php/EPSS265/spenvis_mul-rmt.txt\nhttps://www.spenvis.oma.be/spenvis/htusers/b/beforerr/EPSS265/1699989981/spenvis_mlo.txt\n\n\n\nCode\nimport yaml\n\nwith open(\"config.yaml\", 'r') as stream:\n    config = yaml.safe_load(stream)\n\n\n\n\nCode\nuser = config[\"user\"]\nproject = config[\"project\"]\nrun = config[\"run\"]\nfiles = config[\"files\"]\n\noutput = files[\"output\"]\nreport = files[\"report\"]\n\nbase_url = config[\"base_url\"]\nurl_pattern = config[\"url_pattern\"]\n\nprint(\n    url_pattern.format(\n        base_url=base_url,\n        user=user,\n        project=project,\n        run=run,\n        filename=output[\"filename\"],\n    )\n)\n\nprint(\n    url_pattern.format(\n        base_url=base_url,\n        user=user,\n        project=project,\n        run=run,\n        filename=report[\"filename\"],\n    )\n)\n\n\nhttps://www.spenvis.oma.be/spenvis/htusers/b//beforerr/EPSS265/1699990533/spenvis_mlo.txt\nhttps://www.spenvis.oma.be/spenvis/htusers/b//beforerr/EPSS265/1699990533/spenvis_mul-rmt.txt\n\n\n\n’*‘, 10, 4, 0, 0, 5, 5, 3, 0 ’DOSE ANALYSIS’ ‘MULASSIS v1.23’ ‘geant4-09-05-patch-02 (22-October-2012)’ ‘File Created: Wed Nov 15 23:11:52 2023’\n‘End of File’\n\n\nSPENVIS generated macrofile for MULASSIS\n/geometry/layer/delete 0 /geometry/material/addNIST G4_Al /geometry/material/addNIST G4_Si /geometry/layer/shape slab /geometry/layer/add 0 Vacuum 1 1.000E+00 mm /geometry/layer/add 1 G4_Al 2 1.000E-03 um /geometry/layer/add 2 G4_Si 3 1.000E+00 mm # Total thickness = 2.000 mm /analysis/file spenvis # # Analysis definition #",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Project",
      "Objective"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw04.html",
    "href": "courses/epss265/homeworks/epss265_hw04.html",
    "title": "04 - EFI Calibration",
    "section": "",
    "text": "For a time of interest from THEMIS or MMS (or RBSP or other), based on the overview plots at the mission website, finish the following steps.\n\nObtain EFI data in spinning and despun spacecraft coord’s and in some geophysical (e.g., GSE or GSM) coord’s.\nUsing the data in DSL or DMPA coordinates (where XY are despun, spin-plane components) estimate the offset in X and Y from a quiet time in the magnetosphere when the flows, and hence –VxB, are expected to be slow. Remove the offset from the data.\nWith the spin plane offsets removed, obtain the 3rd component (Z) for times when the Bfield is at a large angle relative to the spin plane (&gt;10 deg or more) using the E*B=0 approximation.\nCompare your estimate of Ez with the measurement of the same component made by the axial electric field boom pair. How large are the offsets for the axial field compared to those you have found for the spin plane components?\n\nNote: A crib sheet and a jupyter notebook on how to perform the offset removal and EdotB determination are my_thm_efi_load_cal_crib.pyspd and my_thm_efi_load_cal_crib.py, located in the class notes below Lecture 12. Use a different spacecraft for your solution. A good day for THEMIS is another spacecraft from the first Science paper (2008-02-26 4-6UT)– except TH-D which is in the released crib sheet. A good day for MMS is the first Science paper (2015-10-16 13:05-13:08UT) from any of the four MMS spacecraft.\nWe choose MMS for this question. And the data is from 2015-10-16 13:00-14:00UT.\nIts overall summary plot together with SCM quicklook plots are shown below.",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "04 - EFI Calibration"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw04.html#quickplot",
    "href": "courses/epss265/homeworks/epss265_hw04.html#quickplot",
    "title": "04 - EFI Calibration",
    "section": "Quickplot",
    "text": "Quickplot\n\n\nCode\nimport pyspedas\nfrom pytplot import tplot, get_data, tlimit\n\nimport xarray as xr\nimport numpy as np\n\n\n\n\nCode\ntrange = ['2015-10-16T13:00:00', '2015-10-16T13:10:00']\ntvars = pyspedas.mms.edp(trange=trange, time_clip=True)\ntplot(tvars)\n\n\n28-Nov-23 17:11:35: Loading /Users/zijin/data/mms/mms1/edp/fast/l2/dce/2015/10/mms1_edp_fast_l2_dce_20151016_v2.1.0.cdf\n28-Nov-23 17:11:37: Time clip was applied to: mms1_edp_dce_gse_fast_l2\n28-Nov-23 17:11:38: Time clip was applied to: mms1_edp_dce_dsl_fast_l2\n28-Nov-23 17:11:38: Time clip was applied to: mms1_edp_dce_par_epar_fast_l2\n28-Nov-23 17:11:38: Loaded variables:\n28-Nov-23 17:11:38: mms1_edp_dce_gse_fast_l2\n28-Nov-23 17:11:38: mms1_edp_dce_dsl_fast_l2\n28-Nov-23 17:11:38: mms1_edp_dce_par_epar_fast_l2\n\n\n\n\n\n\n\n\n\n\n\nCode\ntrangeOfInterest = ['2015-10-16T13:06:30', '2015-10-16T13:07:30']\ntlimit(trangeOfInterest)\ntplot(tvars)",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "04 - EFI Calibration"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw04.html#offset",
    "href": "courses/epss265/homeworks/epss265_hw04.html#offset",
    "title": "04 - EFI Calibration",
    "section": "Offset",
    "text": "Offset\nWe choose a quite time by manually inspecting the data.\n\n\nCode\ntrange4offset = ['2015-10-16T13:00:30', '2015-10-16T13:01:30']\ntlimit(trange4offset)\ntplot(tvars)\ntlimit(full=True)\n\n\n\n\n\n\n\n\n\n\n\nCode\ne_tvar = 'mms1_edp_dce_dsl_fast_l2'\ne_data : xr.DataArray = get_data(e_tvar, xarray=True)\noffset = e_data.sel(time=slice(trange4offset[0], trange4offset[1])).mean(dim='time')\nprint('Ex offset =', offset[0].data)\nprint('Ey offset =', offset[1].data)\n\n\nEx offset = 0.23904572\nEy offset = 0.18106854",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "04 - EFI Calibration"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw04.html#e_z-component",
    "href": "courses/epss265/homeworks/epss265_hw04.html#e_z-component",
    "title": "04 - EFI Calibration",
    "section": "\\(E_z\\) component",
    "text": "\\(E_z\\) component\nWe use the \\(E \\cdot B=0\\) approximation to calculate \\(E_z\\) component. And we ignore the differences (fractions of a degree) between DBCS, DMPA and DSL. *\n\n\nCode\npyspedas.mms.fgm(trange=trange, time_clip=True, varformat='*dmpa*')\nmag_tvar = 'mms1_fgm_b_dmpa_srvy_l2'\ntplot(mag_tvar)\n\n\n28-Nov-23 17:14:28: Loading /Users/zijin/data/mms/mms1/fgm/srvy/l2/2015/10/mms1_fgm_srvy_l2_20151016_v4.18.0.cdf\n28-Nov-23 17:14:30: Time clip was applied to: mms1_fgm_b_dmpa_srvy_l2\n28-Nov-23 17:14:30: Time clip was applied to: mms1_fgm_flag_srvy_l2\n28-Nov-23 17:14:30: Loaded variables:\n28-Nov-23 17:14:30: mms1_fgm_b_dmpa_srvy_l2\n28-Nov-23 17:14:30: mms1_fgm_b_dmpa_srvy_l2_bvec\n28-Nov-23 17:14:30: mms1_fgm_b_dmpa_srvy_l2_btot\n28-Nov-23 17:14:30: mms1_fgm_b_gse_srvy_l2_bvec\n28-Nov-23 17:14:30: mms1_fgm_b_gse_srvy_l2_btot\n28-Nov-23 17:14:30: mms1_fgm_b_gsm_srvy_l2_bvec\n28-Nov-23 17:14:30: mms1_fgm_b_gsm_srvy_l2_btot\n28-Nov-23 17:14:30: mms1_fgm_b_bcs_srvy_l2_bvec\n28-Nov-23 17:14:30: mms1_fgm_b_bcs_srvy_l2_btot\n\n\n\n\n\n\n\n\n\n\n\nCode\ndef calibrate_offset(data, offset):\n    return data - offset\n\n\n\n\nCode\ndef calibrate_e_dot_b(e_data: xr.DataArray, mag_data, threshold_angle=10):\n    data = e_data.copy()\n    data[:, 2] = (\n        -(e_data[:, 0] * mag_data[:, 0] + e_data[:, 1] * mag_data[:, 1])\n        / mag_data[:, 2]\n    )\n    \n    threshold = np.sin(np.deg2rad(threshold_angle))\n    mask = np.abs((mag_data[:, 2] / mag_data[:, 3])) &gt; threshold\n    data[~mask] = np.nan\n    \n    return data\n\n\n\n\nCode\n# Interpolate FGM data on EDP times\npyspedas.tinterpol(mag_tvar, e_tvar)\nmag_data = get_data(mag_tvar + '-itrp', xarray=True)\n\ne_data_c1 = calibrate_offset(e_data, offset)\ne_data_c2 = calibrate_e_dot_b(e_data_c1, mag_data)\n\n\n28-Nov-23 17:15:11: tinterpol (linear) was applied to: mms1_fgm_b_dmpa_srvy_l2-itrp",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "04 - EFI Calibration"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw04.html#comparison",
    "href": "courses/epss265/homeworks/epss265_hw04.html#comparison",
    "title": "04 - EFI Calibration",
    "section": "Comparison",
    "text": "Comparison\n\nCompare your estimate of Ez with the measurement of the same component made by the axial electric field boom pair. How large are the offsets for the axial field compared to those you have found for the spin plane components?\n\n\n\nCode\nez_data = e_data.sel(v_dim=2)\nez_data_c2 = e_data_c2.sel(v_dim=2)\n\nxr.concat(\n    [\n        ez_data.assign_coords(datatype=\"Ez original\"),\n        ez_data_c2.assign_coords(datatype=\"Ez calibrated\"),\n    ],\n    dim=\"datatype\",\n).plot(x=\"time\", hue=\"datatype\")\n\n\n\n\n\n\n\n\n\n\n\nCode\nez_offset = np.abs(ez_data - ez_data_c2).mean()\nprint(\"Ez offset = \", ez_offset.data)\n\n\nEz offset =  0.43761042",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "04 - EFI Calibration"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw05.html",
    "href": "courses/epss265/homeworks/epss265_hw05.html",
    "title": "05 - LEP Principles",
    "section": "",
    "text": "References:",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "05 - LEP Principles"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw05.html#q1.-retarding-potential-analyzers",
    "href": "courses/epss265/homeworks/epss265_hw05.html#q1.-retarding-potential-analyzers",
    "title": "05 - LEP Principles",
    "section": "Q1. Retarding Potential Analyzers",
    "text": "Q1. Retarding Potential Analyzers\n\nIn the ionosphere, mount along ram velocity, measure species densities (in like atomic mass groups)\n\nRam speed (7.5km/s) is high or supersonic relative to ion thermal speed or motion\nSpacecraft (sc) charging is negative and small relative to motional energy\nI-V curve has steps at \\(qV_{ret} = \\frac{1}{2}m(V_{sr}+V_r)^2 – q \\phi_s\\) ; \\(\\phi_s\\) = sensor potential (w/r/t to plasma), \\(V_{s_r}\\) = sc ram speed, \\(V_r\\) = ion speed\n\nHomework Q#1\n\nShow that the thermal width of the steps is \\(m V_{sr} V_{th}\\), where \\(V_{th}\\) is the ion species thermal speed.\nShow that for sensor potential of –0.8V, the step functions are at ~1.1V for H+ and ~5.5V for O+.\n\n\n\n\n\n\n\nFigure 1. Schematic cross-sectio onf the planar RPA sensor illustrating the arrangement of internal grids required to perform the retarding potential analysis of thermal ions.\n\n\nthermal width = \\(\\frac{1}{2} m (V_{th} + V_{s_r})^2 - \\frac{1}{2} m (V_{th} - V_{s_r})^2 = m V_{s_r} V_{th}\\)\nstep function for low temperature ions, taking \\(V_{r}=0\\)\n\\[V_{ret} = \\frac{1}{2} \\frac{m}{q}V_{s_r}^2 – \\phi_s\\]\n\n\nCode\nfrom plasmapy.particles import Particle\nimport astropy.units as u\n\n\n\ndef calc_step_potential(phi, v_sr, particle: Particle):\n    result = particle.mass * v_sr ** 2 / (2 * particle.charge) - phi\n    return result.to(u.V)\n\nphi = -0.8 * u.V\nv_sr = 7.5 * u.km / u.s\n\nproton = Particle('proton')\no_plus = Particle('O+')\n\nprint(f'Proton step potential: {calc_step_potential(phi, v_sr, proton)}')\nprint(f'O+ step potential: {calc_step_potential(phi, v_sr, o_plus)}')\n\nProton step potential: 1.0936161382302447 V\nO+ step potential: 5.463469940275583 V",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "05 - LEP Principles"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw05.html#q2.-rpaion-drift-meters",
    "href": "courses/epss265/homeworks/epss265_hw05.html#q2.-rpaion-drift-meters",
    "title": "05 - LEP Principles",
    "section": "Q2. RPA/Ion Drift Meters",
    "text": "Q2. RPA/Ion Drift Meters\n\nIn the ionosphere, mounted along ram velocity, measure species velocity\n\nG2 (positive) retards e.g. the lower energy H+, but allows the higher energy O+ through\nCollimated beam comes through and falls asymmetrically (based on direction) on collectors\nG6 (negative) suppresses electrons\nG3-5 are grounded to remove distortions\n\nHomework Q#2: Determine transverse velocity \\(V_t\\) as function of ram speed, W, D.\n\n\n\n\n\n\nFigure 5. Ambient ions are accelerated through the spacecraft sheath potential and account of this acceleration decrease the apparent ion arrival angleas shown.\n\n\nThe ram velocity measued at the RPA can be related to the ion velocity at infinity \\(V_r\\) by\n\\[ \\frac{1}{2} m V_{ram} = \\frac{1}{2} m (V_{r} + V_s)^2 - q \\phi_s\\]\nThe ratio of two currents measured by the RPA is\n\\[ J_1 / J_2 = \\frac{A_1}{A_2} = \\frac{W-2 D \\tan \\alpha}{W+2 D \\tan \\alpha}\\]\nwhere \\(A_1\\) and \\(A_2\\) are the areas of the two collectors. The angle \\(\\alpha\\) is the angle between the ion velocity and the normal to the collector surface. The ion velocity can be expressed as\n\\[ V_t = V_{ram} \\tan \\alpha \\]\nThe log of the ratio of the fluxes, which are actually measured\n\\[ \\log R = J_1 / J_2\\]\nCombining these equations gives\n\\[\nV_t=\\left[\\left(V_r+V_s\\right)^2-2 q \\phi_s / m\\right]^{\\frac{1}{2}} \\frac{W}{2 D}\\left( 1-\\log R \\right) /\\left(1+ \\log R \\right)\n\\]",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "05 - LEP Principles"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw05.html#q3.-magnetic-spectrographs",
    "href": "courses/epss265/homeworks/epss265_hw05.html#q3.-magnetic-spectrographs",
    "title": "05 - LEP Principles",
    "section": "Q3. Magnetic Spectrographs",
    "text": "Q3. Magnetic Spectrographs\n\nFor low energy (less than a few keV) particles (left):\n\nRPA provides velocity, temperature. Post-acceleration, Vpa, behind it allows refined measurement of m/q\nHomework Q#3 Show that in LIMS: \\(m/q=(B r_c)2/(2V_{pa})\\), where B is magnetic field, rc particle magnetic radius\n\nFor high energy particles (right) the RPA is not used (they are hard to control with potentials):\n\nBroom magnet clears electrons\nHigh field bends the high energy ions\nIons that were not bent are assumed to be neutrals (ENAs)\n\n\n\n\n\n\n\nLIMS on SCATHA\n\n\nThe energy of accelerated particle is: \\[\n\\frac{1}{2} m v^2=q V_{p a}\n\\]\nParticles that are able to reach the detector must satisify: \\[\nm v^2 r_c=B q v\n\\]\nCombining Equations we get: \\[\n\\begin{aligned}\n& v=\\left(\\frac{2 q}{m} V_{p a}\\right)^{\\frac{1}{2}} \\\\\n\\Rightarrow & m / q=\\left(B r_c\\right)^2 / 2 v_{p a}\n\\end{aligned}\n\\]",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "05 - LEP Principles"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw05.html#q4.-electrostatic-analyzers",
    "href": "courses/epss265/homeworks/epss265_hw05.html#q4.-electrostatic-analyzers",
    "title": "05 - LEP Principles",
    "section": "Q4. Electrostatic Analyzers",
    "text": "Q4. Electrostatic Analyzers\n\nElectrostatic deflection “analyzes” distribution selecting particles with matching centrifugal and electrostatic forces\n\nAnalyser constant, \\(K=R/\\Delta\\), where \\(\\Delta=R_2-R_1\\); \\(R=(R_2+R_1)/2\\). Outer shell is at 0 Volts, inner shell at potential V.\nElectrostatic deflection at the entrance aperture can measure incoming ions from different directions if spacecraft non-spinning\nHomework Q#4 Show that the energy W of the particles of charge q incident on the MCP is \\(W=-K q V /2\\)\n\n\nParticles that are able to reach the detector must satisify:\n\\[\nm v^2 R=q E\n\\]\nwhere \\(E\\) is the electric field between \\(R_2\\) and \\(R_1\\), \\(E \\approx \\frac{-V}{\\Delta}\\), so\n\\[\n\\begin{aligned}\n& m v^2=\\frac{-R}{\\Delta} q V = -K q V \\\\\n\\Rightarrow & W=\\frac{1}{2} m v^2=-\\frac{1}{2} K q V\n\\end{aligned}\n\\]",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "05 - LEP Principles"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw05.html#q5.-time-of-flight-post-analyzer-mass-discrimination",
    "href": "courses/epss265/homeworks/epss265_hw05.html#q5.-time-of-flight-post-analyzer-mass-discrimination",
    "title": "05 - LEP Principles",
    "section": "Q5. Time of Flight (post-analyzer) Mass Discrimination",
    "text": "Q5. Time of Flight (post-analyzer) Mass Discrimination\n\nElectrostatic deflection provides energy per charge: E/Q. Time of flight, t, provides the energy per mass E/M\n\nPost-acceleration potential \\(U_{ACC}\\) is sufficient for optimal McP operation and timing electrons at foil. Measure flux at \\(E/Q+ U_{ACC}\\)\nElectrons generated at carbon foil. Carbon foil results in passage of an energy fraction \\(\\alpha\\)\nHomework Q#5. Show \\(M/Q=2a(E/Q + U_{ACC})/(d/t)^2\\), where: Q=ion charge in units of elemental charge, e.\n\n\nThe velocity of ions after passing through the foil is\n\\[\nv=d / t\n\\]\nDue to partial energy transfer after passing the foil\n\\[ \\frac{1}{2} M v^2=\\alpha\\left(E + Q U_{ACC}\\right)\n\\]\nCombining Equations we get:\n\\[\nM / Q=2 \\alpha\\left(E / Q+U_{ACC}\\right) /(d / t)^2\n\\]",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "05 - LEP Principles"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw03.html",
    "href": "courses/phys231/phys231_hw03.html",
    "title": "Homework 03",
    "section": "",
    "text": "Complete PDF\nMathematica Notebook",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 03"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw03.html#conformal-map",
    "href": "courses/phys231/phys231_hw03.html#conformal-map",
    "title": "Homework 03",
    "section": "1. Conformal map",
    "text": "1. Conformal map\n\nConsider the half-infinite strip\n\\[\nS = \\{z \\,|\\, \\text{Re}\\, z &gt; 0, 2i &lt; \\text{Im}\\, z &lt; 5i \\}\n\\]\nFind an invertible conformal map sending \\(S\\) to the upper half plane\n\\[\nH = \\{z \\,|\\, \\text{Im}\\, z &gt; 0 \\},\n\\]\n\nwe can proceed in steps using standard conformal mappings.\n\nTranslate the Strip: First, we translate the strip downwards \\(T(z) = z - 2i\\) so that its imaginary boundaries are on the real axis and at \\(3i\\).\nScale the Strip: Next, we scale the strip so that its width becomes \\(\\pi\\). Define the scaling map \\(D(z) = \\frac{\\pi}{3}z\\).\nApply the Exponential Function: The exponential function \\(E(z)=e^z\\) maps horizontal strips to \\(\\{z \\,|\\,\\text{Im}\\, z &gt; 0, |z| &gt; 1 \\}\\)\nMap to the Upper Half-Plane: \\(R(z)=\\frac{1}{2} (z + 1/z)\\) will map to the upper half-plane.\n\nSo, the complete conformal map \\(F\\) from \\(S\\) to \\(H\\) is the composition of these maps:\n\\[\nF(z) = R(E(D(T(z)))) = \\sqrt{e^{\\frac{\\pi}{3}(z - 3.5i)}}.\n\\]\nThis map is invertible and conformal.\nNote that the inverse map of \\(R(z)\\)\n\\[\nz = w+\\sqrt{w^2 − 1}\n\\]\nhas a branch cut at \\(w ∈ (−1, 1)\\). However, for \\(|z| &gt; 1\\), we have \\(\\text{Im}\\, w &gt; 0\\), so the maps are inevitable.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 03"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw03.html#saddle-point",
    "href": "courses/phys231/phys231_hw03.html#saddle-point",
    "title": "Homework 03",
    "section": "2. Saddle point",
    "text": "2. Saddle point\n\nProve that if \\(f = u + iv\\) is holomorphic at \\(z = 0\\) and \\(f'(z)\\) has a zero of degree 1 at \\(z = 0\\), that both \\(u\\) and \\(v\\) have saddle points at \\(z = 0\\).\n\nAt \\(z=0\\), \\(f^{\\prime}=u_x+i v_x=0\\) \\[\n\\Rightarrow u_x(0)=0 \\text { and } v_x(0)=0\n\\]\n\\(f\\) is holomorphic\n\\[\n\\begin{array}{l}\nv_y=u_x=0 \\\\\nu_y=-v_x=0\n\\end{array}\n\\]\nSo the Hessian determinant is\n\\[\n\\begin{aligned}\nD_u=u_{x x} u_{y y}-\\left(u_{x y}\\right)^2 & =-v_{y x} v_{x y}-u_{x y}^2 \\\\\n& =-v_{x y}^2-u_{x y}^2 \\\\\nD_v=v_{x x} v_{y y}-\\left(v_{x y}\\right)^2= & -v_{x y}^2-u_{x y}^2\n\\end{aligned}\n\\]\nSince \\(f^{\\prime}\\) has a zero of degree \\(1 \\Rightarrow\\) second derivative of \\(u\\) and \\(v\\) are nonzero at \\(z=0\\), which gives \\(D_u&lt;0\\) and \\(D_\\nu&lt;0\\). Given first derivative is zero, \\(u\\) and \\(v\\) have saddle points at \\(z=0\\)",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 03"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw03.html#holomorphic-functions-agree",
    "href": "courses/phys231/phys231_hw03.html#holomorphic-functions-agree",
    "title": "Homework 03",
    "section": "3. Holomorphic functions agree",
    "text": "3. Holomorphic functions agree\n\nShow that if two holomorphic functions agree on an interval of the real line, they agree everywhere.\n\nLet’s say two holomorphic function \\(f\\) and \\(g\\) agree on Interval \\(I\\). we show \\(h=f-g\\) if \\(h \\equiv 0\\) on \\(I\\), then \\(h\\) is 0 everywhere.\n\\[\nh(z)=\\sum_{n=0}^{\\infty} \\frac{(z-c)^n}{n !} h^{(n)}(c)\n\\]\nfor \\(c \\in I\\). On the real line, \\(h(x)\\) and all its derivatives with respect to \\(x\\) vanish. So \\(h^{(n)}(c) =0\\) for all \\(n\\ge0\\). And because \\(h\\) is an entire function the radius of convergence should be infinite. Therefore, for any \\(z ∈ C\\) lies within the circle of convergence, we have \\(h(z) = 0\\).",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 03"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw03.html#mobius-transformations",
    "href": "courses/phys231/phys231_hw03.html#mobius-transformations",
    "title": "Homework 03",
    "section": "5. Mobius transformations",
    "text": "5. Mobius transformations\n\nShow that Mobius transformations send circles and lines to circles and lines.\n\nMobius transformations\n\\[\nf(z) = \\frac{a z+b}{c z+d} = \\frac{a}{c}+\\frac{e}{z+\\frac{d}{c}},\n\\]\ncan be decomposed into four simple transformation of translation, dilation, and inversion.\n\\[\nf=f_4 \\circ f_3 \\circ f_2 \\circ f_1 .\n\\]\nSince translation, dilation perserve geometrical lines and circles, we only need to show that inversion \\(I(z)=1/z\\) sends circles and lines to circles and lines.\n\\[\nI(z) = I(x+i y)=\\frac{1}{x+i y}=\\frac{x}{x^2+y^2}-\\frac{y i}{x^2+y^2}\n\\]\nSo \\(I\\) maps \\((x, y)\\) into a \\((u, v)\\) with\n\\[\nu=\\frac{x}{x^2+y^2} \\text { and } v=\\frac{-y}{x^2+y^2}\n\\]\nFor line of general form \\(Ax+By=C\\), we have\n\\[\n\\begin{aligned}\nAu - B v= (u^2+v^2)C\n\\end{aligned}\n\\]\nThus \\(I\\) maps a line to a circle (\\(C \\neq 0\\)) or a line (\\(C = 0\\)).\nFor cicrcle of general form \\(D x+E y+F\\left(x^2+y^2\\right)=R\\), we have\n\\[\nD u -E v + F = R\\left(u^2+v^2\\right)\n\\]\nThus \\(I\\) maps a circle to a circle (\\(R \\neq 0\\)) or a line (\\(R = 0\\)). Note here, \\(R\\) is not the radius of the original circle.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 03"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw03.html#cross-ratio-under-simultaneous-mobius-transformations",
    "href": "courses/phys231/phys231_hw03.html#cross-ratio-under-simultaneous-mobius-transformations",
    "title": "Homework 03",
    "section": "6. cross-ratio under simultaneous Mobius transformations",
    "text": "6. cross-ratio under simultaneous Mobius transformations\n\nShow that for any three points \\(z_1, z_2, z_3\\), there is precisely one Mobius transformation sending \\(z_1\\) to 0, \\(z_2\\) to 1, and \\(z_3\\) to infinity. The image of a fourth point \\(z_4\\) under this map defines the “cross-ratio” of \\(\\left(z_1, z_2, z_3, z_4\\right)\\). Show that the cross ratio is preserved under simultaneous Mobius transformations of these four points.\n\nLet Möbius transformation \\(f(z) = (a z+b) /(c z+d)\\), satisfying\n\\[\nf\\left(z_1\\right)=0, f\\left(z_2\\right)=1, f\\left(z_3\\right)=\\infty\n\\]\nThen the Möbius transformation is determined by\n\\[\n\\begin{aligned}\n& f\\left(z_1\\right)=0 \\Rightarrow a z_1 + b=0 \\\\\n& f\\left(z_2\\right)=1 \\Rightarrow a z_2 +b - c z_2 - d =0 \\\\\n& f\\left(z_3\\right)=\\infty \\Rightarrow c z_3 + d =0\n\\end{aligned}\n\\]\nThe three linear equations can be solved in the sense of their relative ratio.\nAnd the Möbius transformation can be written as\n\\[\nf(z)=\\frac{z_2-z_3}{z_2-z_1} \\frac{z-z_1}{z-z_3}\n\\]\nSo the cross ratio is\n\\[\n\\frac{z_2-z_3}{z_2-z_1} \\frac{z_4-z_1}{z_4-z_3}\n\\]\nThen the cross ratio of the image under the transformation of any \\(f\\) is\n\\[\n\\frac{f(z_2)-f(z_3)}{f(z_2)-f(z_1)} \\frac{f(z_4)-f(z_1)}{f(z_4)-f(z_3)}\n\\]\nNote that\n\\[\nf(x)-f(y)=\\frac{a x+b}{c x+d}-\\frac{a y+b}{c y+d}=\\frac{(a d-b c)(x-y)}{(c x+d)(c y+d)}\n\\]\nand\n\\[\n\\frac{f(x)-f(y)}{f(x)-f(z)} = \\frac{(x-y)(cz+d)}{(x-z)(cy+d)}\n\\]\nSo\n\\[\n\\frac{f(z_2)-f(z_3)}{f(z_2)-f(z_1)} \\frac{f(z_4)-f(z_1)}{f(z_4)-f(z_3)} =\n\\frac{(z_2-z_3)(c z_1 +d)}{(z_2-z_1)(c z_3 + d)} \\frac{(z_4-z_1)(c z_3 +d)}{(z_4-z_3)(c z_1 + d)}\n= \\frac{z_2-z_3}{z_2-z_1} \\frac{z_4-z_1}{z_4-z_3}\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 03"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw03.html#joukowski-transform",
    "href": "courses/phys231/phys231_hw03.html#joukowski-transform",
    "title": "Homework 03",
    "section": "4. Joukowski transform",
    "text": "4. Joukowski transform",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 03"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw04.html",
    "href": "courses/phys231/phys231_hw04.html",
    "title": "Homework 04",
    "section": "",
    "text": "Complete PDF\nMathematica Notebook",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 04"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw04.html#winding-number",
    "href": "courses/phys231/phys231_hw04.html#winding-number",
    "title": "Homework 04",
    "section": "2. Winding number",
    "text": "2. Winding number\n\nSuppose \\(f(z)\\) is holomorphic in the disc \\(|z| ≤ ϵ\\) and has a zero at \\(z = 0\\) but nowhere else in the disc \\(|z| ≤ ϵ\\). Show by direct integration that\n\\[\n\\frac{1}{2πi} \\int_{|z|=ϵ} \\frac{f'(z)}{f(z)} dz\n\\]\nequals the winding number of the argument of f around the circle \\(|z| = ϵ\\). Then use the residue theorem to show that this equals the degree of the zero, in agreement with the argument principle.\n\nThe integral\n\\[\n\\int_{C} \\frac{f'(z)}{f(z)} dz = \\int_{C} \\frac{1}{f(z)} df(z) = \\int_{f(C)} \\frac{1}{w} dw\n\\]\neffectively measures the total change in the argument of \\(f(z)\\) as \\(z\\) traverses the circle, which equals the winding number of the argument of \\(f\\).\nSince \\(f(z)\\) is holomorphic in the disc \\(|z| \\leq \\epsilon\\) and has a zero at \\(z = 0\\), \\(f(z)\\) can be locally expressed as \\(z^n g(z)\\), where \\(n\\) is the degree of the zero.\nThen, \\(f'(z) = n z^{n−1} g(z) + z^n g'(z)\\), and so\n\\[\n\\frac{f'(z)}{f(z)} = \\frac{n}{z} + \\frac{g'(z)}{g(z)}\n\\]\nThe residue at \\(z=0\\) is the coefficient of \\(\\frac{1}{z}\\) in this expression, which is \\(n\\), the degree of the zero.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 04"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw04.html#analytic-continuation-and-fourier-coefficents",
    "href": "courses/phys231/phys231_hw04.html#analytic-continuation-and-fourier-coefficents",
    "title": "Homework 04",
    "section": "4. Analytic continuation and Fourier coefficents",
    "text": "4. Analytic continuation and Fourier coefficents\n\nGive an analytic continuation of \\(\\cos θ\\) from the unit circle \\(z = e^{iθ}\\) to the complex plane minus the origin.\nConclude that the Fourier coefficients \\(c_n\\) of \\(e^{- \\cos θ}\\) decrease faster than any exponential, meaning \\(c_n = o(e^{−αn})\\) for all \\(α\\) as \\(n → ±∞\\). Compare this to the Fourier series of \\(1/(cos θ −3/2)\\), what is the decay of its Fourier coefficents?\n\n\nAnalytic continuation\nOn the unit circle \\(z=e ^ {iθ}\\), \\(\\cos \\theta = \\frac{1}{2} (e^{iθ} +e^{−iθ}) = \\frac{1}{2} (z+ z^{-1})\\). This expression provides an analytic continuation of \\(\\cos \\theta\\) to the complex plane minus the origin, as it is well-defined for all \\(z \\neq 0\\).\n\n\nFourier coefficents of \\(e^{−\\cos \\theta}\\)\nThe function \\(e^{−\\cos \\theta}\\) is smooth and periodic. The Fourier coefficients \\(c_n\\) of a periodic function \\(f(θ)\\) are given by:\n\\[\nc_n= 1/2π ∫_{0}^{2π} f(θ)e^{inθ}dθ = 1/2π \\int_{0}^{2π} e^{-\\cos θ + i n θ}dθ\n\\]\n\\[\n1/2π \\int_{0}^{2π} e^{-\\cos θ + i n θ} dθ = 1/2π \\int_{|z|=1} e^{-z/2-1/2z} z^n \\frac{dz}{i z} = Res_{z=0} { e^{-z/2-1/2z} z^{n-1} }\n\\]\nThe coefficient \\(a_{-n}\\) of \\(g(z)=e^{-z/2-1/2z}\\) at the point of \\(z=0\\) can de derived by expanding by separately \\(e^{-z/2}\\) as Talyor Series and \\(e^{−1/(2z)}\\) as a Laurent Series and then multiplying these series together\n\\[\na_{-n} = \\sum_{k=0}^{\\infty} (-\\frac{1}{2})^k \\frac{1}{k!} (-\\frac{1}{2})^{(n+k)} \\frac{1}{(n+k)!}\n\\]\nSo fourier coefficients \\(c_n\\)\n\\[\nc_n = a_{-n}  \\leq  |a_{-n} | \\leq \\frac{1}{2^{n}}\\frac{1}{n!}\n\\]\ndecrease faster than any exponential.\n\n\nFourier coefficents of \\(\\frac{1}{\\cos \\theta - 3/2}\\)\nThe Fourier coefficients \\(c_n\\) of a periodic function \\(f(θ)\\) are given by:\n\\[\n\\begin{aligned}\nc_n\n&= \\frac{1}{2π} \\int_{0}^{2π} f(θ)e^{inθ}dθ \\\\\n&= \\frac{1}{2π} \\int_{0}^{2π} \\frac{1}{\\cos \\theta - 3/2}e^{i n θ}dθ \\\\\n&= \\frac{1}{2πi} \\int_{|z| = 1} \\frac{2z}{z^2-3z+1} z^{n-1} dz\n\\end{aligned}\n\\]\nLet \\(z^2 - 3z+1=(z-z_1)(z-z_2)\\), where \\(z_1 = \\frac{1}{2} \\left(3-\\sqrt{5}\\right), z_2=\\frac{1}{2} \\left(3 + \\sqrt{5}\\right)\\).\n\\[\n\\begin{aligned}\nc_n\n&= Res_{z=z_1}  \\frac{2z}{(z-z_1)(z-z_2)} z^{n-1} \\\\\n&= \\frac{2 z_1}{z_1-z_2} {z_1}^{n-1}\n\\end{aligned}\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 04"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw04.html#laurent-series-and-singularity",
    "href": "courses/phys231/phys231_hw04.html#laurent-series-and-singularity",
    "title": "Homework 04",
    "section": "5. Laurent series and singularity",
    "text": "5. Laurent series and singularity\nLet’s consider a function \\(f\\) that is holomorphic in a disc around \\(z_0\\) except at \\(z_0\\) itself.\n\nRemovable Singularity:\nIf \\(f\\) has a removable singularity at \\(z_0\\), it means that \\(f\\) can be extended to a holomorphic function at \\(z_0\\). In terms of the Laurent series, this implies that all the coefficients \\(a_n\\) for \\(n &lt; 0\\) are zero because it reduces to its Taylor series.\nConversely, if all \\(a_n = 0\\) for \\(n &lt; 0\\), the Laurent series reduces to a Taylor series, implying that \\(f\\) is holomorphic at \\(z_0\\) (since it can be expressed as a power series), and thus the singularity is removable.\nPole of Order \\(m\\) :\nIf \\(f\\) has a pole of order \\(m\\) at \\(z_0\\), it means that in the Laurent series, there is a term with \\((z - z_0)^{-m}\\) (where \\(a_{-m} \\neq 0\\)) and no terms with higher negative powers.\nConversely, if there is some \\(m &lt; 0\\) such that \\(a_m \\neq 0\\) but \\(a_n = 0\\) for all \\(n &lt; m\\), then the Laurent series has a term \\(a_m (z - z_0)^m\\) as its term with the highest negative power, indicating a pole of order \\(m\\) .\nEssential Singularity:\nIf the singularity at \\(z_0\\) is neither removable nor a pole, it must be an essential singularity. This is characterized by the fact that there are infinitely many negative powers of \\(z - z_0\\) in the Laurent series with non-zero coefficients. In other words, if the Laurent series has non-zero \\(a_n\\) for infinitely many \\(n &lt; 0\\), then \\(z_0\\) is an essential singularity.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 04"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw04.html#euler-proof-of-basel-problem",
    "href": "courses/phys231/phys231_hw04.html#euler-proof-of-basel-problem",
    "title": "Homework 04",
    "section": "6. Euler proof of Basel problem",
    "text": "6. Euler proof of Basel problem\n\nUsing the result of the bonus problem, prove that\n\\[\n\\sin π z = \\prod (1 − z/n)e^{z/n} = π z  \\prod (1 − z^2/n^2)\n\\]\nThen compare the Taylor series of sin πz to the first couple terms in the expansion of the infinite product to conclude\n\\[\n\\sum_{n=1}^{\\infty}  1/n^2 = π^2/ 6\n\\]\n\nAccording to the Weierstrass factorization theorem, an entire function can be represented as a product over its zeros. The function \\(\\sin \\pi z\\) is entire and has zeros at all integers. The product representation for \\(\\sin \\pi z\\) is given by:\n\\[\n\\sin \\pi z = \\pi z \\prod_{n=1}^{\\infty} \\left(1 - \\frac{z}{n}\\right)\\left(1 + \\frac{z}{n}\\right)\n=  \\sin \\pi z = \\pi z \\prod_{n=1}^{\\infty} \\left(1 - \\frac{z^2}{n^2}\\right)\n\\]\nThe Taylor series expansion of \\(\\sin \\pi z\\) around \\(z = 0\\) is:\n\\[\n\\sin \\pi z = \\pi z - \\frac{\\pi^3 z^3}{3!} + \\frac{\\pi^5 z^5}{5!} - \\frac{\\pi^7 z^7}{7!} + \\cdots\n\\]\nNow, let’s expand the infinite product to the first couple of terms and keeping terms up to \\(z^3\\), we get:\n\\[\n\\begin{aligned}\n\\pi z \\prod_{n=1}^{\\infty} \\left(1 - \\frac{z^2}{n^2}\\right)\n&= \\pi z \\left(1 - \\frac{z^2}{1^2}\\right)\\left(1 - \\frac{z^2}{2^2}\\right)\\left(1 - \\frac{z^2}{3^2}\\right) \\cdots \\\\\n&= \\pi z \\left(1 - z^2 \\left(\\frac{1}{1^2} + \\frac{1}{2^2} + \\frac{1}{3^2} + \\cdots\\right) + \\cdots \\right)\n\\end{aligned}\n\\]\nComparing the coefficient of \\(z^3\\) from the Taylor series and the product expansion, we have:\n\\[\n-\\frac{\\pi^3}{6} = -\\pi \\left(\\frac{1}{1^2} + \\frac{1}{2^2} + \\frac{1}{3^2} + \\cdots\\right)\n\\]\nThis is the result we want.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 04"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw05.html",
    "href": "courses/phys231/phys231_hw05.html",
    "title": "Homework 05",
    "section": "",
    "text": "Compute this generalization of an integral we did in class:\n\\[\nI_{n,a}(k) = \\int^{∞}_{−∞} \\frac{ e^{ikx} }{ (x^2 + a^2)^n} dx\n\\]\nwhere \\(k, a \\in {\\mathbb{R}}, a &gt; 0\\) and \\(n \\in {\\mathbb{Z}}, n \\geq 1\\). What is the degree of differentiability of \\(I_{n,a}(k)\\) with respect to \\(k\\)? How does this relate to the decay of the integrand?\n\n\n\nComplex function \\(f(z) = \\frac{e^{ikz}}{(z^2 + a^2)^n}\\) has poles at \\(z = \\pm i a\\).\nThe residue at \\(z = + i a\\) pole\n\\[\n\\text{Res}(f, ia) = \\frac{1}{(n-1)!} \\lim_{z \\to ia} \\frac{d^{n-1}}{dz^{n-1}} \\left[ (z - ia)^n f(z) \\right]\n\\]\nConstruct a semicircular contour in the upper half-plane that consists of a line segment \\(C_1\\) from \\(−R\\) to \\(R\\) and a semicircular arc \\(C_2\\) of radius \\(R\\) centered at the origin.\nThe integral over the contour \\(C\\) is:\n\\[\n\\int_C f(z) dz = 2\\pi i \\times \\text{Res}(f, ia)\n\\]\nAs \\(R \\to \\infty\\), the integral over \\(C_2\\) vanishes for \\(k&gt;0\\) due to the exponential decay of \\(e^{ikz}\\) in the upper half-plane.\nThe original integral \\(I_{n,a}(k)\\) is equal to the integral over \\(C_1\\):\n\\[\nI_{n,a}(k) = 2\\pi i \\times \\text{Res}(f, ia)\n\\]\n\n\n\n\\[\nI_{n,a}'(k) = \\int^{∞}_{−∞} \\frac{ ix e^{ikx} }{ (x^2 + a^2)^n} dx\n\\]\nThe corresponding complex function\n\\[\nf_k(z) = \\frac{i z e^{ikz}}{(z^2 + a^2)^n}\n\\]\nhas poles at \\(z = \\pm i a\\).\nThe function \\(I_{n,a}(k)\\) will be infinitely differentiable with respect to \\(k\\) because the exponential function \\(e^{ikx}\\) is smooth and the denominator does not depend on \\(k\\).\n\n\n\nThe decay of the integrand as \\(x \\to \\pm\\infty\\) is crucial for the convergence of the integral. The factor \\((x^2 + a^2)^{-n}\\) ensures that the integrand decays sufficiently fast at infinity for the integral to converge.\nThe faster decay of the integrand at infinity, which is ensured by a higher \\(n\\), means that \\(I_{n,a}(k)\\) will be more regular (i.e., higher degree of differentiability).",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 05"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw05.html#integral-differentiability-and-decay-rate",
    "href": "courses/phys231/phys231_hw05.html#integral-differentiability-and-decay-rate",
    "title": "Homework 05",
    "section": "",
    "text": "Compute this generalization of an integral we did in class:\n\\[\nI_{n,a}(k) = \\int^{∞}_{−∞} \\frac{ e^{ikx} }{ (x^2 + a^2)^n} dx\n\\]\nwhere \\(k, a \\in {\\mathbb{R}}, a &gt; 0\\) and \\(n \\in {\\mathbb{Z}}, n \\geq 1\\). What is the degree of differentiability of \\(I_{n,a}(k)\\) with respect to \\(k\\)? How does this relate to the decay of the integrand?\n\n\n\nComplex function \\(f(z) = \\frac{e^{ikz}}{(z^2 + a^2)^n}\\) has poles at \\(z = \\pm i a\\).\nThe residue at \\(z = + i a\\) pole\n\\[\n\\text{Res}(f, ia) = \\frac{1}{(n-1)!} \\lim_{z \\to ia} \\frac{d^{n-1}}{dz^{n-1}} \\left[ (z - ia)^n f(z) \\right]\n\\]\nConstruct a semicircular contour in the upper half-plane that consists of a line segment \\(C_1\\) from \\(−R\\) to \\(R\\) and a semicircular arc \\(C_2\\) of radius \\(R\\) centered at the origin.\nThe integral over the contour \\(C\\) is:\n\\[\n\\int_C f(z) dz = 2\\pi i \\times \\text{Res}(f, ia)\n\\]\nAs \\(R \\to \\infty\\), the integral over \\(C_2\\) vanishes for \\(k&gt;0\\) due to the exponential decay of \\(e^{ikz}\\) in the upper half-plane.\nThe original integral \\(I_{n,a}(k)\\) is equal to the integral over \\(C_1\\):\n\\[\nI_{n,a}(k) = 2\\pi i \\times \\text{Res}(f, ia)\n\\]\n\n\n\n\\[\nI_{n,a}'(k) = \\int^{∞}_{−∞} \\frac{ ix e^{ikx} }{ (x^2 + a^2)^n} dx\n\\]\nThe corresponding complex function\n\\[\nf_k(z) = \\frac{i z e^{ikz}}{(z^2 + a^2)^n}\n\\]\nhas poles at \\(z = \\pm i a\\).\nThe function \\(I_{n,a}(k)\\) will be infinitely differentiable with respect to \\(k\\) because the exponential function \\(e^{ikx}\\) is smooth and the denominator does not depend on \\(k\\).\n\n\n\nThe decay of the integrand as \\(x \\to \\pm\\infty\\) is crucial for the convergence of the integral. The factor \\((x^2 + a^2)^{-n}\\) ensures that the integrand decays sufficiently fast at infinity for the integral to converge.\nThe faster decay of the integrand at infinity, which is ensured by a higher \\(n\\), means that \\(I_{n,a}(k)\\) will be more regular (i.e., higher degree of differentiability).",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 05"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw05.html#integral-of-a-keyhole-contour",
    "href": "courses/phys231/phys231_hw05.html#integral-of-a-keyhole-contour",
    "title": "Homework 05",
    "section": "2. Integral of a keyhole contour",
    "text": "2. Integral of a keyhole contour\n\nCompute the following integral by a choice of keyhole contour, where \\(a, b, c ∈ {\\mathbb{R}}\\) and \\(b, c &gt; 0\\):\n\\[\nI(a, b, c) = \\int^∞_{−∞} dx \\frac{\\log(x^2 + c^2)}{ (x − a)^2 + b^2}\n\\]\n\nThe complex function\n\\[\nf(z) = \\frac{\\log(z^2 + c^2)}{ (z − a)^2 + b^2} = \\frac{\\log(z+ ic)}{ (z − a)^2 + b^2} + \\frac{\\log(z - ic)}{ (z − a)^2 + b^2}\n\\]\nmay have branch point \\(𝑧 = \\pm 𝑖c\\) and have poles at \\(a \\pm ib\\).\nConsider the contour integral \\(\\oint_C dz f(z)\\)in the complex plane where \\(𝐶\\) is a semicircle of radius \\(R\\) in the upper half-plane with a detour down and up the imaginary axis about the branch point \\(z=ic\\).\n\nThe function \\(\\log(z + ic)\\) is holomorphic in the upper half plane if we choose its branch cut to lie in the lower half plane, so the integrand is holomorphic inside the contour of \\(C\\) except for a simple pole at \\(a + ib\\).\n\\[\n\\oint_C dz \\frac{\\log(z+ ic)}{ (z − a)^2 + b^2} = 2 \\pi i \\frac{\\log(a+ib+ic)}{2ib} = \\frac{\\pi}{b} \\log(a+ib+ic)\n\\]\nThe function \\(\\log(z - ic)\\) has a branch cut in the upper half plane. We have\n\\[\n\\oint_C dz \\frac{\\log(z - ic)}{ (z − a)^2 + b^2} = \\frac{\\pi}{b} \\log(a + ib - ic) + \\int_{ic}^{\\infty} \\frac{ \\log (iy-ic+\\epsilon) - \\log (iy-ic+\\epsilon)}{ (z-a)^2+b^2}\n\\]\nSince the contribution from the big semi-circle tends to zero as \\(R → ∞\\) and from the small circle around \\(ic\\) as its radius tends to zero. And\n\\[\n\\int_{ic}^{\\infty} \\frac{ \\log (iy-ic+\\epsilon) - \\log (iy-ic+\\epsilon)}{ (z-a)^2+b^2} = -2 \\pi \\int_c^{\\infty}dy \\frac{1}{(iy-a)^2+b^2} = - \\frac{\\pi}{b}\\log \\frac{a+ib-ic}{a-ib-ic}\n\\]\nSo\n\\[\n\\begin{align*}\nI(a, b, c)\n&= \\int^∞_{−∞} dx \\frac{\\log(x^2 + c^2)}{ (x − a)^2 + b^2} \\\\\n&= \\frac{\\pi}{b} \\log(a+ib+ic) + \\frac{\\pi}{b} \\log(a+ib-ic) - - \\frac{\\pi}{b}\\log \\frac{a+ib-ic}{a-ib-ic} \\\\\n&= \\frac{\\pi}{b} \\log(a^2+(b+c)^2)\n\\end{align*}\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 05"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw05.html#integral-and-laurent-expansion",
    "href": "courses/phys231/phys231_hw05.html#integral-and-laurent-expansion",
    "title": "Homework 05",
    "section": "3. Integral and Laurent expansion",
    "text": "3. Integral and Laurent expansion\n\nConsider the integral\n\\[\n\\int_C dz \\frac{z + 2}{ z^2 − 9}\n\\]\nwhere \\(C\\) is a positively-oriented circle of radius 4. Compute this integral by taking the sum of the residues inside the circle, and then again by computing the “residue at \\(∞\\)” meaning using the outer Laurent expansion\n\nThe integrand\n\\[\nf(z) = \\frac{z + 2}{z^2 - 9}\n\\]\nhave simple poles at \\(z =\\pm 3\\).\n\\[\n\\text{Res}(f, 3) = \\lim_{z \\to 3} (z - 3) \\frac{z + 2}{z^2 - 9} = \\frac{5}{6}\n\\]\n\\[\n\\text{Res}(f, -3) = \\lim_{z \\to -3} (z + 3) \\frac{z + 2}{z^2 - 9} = \\frac{1}{6}\n\\]\nBy the residue theorem, the integral over the contour \\(C\\) is:\n\\[\n\\int_C f(z) , dz = 2\\pi i \\times (\\text{Res}(f, 3) + \\text{Res}(f, -3)) = 2\\pi i\n\\]\nUsing the outer Laurent expansion\n\\[\n\\frac{z + 2}{z^2 - 9} = \\frac{1}{z} + O[\\frac{1}{z^2}]\n\\]\nSo using residue at \\(∞\\)\n\\[\n\\text{Res}(f, ∞) = 1\n\\] \\[\n\\int_C f(z) , dz = 2\\pi i \\times \\text{Res}(f, ∞) = 2\\pi i\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 05"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw05.html#analytically-continuing",
    "href": "courses/phys231/phys231_hw05.html#analytically-continuing",
    "title": "Homework 05",
    "section": "4. Analytically continuing",
    "text": "4. Analytically continuing\n\nCompute the integral\n\\[\n\\int^{2π}_{0} \\frac{dθ}{2 − \\cos θ  }\n\\]\nby analytically continuing the integrand and then using residues.\n\nPerform a change of variables to convert the integral into a contour integral in the complex plane.\nLet \\(z = e^{i\\theta}\\). Then, \\(dz = ie^{i\\theta}d\\theta = izd\\theta\\) and \\(d\\theta = \\frac{dz}{iz}\\). Also, \\(\\cos \\theta = \\frac{1}{2}(e^{i\\theta} + e^{-i\\theta}) = \\frac{1}{2}(z + \\frac{1}{z})\\).\nSubstituting these into the integral, we get:\n\\[\n\\int^{2π}_{0} \\frac{dθ}{2 − \\cos θ  } = \\int_{|z|=1} \\frac{1}{2 - \\frac{1}{2}(z + \\frac{1}{z})} \\times \\frac{dz}{iz}\n\\]\nSimplifying this, we have:\n\\[\n\\int_{|z|=1} \\frac{dz}{2iz - \\frac{1}{2}i(z^2 + 1)}\n\\]\nTo find the poles of the integrand, we set the denominator to zero:\n\\[\niz - \\frac{1}{2}i(z^2 + 1) =0\n\\]\n\\[\nz_1=2-\\sqrt{3}, z_2=2+\\sqrt{3}\n\\]\n\\(z_1\\) is within the contour, so\n\\[\n\\int_{|z|=1} \\frac{1}{2 - \\frac{1}{2}(z + \\frac{1}{z})} \\times \\frac{dz}{iz} = 2 \\pi i \\frac{2}{i(z_2-z_1)} = \\frac {2 \\pi}{\\sqrt 3}\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 05"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw05.html#gamma-function",
    "href": "courses/phys231/phys231_hw05.html#gamma-function",
    "title": "Homework 05",
    "section": "5. Gamma function",
    "text": "5. Gamma function\n\nThe Gamma function is usually defined as\n\\[\nΓ(z) = \\int^∞_0 t^{z−1}e^{−t}dt\n\\]\n(This kind of integral is known as a Mellin transform, in this case of \\(e^{−t}\\), and we can equivalently write it as a two-sided Laplace transform of \\(e^{−e^s}\\) by taking \\(s = \\log t\\).) Verify this integral exists for \\(\\Re(z) &gt; 0\\) and that\n\\[\nzΓ(z) = Γ(z + 1)\n\\] \\[\nΓ(n + 1) = n!\n\\]\nThe first relation can be iterated to analytically continue the \\(Γ\\) function to the whole complex plane, except for poles at the nonpositive integers. However, there is a way to analytically continue it all at once:\nSplit the integral into two parts \\(\\int^∞_ 1 +\\int^1_0\\) . Show that the first part yields an entire function in \\(z\\), and that the second part equals\n\\[\n\\sum_{n=0}^\\infty \\frac{(−1)^n}{n!} \\frac{1}{ z + n}\n\\]\nwhich is an entire meromorphic function with poles at the non-positive integers, thus giving an analytic continuation of \\(Γ\\) as a meromorphic function on all of \\({\\mathbb{C}}\\).\n\nTo verify the properties of the Gamma function and its analytic continuation, we’ll break down the problem into parts.\n\nExistence\nWe prove this integral converges absolutely.\n\\[\n\\int\\limits_0^\\infty |t^{z-1}e^{-t}| dt  = \\int\\limits_0^\\infty t^{\\operatorname{Re} z-1}e^{-t} dt\n\\]\nFor \\(z \\in {\\mathbb{R}}\\),\n\\[\n\\int\\limits_0^\\infty t^{z-1}e^{-t}dt = \\int\\limits_0^1 t^{z-1}e^{-t}dt + \\int\\limits_1^\\infty t^{z-1}e^{-t}dt\n\\]\nwe have for large \\(N \\le t,\\) \\(t^{z-1}e^{-t}\\le e^{-t/2}\\)\n\\[\n0\\le t\\le N \\implies t^{z-1}e^{-t}\\le t^{z-1}\n\\;,\\;\\;\\text{and}\\;\\;\n\\int\\limits_0^N t^{z-1}dt=\\left.\\frac{t^z}z\\right|_0^N=\\frac{N^z}{z}\n\\]\n\\[\nN \\le t\\implies t^{z-1}e^{-t}\\le e^{-t/2}\n\\;,\\;\\;\\text{and}\\;\\;\n\\int\\limits_N^\\infty e^{-t/2} dt=\\left. -2 e^{-t/2}\\right|_N^\\infty= 2e^{-N/2}\n\\]\nSo\n\\[\n\\int\\limits_0^\\infty |t^{z-1}e^{-t}| dt  \\le \\infty\n\\]\nTherefore, this integral exists for \\(\\Re(z) &gt; 0\\).\n\n\n\\(zΓ(z) = Γ(z + 1)\\)\nBy definition:\n\\[\nz\\Gamma(z) = z \\int_{0}^{\\infty} t^{z-1}e^{-t} dt\n\\]\nUsing integration by parts, we get:\n\\[\n\\begin{aligned}\nz\\Gamma(z)\n&= \\left. t^z e^{-t} \\right| _{0}^{\\infty} - \\int_{0}^{\\infty} t^{z} (-e^{-t}) dt \\\\\n&= \\int_{0}^{\\infty} t^z e^{-t} dt \\\\\n&= \\Gamma(z + 1)\n\\end{aligned}\n\\]\n\n\n\\(Γ(n + 1) = n!\\)\n\\[\n{\\displaystyle {\\begin{aligned}\\Gamma (1)&=\\int _{0}^{\\infty }t^{1-1}e^{-t}\\,dt\\\\&=\\int _{0}^{\\infty }e^{-t}\\,dt\\\\&=1.\\end{aligned}}}\n\\]\nBy induction we have \\(Γ(n + 1) = n!\\)\n\n\nSplitting\nNow, to analytically continue the Gamma function, we split the integral into two parts:\n\\[\n\\Gamma(z) = \\int_{1}^{\\infty} t^{z-1}e^{-t} dt + \\int_{0}^{1} t^{z-1}e^{-t} dt\n\\]\n\nThe first part \\(\\int_{1}^{\\infty} t^{z-1}e^{-t} dt = (\\int_{1}^{N} + \\int_{N}^{\\infty}) t^{z-1}e^{-t} dt\\) converges for all \\(z\\) and is an entire function in \\(z\\).\nThe second part \\(\\int_{0}^{1} t^{z-1}e^{-t} dt\\) ) can be expressed as a power series using the Taylor expansion of \\(e^{-t}\\) :\n\n\\[\n\\int_{0}^{1} t^{z-1}e^{-t}dt\n= \\int_{0}^{1} t^{z-1} \\sum_{n=0}^{\\infty} \\frac{(-1)^n}{n!} t^n dt\n= \\sum_{n=0}^{\\infty} \\frac{(-1)^n}{n!} \\int_{0}^{1} t^{z + n - 1} dt\n= \\sum_{n=0}^{\\infty} \\frac{(-1)^n}{n!} \\frac{1}{z + n}\n\\]\nThis series converges for ( z ) not a non-positive integer and provides an analytic continuation of \\(\\Gamma\\) as a meromorphic function on all of \\(\\mathbb{C}\\), with poles at the non-positive integers.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 05"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw05.html#gamma-relation",
    "href": "courses/phys231/phys231_hw05.html#gamma-relation",
    "title": "Homework 05",
    "section": "6. Gamma relation",
    "text": "6. Gamma relation\n\nProve the relation\n\\[\nΓ(z)Γ(1 − z) = \\frac{π} {\\sin πz}\n\\]\nby combining the two Gamma integrals into\n\\[\nΓ(z)Γ(1 − z) = \\int^∞_0 dt \\frac{t^{z−1}}{t + 1}\n\\]\nand evaluating this by residues.\n\n\\[\n\\Gamma(z) = \\int_{0}^{\\infty} t^{z-1}e^{-t} dt\n\\]\nFor fixed \\(t\\)\n\\[\n\\Gamma(1 - z)\n= \\int_{0}^{\\infty} t^{-z}e^{-t} dt\n= \\int_{0}^{\\infty} u^{-z}e^{-u} du\n= t \\int_{0}^{\\infty} (vt)^{-z}e^{-vt} dv\n\\]\nBy combining these two\n\\[\nΓ(z)Γ(1 − z)\n= \\int^∞_0\\int^∞_0  e^{-t(1+v)} v^{-z} dvdt\n= \\int^∞_0 dv \\frac{v^{z−1}}{v + 1}\n= \\int^∞_0 dt \\frac{t^{z−1}}{t + 1}\n= \\int^∞_{-∞} dt \\frac{e^{zx}}{ 1+e^x }\n\\]\nComplex function\n\\[\n\\frac{e^{zx}}{ 1+e^x }\n\\]\nhave pole at \\(\\pi i\\). Consider a contour \\(C_R\\) in the complex plane with vertices at \\(R\\), \\(−R\\), \\(R+2πi\\), and \\(−R+2πi\\), as \\(R\\) tends to infinity. We have\n\\[\n{\\displaystyle \\int _{C_{R}}{\\frac {e^{xz}}{1+e^{x}}} dx=-2\\pi ie^{z \\pi i}}\n\\] \\[\n\\int _{C_{R3}}{f(x,z)} dx = -e^{2\\pi i z} \\int _{C_{R1}}{f(x,z)} dx\n\\]\nThe right and left vertical sides of the rectangle tend to 0 as \\(R \\to \\infty\\) for \\(z \\in (0,1)\\).\n\\[\n\\int^∞_{-∞} dt \\frac{e^{zx}}{ 1+e^x } = \\frac{-2\\pi ie^{z \\pi i}}{1-e^{2\\pi i z}} = \\frac{\\pi}{\\sin \\pi z}\n\\]\nBy analytic continuation, this relation is true for all \\(z \\in {\\mathbb{C}}/\\ {\\mathbb{Z}}\\)",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 05"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw06.html",
    "href": "courses/epss265/homeworks/epss265_hw06.html",
    "title": "06 - FPI",
    "section": "",
    "text": "For an event/spacecraft of your choice from MMS (other than MMS3 for the event in the above crib provided), introduce L2 FPI ion and electron moments and eflux energy spectrograms. Explain what the region of space is (why the data are consistent with that region). Magnetic field is always useful to include. Use a geophysical coordinate system (GSM, GSE a al., Science 2016 and Torbert et al., Science 2018.\nUsing standard tools in mms_part_products, obtain gyro-velocity spectra of high-energy (5-10keV or 20-30keV) ions. Can you tell the gradient of those ions at the magnetopause, or the plasma sheet boundary layer from their duskward anisotropy?\nAlso using mms_part_products, obtain pitch angle spectra from FPI for low (100-1000eV) and high (10-20keV) electrons in a region surrounding magnetic reconnection (1-2min before and after). Can you tell where the anisotropy reverses from towards to away from the RX region? How do you interpret this reversal?\nWe choose MMS for this question. And the data is from 2015-10-16 13:00-14:00UT.\nIts locations plot together with related quicklook plots are shown below copied from (Burch et al. 2016) paper.\nFPI visualizations are shown below obtained from MMS/FPI Website.\nCode\nimport pyspedas\nfrom pyspedas import tcopy\nfrom pyspedas.mms.particles.mms_part_getspec import mms_part_getspec\nfrom pytplot import tplot, store_data, options\nCode\ntrangeOfInterest = [\"2015-10-16T13:05:30\", \"2015-10-16T13:08:30\"]\nmms_num = \"2\"\nfpi_data_rate = \"brst\"\nCode\nmms_sc = \"mms\" + mms_num\nmms_sc_f = mms_sc + \"_\"\nfpi_dr_f = \"_\" + fpi_data_rate\nCode\npyspedas.mms.fgm(trange=trangeOfInterest, probe=mms_num, time_clip=True)\npyspedas.mms.fpi(\n    trange=trangeOfInterest, probe=mms_num, time_clip=True, data_rate=fpi_data_rate\n)",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "06 - FPI"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw06.html#notes",
    "href": "courses/epss265/homeworks/epss265_hw06.html#notes",
    "title": "06 - FPI",
    "section": "Notes",
    "text": "Notes\nI have released a cribsheet “myexample_FPI_mom_part_spectra” for doing moments and enegry/angle spectra calculations using pyspedas. The crib sheet (.pyspd) and its Jupytr notebook (.ipynb) along with 2 plots they produce are in mms_BE_FPI_pyspd_cribs.zip. They show you how to make moments, and energy, phi, theta, pitch angle and gyrophase spectrograms for ions and electrons from MMS L2 data.\nNote that energy spectra and moments already exist as L2 products. The routines I mention create additional angle spectrograms that are useful for analysis.\nThere are some problems with mms_part_getspec, the basic routine for doing the above spectra. (I have informed the software team and they will resolve these problems soon enough.) The major bugs are:\n\nThe ion moments computation does not produce good results (plotted in the second figure, and compared to L2 moments you can simply load and plot in the first figure) so you cannot yet trust them. The symptom is that the computed ion density is too high and the ion velocity compared to the directly-loaded ion moments. This may be simply an issue of setting the right keywords in the computation and making them default or at least documenting them. Electron moments seem fine.\nThe pitch-angle spectrogram computation for ions or electrons does not produce anything. I have commented out the calls producing them.\n\nThe crib sheet only applies the above moments and spectrogram calc’s to 5 minutes of fast survey data. Some take several minutes to complete but some take less than 1 minute. Some are un-necessarily long and I have informed the team on methods to accelerate them. For now, you can see them run one at a time and can plot the results, and digest them, while another one is running in the background.\nThese are similar to routines that already exist in IDL for both THEMIS and MMS, but in PySPEDAS only the MMS ones are currently available. The tools are generic enough and will be implemented on THEMIS and other spacecraft in the future.",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "06 - FPI"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw06.html#part-1",
    "href": "courses/epss265/homeworks/epss265_hw06.html#part-1",
    "title": "06 - FPI",
    "section": "Part 1",
    "text": "Part 1\n\nMagnetic field panel\n\n\nCode\nfgm_tvar = \"fgm_b_gsm_srvy_l2_bvec\"\nfgm_tvar_f = mms_sc_f + fgm_tvar\nmag_panel = fgm_tvar_f\noptions(mag_panel, \"ytitle\", \"FGM \\n magnetic field\")\n\n\n\n\nEnergy panel\n\n\nCode\ni_energy_spectr_tvar = \"dis_energyspectr_omni\"\ne_energy_spectr_tvar = \"des_energyspectr_omni\"\n\ni_spectr_panel = mms_sc_f + i_energy_spectr_tvar + fpi_dr_f\ne_spectr_panel = mms_sc_f + e_energy_spectr_tvar + fpi_dr_f\noptions(i_spectr_panel, \"ytitle\", \"Ion \\n OMNI spectrum\")\noptions(e_spectr_panel, \"ytitle\", \"Electron \\n OMNI spectrum\")\n\n\n\n\nDensity panel\n\n\nCode\nnumberdensity_tvars = [\"des_numberdensity\", \"dis_numberdensity\"]\nnumberdensity_tvars_f = [mms_sc_f + tvar + fpi_dr_f for tvar in numberdensity_tvars]\n\nnumberdensity_panel = mms_sc_f + \"numberdensity\" + fpi_dr_f\n\nstore_data(numberdensity_panel, numberdensity_tvars_f)\noptions(numberdensity_panel, \"Color\", [\"black\", \"red\"])\noptions(numberdensity_panel, \"ytitle\", \"Number \\n density\")\n\n\n\n\nVelocity panel\n\n\nCode\ni_velocity_tvar = \"dis_bulkv_gse\"\ne_velocity_tvar = \"des_bulkv_gse\"\n\ni_velocity_panel = mms_sc_f + i_velocity_tvar + fpi_dr_f\ne_velocity_panel = mms_sc_f + e_velocity_tvar + fpi_dr_f\n\noptions(i_velocity_panel, \"ytitle\", \"Ion \\n velocity\")\noptions(e_velocity_panel, \"ytitle\", \"Electron \\n velocity\")\n\n\n\n\nTemperature panel\n\n\nCode\ni_temperature_tvars = [\"dis_temppara\", \"dis_tempperp\"]\ne_temperature_tvars = [\"des_temppara\", \"des_tempperp\"]\n\n\ni_temperature_tvars_f0 = [mms_sc_f + tvar + fpi_dr_f for tvar in i_temperature_tvars]\ne_temperature_tvars_f0 = [mms_sc_f + tvar + fpi_dr_f for tvar in e_temperature_tvars]\n\ni_temperature_panel = mms_sc_f + \"dis_temp\" + fpi_dr_f\ne_temperature_panel = mms_sc_f + \"des_temp\" + fpi_dr_f\n\nstore_data(i_temperature_panel, i_temperature_tvars_f0)\noptions(i_temperature_panel, \"Color\", [\"blue\", \"red\"])\noptions(i_temperature_panel, \"ytitle\", \"Ion \\n temperature\")\n\nstore_data(e_temperature_panel, e_temperature_tvars_f0)\noptions(e_temperature_panel, \"Color\", [\"blue\", \"red\"])\noptions(e_temperature_panel, \"ytitle\", \"Electron \\n temperature\")\n\n\n\n\nAll panels\n\n\nCode\ntvars2plot = [\n    mag_panel,\n    i_spectr_panel,\n    e_spectr_panel,\n    numberdensity_panel,\n    i_velocity_panel,\n    e_velocity_panel,\n    i_temperature_panel,\n    e_temperature_panel,\n]\ntplot(tvars2plot)\n\n\n\n\n\n\n\n\n\nWe can see that the spacecraft is crossing the magnetopause from the magnetosphere to the magnetosheath. The magnetic field is changing violently during the crossing. The density is increasing and the temperature is decreasing.",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "06 - FPI"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw06.html#part-2",
    "href": "courses/epss265/homeworks/epss265_hw06.html#part-2",
    "title": "06 - FPI",
    "section": "Part 2",
    "text": "Part 2\n\nUsing standard tools in mms_part_products, obtain gyro-velocity spectra of high-energy (5-10keV or 20-30keV) ions. Can you tell the gradient of those ions at the magnetopause, or the plasma sheet boundary layer from their duskward anisotropy?\n\nWe can see from the figure below that the ions have aniostropy in the gryo-velocity spectra after the spacecraft crosses the magnetopause. The ion becomes more isotropic in the reconnecting region and in the magnetosphere.\nNote: burst mode data is super slow to calculate the spectra. So we use fast mode data instead.\n\n\nCode\nfpi_data_rate = \"fast\"\n\nlow_energy_range = [100, 1e3]\nhigh_energy_range = [1e4, 3e4]\n\n\n\n\nCode\ntvars2plot = mms_part_getspec(\n    trange=trangeOfInterest,\n    probe=mms_num,\n    species=\"i\",\n    data_rate=fpi_data_rate,\n    units=\"eflux\",\n    output=\"gyro\",\n    pitch=[45.0, 135.0],\n    energy=high_energy_range,\n)\n\n\n\n\nCode\ntplot(tvars2plot)",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "06 - FPI"
    ]
  },
  {
    "objectID": "courses/epss265/homeworks/epss265_hw06.html#part-3",
    "href": "courses/epss265/homeworks/epss265_hw06.html#part-3",
    "title": "06 - FPI",
    "section": "Part 3",
    "text": "Part 3\n\nAlso using mms_part_products, obtain pitch angle spectra from FPI for low (100-1000eV) and high (10-20keV) electrons in a region surrounding magnetic reconnection (1-2min before and after). Can you tell where the anisotropy reverses from towards to away from the RX region? How do you interpret this reversal?\n\nParticles that travel parallel and antiparallel to the magnetic field are respectively located near the bottom and the top of the pitch angle spectrum.\nAlthough the particles travelling antiparallel to the magnetic field increase after the spacecraft crosses the magnetopause, the particles travelling parallel to the magnetic field still dominate the pitch angle spectrum for low energy electrons.\nFor the high energy electrons, this is no clear anisotropy in the pitch angle spectrum, which may be due to the use of fast mode data instead of burst mode data.\n\n\nCode\nspecies = \"e\"\nfpi_data_rate = \"fast\"\noutput=\"pa\"\n\nlow_energy_range = [100, 1e3]\nhigh_energy_range = [1e4, 2e4]\n\n\n\n\nCode\ntemp_tvar = mms_part_getspec(\n    trange=trangeOfInterest,\n    probe=mms_num,\n    species=species,\n    data_rate=fpi_data_rate,\n    output=output,\n    energy=low_energy_range\n)\ntcopy(temp_tvar[0], \"low_energy_electron_pa\")\n\ntemp_tvar = mms_part_getspec(\n    trange=trangeOfInterest,\n    probe=mms_num,\n    species=species,\n    data_rate=fpi_data_rate,\n    output=output,\n    energy=high_energy_range\n)\ntcopy(temp_tvar[0], \"high_energy_electron_pa\")\n\n\n\n\nCode\ntplot([\"low_energy_electron_pa\", \"high_energy_electron_pa\"])",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "06 - FPI"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw06.html",
    "href": "courses/phys231/phys231_hw06.html",
    "title": "Homework 06",
    "section": "",
    "text": "Consider the equation\n\\[\nx^{\\prime \\prime}(t)+2 \\gamma x(t)+\\omega_0^2 x(t)=f(t) .\n\\]\nUsing the Green’s function for this equation, which satisfies\n\\[\nG^{\\prime \\prime}(t)+2 \\gamma G^{\\prime}(t)+\\omega_0^2 G(t)=\\delta(t)\n\\]\nderive the response \\(x(t)\\) to a square pulse\n\\[\nf(t)=\\left\\{\\begin{array}{ll}\n1 & 0 \\leq t \\leq 1 \\\\\n0 & \\text { otherwise }\n\\end{array} .\\right.\n\\]\nDo this by solving for \\(\\tilde{G}(\\omega)\\) in the Fourier domain and note\n\\[\n\\tilde{x}(\\omega)=\\tilde{G}(\\omega) \\tilde{f}(\\omega)\n\\]\n(Note that when inverting this Fourier transform it is important to treat this as a distribution.) Check that \\(x(t)\\) is causal and check that its Fourier transform \\(\\tilde{x}(\\omega)\\) satisfies the Kramers-Kronig relations.\n\nThe differential equation for \\(G(t)\\) in the Fourier domain is\n\\[\n(-\\omega^2 + 2i\\gamma\\omega + \\omega_0^2) \\tilde{G}(\\omega) = 1\n\\]\nSo\n\\[\n\\tilde{G}(\\omega) = \\frac{1}{-\\omega^2 + 2i \\gamma \\omega + \\omega_0^2}\n\\]\nIts Fourier transform \\(\\tilde{f}(\\omega)\\) is given by:\n\\[\n\\tilde{f}(\\omega) = \\int_{-\\infty}^{\\infty} f(t) e^{-i\\omega t} \\, dt = \\int_{0}^{1} e^{-i\\omega t} \\, dt\n\\]\n\\[\n\\tilde{f}(\\omega) = \\left. \\frac{-1}{i\\omega} e^{-i\\omega t} \\right|_0^1 = \\frac{1 - e^{-i\\omega}}{i\\omega}\n\\]\nNow, we use the relation \\(\\tilde{x}(\\omega) = \\tilde{G}(\\omega) \\tilde{f}(\\omega)\\):\n\\[\n\\tilde{x}(\\omega) = \\frac{1}{-\\omega^2 + 2i\\gamma\\omega + \\omega_0^2} \\cdot \\frac{1 - e^{-i\\omega}}{i\\omega}\n\\]\nTo find \\(x(t)\\), we compute the inverse Fourier transform of \\(\\tilde{x}(\\omega)\\).\n\\[\nx(t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\tilde{x}(\\omega) e^{i\\omega t} \\, d\\omega\n\\]\nWe use contour integration in the complex plane to calculate this.\n\\(\\tilde{x}(\\omega)\\) has poles at \\(p_1 = iγ+\\sqrt{\\omega_0^2-\\gamma^2}, p_2=iγ-\\sqrt{\\omega_0^2-\\gamma^2}\\)\nThe residue at \\(p_1\\) is\n\\[\n\\frac{\ne^{-\\gamma +\n  (\\gamma + \\sqrt{\\gamma^2 - \\omega_0^2}) (1 - t)} (e^\\gamma - e^{\n   \\sqrt{\\gamma^2 - \\omega_0^2}})\n}\n{2 \\sqrt{-\\gamma^2 +\n  \\omega_0^2} (-\\gamma +\\sqrt{\\gamma^2-\\omega_0^2})}\n\\]\n…\nWe can see that \\(x(t) = 0\\) for \\(t&lt;0\\), which means \\(x(t)\\) is causal.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 06"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw06.html#greens-function",
    "href": "courses/phys231/phys231_hw06.html#greens-function",
    "title": "Homework 06",
    "section": "",
    "text": "Consider the equation\n\\[\nx^{\\prime \\prime}(t)+2 \\gamma x(t)+\\omega_0^2 x(t)=f(t) .\n\\]\nUsing the Green’s function for this equation, which satisfies\n\\[\nG^{\\prime \\prime}(t)+2 \\gamma G^{\\prime}(t)+\\omega_0^2 G(t)=\\delta(t)\n\\]\nderive the response \\(x(t)\\) to a square pulse\n\\[\nf(t)=\\left\\{\\begin{array}{ll}\n1 & 0 \\leq t \\leq 1 \\\\\n0 & \\text { otherwise }\n\\end{array} .\\right.\n\\]\nDo this by solving for \\(\\tilde{G}(\\omega)\\) in the Fourier domain and note\n\\[\n\\tilde{x}(\\omega)=\\tilde{G}(\\omega) \\tilde{f}(\\omega)\n\\]\n(Note that when inverting this Fourier transform it is important to treat this as a distribution.) Check that \\(x(t)\\) is causal and check that its Fourier transform \\(\\tilde{x}(\\omega)\\) satisfies the Kramers-Kronig relations.\n\nThe differential equation for \\(G(t)\\) in the Fourier domain is\n\\[\n(-\\omega^2 + 2i\\gamma\\omega + \\omega_0^2) \\tilde{G}(\\omega) = 1\n\\]\nSo\n\\[\n\\tilde{G}(\\omega) = \\frac{1}{-\\omega^2 + 2i \\gamma \\omega + \\omega_0^2}\n\\]\nIts Fourier transform \\(\\tilde{f}(\\omega)\\) is given by:\n\\[\n\\tilde{f}(\\omega) = \\int_{-\\infty}^{\\infty} f(t) e^{-i\\omega t} \\, dt = \\int_{0}^{1} e^{-i\\omega t} \\, dt\n\\]\n\\[\n\\tilde{f}(\\omega) = \\left. \\frac{-1}{i\\omega} e^{-i\\omega t} \\right|_0^1 = \\frac{1 - e^{-i\\omega}}{i\\omega}\n\\]\nNow, we use the relation \\(\\tilde{x}(\\omega) = \\tilde{G}(\\omega) \\tilde{f}(\\omega)\\):\n\\[\n\\tilde{x}(\\omega) = \\frac{1}{-\\omega^2 + 2i\\gamma\\omega + \\omega_0^2} \\cdot \\frac{1 - e^{-i\\omega}}{i\\omega}\n\\]\nTo find \\(x(t)\\), we compute the inverse Fourier transform of \\(\\tilde{x}(\\omega)\\).\n\\[\nx(t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\tilde{x}(\\omega) e^{i\\omega t} \\, d\\omega\n\\]\nWe use contour integration in the complex plane to calculate this.\n\\(\\tilde{x}(\\omega)\\) has poles at \\(p_1 = iγ+\\sqrt{\\omega_0^2-\\gamma^2}, p_2=iγ-\\sqrt{\\omega_0^2-\\gamma^2}\\)\nThe residue at \\(p_1\\) is\n\\[\n\\frac{\ne^{-\\gamma +\n  (\\gamma + \\sqrt{\\gamma^2 - \\omega_0^2}) (1 - t)} (e^\\gamma - e^{\n   \\sqrt{\\gamma^2 - \\omega_0^2}})\n}\n{2 \\sqrt{-\\gamma^2 +\n  \\omega_0^2} (-\\gamma +\\sqrt{\\gamma^2-\\omega_0^2})}\n\\]\n…\nWe can see that \\(x(t) = 0\\) for \\(t&lt;0\\), which means \\(x(t)\\) is causal.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 06"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw06.html#different-drive-function",
    "href": "courses/phys231/phys231_hw06.html#different-drive-function",
    "title": "Homework 06",
    "section": "2 Different drive function",
    "text": "2 Different drive function\n\nSolve the equation in problem 1 with the drive\n\\[\nf(t)=\\left\\{\\begin{array}{ll}\ne^{-t} & t \\geq 0 \\\\\n0 & t&lt;0\n\\end{array} .\\right.\n\\]\n\nThe solution can be expressed as the convolution of the Green’s function with the driving force \\(f(t)\\):\n\\[\nx(t) = \\int_{-\\infty}^{\\infty} G(t - \\tau) f(\\tau) d\\tau\n\\]\nThe form of \\(G(t)\\) depends on the values of \\(\\gamma\\) and \\(\\omega_0\\). For simplicity, let’s assume \\(\\gamma &gt; 0\\) and \\(\\omega_0 &gt; 0\\). The exact form of \\(G(t)\\) depends on whether the system is underdamped, overdamped, or critically damped. Without loss of generality, let’s assume an underdamped system, where \\(\\gamma^2 &lt; \\omega_0^2\\), which gives a Green’s function of the form:\n\\[\nG(t) = \\Theta(t) \\frac{e^{-\\gamma t}}{\\omega_d} \\sin(\\omega_d t)\n\\]\nwhere \\(\\omega_d = \\sqrt{\\omega_0^2 - \\gamma^2}\\) and \\(\\Theta(t)\\) is the Heaviside step function.\nNow, we compute the convolution integral:\n\\[\nx(t) = \\int_{-\\infty}^{\\infty} G(t - \\tau) f(\\tau) d\\tau\n\\]\nSince \\(f(\\tau) = 0\\) for \\(\\tau &lt; 0\\), the integral simplifies to:\n\\[\nx(t) = \\int_{0}^{t} G(t - \\tau) e^{-\\tau} d\\tau\n\\]\nSubstitute the expression for \\(G(t - \\tau)\\) and carry out the integration:\n\\[\nx(t) = \\int_{0}^{t} \\Theta(t - \\tau) \\frac{e^{-\\gamma (t - \\tau)}}{\\omega_d} \\sin(\\omega_d (t - \\tau)) e^{-\\tau} d\\tau\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 06"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw06.html#greens-function-and-boundary-conditions",
    "href": "courses/phys231/phys231_hw06.html#greens-function-and-boundary-conditions",
    "title": "Homework 06",
    "section": "3 Green’s function and boundary conditions",
    "text": "3 Green’s function and boundary conditions\n\nFind the Green’s function \\(G(x)\\) satisfying\n\\[\n\\frac{d^2}{d x^2} G(x, y)=\\delta(x-y)\n\\]\nwith the boundary conditions \\(G(0, y)=G(1, y)=0\\). Show that with this boundary condition,\n\\[\n\\phi(x)=\\int_0^1 G(x, y) f(y) d y\n\\]\nsatisfies\n\\[\n\\frac{d^2}{d x^2} \\phi(x)=f(x)\n\\]\nand the boundary conditions \\(\\phi(0)=\\phi(1)=0\\).\n\nWe consider two cases, \\(x &lt; y\\) and \\(x &gt; y\\), because the delta function \\(\\delta(x-y)\\) changes the behavior of the solution at \\(x = y\\). We define \\(G(x, y)\\) piecewise for these two cases:\n\nFor \\(x &lt; y\\), let \\(G(x, y) = A(y)x + C(y)\\).\nFor \\(x &gt; y\\), let \\(G(x, y) = B(y)(1 - x) + D(y)\\).\n\nApplying the boundary conditions\n\n\\(G(0, y) = 0\\) gives \\(C(y) = 0\\)\n\\(G(1, y) = 0\\) gives \\(D(y) = 0\\)\n\nThe function \\(G(x, y)\\) itself must be continuous at \\(x = y\\), this gives us:\n\\[\nA(y)y = B(y)(1 - y)\n\\]\nThe derivative \\(\\frac{d}{dx} G(x, y)\\) should have a discontinuity of 1 at \\(x = y\\) (this comes from the delta function). Therefore, the jump at \\(x = y\\) is\n\\[\nA(y) - (-B(y)) = 1\n\\]\nThe solutions for \\(A(y)\\) and \\(B(y)\\) are:\n\\[\nA(y)=1−y, B(y)=y\n\\]\nWith these, the Green’s function \\(G(x, y)\\) for \\(x &lt; y\\) and \\(x &gt; y\\) can be fully specified:\n\nFor \\(x &lt; y\\), \\(G(x, y) = A(y)x = (1 - y)x\\).\nFor \\(x &gt; y\\), \\(G(x, y) = B(y)(1 - x) = y(1 - x)\\).\n\n\nProving \\(\\phi(x)\\) Satisfies the Given Conditions:\nWe differentiate \\(\\phi(x)\\) twice with respect to \\(x\\):\n\\[\n\\frac{d^2}{dx^2} \\phi(x) = \\frac{d^2}{dx^2} \\int_0^1 G(x, y) f(y) dy\n\\]\nBecause \\(G(x, y)\\) is a Green’s function, its second derivative with respect to \\(x\\) is \\(\\delta(x-y)\\). Therefore, the integral becomes:\n\\[\n\\frac{d^2}{dx^2} \\phi(x) = \\int_0^1 \\delta(x-y) f(y) dy\n\\]\nThe delta function picks out the value of \\(f(y)\\) at \\(y = x\\), so:\n\\[\n\\frac{d^2}{dx^2} \\phi(x) = f(x)\n\\]\n\nSince \\(G(0, y) = 0\\), it follows that \\(\\phi(0) = \\int_0^1 G(0, y) f(y) dy = 0\\).\nSimilarly, since \\(G(1, y) = 0\\), it follows that \\(\\phi(1) = \\int_0^1 G(1, y) f(y) dy = 0\\).\n\nTherefore, \\(\\phi(x)\\) satisfies the differential equation with the boundary conditions \\(\\phi(0) = \\phi(1) = 0\\).",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 06"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw06.html#nyquistshannon-sampling-theorem",
    "href": "courses/phys231/phys231_hw06.html#nyquistshannon-sampling-theorem",
    "title": "Homework 06",
    "section": "4 Nyquist–Shannon sampling theorem",
    "text": "4 Nyquist–Shannon sampling theorem\n\nSuppose \\(f(t)\\) is band-limited, meaning its Fourier transform satisfies \\(\\tilde{f}(\\omega)=0\\) for \\(|\\omega| \\geq 2 \\pi \\Lambda\\). If \\(T&lt;1 /(2 \\Lambda)\\), we showed it is possible to reconstruct \\(f(t)\\) from the set of sample values \\(f(n T)\\), where \\(n \\in \\mathbb{Z}\\). Give an explicit formula for \\(f(t)\\) in terms of the sample values.\n\nWhen \\(x(t)\\) is a function with a Fourier transform \\(X(f)\\) :\n\\[\nX(f) \\triangleq \\int_{-\\infty}^{\\infty} x(t) e^{-i 2 \\pi f t} \\mathrm{~d} t\n\\]\nthe Poisson summation formula indicates that the samples, \\(x(n T)\\), of \\(x(t)\\) are sufficient to create a periodic summation of \\(X(f)\\). The result is:\n\\[\nX_s(f) \\triangleq \\sum_{k=-\\infty}^{\\infty} X\\left(f-k f_s\\right)=\\sum_{n=-\\infty}^{\\infty} T \\cdot x(n T) e^{-i 2 \\pi n T f}\n\\]\nWhen there is no overlap of the copies (also known as “images”) of \\(X(f)\\), the \\(k=0\\) term of Eq. 1 can be recovered by the product:\n\\[\nX(f)=H(f) \\cdot X_s(f)\n\\]\nwhere:\n\\[\nH(f) \\triangleq \\begin{cases}1 & |f|&lt;B \\\\ 0 & |f|&gt;f_s-B\\end{cases}\n\\]\nThe sampling theorem is proved since \\(X(f)\\) uniquely determines \\(x(t)\\). All that remains is to derive the formula for reconstruction. \\(H(f)\\) need not be precisely defined in the region \\(\\left[B, f_s-B\\right]\\) because \\(X_s(f)\\) is zero in that region. However, the worst case is when \\(B=f_s / 2\\), the Nyquist frequency. A function that is sufficient for that and all less severe cases is:\n\\[\nH(f)=\\operatorname{rect}\\left(\\frac{f}{f_s}\\right)= \\begin{cases}1 & |f|&lt;\\frac{f_s}{2} \\\\ 0 & |f|&gt;\\frac{f_s}{2}\\end{cases}\n\\]\nwhere rect is the rectangular function. Therefore:\n\\[\n\\begin{aligned}\nX(f) & =\\operatorname{rect}\\left(\\frac{f}{f_s}\\right) \\cdot X_s(f) \\\\\n& =\\operatorname{rect}(T f) \\cdot \\sum_{n=-\\infty}^{\\infty} T \\cdot x(n T) e^{-i 2 \\pi n T f}  \\\\\n& =\\sum_{n=-\\infty}^{\\infty} x(n T) \\cdot \\underbrace{T \\cdot \\operatorname{rect}(T f) \\cdot e^{-i 2 \\pi n T f}}_{\\mathcal{F}\\left\\{\\operatorname{sinc}\\left(\\frac{t-n T}{T}\\right)\\right\\}}\n\\end{aligned}\n\\]\nThe inverse transform of both sides produces the Whittaker-Shannon interpolation formula:\n\\[\nx(t)=\\sum_{n=-\\infty}^{\\infty} x(n T) \\cdot \\operatorname{sinc}\\left(\\frac{t-n T}{T}\\right)\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 06"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw06.html#jacobi-theta-function",
    "href": "courses/phys231/phys231_hw06.html#jacobi-theta-function",
    "title": "Homework 06",
    "section": "5 Jacobi theta function",
    "text": "5 Jacobi theta function\n\nConsider the Jacobi theta function\n\\[\n\\vartheta_3(\\tau)=\\sum_{n=-\\infty}^{\\infty} e^{i \\pi \\tau n^2}\n\\]\nShow by Poisson summation that\n\\[\n\\vartheta_3(-1 / \\tau)=\\sqrt{i \\tau} \\vartheta_3(\\tau)\n\\]\n\nConsider the function \\(f(x) = e^{i \\pi \\tau x^2}\\). The Fourier transform of \\(f(x)\\) is given by:\n\\[\n\\hat{f}(\\xi) = \\int_{-\\infty}^{\\infty} e^{i \\pi \\tau x^2} e^{-2 \\pi i x \\xi} dx\n\\]\nApplying the Poisson summation formula, we have:\n\\[\n\\sum_{n=-\\infty}^{\\infty} e^{i \\pi \\tau n^2} = \\sum_{m=-\\infty}^{\\infty} \\hat{f}(m)\n\\]\nSubstituting \\(\\hat{f}(m)\\) we get:\n\\[\n\\vartheta_3(\\tau) = \\sqrt{\\frac{i}{\\tau}} \\sum_{m=-\\infty}^{\\infty} e^{-\\pi i m^2 / \\tau}\n\\]\nChange of Variable: Let \\(\\tau' = -1/\\tau\\). Then \\(e^{-\\pi i m^2 / \\tau} = e^{i \\pi \\tau' m^2}\\). Therefore, the sum becomes:\n\\[\n\\vartheta_3(\\tau) = \\sqrt{\\frac{i}{\\tau}} \\sum_{m=-\\infty}^{\\infty} e^{i \\pi \\tau' m^2}\n\\]\nRecognizing the sum as \\(\\vartheta_3(\\tau')\\) with \\(\\tau' = -1/\\tau\\), we get:\n\\[\n\\vartheta_3(\\tau) = \\sqrt{\\frac{i}{\\tau}} \\vartheta_3\\left(-\\frac{1}{\\tau}\\right)\n\\]\nor equivalently:\n\\[\n\\vartheta_3\\left(-\\frac{1}{\\tau}\\right) = \\sqrt{i\\tau} \\vartheta_3(\\tau)\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 06"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw06.html#jacobi-theta-function-by-integral",
    "href": "courses/phys231/phys231_hw06.html#jacobi-theta-function-by-integral",
    "title": "Homework 06",
    "section": "6 Jacobi theta function by integral",
    "text": "6 Jacobi theta function by integral\n\nShow another way by considering the integral\n\\[\nI_N(\\tau)=\\int_{\\gamma_N} \\frac{e^{-\\pi i z^2 \\tau}}{e^{2 \\pi i z}-1} d z\n\\]\nwhere \\(\\gamma_N\\) is a rectangular contour with vertices \\(\\pm(N+1 / 2) \\pm i\\). Compute this by residues and take the limit \\(N \\rightarrow \\infty\\) to show it equals \\(\\vartheta_3(\\tau)\\). Then argue we can rewrite the contour integral as\n\\[\n\\vartheta_3(\\tau)=\\int_{-\\infty-i \\epsilon}^{\\infty-i \\epsilon} \\frac{e^{-\\pi i z^2 \\tau}}{e^{2 \\pi i z}-1} d z-\\int_{-\\infty+i \\epsilon}^{\\infty+i \\epsilon} \\frac{e^{-\\pi i z^2 \\tau}}{e^{2 \\pi i z}-1} d z\n\\]\nand do geometric series expansions and direct Gaussian integration to show this is also \\(\\frac{1}{\\sqrt{i \\tau}} \\vartheta_3(-1 / \\tau)\\).\n\nCompute by Residues: Inside the contour \\(\\gamma_N\\), the poles of the integrand occur at integers. The residue at each pole \\(n\\) (an integer) is given by evaluating the limit as \\(z \\to n\\) of \\((z - n)\\) times the integrand. This leads to residues of the form \\(e^{-\\pi i n^2 \\tau}\\).\nSumming the residues for all poles within the contour, we get:\n\\[\n\\sum_{n=-N}^N e^{-\\pi i n^2 \\tau}\n\\]\nThis is a finite sum approximation of the theta function \\(\\vartheta_3(\\tau)\\). As \\(N \\to \\infty\\), this sum becomes \\(\\vartheta_3(\\tau)\\). So, we have:\n\\[\n\\lim_{N \\to \\infty} I_N(\\tau) = \\vartheta_3(\\tau)\n\\]\nThe contour integral can be rewritten as:\n\\[\n\\vartheta_3(\\tau) = \\int_{-\\infty-i\\epsilon}^{\\infty-i\\epsilon} \\frac{e^{-\\pi i z^2 \\tau}}{e^{2 \\pi i z} - 1} dz - \\int_{-\\infty+i\\epsilon}^{\\infty+i\\epsilon} \\frac{e^{-\\pi i z^2 \\tau}}{e^{2 \\pi i z} - 1} dz\n\\]\nHere, \\(\\epsilon\\) is a small positive number. The integrand can be expanded using the geometric series for \\(e^{2 \\pi i z}\\). This series converges absolutely for \\(|\\text{Im}(z)| &gt; 0\\). After the series expansion, the integrals involve terms of the form \\(e^{-\\pi i z^2 \\tau}\\) which are Gaussian integrals. These integrals can be evaluated directly, and due to the symmetry of the Gaussian, they will involve a factor of \\(\\frac{1}{\\sqrt{i \\tau}}\\). By summing these integrals, we obtain the identity:\n\\[\n\\vartheta_3(\\tau) = \\frac{1}{\\sqrt{i \\tau}} \\vartheta_3\\left(-\\frac{1}{\\tau}\\right)\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 06"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw09.html",
    "href": "courses/phys231/phys231_hw09.html",
    "title": "Homework 09",
    "section": "",
    "text": "Show using steepest descent that the leading asymptotics of \\(\\Gamma(z)\\) for \\(z=r e^{i \\theta}, r \\rightarrow \\infty, \\operatorname{Re} z&gt;0\\), are given by the complex Stirling approximation\n\\[\n\\Gamma(z) \\sim e^{-z} z^z\\left(\\frac{2 \\pi}{z}\\right)^{1 / 2} .\n\\]\n\nThe Gamma function\n\\[\n\\Gamma(z) = \\int_{0}^{\\infty} t^{z-1} e^{-t} dt\n\\]\nafter performing a change of variables by setting \\(t = zu\\), which yields:\n\\[\n\\Gamma(z) = z^z \\int_{0}^{\\infty} u^{z-1} e^{-zu} du\n\\]\nThe method of steepest descent involves analyzing the integrand’s behavior around its saddle points, where the first derivative of the exponent vanishes. For our integral, the exponent is \\(-zu + (z-1)\\log(u)\\). The saddle point occurs where its derivative with respect to \\(u\\) is zero. This gives us:\n\\[\n-z + \\frac{z-1}{u} = 0\n\\]\n\\[\nu = \\frac{z-1}{z} \\approx 1 \\quad \\text{for large } z\n\\]\nNear the saddle point \\(u = 1\\), we approximate the exponent by a second-order Taylor expansion:\n\\[\n-zu + (z-1)\\log(u) \\approx -z + (z-1)\\log(z) - \\frac{z}{2}(u-1)^2\n\\]\nThe integral can now be approximated as:\n\\[\n\\Gamma(z) \\approx z^z e^{-z} e^{(z-1)\\log(z)} \\int_{-\\infty}^{\\infty} e^{-\\frac{z}{2}(u-1)^2} du\n\\]\nWith the Gaussian integral evaluates to:\n\\[\n\\int_{-\\infty}^{\\infty} e^{-\\frac{z}{2}(u-1)^2} du = \\sqrt{\\frac{2\\pi}{z}}\n\\]\nWe get:\n\\[\n\\Gamma(z) \\sim e^{-z} z^z \\left(\\frac{2\\pi}{z}\\right)^{\\frac{1}{2}}\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 09"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw09.html#stirling-approximation",
    "href": "courses/phys231/phys231_hw09.html#stirling-approximation",
    "title": "Homework 09",
    "section": "",
    "text": "Show using steepest descent that the leading asymptotics of \\(\\Gamma(z)\\) for \\(z=r e^{i \\theta}, r \\rightarrow \\infty, \\operatorname{Re} z&gt;0\\), are given by the complex Stirling approximation\n\\[\n\\Gamma(z) \\sim e^{-z} z^z\\left(\\frac{2 \\pi}{z}\\right)^{1 / 2} .\n\\]\n\nThe Gamma function\n\\[\n\\Gamma(z) = \\int_{0}^{\\infty} t^{z-1} e^{-t} dt\n\\]\nafter performing a change of variables by setting \\(t = zu\\), which yields:\n\\[\n\\Gamma(z) = z^z \\int_{0}^{\\infty} u^{z-1} e^{-zu} du\n\\]\nThe method of steepest descent involves analyzing the integrand’s behavior around its saddle points, where the first derivative of the exponent vanishes. For our integral, the exponent is \\(-zu + (z-1)\\log(u)\\). The saddle point occurs where its derivative with respect to \\(u\\) is zero. This gives us:\n\\[\n-z + \\frac{z-1}{u} = 0\n\\]\n\\[\nu = \\frac{z-1}{z} \\approx 1 \\quad \\text{for large } z\n\\]\nNear the saddle point \\(u = 1\\), we approximate the exponent by a second-order Taylor expansion:\n\\[\n-zu + (z-1)\\log(u) \\approx -z + (z-1)\\log(z) - \\frac{z}{2}(u-1)^2\n\\]\nThe integral can now be approximated as:\n\\[\n\\Gamma(z) \\approx z^z e^{-z} e^{(z-1)\\log(z)} \\int_{-\\infty}^{\\infty} e^{-\\frac{z}{2}(u-1)^2} du\n\\]\nWith the Gaussian integral evaluates to:\n\\[\n\\int_{-\\infty}^{\\infty} e^{-\\frac{z}{2}(u-1)^2} du = \\sqrt{\\frac{2\\pi}{z}}\n\\]\nWe get:\n\\[\n\\Gamma(z) \\sim e^{-z} z^z \\left(\\frac{2\\pi}{z}\\right)^{\\frac{1}{2}}\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 09"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw09.html#airy-function",
    "href": "courses/phys231/phys231_hw09.html#airy-function",
    "title": "Homework 09",
    "section": "2 Airy function",
    "text": "2 Airy function\n\nConsider the time-independent Schrodinger equation for a linear potential:\n\\[\n\\frac{d^2}{d x^2} \\psi(x)=x \\psi(x) \\text {. }\n\\]\n\nShow that the “Airy function” defined by\n\\[\nA i(x)=\\frac{1}{2 \\pi} \\int_{-\\infty}^{\\infty} e^{i x y+i y^3 / 3} d y\n\\]\nsolves the equation above.\nDetermine the saddle points of \\(i x y+i y^3 / 3\\) in the \\(y\\) plane and make a change of variables to the integral so that these saddle points are not moving. Determine the direction of steepest descent on the constant phase contours through these saddle points for each argument of complex \\(x\\).\nFind the steepest descent contour for \\(A i(x)\\) for \\(x \\rightarrow e^{i \\alpha} \\infty\\) for each \\(\\alpha\\). Determine the leading asymptotics for each \\(\\alpha\\).\n\n\n\n2.1 Verifying the Airy Function as a Solution\nTaking the Fourier transform on both sides of equation we get\n\\[\n\\mathcal{F}\\left(\\frac{d^2 y}{d x^2}\\right)=\\mathcal{F}(x y),\n\\]\nFor the L.H.S., we get\n\\[\n\\mathcal{F}\\left(\\frac{d^2 y}{d x^2}\\right)=\\frac{1}{2 \\pi} \\int_{-\\infty}^{+\\infty} \\frac{d^2 y}{d x^2} e^{-i k x} d x = =-k^2 \\mathcal{F}(y) .\n\\]\nFor the R.H.S. based on the derivative of the Fourier transform with respect to \\(k\\) we get,\n\\[\n\\frac{d}{d k} \\mathcal{F}(y)=\\frac{d}{d k}\\left(\\frac{1}{2 \\pi} \\int_{-\\infty}^{+\\infty} y e^{-i k x} d x\\right),\n\\]\nTherefore,\n\\[\n\\frac{d}{d k} \\mathcal{F}(y)=\\frac{1}{2 \\pi} \\int^{+\\infty} \\frac{d}{d k}\\left(y e^{-i k x}\\right) d x=\\frac{1}{2 \\pi} \\int^{+\\infty}(-i x) y e^{-i k x} d x\n\\]\nWe have\n\\[\n\\mathcal{F}(x y)=i \\frac{d \\mathcal{F}(y)}{d k},\n\\]\nSo the equation becomes\n\\[\n-k^2 \\mathcal{F}(y)=i \\frac{d \\mathcal{F}(y)}{d k},\n\\]\nthe only solution is\n\\[\n\\mathcal{F}(y)=e^{i \\frac{k^3}{3}},\n\\]\ntaking the inverse Fourier transform, we get a solution satisfying the differential equation. Hence we have the final solution as\n\\[\ny=A i(x)=\\frac{1}{2 \\pi} \\int_{-\\infty}^{+\\infty} e^{i\\left(k x+\\frac{k^3}{3}\\right)} d k .\n\\]\n\n\n2.2 Saddle Points\nThe exponent in the integral is \\(ixy + \\frac{i}{3}y^3\\). To find the saddle points, we set the derivative of this expression with respect to \\(y\\) equal to zero:\n\\[\nix + iy^2 = 0\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 09"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw09.html#zepsilon-function",
    "href": "courses/phys231/phys231_hw09.html#zepsilon-function",
    "title": "Homework 09",
    "section": "3 \\(Z(\\epsilon)\\) function",
    "text": "3 \\(Z(\\epsilon)\\) function\n\nCompute the all-orders asymptotic series for\n\\[\nZ(\\epsilon)=\\int d x e^{-x^2-\\epsilon x^4} \\quad \\epsilon \\rightarrow 0^{+}\n\\]\nand then use Borel summation to evaluate the integral.\n\nThe expansion is based on the Taylor series of \\(e^{-\\epsilon x^4}\\) around \\(\\epsilon = 0\\):\n\\[\ne^{-\\epsilon x^4} = \\sum_{n=0}^{\\infty} \\frac{(-\\epsilon x^4)^n}{n!}\n\\]\nSubstituting this series into the integral and integrating term by term, we get:\n\\[\nZ(\\epsilon) = \\sum_{n=0}^{\\infty} \\frac{(-\\epsilon)^n}{n!} \\int dx\\, x^{4n} e^{-x^2}\n\\]\nEach term in this series can be integrated using standard methods, often involving gamma functions for even powers of \\(x\\).\nThe Borel sum is then given by an integral of the Borel transform against an exponential:\n\\[\n\\tilde{Z}(\\epsilon) = \\int_0^\\infty e^{-t} B(t \\epsilon) dt\n\\]\nwhere \\(B(t)\\) is the Borel transform of the series.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 09"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw08.html",
    "href": "courses/phys231/phys231_hw08.html",
    "title": "Homework 08",
    "section": "",
    "text": "Find an asymptotic series for\n\\[\nf(x)= \\log (x-2)\n\\]\nas \\(x \\rightarrow \\infty\\) in terms of \\(\\log x\\) and inverse powers of \\(x\\). (Hint: split the log and use Taylor series on one part.)\n\n\\[\nf(x) = \\log(x - 2) = \\log x + \\log(1 - \\frac{2}{x})\n\\]\nThe Taylor series expansion of \\(\\log(1 - y)\\) around \\(y = 0\\) is:\n\\[\n\\log(1 - y) = -y - \\frac{y^2}{2} - \\frac{y^3}{3} - \\cdots\n\\]\nBy substituting \\(y = \\frac{2}{x}\\) into this series, the asymptotic series for \\(f(x)\\) as \\(x \\to \\infty\\) is:\n\\[\nf(x) = \\log x - \\frac{2}{x} - \\frac{2^2}{2x^2} - \\frac{2^3}{3x^3} - \\cdots\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 08"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw08.html#asymptotic-series-for-log-x-2",
    "href": "courses/phys231/phys231_hw08.html#asymptotic-series-for-log-x-2",
    "title": "Homework 08",
    "section": "",
    "text": "Find an asymptotic series for\n\\[\nf(x)= \\log (x-2)\n\\]\nas \\(x \\rightarrow \\infty\\) in terms of \\(\\log x\\) and inverse powers of \\(x\\). (Hint: split the log and use Taylor series on one part.)\n\n\\[\nf(x) = \\log(x - 2) = \\log x + \\log(1 - \\frac{2}{x})\n\\]\nThe Taylor series expansion of \\(\\log(1 - y)\\) around \\(y = 0\\) is:\n\\[\n\\log(1 - y) = -y - \\frac{y^2}{2} - \\frac{y^3}{3} - \\cdots\n\\]\nBy substituting \\(y = \\frac{2}{x}\\) into this series, the asymptotic series for \\(f(x)\\) as \\(x \\to \\infty\\) is:\n\\[\nf(x) = \\log x - \\frac{2}{x} - \\frac{2^2}{2x^2} - \\frac{2^3}{3x^3} - \\cdots\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 08"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw08.html#watsons-lemma-and-int_01-frace-s-x1x2-d-x",
    "href": "courses/phys231/phys231_hw08.html#watsons-lemma-and-int_01-frace-s-x1x2-d-x",
    "title": "Homework 08",
    "section": "2 Watson’s lemma and \\(\\int_0^1 \\frac{e^{-s x}}{1+x^2} d x\\)",
    "text": "2 Watson’s lemma and \\(\\int_0^1 \\frac{e^{-s x}}{1+x^2} d x\\)\n\nUse Watson’s lemma to find the \\(s \\rightarrow \\infty\\) asymptotic series for\n\\[\nI(s)=\\int_0^1 \\frac{e^{-s x}}{1+x^2} d x\n\\]\n\nTo use Watson’s Lemma, we need to express \\(\\frac{1}{1+x^2}\\) as a power series at \\(x = 0\\). The Taylor series of \\(\\frac{1}{1+x^2}\\) around \\(x = 0\\) is:\n\\[\n\\frac{1}{1+x^2} = 1 - x^2 + x^4 - x^6 + \\cdots\n\\]\nwhich is valid for \\(|x| &lt; 1\\). Substituting this into \\(I(s)\\) gives:\n\\[\nI(s) = \\int_0^1 e^{-s x} (1 - x^2 + x^4 - x^6 + \\cdots) \\, dx\n\\]\nNow, we can integrate term by term:\n\nFor the first term:\n\\[\n\\int_0^1 e^{-s x} \\, dx = \\frac{1}{s} (1 - e^{-s})\n\\]\nAs \\(s \\rightarrow \\infty\\), \\(e^{-s}\\) approaches 0 faster than \\(1/s\\), so this term becomes \\(\\frac{1}{s}\\).\nFor the second term:\n\\[\n-\\int_0^1 x^2 e^{-s x} \\, dx\n\\]\nApplying integration by parts or a similar method, we find this term is \\(O\\left(\\frac{1}{s^3}\\right)\\) as \\(s \\rightarrow \\infty\\).\nSimilarly, each subsequent term will contribute higher order terms in \\(\\frac{1}{s}\\).\n\nHence, the asymptotic expansion of \\(I(s)\\) as \\(s \\rightarrow \\infty\\) is:\n\\[\nI(s) \\sim \\frac{1}{s} - \\frac{1}{s^3} + \\cdots\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 08"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw08.html#watsons-lemma-and-int_0infty-sin-sqrtx-e-s-x2-d-x",
    "href": "courses/phys231/phys231_hw08.html#watsons-lemma-and-int_0infty-sin-sqrtx-e-s-x2-d-x",
    "title": "Homework 08",
    "section": "3 Watson’s lemma and \\(\\int_0^{\\infty} \\sin (\\sqrt{x}) e^{-s x^2} d x\\)",
    "text": "3 Watson’s lemma and \\(\\int_0^{\\infty} \\sin (\\sqrt{x}) e^{-s x^2} d x\\)\n\nUse Watson’s lemma to find the \\(s \\rightarrow \\infty\\) asymptotic series for\n\\[\nI(s)=\\int_0^{\\infty} \\sin (\\sqrt{x}) e^{-s x^2} d x\n\\]\n\nThe integral \\(I(s)\\) does not directly fit this form of Watson’s lemma due to the \\(e^{-s x^2}\\) term. So first, we perform a change of variable to transform the integral into a more suitable form for Watson’s Lemma. Let \\(u = x^2\\), then \\(du = 2x \\, dx\\) or \\(dx = \\frac{du}{2\\sqrt{u}}\\). The integral becomes:\n\\[\nI(s) = \\int_0^{\\infty} \\sin(u^{1/4}) e^{-s u} \\frac{du}{2\\sqrt{u}}\n\\]\nExpand \\(\\sin(u^{1/4})\\) in a Taylor series about \\(u = 0\\):\n\\[\n\\sin(u^{1/4}) = u^{1/4} - \\frac{u^{3/4}}{3!} + \\frac{u^{5/4}}{5!} - \\cdots\n\\]\nSubstituting this series into the integral, we get:\n\\[\nI(s) = \\int_0^{\\infty} \\left(u^{1/4} - \\frac{u^{3/4}}{3!} + \\cdots \\right) e^{-s u} \\frac{du}{2\\sqrt{u}}\n= \\frac{\\Gamma(3/4)}{2 s^{3/4}} - \\frac{\\Gamma(5/4)}{12 s^{5/4}} + \\cdots\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 08"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw08.html#asymptotic-series-for-the-error-function",
    "href": "courses/phys231/phys231_hw08.html#asymptotic-series-for-the-error-function",
    "title": "Homework 08",
    "section": "4 Asymptotic series for the error function",
    "text": "4 Asymptotic series for the error function\n\nUse integration by parts to give the \\(x \\rightarrow \\infty\\) asymptotic series for the error function\n\\[\n\\operatorname{erf}(x)=\\frac{2}{\\sqrt{\\pi}} \\int_x^{\\infty} e^{-t^2} d t .\n\\]\n\nWe can apply successive integration by parts to \\(\\operatorname{erfc}(\\lambda)\\), in which the first step gives\n\\[\n\\begin{aligned}\n\\operatorname{erf}(x) & =\\frac{2}{\\sqrt{\\pi}} \\int_x^{\\infty} \\exp \\left(-t^2\\right) d t \\\\\n& =\\frac{2}{\\sqrt{\\pi}} \\int_x^{\\infty} \\frac{-2 t \\exp \\left(-t^2\\right)}{-2 t} d t,\\left[u=\\frac{1}{-2 t}, d v=-2 t \\exp \\left(-t^2\\right) d t\\right] \\\\\n& =\\frac{2}{\\sqrt{\\pi}}\\left[\\frac{\\exp \\left(-t^2\\right)}{-2 t}-\\int \\frac{\\exp \\left(-t^2\\right)}{2 t^2} d t\\right]_x^{\\infty} \\\\\n& =\\frac{2}{\\sqrt{\\pi}}\\left[\\frac{\\exp \\left(-x^2\\right)}{2 x}-\\int_x^{\\infty} \\frac{\\exp \\left(-t^2\\right)}{2 t^2} d t\\right] \\\\\n& =\\frac{2 e^{-x^2}}{\\sqrt{\\pi}}\\left(\\frac{1}{2 x}\\right)-\\frac{2}{\\sqrt{\\pi}} \\int_x^{\\infty} \\frac{\\exp \\left(-t^2\\right)}{2 t^2} d t\n\\end{aligned}\n\\]\nWe have obtained the first term. And applying integration by parts to the new integral gives\n\\[\n\\begin{aligned}\n\\int_x^{\\infty} \\frac{\\exp \\left(-t^2\\right)}{2 t^2} d t & =\\frac{1}{2} \\int_x^{\\infty} \\frac{-2 t \\exp \\left(-t^2\\right)}{-2 t^3} d t\\left[u=-\\frac{1}{2 t^3}, d v=-2 t \\exp \\left(-t^2\\right) d t\\right] \\\\\n& =\\frac{1}{2}\\left[\\frac{\\exp \\left(-t^2\\right)}{-2 t^3}-\\int \\frac{3 \\exp \\left(-t^2\\right)}{2 t^4} d t\\right]_x^{\\infty} \\\\\n& =\\frac{1}{2}\\left[\\frac{\\exp \\left(-x^2\\right)}{2 x^3}-\\int_x^{\\infty} \\frac{3 \\exp \\left(-t^2\\right)}{2 t^4} d t\\right]\n\\end{aligned}\n\\]\nThus we have\n\\[\n\\operatorname{erfc}(x)=\\frac{e^{-x^2}}{\\sqrt{\\pi}}\\left(\\frac{1}{2 x}-\\frac{1}{4 x^3}-\\int_x^{\\infty} \\frac{3 \\exp \\left(-t^2\\right)}{2 t^4} d t\\right),\n\\]\nContinuing with successive integration by parts we will obtain the asymptotic expansion.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 08"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw08.html#stirlings-formula",
    "href": "courses/phys231/phys231_hw08.html#stirlings-formula",
    "title": "Homework 08",
    "section": "5 Stirling’s formula",
    "text": "5 Stirling’s formula\n\nUse Laplace’s method to derive Stirling’s formula\n\\[\nn ! \\sim \\sqrt{2 \\pi n} n^n e^{-n} \\quad n \\rightarrow \\infty\n\\]\nusing the Gamma function. Also find the next term in the asymptotic series.\n\nGamma function, which is related to the factorial by \\(\\Gamma(n+1) = n!\\) is defined as:\n\\[\n\\Gamma(n) = \\int_0^{\\infty} e^{-t} t^{n-1} dt\n\\]\nFor large \\(n\\), we approximate this integral using Laplace’s method, which is effective for integrals of the form \\(\\int e^{M f(t)} dt\\) where \\(M\\) is a large parameter. Here, we can rewrite the Gamma function as:\n\\[\n\\Gamma(n+1) = \\int_0^{\\infty} e^{n \\log t - t} dt\n\\]\nNow, to apply Laplace’s method, we find the maximum of the function \\(f(t) = \\log t - \\frac{t}{n}\\). Taking the derivative and setting it to zero gives:\n\\[\n\\frac{d}{dt} \\left( \\log t - \\frac{t}{n} \\right) = \\frac{1}{t} - \\frac{1}{n} = 0\n\\]\nThis yields \\(t = n\\) as the point where \\(f(t)\\) attains its maximum. We then expand \\(f(t)\\) around this point:\n\\[\nf(t) \\approx f(n) + \\frac{1}{2} f''(n) (t - n)^2\n\\]\nwhere \\(f(n) = \\log n - 1\\) and \\(f''(n) = -1/n^2\\). The integral becomes:\n\\[\n\\Gamma(n+1) \\approx e^{n \\log n - n} \\int_{0}^{\\infty} e^{-\\frac{1}{2} \\frac{(t-n)^2}{n}} dt\n\\]\nChanging variables with \\(u = \\frac{t-n}{\\sqrt{n}}\\) gives:\n\\[\n\\Gamma(n+1) \\approx e^{n \\log n - n} \\sqrt{n} \\int_{0}^{\\infty} e^{-\\frac{1}{2} u^2} du\n\\]\nRecognizing the Gaussian integral, we get:\n\\[\n\\Gamma(n+1) = n! \\approx e^{n \\log n - n} \\sqrt{2 \\pi n} = \\sqrt{2 \\pi n} n^n e^{-n} \\quad n \\rightarrow \\infty\n\\]\nThe second derivative \\(f''(t)\\) at the point \\(t = n\\) gives us the next leading term. The third derivative of \\(f(t)\\) is:\n\\[\nf'''(t) = \\frac{2}{t^3}\n\\]\nEvaluating this at \\(t = n\\) gives:\n\\[\nf'''(n) = \\frac{2}{n^3}\n\\]\nThe corresponding term in the expansion is of the order \\(\\frac{1}{n}\\), which leads to the next term in the series being \\(\\frac{1}{12n}\\). Therefore, the improved Stirling’s formula, including the next term in the asymptotic series, is:\n\\[\nn! \\sim \\sqrt{2 \\pi n}\\, n^n e^{-n} \\left( 1 + \\frac{1}{12n} \\right)\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 08"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw08.html#leading-asymptotics-of-ixint_-11-e-x-sin-4-t-d-t",
    "href": "courses/phys231/phys231_hw08.html#leading-asymptotics-of-ixint_-11-e-x-sin-4-t-d-t",
    "title": "Homework 08",
    "section": "6 Leading asymptotics of \\(I(x)=\\int_{-1}^1 e^{-x \\sin ^4 t} d t\\)",
    "text": "6 Leading asymptotics of \\(I(x)=\\int_{-1}^1 e^{-x \\sin ^4 t} d t\\)\n\nUse Laplace’s method to find the leading asymptotics of\n\\[\nI(x)=\\int_{-1}^1 e^{-x \\sin ^4 t} d t\n\\]\nas \\(x \\rightarrow \\infty\\).\n\nFor the given integral, we observe that \\(\\sin^4 t\\) is maximized when \\(t = 0\\) within the interval \\([-1, 1]\\). Near this point, the function \\(\\sin^4 t\\) can be approximated by its Taylor expansion:\n\\[\n\\sin^4 t \\approx t^4\n\\]\nfor small values of \\(t\\). The integral becomes:\n\\[\nI(x) \\approx \\int_{-1}^1 e^{-x t^4} dt\n\\]\nAs \\(x \\rightarrow \\infty\\), the contribution to the integral from regions where \\(t\\) is not very small becomes negligible, so we can extend the limits of the integral to infinity for the purpose of asymptotic approximation:\n\\[\nI(x) \\approx \\int_{-\\infty}^{\\infty} e^{-x t^4} dt\n\\]\nLet \\(u = x^{1/4} t\\), then \\(dt = x^{-1/4} du\\) and the integral becomes:\n\\[\nI(x) \\approx \\int_{-\\infty}^{\\infty} e^{-u^4} x^{-1/4} du\n\\]\nThe integral \\(\\int_{-\\infty}^{\\infty} e^{-u^4} du\\) is a constant (independent of \\(x\\)), so the leading asymptotic behavior of \\(I(x)\\) as \\(x \\rightarrow \\infty\\) is given by:\n\\[\nI(x) \\sim C x^{-1/4}\n\\]\nwhere \\(C\\) is the value of the integral \\(\\int_{-\\infty}^{\\infty} e^{-u^4} du\\), which can be evaluated numerically.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 08"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw07.html",
    "href": "courses/phys231/phys231_hw07.html",
    "title": "Homework 07",
    "section": "",
    "text": "Use Fourier analysis to compute a Green’s function for Poisson’s equation on \\(\\mathbb{R}^3\\), satisfying\n\\[\n\\left(\\partial_x^2+\\partial_y^2+\\partial_z^2\\right) G(x, y, z)=\\delta^{(3)}(x, y, z)\n\\]\nProve there is a unique such Green’s function which goes to zero at infinity (hint: use Liouville’s theorem for harmonic functions).\nFind the Green’s function but now for functions on the unit ball around the origin, with Dirichlet boundary conditions \\(\\phi(x, y, z)=0\\) for \\(x^2+y^2+z^2=1\\). Hint: Schwartz reflection principle/method of images.\n\n\n\n\nLet \\(\\hat{G}(k_x, k_y, k_z)\\) be the Fourier transform of \\(G(x, y, z)\\). After Fourier transform, the equation becomes:\n\\[\n-(k_x^2 + k_y^2 + k_z^2) \\hat{G}(k_x, k_y, k_z) = 1\n\\]\nsince the Fourier transform of \\(\\delta^{(3)}(x, y, z)\\) is 1.\nThus, the solution in Fourier Space:\n\\[\n\\hat{G}(k_x, k_y, k_z) = -\\frac{1}{k_x^2 + k_y^2 + k_z^2}\n\\]\nTo find \\(G(x, y, z)\\), perform the inverse Fourier transform:\n\\[\nG(x, y, z) = \\int_{\\mathbb{R}^3} -\\frac{e^{i(k_x x + k_y y + k_z z)}}{k_x^2 + k_y^2 + k_z^2} \\, dk_x \\, dk_y \\, dk_z\n\\]\nThis integral yields \\(G(x, y, z) = \\frac{-1}{4\\pi\\sqrt{x^2 + y^2 + z^2}}\\).\n\n\n\nLiouville’s theorem states that a bounded harmonic function on \\(\\mathbb{R}^n\\) is constant. Given any two Green’s functions \\(G_1\\) and \\(G_2\\) that vanish at infinity, their difference \\(G_1 - G_2\\) is harmonic (satisfies Laplace’s equation) and bounded. By Liouville’s theorem, \\(G_1 - G_2\\) is constant, and since both go to zero at infinity, this constant must be zero. Thus, \\(G_1 = G_2\\), proving uniqueness.\n\n\n\nTo find a function \\(G(x, y, z; x', y', z')\\) that satisfies:\n\n\\((\\partial_x^2 + \\partial_y^2 + \\partial_z^2) G(x, y, z; x', y', z') = -\\delta(x - x', y - y', z - z')\\) within the unit ball \\(x^2 + y^2 + z^2 &lt; 1\\).\n\\(G(x, y, z; x', y', z') = 0\\) for \\(x^2 + y^2 + z^2 = 1\\), enforcing the Dirichlet boundary conditions.\n\nWe place an “image” point source at \\((x'', y'', z'')\\) where \\((x'', y'', z'') = \\frac{(x', y', z')}{|x'|^2 + |y'|^2 + |z'|^2}\\) outside the unit ball in such a way that the combined effect of the real source and the image source satisfies the boundary conditions.\nThe Green’s function then is a combination of the solution from both the real and the image source\n\\[\nG(x, y, z; x', y', z') = \\frac{1}{4\\pi\\sqrt{(x - x')^2 + (y - y')^2 + (z - z')^2}} - \\frac{1}{4\\pi\\sqrt{(x - x'')^2 + (y - y'')^2 + (z - z'')^2}}\n\\]\nMore generally, we define the point \\(x^* = \\frac{x}{|x|^2}\\) dual to \\(x\\). Therefore, a Green’s function for \\(B^n(0, 1)\\) is given by \\(G(x, y) = Φ(y − x) − Φ(|x|(y − x^*))\\).",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 07"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw07.html#greens-function-for-poissons-equation",
    "href": "courses/phys231/phys231_hw07.html#greens-function-for-poissons-equation",
    "title": "Homework 07",
    "section": "",
    "text": "Use Fourier analysis to compute a Green’s function for Poisson’s equation on \\(\\mathbb{R}^3\\), satisfying\n\\[\n\\left(\\partial_x^2+\\partial_y^2+\\partial_z^2\\right) G(x, y, z)=\\delta^{(3)}(x, y, z)\n\\]\nProve there is a unique such Green’s function which goes to zero at infinity (hint: use Liouville’s theorem for harmonic functions).\nFind the Green’s function but now for functions on the unit ball around the origin, with Dirichlet boundary conditions \\(\\phi(x, y, z)=0\\) for \\(x^2+y^2+z^2=1\\). Hint: Schwartz reflection principle/method of images.\n\n\n\n\nLet \\(\\hat{G}(k_x, k_y, k_z)\\) be the Fourier transform of \\(G(x, y, z)\\). After Fourier transform, the equation becomes:\n\\[\n-(k_x^2 + k_y^2 + k_z^2) \\hat{G}(k_x, k_y, k_z) = 1\n\\]\nsince the Fourier transform of \\(\\delta^{(3)}(x, y, z)\\) is 1.\nThus, the solution in Fourier Space:\n\\[\n\\hat{G}(k_x, k_y, k_z) = -\\frac{1}{k_x^2 + k_y^2 + k_z^2}\n\\]\nTo find \\(G(x, y, z)\\), perform the inverse Fourier transform:\n\\[\nG(x, y, z) = \\int_{\\mathbb{R}^3} -\\frac{e^{i(k_x x + k_y y + k_z z)}}{k_x^2 + k_y^2 + k_z^2} \\, dk_x \\, dk_y \\, dk_z\n\\]\nThis integral yields \\(G(x, y, z) = \\frac{-1}{4\\pi\\sqrt{x^2 + y^2 + z^2}}\\).\n\n\n\nLiouville’s theorem states that a bounded harmonic function on \\(\\mathbb{R}^n\\) is constant. Given any two Green’s functions \\(G_1\\) and \\(G_2\\) that vanish at infinity, their difference \\(G_1 - G_2\\) is harmonic (satisfies Laplace’s equation) and bounded. By Liouville’s theorem, \\(G_1 - G_2\\) is constant, and since both go to zero at infinity, this constant must be zero. Thus, \\(G_1 = G_2\\), proving uniqueness.\n\n\n\nTo find a function \\(G(x, y, z; x', y', z')\\) that satisfies:\n\n\\((\\partial_x^2 + \\partial_y^2 + \\partial_z^2) G(x, y, z; x', y', z') = -\\delta(x - x', y - y', z - z')\\) within the unit ball \\(x^2 + y^2 + z^2 &lt; 1\\).\n\\(G(x, y, z; x', y', z') = 0\\) for \\(x^2 + y^2 + z^2 = 1\\), enforcing the Dirichlet boundary conditions.\n\nWe place an “image” point source at \\((x'', y'', z'')\\) where \\((x'', y'', z'') = \\frac{(x', y', z')}{|x'|^2 + |y'|^2 + |z'|^2}\\) outside the unit ball in such a way that the combined effect of the real source and the image source satisfies the boundary conditions.\nThe Green’s function then is a combination of the solution from both the real and the image source\n\\[\nG(x, y, z; x', y', z') = \\frac{1}{4\\pi\\sqrt{(x - x')^2 + (y - y')^2 + (z - z')^2}} - \\frac{1}{4\\pi\\sqrt{(x - x'')^2 + (y - y'')^2 + (z - z'')^2}}\n\\]\nMore generally, we define the point \\(x^* = \\frac{x}{|x|^2}\\) dual to \\(x\\). Therefore, a Green’s function for \\(B^n(0, 1)\\) is given by \\(G(x, y) = Φ(y − x) − Φ(|x|(y − x^*))\\).",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 07"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw07.html#greens-function-for-the-heat-equation",
    "href": "courses/phys231/phys231_hw07.html#greens-function-for-the-heat-equation",
    "title": "Homework 07",
    "section": "2 Green’s function for the heat equation",
    "text": "2 Green’s function for the heat equation\n\nFind the Green’s function for the heat equation\n\\[\n\\partial_t u=\\partial_x^2 u\n\\]\nby Fourier analysis.\n\nWe want to find a Green’s function \\(G(x, t; x', t')\\) that satisfies the following properties:\n\n\\(\\partial_t G = \\partial_x^2 G\\)\n\\(G(x, t; x', t')\\) behaves like a delta function as \\(t \\to t'^+\\), i.e., \\(G(x, t; x', t') \\to \\delta(x - x')\\) as \\(t \\to t'^+\\).\n\nBy taking the Fourier transform of \\(G\\) with respect to \\(x\\), the heat equation in Fourier space becomes\n\\[\n\\partial_t \\hat{G} = -k^2 \\hat{G}\n\\]\nThis is a first-order linear differential equation in \\(t\\), the solution is\n\\[\n\\hat{G}(k, t; x', t') = A(k, x', t') e^{-k^2 (t - t')}\n\\]\nwhere \\(A(k, x', t')\\) is to be determined.\nNow we apply the initial condition. The initial condition is that \\(G\\) approaches \\(\\delta(x - x')\\) as \\(t \\to t'^+\\). In Fourier space, this translates to \\(\\hat{G}(k, t; x', t') \\to e^{-ik(x - x')}\\) as \\(t \\to t'^+\\). Thus\n\\[\nA(k, x', t') = e^{-ikx'}\n\\]\nThen take the inverse Fourier transform of \\(\\hat{G}(k, t; x', t')\\) to get back to the spatial domain:\n\\[\nG(x, t; x', t') = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} e^{-ikx'} e^{-ikx} e^{-k^2 (t - t')} dk\n\\]\nThis integral yields a function of the form:\n\\[\nG(x, t; x', t') = \\frac{1}{\\sqrt{4\\pi (t - t')}} e^{-\\frac{(x - x')^2}{4(t - t')}}\n\\]\nfor \\(t &gt; t'\\).\nSo the Green’s function for the heat equation is:\n\\[\nG(x, t; x', t') = \\begin{cases} \\frac{1}{\\sqrt{4\\pi (t - t')}} e^{-\\frac{(x - x')^2}{4(t - t')}}, & t &gt; t' \\\\ 0, & \\text{otherwise} \\end{cases}\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 07"
    ]
  },
  {
    "objectID": "courses/phys231/phys231_hw07.html#resolvent-rz-az-mathbb1-a-1",
    "href": "courses/phys231/phys231_hw07.html#resolvent-rz-az-mathbb1-a-1",
    "title": "Homework 07",
    "section": "3 Resolvent \\(R(z, A)=(z \\mathbb{1}-A)^{-1}\\)",
    "text": "3 Resolvent \\(R(z, A)=(z \\mathbb{1}-A)^{-1}\\)\n\nGiven a finite dimensional complex matrix \\(A\\), we can define the resolvent\n\\[\nR(z, A)=(z \\mathbb{1}-A)^{-1}=\\frac{1}{z-A},\n\\]\nwhere \\(\\mathbb{1}\\) is the identity matrix. This equation makes sense whenever \\(z\\) is not an eigenvalue of \\(A\\), and so we can consider \\(R(z, A)\\) as a meromorphic, matrix-valued function of \\(z\\), with poles at the eigenvalues of \\(A\\). For these problems, assume \\(A\\) is Hermitian:\n\nShow that\n\\[\nR(z, A)=\\frac{P_\\lambda}{z-\\lambda},\n\\]\nwhere \\(P_\\lambda\\) is the projector onto the eigenspace of \\(\\lambda\\) eigenvectors.\nSuppose \\(w\\) is orthogonal to the kernel of \\(A\\). Prove that\n\\[\nv=\\int_C \\frac{d z}{2 \\pi i} \\frac{R(z, A)}{z} w\n\\]\nsolves the equation\n\\[\nA v=w,\n\\]\nwhere \\(C\\) is a contour winding once around \\(z=0\\) and not enclosing any other eigenvalues.\nShow the same as in (2) for a contour enclosing all eigenvalues except for 0.\n\n\n\n3.1 Expression for \\(R(z, A)\\)\nGiven a Hermitian matrix \\(A\\), its eigenvalues are real, and it can be diagonalized. Let \\(\\lambda\\) be an eigenvalue of \\(A\\) and \\(P_\\lambda\\) the projector onto the eigenspace of \\(\\lambda\\). We have spectral decomposition\n\\[\nA = \\sum_{\\lambda} \\lambda P_\\lambda\n\\]\nthe expression for \\(R(z, A)\\) can be simplified:\n\\[\nR(z, A) = (z\\mathbb{1} - A)^{-1} = \\left( z \\sum_\\lambda P_\\lambda - \\sum_\\lambda \\lambda P_\\lambda \\right)^{-1}\n\\]\nBecause the projectors \\(P_\\lambda\\) are orthogonal and sum to the identity: \\(R(z, A) = \\sum_\\lambda (zP_\\lambda - \\lambda P_\\lambda)^{-1}\\).\n\nThus, \\(R(z, A) = \\sum_\\lambda \\frac{P_\\lambda}{z - \\lambda}\\).\n\n\n\n3.2 Solving \\(A v = w\\)\nSubstitute the expression for \\(R(z, A)\\) into the integral:\n\\[\nv = \\int_C \\frac{d z}{2 \\pi i} \\frac{\\sum_\\lambda \\frac{P_\\lambda}{z - \\lambda}}{z} w\n\\]\nEvaluate it using the residue theorem. Since \\(C\\) winds around \\(z = 0\\) and does not enclose any other eigenvalues, the only contribution comes from the pole at \\(z = 0\\).\nThe residue at \\(z = 0\\) gives \\(P_0 w\\). So \\(A v = A P_0 w = w\\)\n\n\n3.3 Contour Enclosing All Eigenvalues Except 0\nUse the same integral expression for \\(v\\). But now the integral will pick up residues from all poles \\(\\lambda \\neq 0\\) within the contour \\(C\\).\nFor each \\(\\lambda \\neq 0\\), the residue at \\(z = \\lambda\\) is \\(\\frac{P_\\lambda w}{\\lambda}\\).\nSumming up the residues, \\(v = \\sum_{\\lambda \\neq 0} \\frac{P_\\lambda w}{\\lambda}\\).\nMultiplying both sides by \\(A\\) (and using \\(AP_\\lambda = \\lambda P_\\lambda\\)), we get \\(A v = \\sum_{\\lambda \\neq 0} P_\\lambda w = w - P_0 w\\).\nSince \\(w\\) is orthogonal to the kernel of \\(A\\), \\(P_0 w = 0\\). Therefore, \\(A v = w\\).",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 07"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw05.html",
    "href": "docs/courses/epss265/homeworks/epss265_hw05.html",
    "title": "05 - LEP Principles",
    "section": "",
    "text": "References:",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "05 - LEP Principles"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw05.html#q1.-retarding-potential-analyzers",
    "href": "docs/courses/epss265/homeworks/epss265_hw05.html#q1.-retarding-potential-analyzers",
    "title": "05 - LEP Principles",
    "section": "Q1. Retarding Potential Analyzers",
    "text": "Q1. Retarding Potential Analyzers\n\nIn the ionosphere, mount along ram velocity, measure species densities (in like atomic mass groups)\n\nRam speed (7.5km/s) is high or supersonic relative to ion thermal speed or motion\nSpacecraft (sc) charging is negative and small relative to motional energy\nI-V curve has steps at \\(qV_{ret} = \\frac{1}{2}m(V_{sr}+V_r)^2 – q \\phi_s\\) ; \\(\\phi_s\\) = sensor potential (w/r/t to plasma), \\(V_{s_r}\\) = sc ram speed, \\(V_r\\) = ion speed\n\nHomework Q#1\n\nShow that the thermal width of the steps is \\(m V_{sr} V_{th}\\), where \\(V_{th}\\) is the ion species thermal speed.\nShow that for sensor potential of –0.8V, the step functions are at ~1.1V for H+ and ~5.5V for O+.\n\n\n\n\n\n\n\nFigure 1. Schematic cross-sectio onf the planar RPA sensor illustrating the arrangement of internal grids required to perform the retarding potential analysis of thermal ions.\n\n\nthermal width = \\(\\frac{1}{2} m (V_{th} + V_{s_r})^2 - \\frac{1}{2} m (V_{th} - V_{s_r})^2 = m V_{s_r} V_{th}\\)\nstep function for low temperature ions, taking \\(V_{r}=0\\)\n\\[V_{ret} = \\frac{1}{2} \\frac{m}{q}V_{s_r}^2 – \\phi_s\\]\n\n\nCode\nfrom plasmapy.particles import Particle\nimport astropy.units as u\n\n\n\ndef calc_step_potential(phi, v_sr, particle: Particle):\n    result = particle.mass * v_sr ** 2 / (2 * particle.charge) - phi\n    return result.to(u.V)\n\nphi = -0.8 * u.V\nv_sr = 7.5 * u.km / u.s\n\nproton = Particle('proton')\no_plus = Particle('O+')\n\nprint(f'Proton step potential: {calc_step_potential(phi, v_sr, proton)}')\nprint(f'O+ step potential: {calc_step_potential(phi, v_sr, o_plus)}')\n\nProton step potential: 1.0936161382302447 V\nO+ step potential: 5.463469940275583 V",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "05 - LEP Principles"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw05.html#q2.-rpaion-drift-meters",
    "href": "docs/courses/epss265/homeworks/epss265_hw05.html#q2.-rpaion-drift-meters",
    "title": "05 - LEP Principles",
    "section": "Q2. RPA/Ion Drift Meters",
    "text": "Q2. RPA/Ion Drift Meters\n\nIn the ionosphere, mounted along ram velocity, measure species velocity\n\nG2 (positive) retards e.g. the lower energy H+, but allows the higher energy O+ through\nCollimated beam comes through and falls asymmetrically (based on direction) on collectors\nG6 (negative) suppresses electrons\nG3-5 are grounded to remove distortions\n\nHomework Q#2: Determine transverse velocity \\(V_t\\) as function of ram speed, W, D.\n\n\n\n\n\n\nFigure 5. Ambient ions are accelerated through the spacecraft sheath potential and account of this acceleration decrease the apparent ion arrival angleas shown.\n\n\nThe ram velocity measued at the RPA can be related to the ion velocity at infinity \\(V_r\\) by\n\\[ \\frac{1}{2} m V_{ram} = \\frac{1}{2} m (V_{r} + V_s)^2 - q \\phi_s\\]\nThe ratio of two currents measured by the RPA is\n\\[ J_1 / J_2 = \\frac{A_1}{A_2} = \\frac{W-2 D \\tan \\alpha}{W+2 D \\tan \\alpha}\\]\nwhere \\(A_1\\) and \\(A_2\\) are the areas of the two collectors. The angle \\(\\alpha\\) is the angle between the ion velocity and the normal to the collector surface. The ion velocity can be expressed as\n\\[ V_t = V_{ram} \\tan \\alpha \\]\nThe log of the ratio of the fluxes, which are actually measured\n\\[ \\log R = J_1 / J_2\\]\nCombining these equations gives\n\\[\nV_t=\\left[\\left(V_r+V_s\\right)^2-2 q \\phi_s / m\\right]^{\\frac{1}{2}} \\frac{W}{2 D}\\left( 1-\\log R \\right) /\\left(1+ \\log R \\right)\n\\]",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "05 - LEP Principles"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw05.html#q3.-magnetic-spectrographs",
    "href": "docs/courses/epss265/homeworks/epss265_hw05.html#q3.-magnetic-spectrographs",
    "title": "05 - LEP Principles",
    "section": "Q3. Magnetic Spectrographs",
    "text": "Q3. Magnetic Spectrographs\n\nFor low energy (less than a few keV) particles (left):\n\nRPA provides velocity, temperature. Post-acceleration, Vpa, behind it allows refined measurement of m/q\nHomework Q#3 Show that in LIMS: \\(m/q=(B r_c)2/(2V_{pa})\\), where B is magnetic field, rc particle magnetic radius\n\nFor high energy particles (right) the RPA is not used (they are hard to control with potentials):\n\nBroom magnet clears electrons\nHigh field bends the high energy ions\nIons that were not bent are assumed to be neutrals (ENAs)\n\n\n\n\n\n\n\nLIMS on SCATHA\n\n\nThe energy of accelerated particle is:\n\\[\n\\frac{1}{2} m v^2=q V_{p a}\n\\]\nParticles that are able to reach the detector must satisify:\n\\[\nm v^2 r_c=B q v\n\\]\nCombining Equations we get:\n\\[\n\\begin{aligned}\n& v=\\left(\\frac{2 q}{m} V_{p a}\\right)^{\\frac{1}{2}} \\\\\n\\Rightarrow & m / q=\\left(B r_c\\right)^2 / 2 v_{p a}\n\\end{aligned}\n\\]",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "05 - LEP Principles"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw05.html#q4.-electrostatic-analyzers",
    "href": "docs/courses/epss265/homeworks/epss265_hw05.html#q4.-electrostatic-analyzers",
    "title": "05 - LEP Principles",
    "section": "Q4. Electrostatic Analyzers",
    "text": "Q4. Electrostatic Analyzers\n\nElectrostatic deflection “analyzes” distribution selecting particles with matching centrifugal and electrostatic forces\n\nAnalyser constant, \\(K=R/\\Delta\\), where \\(\\Delta=R_2-R_1\\); \\(R=(R_2+R_1)/2\\). Outer shell is at 0 Volts, inner shell at potential V.\nElectrostatic deflection at the entrance aperture can measure incoming ions from different directions if spacecraft non-spinning\nHomework Q#4 Show that the energy W of the particles of charge q incident on the MCP is \\(W=-K q V /2\\)\n\n\nParticles that are able to reach the detector must satisify:\n\\[\nm v^2 R=q E\n\\]\nwhere \\(E\\) is the electric field between \\(R_2\\) and \\(R_1\\), \\(E \\approx \\frac{-V}{\\Delta}\\), so\n\\[\n\\begin{aligned}\n& m v^2=\\frac{-R}{\\Delta} q V = -K q V \\\\\n\\Rightarrow & W=\\frac{1}{2} m v^2=-\\frac{1}{2} K q V\n\\end{aligned}\n\\]",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "05 - LEP Principles"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw05.html#q5.-time-of-flight-post-analyzer-mass-discrimination",
    "href": "docs/courses/epss265/homeworks/epss265_hw05.html#q5.-time-of-flight-post-analyzer-mass-discrimination",
    "title": "05 - LEP Principles",
    "section": "Q5. Time of Flight (post-analyzer) Mass Discrimination",
    "text": "Q5. Time of Flight (post-analyzer) Mass Discrimination\n\nElectrostatic deflection provides energy per charge: E/Q. Time of flight, t, provides the energy per mass E/M\n\nPost-acceleration potential \\(U_{ACC}\\) is sufficient for optimal McP operation and timing electrons at foil. Measure flux at \\(E/Q+ U_{ACC}\\)\nElectrons generated at carbon foil. Carbon foil results in passage of an energy fraction \\(\\alpha\\)\nHomework Q#5. Show \\(M/Q=2a(E/Q + U_{ACC})/(d/t)^2\\), where: Q=ion charge in units of elemental charge, e.\n\n\nThe velocity of ions after passing through the foil is\n\\[\nv=d / t\n\\]\nDue to partial energy transfer after passing the foil\n\\[ \\frac{1}{2} M v^2=\\alpha\\left(E + Q U_{ACC}\\right)\n\\]\nCombining Equations we get:\n\\[\nM / Q=2 \\alpha\\left(E / Q+U_{ACC}\\right) /(d / t)^2\n\\]",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "05 - LEP Principles"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw04.html",
    "href": "docs/courses/epss265/homeworks/epss265_hw04.html",
    "title": "04 - EFI Calibration",
    "section": "",
    "text": "For a time of interest from THEMIS or MMS (or RBSP or other), based on the overview plots at the mission website, finish the following steps.\n\nObtain EFI data in spinning and despun spacecraft coord’s and in some geophysical (e.g., GSE or GSM) coord’s.\nUsing the data in DSL or DMPA coordinates (where XY are despun, spin-plane components) estimate the offset in X and Y from a quiet time in the magnetosphere when the flows, and hence –VxB, are expected to be slow. Remove the offset from the data.\nWith the spin plane offsets removed, obtain the 3rd component (Z) for times when the Bfield is at a large angle relative to the spin plane (&gt;10 deg or more) using the E*B=0 approximation.\nCompare your estimate of Ez with the measurement of the same component made by the axial electric field boom pair. How large are the offsets for the axial field compared to those you have found for the spin plane components?\n\nNote: A crib sheet and a jupyter notebook on how to perform the offset removal and EdotB determination are my_thm_efi_load_cal_crib.pyspd and my_thm_efi_load_cal_crib.py, located in the class notes below Lecture 12. Use a different spacecraft for your solution. A good day for THEMIS is another spacecraft from the first Science paper (2008-02-26 4-6UT)– except TH-D which is in the released crib sheet. A good day for MMS is the first Science paper (2015-10-16 13:05-13:08UT) from any of the four MMS spacecraft.\nWe choose MMS for this question. And the data is from 2015-10-16 13:00-14:00UT.\nIts overall summary plot together with SCM quicklook plots are shown below.",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "04 - EFI Calibration"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw04.html#quickplot",
    "href": "docs/courses/epss265/homeworks/epss265_hw04.html#quickplot",
    "title": "04 - EFI Calibration",
    "section": "Quickplot",
    "text": "Quickplot\n\n\nCode\nimport pyspedas\nfrom pytplot import tplot, get_data, tlimit\n\nimport xarray as xr\nimport numpy as np\n\n\n\n\nCode\ntrange = ['2015-10-16T13:00:00', '2015-10-16T13:10:00']\ntvars = pyspedas.mms.edp(trange=trange, time_clip=True)\ntplot(tvars)\n\n\n28-Nov-23 17:11:35: Loading /Users/zijin/data/mms/mms1/edp/fast/l2/dce/2015/10/mms1_edp_fast_l2_dce_20151016_v2.1.0.cdf\n28-Nov-23 17:11:37: Time clip was applied to: mms1_edp_dce_gse_fast_l2\n28-Nov-23 17:11:38: Time clip was applied to: mms1_edp_dce_dsl_fast_l2\n28-Nov-23 17:11:38: Time clip was applied to: mms1_edp_dce_par_epar_fast_l2\n28-Nov-23 17:11:38: Loaded variables:\n28-Nov-23 17:11:38: mms1_edp_dce_gse_fast_l2\n28-Nov-23 17:11:38: mms1_edp_dce_dsl_fast_l2\n28-Nov-23 17:11:38: mms1_edp_dce_par_epar_fast_l2\n\n\n\n\n\n\n\n\n\n\n\nCode\ntrangeOfInterest = ['2015-10-16T13:06:30', '2015-10-16T13:07:30']\ntlimit(trangeOfInterest)\ntplot(tvars)",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "04 - EFI Calibration"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw04.html#offset",
    "href": "docs/courses/epss265/homeworks/epss265_hw04.html#offset",
    "title": "04 - EFI Calibration",
    "section": "Offset",
    "text": "Offset\nWe choose a quite time by manually inspecting the data.\n\n\nCode\ntrange4offset = ['2015-10-16T13:00:30', '2015-10-16T13:01:30']\ntlimit(trange4offset)\ntplot(tvars)\ntlimit(full=True)\n\n\n\n\n\n\n\n\n\n\n\nCode\ne_tvar = 'mms1_edp_dce_dsl_fast_l2'\ne_data : xr.DataArray = get_data(e_tvar, xarray=True)\noffset = e_data.sel(time=slice(trange4offset[0], trange4offset[1])).mean(dim='time')\nprint('Ex offset =', offset[0].data)\nprint('Ey offset =', offset[1].data)\n\n\nEx offset = 0.23904572\nEy offset = 0.18106854",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "04 - EFI Calibration"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw04.html#e_z-component",
    "href": "docs/courses/epss265/homeworks/epss265_hw04.html#e_z-component",
    "title": "04 - EFI Calibration",
    "section": "\\(E_z\\) component",
    "text": "\\(E_z\\) component\nWe use the \\(E \\cdot B=0\\) approximation to calculate \\(E_z\\) component. And we ignore the differences (fractions of a degree) between DBCS, DMPA and DSL. *\n\n\nCode\npyspedas.mms.fgm(trange=trange, time_clip=True, varformat='*dmpa*')\nmag_tvar = 'mms1_fgm_b_dmpa_srvy_l2'\ntplot(mag_tvar)\n\n\n28-Nov-23 17:14:28: Loading /Users/zijin/data/mms/mms1/fgm/srvy/l2/2015/10/mms1_fgm_srvy_l2_20151016_v4.18.0.cdf\n28-Nov-23 17:14:30: Time clip was applied to: mms1_fgm_b_dmpa_srvy_l2\n28-Nov-23 17:14:30: Time clip was applied to: mms1_fgm_flag_srvy_l2\n28-Nov-23 17:14:30: Loaded variables:\n28-Nov-23 17:14:30: mms1_fgm_b_dmpa_srvy_l2\n28-Nov-23 17:14:30: mms1_fgm_b_dmpa_srvy_l2_bvec\n28-Nov-23 17:14:30: mms1_fgm_b_dmpa_srvy_l2_btot\n28-Nov-23 17:14:30: mms1_fgm_b_gse_srvy_l2_bvec\n28-Nov-23 17:14:30: mms1_fgm_b_gse_srvy_l2_btot\n28-Nov-23 17:14:30: mms1_fgm_b_gsm_srvy_l2_bvec\n28-Nov-23 17:14:30: mms1_fgm_b_gsm_srvy_l2_btot\n28-Nov-23 17:14:30: mms1_fgm_b_bcs_srvy_l2_bvec\n28-Nov-23 17:14:30: mms1_fgm_b_bcs_srvy_l2_btot\n\n\n\n\n\n\n\n\n\n\n\nCode\ndef calibrate_offset(data, offset):\n    return data - offset\n\n\n\n\nCode\ndef calibrate_e_dot_b(e_data: xr.DataArray, mag_data, threshold_angle=10):\n    data = e_data.copy()\n    data[:, 2] = (\n        -(e_data[:, 0] * mag_data[:, 0] + e_data[:, 1] * mag_data[:, 1])\n        / mag_data[:, 2]\n    )\n    \n    threshold = np.sin(np.deg2rad(threshold_angle))\n    mask = np.abs((mag_data[:, 2] / mag_data[:, 3])) &gt; threshold\n    data[~mask] = np.nan\n    \n    return data\n\n\n\n\nCode\n# Interpolate FGM data on EDP times\npyspedas.tinterpol(mag_tvar, e_tvar)\nmag_data = get_data(mag_tvar + '-itrp', xarray=True)\n\ne_data_c1 = calibrate_offset(e_data, offset)\ne_data_c2 = calibrate_e_dot_b(e_data_c1, mag_data)\n\n\n28-Nov-23 17:15:11: tinterpol (linear) was applied to: mms1_fgm_b_dmpa_srvy_l2-itrp",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "04 - EFI Calibration"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw04.html#comparison",
    "href": "docs/courses/epss265/homeworks/epss265_hw04.html#comparison",
    "title": "04 - EFI Calibration",
    "section": "Comparison",
    "text": "Comparison\n\nCompare your estimate of Ez with the measurement of the same component made by the axial electric field boom pair. How large are the offsets for the axial field compared to those you have found for the spin plane components?\n\n\n\nCode\nez_data = e_data.sel(v_dim=2)\nez_data_c2 = e_data_c2.sel(v_dim=2)\n\nxr.concat(\n    [\n        ez_data.assign_coords(datatype=\"Ez original\"),\n        ez_data_c2.assign_coords(datatype=\"Ez calibrated\"),\n    ],\n    dim=\"datatype\",\n).plot(x=\"time\", hue=\"datatype\")\n\n\n\n\n\n\n\n\n\n\n\nCode\nez_offset = np.abs(ez_data - ez_data_c2).mean()\nprint(\"Ez offset = \", ez_offset.data)\n\n\nEz offset =  0.43761042",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "04 - EFI Calibration"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/index.html",
    "href": "docs/courses/epss265/homeworks/index.html",
    "title": "Homework",
    "section": "",
    "text": "02 - FGM Basics\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n03 - SCM Noise Curves\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n04 - EFI Calibration\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n05 - LEP Principles\n\n\nLow Energy Plasma Instruments\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n06 - FPI\n\n\nFast Plasma Investigation\n\n\n\n\n\n\n\n\n\n\n\n\nNo matching items",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw02.html",
    "href": "docs/courses/phys231/phys231_hw02.html",
    "title": "Homework 02",
    "section": "",
    "text": "Mathematica notebook",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 02"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw02.html#power-series",
    "href": "docs/courses/phys231/phys231_hw02.html#power-series",
    "title": "Homework 02",
    "section": "5. Power series",
    "text": "5. Power series\n\nConsider a power series of the form\n\\[\na=1+ \\sum_{n=1}^{\\infty} a_n z^n\n\\]\nShow that there is another power series\n\\[\nb = \\sum_{n=0}^{\\infty} b_n z^n\n\\]\nsuch that, as a formal expression\n\\[\nab = 1\n\\]\nDo this by giving a recurrence relation for the coefficients \\(b_n\\). Solve this recurrence relation for \\(1/e^z\\) and show it gives the power series for \\(e^{−z}\\).\n\nThe product \\(ab\\) can be written as:\n\\[\nab = \\left(1 + \\sum_{n=1}^{\\infty} a_n z^n \\right) \\left( \\sum_{n=0}^{\\infty} b_n z^n \\right) = 1\n\\]\nBy expanding, we get:\n\\[\nab = b_0 + (b_1 + a_1 b_0) z + (b_2 + a_1 b_1 + a_2 b_0) z^2 + \\dots + \\left( \\sum_{k=0}^{n} a_k b_{n-k} \\right) z^n + \\dots\n\\]\nFor \\(ab = 1\\), all the coefficients of \\(z^n\\) (for \\(n \\geq 1\\)) must be zero, and the constant term (the coefficient of \\(z^0\\)) must be 1. This gives us the following conditions:\n\n\\(b_0 = 1\\) (since the constant term of \\(ab\\) must be 1).\nFor \\(n \\geq 1\\), we have \\(\\sum_{k=0}^{n} a_k b_{n-k} = 0\\).\n\nFor \\(a_k\\), we have \\(a_0 = 1\\) and \\(a_n\\) for \\(n \\geq 1\\). Thus, the recurrence relation for \\(b_n\\) becomes:\n\\[\nb_n = -\\sum_{k=1}^{n} a_k b_{n-k} \\quad \\text{for } n \\geq 1\n\\]\nFor \\(a = e^z\\). The power series for \\(b= 1/e^z\\) is given by:\n\n\\(b_0 = 1\\) (from the initial condition).\nFor \\(n \\geq 1\\):\n\n\\[\nb_n = -\\sum_{k=1}^{n} \\frac{1}{k!} b_{n-k}\n\\]\nAnd if \\(b_n = \\frac{(-1)^n}{n!}\\). Then, it is exactly the power series for \\(e^{-z}\\):\n\\[\ne^{-z} = \\sum_{n=0}^{\\infty} \\frac{(-z)^n}{n!}\n\\]\nTo prove \\(b_n = \\frac{(-1)^n}{n!}\\), we use induction method. Suppose it is true for \\(n\\), then using\n\\[\n(1 + (-1))^{n+1} = \\sum C_{k}^{n+1}(-1)^{n+1-k} = (n+1)! \\sum_{k=0}^{n+1} \\frac{(-1)^{n+1-k}}{k! (n+1-k)!}\n\\]\nBy substituting \\(b_k = \\frac{(-1)^k}{k!}\\) for \\(k \\le n\\), we have\n\\[\n(-1)^{n+1} / (n+1)~! = -\\sum_{k=1}^{n+1} \\frac{1}{k!} b_{n-k}\n\\]\nSo \\(b_{n+1} = \\frac{(-1)^{n+1}}{(n+1)!}\\). Q.E.D",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 02"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw02.html#expansion-near-pole",
    "href": "docs/courses/phys231/phys231_hw02.html#expansion-near-pole",
    "title": "Homework 02",
    "section": "6. Expansion near pole",
    "text": "6. Expansion near pole\n\nAssuming the result of problem 5 and the bonus problem, show that if \\(f (z) = g(z)/h(z)\\) has a pole at \\(z = 0\\), that we can expand \\(f(z)\\) in a series\n\\[\nf (z) = \\sum_{n=-m}^{\\infty} a_n z^n\n\\]\nfor some \\(m\\), and that this converges in a “punctured disc” \\(\\{ z | |z| &lt; R, z \\ne 0 \\}\\). Make such an expansion for \\(f (z) = z/(1 + z^2)\\) around \\(z = i\\) (hint: for this example we use tricks with geometric series, we don’t need the general recurrence relation).\n\nSince \\(f(z)\\) has a pole at \\(z = 0\\), \\(h(z)\\) must have a zero of order \\(m\\) at \\(z = 0\\)\nGiven this, \\(h(z)\\) can be written as \\(z^m k(z)\\) where \\(k(z)\\) is analytic and non-zero at \\(z = 0\\). Therefore, \\(f(z)\\) can be written as:\n\\[\nf(z) = \\frac{g(z)}{z^m k(z)}\n\\]\nSince \\(k(z)\\) is analytic and non-zero at \\(z = 0\\), there exists a power series \\(\\sum_{n=0}^{\\infty} b_n z^n\\) such that \\(\\frac{1}{k(z)} = \\sum_{n=0}^{\\infty} b_n z^n\\) . This leads to:\n\\[\nf(z) = \\frac{g(z)}{z^m} \\sum_{n=0}^{\\infty} b_n z^n = \\sum_{n=0}^{\\infty} b_n g(z) z^{n-m}\n\\]\nfor \\(z \\ne 0\\). As \\(g(z)\\) is analytic at \\(z = 0\\), it can also be expanded into a power series around \\(z = 0\\). Thus, the product of these two series results in a series of the form:\n\\[\nf(z) = \\sum_{n=-m}^{\\infty} a_n z^n\n\\]\nThis series converges in some punctured disc \\(\\{ z \\,|\\, |z| &lt; R, z \\ne 0 \\}\\) because it is the product of two convergent power series in that region.\nFor the specific function \\(f(z) = \\frac{z}{1 + z^2}\\), we want to expand around \\(z = i\\)\n\\[\nf(z) = \\frac{z}{(z - i)(z + i)}\n\\]\nTo expand around \\(z = i\\), let’s set \\(w = z - i\\), so \\(z = w + i\\). Then:\n\\[\nf(w + i) = \\frac{w + i}{ w (w + 2i)}\n\\]\nNow, observe that:\n\\[\n\\frac{1}{w + 2i} = \\frac{1}{2i} \\cdot \\frac{1}{1 + \\frac{w}{2i}}\n\\]\nSince \\(|\\frac{w}{2i}| &lt; 1\\) for \\(|w| &lt; 2\\), we can use the geometric series expansion:\n\\[\n\\frac{1}{1 + \\frac{w}{2i}} = \\sum_{n=0}^{\\infty} \\left(-\\frac{w}{2i}\\right)^n\n\\]\nThus, we get:\n\\[\nf(z) = \\frac{w + i}{2i w } \\cdot \\sum_{n=0}^{\\infty} \\left(-\\frac{w}{2i}\\right)^n\n\\]\nwhich will be valid in a punctured disc around \\(z = i\\), specifically for \\(|z - i| &lt; 2\\) (or \\(|w| &lt; 2\\)).",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 02"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw07.html",
    "href": "docs/courses/phys231/phys231_hw07.html",
    "title": "Homework 07",
    "section": "",
    "text": "Use Fourier analysis to compute a Green’s function for Poisson’s equation on \\(\\mathbb{R}^3\\), satisfying\n\\[\n\\left(\\partial_x^2+\\partial_y^2+\\partial_z^2\\right) G(x, y, z)=\\delta^{(3)}(x, y, z)\n\\]\nProve there is a unique such Green’s function which goes to zero at infinity (hint: use Liouville’s theorem for harmonic functions).\nFind the Green’s function but now for functions on the unit ball around the origin, with Dirichlet boundary conditions \\(\\phi(x, y, z)=0\\) for \\(x^2+y^2+z^2=1\\). Hint: Schwartz reflection principle/method of images.\n\n\n\n\nLet \\(\\hat{G}(k_x, k_y, k_z)\\) be the Fourier transform of \\(G(x, y, z)\\). After Fourier transform, the equation becomes:\n\\[\n-(k_x^2 + k_y^2 + k_z^2) \\hat{G}(k_x, k_y, k_z) = 1\n\\]\nsince the Fourier transform of \\(\\delta^{(3)}(x, y, z)\\) is 1.\nThus, the solution in Fourier Space:\n\\[\n\\hat{G}(k_x, k_y, k_z) = -\\frac{1}{k_x^2 + k_y^2 + k_z^2}\n\\]\nTo find \\(G(x, y, z)\\), perform the inverse Fourier transform:\n\\[\nG(x, y, z) = \\int_{\\mathbb{R}^3} -\\frac{e^{i(k_x x + k_y y + k_z z)}}{k_x^2 + k_y^2 + k_z^2} \\, dk_x \\, dk_y \\, dk_z\n\\]\nThis integral yields \\(G(x, y, z) = \\frac{-1}{4\\pi\\sqrt{x^2 + y^2 + z^2}}\\).\n\n\n\nLiouville’s theorem states that a bounded harmonic function on \\(\\mathbb{R}^n\\) is constant. Given any two Green’s functions \\(G_1\\) and \\(G_2\\) that vanish at infinity, their difference \\(G_1 - G_2\\) is harmonic (satisfies Laplace’s equation) and bounded. By Liouville’s theorem, \\(G_1 - G_2\\) is constant, and since both go to zero at infinity, this constant must be zero. Thus, \\(G_1 = G_2\\), proving uniqueness.\n\n\n\nTo find a function \\(G(x, y, z; x', y', z')\\) that satisfies:\n\n\\((\\partial_x^2 + \\partial_y^2 + \\partial_z^2) G(x, y, z; x', y', z') = -\\delta(x - x', y - y', z - z')\\) within the unit ball \\(x^2 + y^2 + z^2 &lt; 1\\).\n\\(G(x, y, z; x', y', z') = 0\\) for \\(x^2 + y^2 + z^2 = 1\\), enforcing the Dirichlet boundary conditions.\n\nWe place an “image” point source at \\((x'', y'', z'')\\) where \\((x'', y'', z'') = \\frac{(x', y', z')}{|x'|^2 + |y'|^2 + |z'|^2}\\) outside the unit ball in such a way that the combined effect of the real source and the image source satisfies the boundary conditions.\nThe Green’s function then is a combination of the solution from both the real and the image source\n\\[\nG(x, y, z; x', y', z') = \\frac{1}{4\\pi\\sqrt{(x - x')^2 + (y - y')^2 + (z - z')^2}} - \\frac{1}{4\\pi\\sqrt{(x - x'')^2 + (y - y'')^2 + (z - z'')^2}}\n\\]\nMore generally, we define the point \\(x^* = \\frac{x}{|x|^2}\\) dual to \\(x\\). Therefore, a Green’s function for \\(B^n(0, 1)\\) is given by \\(G(x, y) = Φ(y − x) − Φ(|x|(y − x^*))\\).",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 07"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw07.html#greens-function-for-poissons-equation",
    "href": "docs/courses/phys231/phys231_hw07.html#greens-function-for-poissons-equation",
    "title": "Homework 07",
    "section": "",
    "text": "Use Fourier analysis to compute a Green’s function for Poisson’s equation on \\(\\mathbb{R}^3\\), satisfying\n\\[\n\\left(\\partial_x^2+\\partial_y^2+\\partial_z^2\\right) G(x, y, z)=\\delta^{(3)}(x, y, z)\n\\]\nProve there is a unique such Green’s function which goes to zero at infinity (hint: use Liouville’s theorem for harmonic functions).\nFind the Green’s function but now for functions on the unit ball around the origin, with Dirichlet boundary conditions \\(\\phi(x, y, z)=0\\) for \\(x^2+y^2+z^2=1\\). Hint: Schwartz reflection principle/method of images.\n\n\n\n\nLet \\(\\hat{G}(k_x, k_y, k_z)\\) be the Fourier transform of \\(G(x, y, z)\\). After Fourier transform, the equation becomes:\n\\[\n-(k_x^2 + k_y^2 + k_z^2) \\hat{G}(k_x, k_y, k_z) = 1\n\\]\nsince the Fourier transform of \\(\\delta^{(3)}(x, y, z)\\) is 1.\nThus, the solution in Fourier Space:\n\\[\n\\hat{G}(k_x, k_y, k_z) = -\\frac{1}{k_x^2 + k_y^2 + k_z^2}\n\\]\nTo find \\(G(x, y, z)\\), perform the inverse Fourier transform:\n\\[\nG(x, y, z) = \\int_{\\mathbb{R}^3} -\\frac{e^{i(k_x x + k_y y + k_z z)}}{k_x^2 + k_y^2 + k_z^2} \\, dk_x \\, dk_y \\, dk_z\n\\]\nThis integral yields \\(G(x, y, z) = \\frac{-1}{4\\pi\\sqrt{x^2 + y^2 + z^2}}\\).\n\n\n\nLiouville’s theorem states that a bounded harmonic function on \\(\\mathbb{R}^n\\) is constant. Given any two Green’s functions \\(G_1\\) and \\(G_2\\) that vanish at infinity, their difference \\(G_1 - G_2\\) is harmonic (satisfies Laplace’s equation) and bounded. By Liouville’s theorem, \\(G_1 - G_2\\) is constant, and since both go to zero at infinity, this constant must be zero. Thus, \\(G_1 = G_2\\), proving uniqueness.\n\n\n\nTo find a function \\(G(x, y, z; x', y', z')\\) that satisfies:\n\n\\((\\partial_x^2 + \\partial_y^2 + \\partial_z^2) G(x, y, z; x', y', z') = -\\delta(x - x', y - y', z - z')\\) within the unit ball \\(x^2 + y^2 + z^2 &lt; 1\\).\n\\(G(x, y, z; x', y', z') = 0\\) for \\(x^2 + y^2 + z^2 = 1\\), enforcing the Dirichlet boundary conditions.\n\nWe place an “image” point source at \\((x'', y'', z'')\\) where \\((x'', y'', z'') = \\frac{(x', y', z')}{|x'|^2 + |y'|^2 + |z'|^2}\\) outside the unit ball in such a way that the combined effect of the real source and the image source satisfies the boundary conditions.\nThe Green’s function then is a combination of the solution from both the real and the image source\n\\[\nG(x, y, z; x', y', z') = \\frac{1}{4\\pi\\sqrt{(x - x')^2 + (y - y')^2 + (z - z')^2}} - \\frac{1}{4\\pi\\sqrt{(x - x'')^2 + (y - y'')^2 + (z - z'')^2}}\n\\]\nMore generally, we define the point \\(x^* = \\frac{x}{|x|^2}\\) dual to \\(x\\). Therefore, a Green’s function for \\(B^n(0, 1)\\) is given by \\(G(x, y) = Φ(y − x) − Φ(|x|(y − x^*))\\).",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 07"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw07.html#greens-function-for-the-heat-equation",
    "href": "docs/courses/phys231/phys231_hw07.html#greens-function-for-the-heat-equation",
    "title": "Homework 07",
    "section": "2 Green’s function for the heat equation",
    "text": "2 Green’s function for the heat equation\n\nFind the Green’s function for the heat equation\n\\[\n\\partial_t u=\\partial_x^2 u\n\\]\nby Fourier analysis.\n\nWe want to find a Green’s function \\(G(x, t; x', t')\\) that satisfies the following properties:\n\n\\(\\partial_t G = \\partial_x^2 G\\)\n\\(G(x, t; x', t')\\) behaves like a delta function as \\(t \\to t'^+\\), i.e., \\(G(x, t; x', t') \\to \\delta(x - x')\\) as \\(t \\to t'^+\\).\n\nBy taking the Fourier transform of \\(G\\) with respect to \\(x\\), the heat equation in Fourier space becomes\n\\[\n\\partial_t \\hat{G} = -k^2 \\hat{G}\n\\]\nThis is a first-order linear differential equation in \\(t\\), the solution is\n\\[\n\\hat{G}(k, t; x', t') = A(k, x', t') e^{-k^2 (t - t')}\n\\]\nwhere \\(A(k, x', t')\\) is to be determined.\nNow we apply the initial condition. The initial condition is that \\(G\\) approaches \\(\\delta(x - x')\\) as \\(t \\to t'^+\\). In Fourier space, this translates to \\(\\hat{G}(k, t; x', t') \\to e^{-ik(x - x')}\\) as \\(t \\to t'^+\\). Thus\n\\[\nA(k, x', t') = e^{-ikx'}\n\\]\nThen take the inverse Fourier transform of \\(\\hat{G}(k, t; x', t')\\) to get back to the spatial domain:\n\\[\nG(x, t; x', t') = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} e^{-ikx'} e^{-ikx} e^{-k^2 (t - t')} dk\n\\]\nThis integral yields a function of the form:\n\\[\nG(x, t; x', t') = \\frac{1}{\\sqrt{4\\pi (t - t')}} e^{-\\frac{(x - x')^2}{4(t - t')}}\n\\]\nfor \\(t &gt; t'\\).\nSo the Green’s function for the heat equation is:\n\\[\nG(x, t; x', t') = \\begin{cases} \\frac{1}{\\sqrt{4\\pi (t - t')}} e^{-\\frac{(x - x')^2}{4(t - t')}}, & t &gt; t' \\\\ 0, & \\text{otherwise} \\end{cases}\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 07"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw07.html#resolvent-rz-az-mathbb1-a-1",
    "href": "docs/courses/phys231/phys231_hw07.html#resolvent-rz-az-mathbb1-a-1",
    "title": "Homework 07",
    "section": "3 Resolvent \\(R(z, A)=(z \\mathbb{1}-A)^{-1}\\)",
    "text": "3 Resolvent \\(R(z, A)=(z \\mathbb{1}-A)^{-1}\\)\n\nGiven a finite dimensional complex matrix \\(A\\), we can define the resolvent\n\\[\nR(z, A)=(z \\mathbb{1}-A)^{-1}=\\frac{1}{z-A},\n\\]\nwhere \\(\\mathbb{1}\\) is the identity matrix. This equation makes sense whenever \\(z\\) is not an eigenvalue of \\(A\\), and so we can consider \\(R(z, A)\\) as a meromorphic, matrix-valued function of \\(z\\), with poles at the eigenvalues of \\(A\\). For these problems, assume \\(A\\) is Hermitian:\n\nShow that\n\\[\nR(z, A)=\\frac{P_\\lambda}{z-\\lambda},\n\\]\nwhere \\(P_\\lambda\\) is the projector onto the eigenspace of \\(\\lambda\\) eigenvectors.\nSuppose \\(w\\) is orthogonal to the kernel of \\(A\\). Prove that\n\\[\nv=\\int_C \\frac{d z}{2 \\pi i} \\frac{R(z, A)}{z} w\n\\]\nsolves the equation\n\\[\nA v=w,\n\\]\nwhere \\(C\\) is a contour winding once around \\(z=0\\) and not enclosing any other eigenvalues.\nShow the same as in (2) for a contour enclosing all eigenvalues except for 0.\n\n\n\n3.1 Expression for \\(R(z, A)\\)\nGiven a Hermitian matrix \\(A\\), its eigenvalues are real, and it can be diagonalized. Let \\(\\lambda\\) be an eigenvalue of \\(A\\) and \\(P_\\lambda\\) the projector onto the eigenspace of \\(\\lambda\\). We have spectral decomposition\n\\[\nA = \\sum_{\\lambda} \\lambda P_\\lambda\n\\]\nthe expression for \\(R(z, A)\\) can be simplified:\n\\[\nR(z, A) = (z\\mathbb{1} - A)^{-1} = \\left( z \\sum_\\lambda P_\\lambda - \\sum_\\lambda \\lambda P_\\lambda \\right)^{-1}\n\\]\nBecause the projectors \\(P_\\lambda\\) are orthogonal and sum to the identity: \\(R(z, A) = \\sum_\\lambda (zP_\\lambda - \\lambda P_\\lambda)^{-1}\\).\n\nThus, \\(R(z, A) = \\sum_\\lambda \\frac{P_\\lambda}{z - \\lambda}\\).\n\n\n\n3.2 Solving \\(A v = w\\)\nSubstitute the expression for \\(R(z, A)\\) into the integral:\n\\[\nv = \\int_C \\frac{d z}{2 \\pi i} \\frac{\\sum_\\lambda \\frac{P_\\lambda}{z - \\lambda}}{z} w\n\\]\nEvaluate it using the residue theorem. Since \\(C\\) winds around \\(z = 0\\) and does not enclose any other eigenvalues, the only contribution comes from the pole at \\(z = 0\\).\nThe residue at \\(z = 0\\) gives \\(P_0 w\\). So \\(A v = A P_0 w = w\\)\n\n\n3.3 Contour Enclosing All Eigenvalues Except 0\nUse the same integral expression for \\(v\\). But now the integral will pick up residues from all poles \\(\\lambda \\neq 0\\) within the contour \\(C\\).\nFor each \\(\\lambda \\neq 0\\), the residue at \\(z = \\lambda\\) is \\(\\frac{P_\\lambda w}{\\lambda}\\).\nSumming up the residues, \\(v = \\sum_{\\lambda \\neq 0} \\frac{P_\\lambda w}{\\lambda}\\).\nMultiplying both sides by \\(A\\) (and using \\(AP_\\lambda = \\lambda P_\\lambda\\)), we get \\(A v = \\sum_{\\lambda \\neq 0} P_\\lambda w = w - P_0 w\\).\nSince \\(w\\) is orthogonal to the kernel of \\(A\\), \\(P_0 w = 0\\). Therefore, \\(A v = w\\).",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 07"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw04.html",
    "href": "docs/courses/phys231/phys231_hw04.html",
    "title": "Homework 04",
    "section": "",
    "text": "Complete PDF\nMathematica Notebook",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 04"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw04.html#winding-number",
    "href": "docs/courses/phys231/phys231_hw04.html#winding-number",
    "title": "Homework 04",
    "section": "2. Winding number",
    "text": "2. Winding number\n\nSuppose \\(f(z)\\) is holomorphic in the disc \\(|z| ≤ ϵ\\) and has a zero at \\(z = 0\\) but nowhere else in the disc \\(|z| ≤ ϵ\\). Show by direct integration that\n\\[\n\\frac{1}{2πi} \\int_{|z|=ϵ} \\frac{f'(z)}{f(z)} dz\n\\]\nequals the winding number of the argument of f around the circle \\(|z| = ϵ\\). Then use the residue theorem to show that this equals the degree of the zero, in agreement with the argument principle.\n\nThe integral\n\\[\n\\int_{C} \\frac{f'(z)}{f(z)} dz = \\int_{C} \\frac{1}{f(z)} df(z) = \\int_{f(C)} \\frac{1}{w} dw\n\\]\neffectively measures the total change in the argument of \\(f(z)\\) as \\(z\\) traverses the circle, which equals the winding number of the argument of \\(f\\).\nSince \\(f(z)\\) is holomorphic in the disc \\(|z| \\leq \\epsilon\\) and has a zero at \\(z = 0\\), \\(f(z)\\) can be locally expressed as \\(z^n g(z)\\), where \\(n\\) is the degree of the zero.\nThen, \\(f'(z) = n z^{n−1} g(z) + z^n g'(z)\\), and so\n\\[\n\\frac{f'(z)}{f(z)} = \\frac{n}{z} + \\frac{g'(z)}{g(z)}\n\\]\nThe residue at \\(z=0\\) is the coefficient of \\(\\frac{1}{z}\\) in this expression, which is \\(n\\), the degree of the zero.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 04"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw04.html#analytic-continuation-and-fourier-coefficents",
    "href": "docs/courses/phys231/phys231_hw04.html#analytic-continuation-and-fourier-coefficents",
    "title": "Homework 04",
    "section": "4. Analytic continuation and Fourier coefficents",
    "text": "4. Analytic continuation and Fourier coefficents\n\nGive an analytic continuation of \\(\\cos θ\\) from the unit circle \\(z = e^{iθ}\\) to the complex plane minus the origin.\nConclude that the Fourier coefficients \\(c_n\\) of \\(e^{- \\cos θ}\\) decrease faster than any exponential, meaning \\(c_n = o(e^{−αn})\\) for all \\(α\\) as \\(n → ±∞\\). Compare this to the Fourier series of \\(1/(cos θ −3/2)\\), what is the decay of its Fourier coefficents?\n\n\nAnalytic continuation\nOn the unit circle \\(z=e ^ {iθ}\\), \\(\\cos \\theta = \\frac{1}{2} (e^{iθ} +e^{−iθ}) = \\frac{1}{2} (z+ z^{-1})\\). This expression provides an analytic continuation of \\(\\cos \\theta\\) to the complex plane minus the origin, as it is well-defined for all \\(z \\neq 0\\).\n\n\nFourier coefficents of \\(e^{−\\cos \\theta}\\)\nThe function \\(e^{−\\cos \\theta}\\) is smooth and periodic. The Fourier coefficients \\(c_n\\) of a periodic function \\(f(θ)\\) are given by:\n\\[\nc_n= 1/2π ∫_{0}^{2π} f(θ)e^{inθ}dθ = 1/2π \\int_{0}^{2π} e^{-\\cos θ + i n θ}dθ\n\\]\n\\[\n1/2π \\int_{0}^{2π} e^{-\\cos θ + i n θ} dθ = 1/2π \\int_{|z|=1} e^{-z/2-1/2z} z^n \\frac{dz}{i z} = Res_{z=0} { e^{-z/2-1/2z} z^{n-1} }\n\\]\nThe coefficient \\(a_{-n}\\) of \\(g(z)=e^{-z/2-1/2z}\\) at the point of \\(z=0\\) can de derived by expanding by separately \\(e^{-z/2}\\) as Talyor Series and \\(e^{−1/(2z)}\\) as a Laurent Series and then multiplying these series together\n\\[\na_{-n} = \\sum_{k=0}^{\\infty} (-\\frac{1}{2})^k \\frac{1}{k!} (-\\frac{1}{2})^{(n+k)} \\frac{1}{(n+k)!}\n\\]\nSo fourier coefficients \\(c_n\\)\n\\[\nc_n = a_{-n}  \\leq  |a_{-n} | \\leq \\frac{1}{2^{n}}\\frac{1}{n!}\n\\]\ndecrease faster than any exponential.\n\n\nFourier coefficents of \\(\\frac{1}{\\cos \\theta - 3/2}\\)\nThe Fourier coefficients \\(c_n\\) of a periodic function \\(f(θ)\\) are given by:\n\\[\n\\begin{aligned}\nc_n\n&= \\frac{1}{2π} \\int_{0}^{2π} f(θ)e^{inθ}dθ \\\\\n&= \\frac{1}{2π} \\int_{0}^{2π} \\frac{1}{\\cos \\theta - 3/2}e^{i n θ}dθ \\\\\n&= \\frac{1}{2πi} \\int_{|z| = 1} \\frac{2z}{z^2-3z+1} z^{n-1} dz\n\\end{aligned}\n\\]\nLet \\(z^2 - 3z+1=(z-z_1)(z-z_2)\\), where \\(z_1 = \\frac{1}{2} \\left(3-\\sqrt{5}\\right), z_2=\\frac{1}{2} \\left(3 + \\sqrt{5}\\right)\\).\n\\[\n\\begin{aligned}\nc_n\n&= Res_{z=z_1}  \\frac{2z}{(z-z_1)(z-z_2)} z^{n-1} \\\\\n&= \\frac{2 z_1}{z_1-z_2} {z_1}^{n-1}\n\\end{aligned}\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 04"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw04.html#laurent-series-and-singularity",
    "href": "docs/courses/phys231/phys231_hw04.html#laurent-series-and-singularity",
    "title": "Homework 04",
    "section": "5. Laurent series and singularity",
    "text": "5. Laurent series and singularity\nLet’s consider a function \\(f\\) that is holomorphic in a disc around \\(z_0\\) except at \\(z_0\\) itself.\n\nRemovable Singularity:\nIf \\(f\\) has a removable singularity at \\(z_0\\), it means that \\(f\\) can be extended to a holomorphic function at \\(z_0\\). In terms of the Laurent series, this implies that all the coefficients \\(a_n\\) for \\(n &lt; 0\\) are zero because it reduces to its Taylor series.\nConversely, if all \\(a_n = 0\\) for \\(n &lt; 0\\), the Laurent series reduces to a Taylor series, implying that \\(f\\) is holomorphic at \\(z_0\\) (since it can be expressed as a power series), and thus the singularity is removable.\nPole of Order \\(m\\) :\nIf \\(f\\) has a pole of order \\(m\\) at \\(z_0\\), it means that in the Laurent series, there is a term with \\((z - z_0)^{-m}\\) (where \\(a_{-m} \\neq 0\\)) and no terms with higher negative powers.\nConversely, if there is some \\(m &lt; 0\\) such that \\(a_m \\neq 0\\) but \\(a_n = 0\\) for all \\(n &lt; m\\), then the Laurent series has a term \\(a_m (z - z_0)^m\\) as its term with the highest negative power, indicating a pole of order \\(m\\) .\nEssential Singularity:\nIf the singularity at \\(z_0\\) is neither removable nor a pole, it must be an essential singularity. This is characterized by the fact that there are infinitely many negative powers of \\(z - z_0\\) in the Laurent series with non-zero coefficients. In other words, if the Laurent series has non-zero \\(a_n\\) for infinitely many \\(n &lt; 0\\), then \\(z_0\\) is an essential singularity.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 04"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw04.html#euler-proof-of-basel-problem",
    "href": "docs/courses/phys231/phys231_hw04.html#euler-proof-of-basel-problem",
    "title": "Homework 04",
    "section": "6. Euler proof of Basel problem",
    "text": "6. Euler proof of Basel problem\n\nUsing the result of the bonus problem, prove that\n\\[\n\\sin π z = \\prod (1 − z/n)e^{z/n} = π z  \\prod (1 − z^2/n^2)\n\\]\nThen compare the Taylor series of sin πz to the first couple terms in the expansion of the infinite product to conclude\n\\[\n\\sum_{n=1}^{\\infty}  1/n^2 = π^2/ 6\n\\]\n\nAccording to the Weierstrass factorization theorem, an entire function can be represented as a product over its zeros. The function \\(\\sin \\pi z\\) is entire and has zeros at all integers. The product representation for \\(\\sin \\pi z\\) is given by:\n\\[\n\\sin \\pi z = \\pi z \\prod_{n=1}^{\\infty} \\left(1 - \\frac{z}{n}\\right)\\left(1 + \\frac{z}{n}\\right)\n=  \\sin \\pi z = \\pi z \\prod_{n=1}^{\\infty} \\left(1 - \\frac{z^2}{n^2}\\right)\n\\]\nThe Taylor series expansion of \\(\\sin \\pi z\\) around \\(z = 0\\) is:\n\\[\n\\sin \\pi z = \\pi z - \\frac{\\pi^3 z^3}{3!} + \\frac{\\pi^5 z^5}{5!} - \\frac{\\pi^7 z^7}{7!} + \\cdots\n\\]\nNow, let’s expand the infinite product to the first couple of terms and keeping terms up to \\(z^3\\), we get:\n\\[\n\\begin{aligned}\n\\pi z \\prod_{n=1}^{\\infty} \\left(1 - \\frac{z^2}{n^2}\\right)\n&= \\pi z \\left(1 - \\frac{z^2}{1^2}\\right)\\left(1 - \\frac{z^2}{2^2}\\right)\\left(1 - \\frac{z^2}{3^2}\\right) \\cdots \\\\\n&= \\pi z \\left(1 - z^2 \\left(\\frac{1}{1^2} + \\frac{1}{2^2} + \\frac{1}{3^2} + \\cdots\\right) + \\cdots \\right)\n\\end{aligned}\n\\]\nComparing the coefficient of \\(z^3\\) from the Taylor series and the product expansion, we have:\n\\[\n-\\frac{\\pi^3}{6} = -\\pi \\left(\\frac{1}{1^2} + \\frac{1}{2^2} + \\frac{1}{3^2} + \\cdots\\right)\n\\]\nThis is the result we want.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 04"
    ]
  },
  {
    "objectID": "docs/courses/phys231/index.html",
    "href": "docs/courses/phys231/index.html",
    "title": "PHYSICS 231A",
    "section": "",
    "text": "In this course, we will cover a selection of analytic methods useful in a wide variety of physics topics. This includes complex analysis, asymptotic approximation of integrals, summing divergent series, manifold topology and de Rham cohomology, Fourier analysis, linear differential equations and Green’s functions, and perturbation theory for nonlinear problems.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A"
    ]
  },
  {
    "objectID": "docs/courses/phys231/index.html#about",
    "href": "docs/courses/phys231/index.html#about",
    "title": "PHYSICS 231A",
    "section": "",
    "text": "In this course, we will cover a selection of analytic methods useful in a wide variety of physics topics. This includes complex analysis, asymptotic approximation of integrals, summing divergent series, manifold topology and de Rham cohomology, Fourier analysis, linear differential equations and Green’s functions, and perturbation theory for nonlinear problems.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A"
    ]
  },
  {
    "objectID": "docs/courses/index.html",
    "href": "docs/courses/index.html",
    "title": "Courses",
    "section": "",
    "text": "ASTR 145\n\n\nHigh Energy Astrophysics\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nEPSS 261\n\n\nData Analysis Methods in Space Physics\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nEPSS 261 Homework\n\n\nData Analysis Methods in Space Physics\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nEPSS 265\n\n\nInstrumentation, Data Processing and Data Analysis in Space Physics\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nEPSS 298\n\n\nModern Data Analysis and Machine Learning for EPSS and Astronomy\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nEPSS 298\n\n\nMHD Turbulence and Magnetic reconnection\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nEPSS M263\n\n\nSolar System Magnetohydrodynamics\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPHYSICS 231A\n\n\nMethods of Mathematical Physics\n\n\n\n\n\n\n\n\n\n\n\nNo matching items",
    "crumbs": [
      "Courses"
    ]
  },
  {
    "objectID": "research/projects/2022_Zijin_solar-wind-LMA/index.html",
    "href": "research/projects/2022_Zijin_solar-wind-LMA/index.html",
    "title": "The kinetic simulation of the interaction between the Moon’s magnetic anomalies and the solar wind",
    "section": "",
    "text": "GitHub repository\nPDF"
  },
  {
    "objectID": "research/projects/2023_Zijin_energetic-ion-scattering/index.html",
    "href": "research/projects/2023_Zijin_energetic-ion-scattering/index.html",
    "title": "Energetic ion scattering by solar wind discontinuities",
    "section": "",
    "text": "Web Pages\nGitHub repository"
  },
  {
    "objectID": "research/projects/2024_Zijin_finesst/index.html",
    "href": "research/projects/2024_Zijin_finesst/index.html",
    "title": "Solar wind discontinuities",
    "section": "",
    "text": "Future Investigators in NASA Earth and Space Science and Technology (FINESST) is a program element in Research Opportunities in Space and Earth Sciences (ROSES)."
  },
  {
    "objectID": "research/projects/2023_Zijin_relativistic-electron-flux/index.html",
    "href": "research/projects/2023_Zijin_relativistic-electron-flux/index.html",
    "title": "Relativistic electron flux decay and recovery",
    "section": "",
    "text": "Web Pages\nGitHub repository"
  },
  {
    "objectID": "research/projects/2023_Zijin_solar-wind-discontinuities-evolution/index.html",
    "href": "research/projects/2023_Zijin_solar-wind-discontinuities-evolution/index.html",
    "title": "Evolution of solar wind discontinuities over radial distance",
    "section": "",
    "text": "Web Pages\nGitHub repository"
  },
  {
    "objectID": "research/index.html",
    "href": "research/index.html",
    "title": "Research",
    "section": "",
    "text": "paper\n\n\n\nWe conducted a search for narrowband radio signals over four observing sessions in 2020–2023 with the L-band receiver (1.15–1.73 GHz) of the 100 m diameter Green Bank Telescope…\n\n\n\n\n\nOct 1, 2023\n\n\nJean-Luc Margot, Megan Grace Li\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "research/index.html#journal-articles",
    "href": "research/index.html#journal-articles",
    "title": "Research",
    "section": "",
    "text": "paper\n\n\n\nWe conducted a search for narrowband radio signals over four observing sessions in 2020–2023 with the L-band receiver (1.15–1.73 GHz) of the 100 m diameter Green Bank Telescope…\n\n\n\n\n\nOct 1, 2023\n\n\nJean-Luc Margot, Megan Grace Li\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "research/index.html#projects",
    "href": "research/index.html#projects",
    "title": "Research",
    "section": "Projects",
    "text": "Projects\n\n\n\n\n\n\n\n\n\n\nSolar wind discontinuities\n\n\nFINESST23 Proposal\n\n\n\nproposal\n\n\nsolar wind\n\n\n\n\n\n\n\n\n\nJan 13, 2024\n\n\nZijin Zhang, Anton V. Artemyev\n\n\n\n\n\n\n\n\n\n\n\n\nEnergetic ion scattering by solar wind discontinuities\n\n\n\n\n\n\nseeding\n\n\nsolar wind\n\n\n\n\n\n\n\n\n\nJan 8, 2024\n\n\nZijin Zhang\n\n\n\n\n\n\n\n\n\n\n\n\nRelativistic electron flux decay and recovery\n\n\nRelative role of EMIC waves, whistler-mode waves, and plasmasheet injections\n\n\n\n\n\n\n\n\nJan 8, 2024\n\n\nZijin Zhang\n\n\n\n\n\n\n\n\n\n\n\n\nEvolution of solar wind discontinuities over radial distance\n\n\n\n\n\n\nseeding\n\n\nsolar wind\n\n\n\n\n\n\n\n\n\nJan 8, 2024\n\n\nZijin Zhang\n\n\n\n\n\n\n\n\n\n\n\n\nThe kinetic simulation of the interaction between the Moon’s magnetic anomalies and the solar wind\n\n\n\n\n\n\nsolar wind\n\n\n\n\n\n\n\n\n\nJul 1, 2022\n\n\nZijin Zhang\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw08.html",
    "href": "docs/courses/phys231/phys231_hw08.html",
    "title": "Homework 08",
    "section": "",
    "text": "Find an asymptotic series for\n\\[\nf(x)= \\log (x-2)\n\\]\nas \\(x \\rightarrow \\infty\\) in terms of \\(\\log x\\) and inverse powers of \\(x\\). (Hint: split the log and use Taylor series on one part.)\n\n\\[\nf(x) = \\log(x - 2) = \\log x + \\log(1 - \\frac{2}{x})\n\\]\nThe Taylor series expansion of \\(\\log(1 - y)\\) around \\(y = 0\\) is:\n\\[\n\\log(1 - y) = -y - \\frac{y^2}{2} - \\frac{y^3}{3} - \\cdots\n\\]\nBy substituting \\(y = \\frac{2}{x}\\) into this series, the asymptotic series for \\(f(x)\\) as \\(x \\to \\infty\\) is:\n\\[\nf(x) = \\log x - \\frac{2}{x} - \\frac{2^2}{2x^2} - \\frac{2^3}{3x^3} - \\cdots\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 08"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw08.html#asymptotic-series-for-log-x-2",
    "href": "docs/courses/phys231/phys231_hw08.html#asymptotic-series-for-log-x-2",
    "title": "Homework 08",
    "section": "",
    "text": "Find an asymptotic series for\n\\[\nf(x)= \\log (x-2)\n\\]\nas \\(x \\rightarrow \\infty\\) in terms of \\(\\log x\\) and inverse powers of \\(x\\). (Hint: split the log and use Taylor series on one part.)\n\n\\[\nf(x) = \\log(x - 2) = \\log x + \\log(1 - \\frac{2}{x})\n\\]\nThe Taylor series expansion of \\(\\log(1 - y)\\) around \\(y = 0\\) is:\n\\[\n\\log(1 - y) = -y - \\frac{y^2}{2} - \\frac{y^3}{3} - \\cdots\n\\]\nBy substituting \\(y = \\frac{2}{x}\\) into this series, the asymptotic series for \\(f(x)\\) as \\(x \\to \\infty\\) is:\n\\[\nf(x) = \\log x - \\frac{2}{x} - \\frac{2^2}{2x^2} - \\frac{2^3}{3x^3} - \\cdots\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 08"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw08.html#watsons-lemma-and-int_01-frace-s-x1x2-d-x",
    "href": "docs/courses/phys231/phys231_hw08.html#watsons-lemma-and-int_01-frace-s-x1x2-d-x",
    "title": "Homework 08",
    "section": "2 Watson’s lemma and \\(\\int_0^1 \\frac{e^{-s x}}{1+x^2} d x\\)",
    "text": "2 Watson’s lemma and \\(\\int_0^1 \\frac{e^{-s x}}{1+x^2} d x\\)\n\nUse Watson’s lemma to find the \\(s \\rightarrow \\infty\\) asymptotic series for\n\\[\nI(s)=\\int_0^1 \\frac{e^{-s x}}{1+x^2} d x\n\\]\n\nTo use Watson’s Lemma, we need to express \\(\\frac{1}{1+x^2}\\) as a power series at \\(x = 0\\). The Taylor series of \\(\\frac{1}{1+x^2}\\) around \\(x = 0\\) is:\n\\[\n\\frac{1}{1+x^2} = 1 - x^2 + x^4 - x^6 + \\cdots\n\\]\nwhich is valid for \\(|x| &lt; 1\\). Substituting this into \\(I(s)\\) gives:\n\\[\nI(s) = \\int_0^1 e^{-s x} (1 - x^2 + x^4 - x^6 + \\cdots) \\, dx\n\\]\nNow, we can integrate term by term:\n\nFor the first term:\n\\[\n\\int_0^1 e^{-s x} \\, dx = \\frac{1}{s} (1 - e^{-s})\n\\]\nAs \\(s \\rightarrow \\infty\\), \\(e^{-s}\\) approaches 0 faster than \\(1/s\\), so this term becomes \\(\\frac{1}{s}\\).\nFor the second term:\n\\[\n-\\int_0^1 x^2 e^{-s x} \\, dx\n\\]\nApplying integration by parts or a similar method, we find this term is \\(O\\left(\\frac{1}{s^3}\\right)\\) as \\(s \\rightarrow \\infty\\).\nSimilarly, each subsequent term will contribute higher order terms in \\(\\frac{1}{s}\\).\n\nHence, the asymptotic expansion of \\(I(s)\\) as \\(s \\rightarrow \\infty\\) is:\n\\[\nI(s) \\sim \\frac{1}{s} - \\frac{1}{s^3} + \\cdots\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 08"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw08.html#watsons-lemma-and-int_0infty-sin-sqrtx-e-s-x2-d-x",
    "href": "docs/courses/phys231/phys231_hw08.html#watsons-lemma-and-int_0infty-sin-sqrtx-e-s-x2-d-x",
    "title": "Homework 08",
    "section": "3 Watson’s lemma and \\(\\int_0^{\\infty} \\sin (\\sqrt{x}) e^{-s x^2} d x\\)",
    "text": "3 Watson’s lemma and \\(\\int_0^{\\infty} \\sin (\\sqrt{x}) e^{-s x^2} d x\\)\n\nUse Watson’s lemma to find the \\(s \\rightarrow \\infty\\) asymptotic series for\n\\[\nI(s)=\\int_0^{\\infty} \\sin (\\sqrt{x}) e^{-s x^2} d x\n\\]\n\nThe integral \\(I(s)\\) does not directly fit this form of Watson’s lemma due to the \\(e^{-s x^2}\\) term. So first, we perform a change of variable to transform the integral into a more suitable form for Watson’s Lemma. Let \\(u = x^2\\), then \\(du = 2x \\, dx\\) or \\(dx = \\frac{du}{2\\sqrt{u}}\\). The integral becomes:\n\\[\nI(s) = \\int_0^{\\infty} \\sin(u^{1/4}) e^{-s u} \\frac{du}{2\\sqrt{u}}\n\\]\nExpand \\(\\sin(u^{1/4})\\) in a Taylor series about \\(u = 0\\):\n\\[\n\\sin(u^{1/4}) = u^{1/4} - \\frac{u^{3/4}}{3!} + \\frac{u^{5/4}}{5!} - \\cdots\n\\]\nSubstituting this series into the integral, we get:\n\\[\nI(s) = \\int_0^{\\infty} \\left(u^{1/4} - \\frac{u^{3/4}}{3!} + \\cdots \\right) e^{-s u} \\frac{du}{2\\sqrt{u}}\n= \\frac{\\Gamma(3/4)}{2 s^{3/4}} - \\frac{\\Gamma(5/4)}{12 s^{5/4}} + \\cdots\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 08"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw08.html#asymptotic-series-for-the-error-function",
    "href": "docs/courses/phys231/phys231_hw08.html#asymptotic-series-for-the-error-function",
    "title": "Homework 08",
    "section": "4 Asymptotic series for the error function",
    "text": "4 Asymptotic series for the error function\n\nUse integration by parts to give the \\(x \\rightarrow \\infty\\) asymptotic series for the error function\n\\[\n\\operatorname{erf}(x)=\\frac{2}{\\sqrt{\\pi}} \\int_x^{\\infty} e^{-t^2} d t .\n\\]\n\nWe can apply successive integration by parts to \\(\\operatorname{erfc}(\\lambda)\\), in which the first step gives\n\\[\n\\begin{aligned}\n\\operatorname{erf}(x) & =\\frac{2}{\\sqrt{\\pi}} \\int_x^{\\infty} \\exp \\left(-t^2\\right) d t \\\\\n& =\\frac{2}{\\sqrt{\\pi}} \\int_x^{\\infty} \\frac{-2 t \\exp \\left(-t^2\\right)}{-2 t} d t,\\left[u=\\frac{1}{-2 t}, d v=-2 t \\exp \\left(-t^2\\right) d t\\right] \\\\\n& =\\frac{2}{\\sqrt{\\pi}}\\left[\\frac{\\exp \\left(-t^2\\right)}{-2 t}-\\int \\frac{\\exp \\left(-t^2\\right)}{2 t^2} d t\\right]_x^{\\infty} \\\\\n& =\\frac{2}{\\sqrt{\\pi}}\\left[\\frac{\\exp \\left(-x^2\\right)}{2 x}-\\int_x^{\\infty} \\frac{\\exp \\left(-t^2\\right)}{2 t^2} d t\\right] \\\\\n& =\\frac{2 e^{-x^2}}{\\sqrt{\\pi}}\\left(\\frac{1}{2 x}\\right)-\\frac{2}{\\sqrt{\\pi}} \\int_x^{\\infty} \\frac{\\exp \\left(-t^2\\right)}{2 t^2} d t\n\\end{aligned}\n\\]\nWe have obtained the first term. And applying integration by parts to the new integral gives\n\\[\n\\begin{aligned}\n\\int_x^{\\infty} \\frac{\\exp \\left(-t^2\\right)}{2 t^2} d t & =\\frac{1}{2} \\int_x^{\\infty} \\frac{-2 t \\exp \\left(-t^2\\right)}{-2 t^3} d t\\left[u=-\\frac{1}{2 t^3}, d v=-2 t \\exp \\left(-t^2\\right) d t\\right] \\\\\n& =\\frac{1}{2}\\left[\\frac{\\exp \\left(-t^2\\right)}{-2 t^3}-\\int \\frac{3 \\exp \\left(-t^2\\right)}{2 t^4} d t\\right]_x^{\\infty} \\\\\n& =\\frac{1}{2}\\left[\\frac{\\exp \\left(-x^2\\right)}{2 x^3}-\\int_x^{\\infty} \\frac{3 \\exp \\left(-t^2\\right)}{2 t^4} d t\\right]\n\\end{aligned}\n\\]\nThus we have\n\\[\n\\operatorname{erfc}(x)=\\frac{e^{-x^2}}{\\sqrt{\\pi}}\\left(\\frac{1}{2 x}-\\frac{1}{4 x^3}-\\int_x^{\\infty} \\frac{3 \\exp \\left(-t^2\\right)}{2 t^4} d t\\right),\n\\]\nContinuing with successive integration by parts we will obtain the asymptotic expansion.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 08"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw08.html#stirlings-formula",
    "href": "docs/courses/phys231/phys231_hw08.html#stirlings-formula",
    "title": "Homework 08",
    "section": "5 Stirling’s formula",
    "text": "5 Stirling’s formula\n\nUse Laplace’s method to derive Stirling’s formula\n\\[\nn ! \\sim \\sqrt{2 \\pi n} n^n e^{-n} \\quad n \\rightarrow \\infty\n\\]\nusing the Gamma function. Also find the next term in the asymptotic series.\n\nGamma function, which is related to the factorial by \\(\\Gamma(n+1) = n!\\) is defined as:\n\\[\n\\Gamma(n) = \\int_0^{\\infty} e^{-t} t^{n-1} dt\n\\]\nFor large \\(n\\), we approximate this integral using Laplace’s method, which is effective for integrals of the form \\(\\int e^{M f(t)} dt\\) where \\(M\\) is a large parameter. Here, we can rewrite the Gamma function as:\n\\[\n\\Gamma(n+1) = \\int_0^{\\infty} e^{n \\log t - t} dt\n\\]\nNow, to apply Laplace’s method, we find the maximum of the function \\(f(t) = \\log t - \\frac{t}{n}\\). Taking the derivative and setting it to zero gives:\n\\[\n\\frac{d}{dt} \\left( \\log t - \\frac{t}{n} \\right) = \\frac{1}{t} - \\frac{1}{n} = 0\n\\]\nThis yields \\(t = n\\) as the point where \\(f(t)\\) attains its maximum. We then expand \\(f(t)\\) around this point:\n\\[\nf(t) \\approx f(n) + \\frac{1}{2} f''(n) (t - n)^2\n\\]\nwhere \\(f(n) = \\log n - 1\\) and \\(f''(n) = -1/n^2\\). The integral becomes:\n\\[\n\\Gamma(n+1) \\approx e^{n \\log n - n} \\int_{0}^{\\infty} e^{-\\frac{1}{2} \\frac{(t-n)^2}{n}} dt\n\\]\nChanging variables with \\(u = \\frac{t-n}{\\sqrt{n}}\\) gives:\n\\[\n\\Gamma(n+1) \\approx e^{n \\log n - n} \\sqrt{n} \\int_{0}^{\\infty} e^{-\\frac{1}{2} u^2} du\n\\]\nRecognizing the Gaussian integral, we get:\n\\[\n\\Gamma(n+1) = n! \\approx e^{n \\log n - n} \\sqrt{2 \\pi n} = \\sqrt{2 \\pi n} n^n e^{-n} \\quad n \\rightarrow \\infty\n\\]\nThe second derivative \\(f''(t)\\) at the point \\(t = n\\) gives us the next leading term. The third derivative of \\(f(t)\\) is:\n\\[\nf'''(t) = \\frac{2}{t^3}\n\\]\nEvaluating this at \\(t = n\\) gives:\n\\[\nf'''(n) = \\frac{2}{n^3}\n\\]\nThe corresponding term in the expansion is of the order \\(\\frac{1}{n}\\), which leads to the next term in the series being \\(\\frac{1}{12n}\\). Therefore, the improved Stirling’s formula, including the next term in the asymptotic series, is:\n\\[\nn! \\sim \\sqrt{2 \\pi n}\\, n^n e^{-n} \\left( 1 + \\frac{1}{12n} \\right)\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 08"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw08.html#leading-asymptotics-of-ixint_-11-e-x-sin-4-t-d-t",
    "href": "docs/courses/phys231/phys231_hw08.html#leading-asymptotics-of-ixint_-11-e-x-sin-4-t-d-t",
    "title": "Homework 08",
    "section": "6 Leading asymptotics of \\(I(x)=\\int_{-1}^1 e^{-x \\sin ^4 t} d t\\)",
    "text": "6 Leading asymptotics of \\(I(x)=\\int_{-1}^1 e^{-x \\sin ^4 t} d t\\)\n\nUse Laplace’s method to find the leading asymptotics of\n\\[\nI(x)=\\int_{-1}^1 e^{-x \\sin ^4 t} d t\n\\]\nas \\(x \\rightarrow \\infty\\).\n\nFor the given integral, we observe that \\(\\sin^4 t\\) is maximized when \\(t = 0\\) within the interval \\([-1, 1]\\). Near this point, the function \\(\\sin^4 t\\) can be approximated by its Taylor expansion:\n\\[\n\\sin^4 t \\approx t^4\n\\]\nfor small values of \\(t\\). The integral becomes:\n\\[\nI(x) \\approx \\int_{-1}^1 e^{-x t^4} dt\n\\]\nAs \\(x \\rightarrow \\infty\\), the contribution to the integral from regions where \\(t\\) is not very small becomes negligible, so we can extend the limits of the integral to infinity for the purpose of asymptotic approximation:\n\\[\nI(x) \\approx \\int_{-\\infty}^{\\infty} e^{-x t^4} dt\n\\]\nLet \\(u = x^{1/4} t\\), then \\(dt = x^{-1/4} du\\) and the integral becomes:\n\\[\nI(x) \\approx \\int_{-\\infty}^{\\infty} e^{-u^4} x^{-1/4} du\n\\]\nThe integral \\(\\int_{-\\infty}^{\\infty} e^{-u^4} du\\) is a constant (independent of \\(x\\)), so the leading asymptotic behavior of \\(I(x)\\) as \\(x \\rightarrow \\infty\\) is given by:\n\\[\nI(x) \\sim C x^{-1/4}\n\\]\nwhere \\(C\\) is the value of the integral \\(\\int_{-\\infty}^{\\infty} e^{-u^4} du\\), which can be evaluated numerically.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 08"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw09.html",
    "href": "docs/courses/phys231/phys231_hw09.html",
    "title": "Homework 09",
    "section": "",
    "text": "Show using steepest descent that the leading asymptotics of \\(\\Gamma(z)\\) for \\(z=r e^{i \\theta}, r \\rightarrow \\infty, \\operatorname{Re} z&gt;0\\), are given by the complex Stirling approximation\n\\[\n\\Gamma(z) \\sim e^{-z} z^z\\left(\\frac{2 \\pi}{z}\\right)^{1 / 2} .\n\\]\n\nThe Gamma function\n\\[\n\\Gamma(z) = \\int_{0}^{\\infty} t^{z-1} e^{-t} dt\n\\]\nafter performing a change of variables by setting \\(t = zu\\), which yields:\n\\[\n\\Gamma(z) = z^z \\int_{0}^{\\infty} u^{z-1} e^{-zu} du\n\\]\nThe method of steepest descent involves analyzing the integrand’s behavior around its saddle points, where the first derivative of the exponent vanishes. For our integral, the exponent is \\(-zu + (z-1)\\log(u)\\). The saddle point occurs where its derivative with respect to \\(u\\) is zero. This gives us:\n\\[\n-z + \\frac{z-1}{u} = 0\n\\]\n\\[\nu = \\frac{z-1}{z} \\approx 1 \\quad \\text{for large } z\n\\]\nNear the saddle point \\(u = 1\\), we approximate the exponent by a second-order Taylor expansion:\n\\[\n-zu + (z-1)\\log(u) \\approx -z + (z-1)\\log(z) - \\frac{z}{2}(u-1)^2\n\\]\nThe integral can now be approximated as:\n\\[\n\\Gamma(z) \\approx z^z e^{-z} e^{(z-1)\\log(z)} \\int_{-\\infty}^{\\infty} e^{-\\frac{z}{2}(u-1)^2} du\n\\]\nWith the Gaussian integral evaluates to:\n\\[\n\\int_{-\\infty}^{\\infty} e^{-\\frac{z}{2}(u-1)^2} du = \\sqrt{\\frac{2\\pi}{z}}\n\\]\nWe get:\n\\[\n\\Gamma(z) \\sim e^{-z} z^z \\left(\\frac{2\\pi}{z}\\right)^{\\frac{1}{2}}\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 09"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw09.html#stirling-approximation",
    "href": "docs/courses/phys231/phys231_hw09.html#stirling-approximation",
    "title": "Homework 09",
    "section": "",
    "text": "Show using steepest descent that the leading asymptotics of \\(\\Gamma(z)\\) for \\(z=r e^{i \\theta}, r \\rightarrow \\infty, \\operatorname{Re} z&gt;0\\), are given by the complex Stirling approximation\n\\[\n\\Gamma(z) \\sim e^{-z} z^z\\left(\\frac{2 \\pi}{z}\\right)^{1 / 2} .\n\\]\n\nThe Gamma function\n\\[\n\\Gamma(z) = \\int_{0}^{\\infty} t^{z-1} e^{-t} dt\n\\]\nafter performing a change of variables by setting \\(t = zu\\), which yields:\n\\[\n\\Gamma(z) = z^z \\int_{0}^{\\infty} u^{z-1} e^{-zu} du\n\\]\nThe method of steepest descent involves analyzing the integrand’s behavior around its saddle points, where the first derivative of the exponent vanishes. For our integral, the exponent is \\(-zu + (z-1)\\log(u)\\). The saddle point occurs where its derivative with respect to \\(u\\) is zero. This gives us:\n\\[\n-z + \\frac{z-1}{u} = 0\n\\]\n\\[\nu = \\frac{z-1}{z} \\approx 1 \\quad \\text{for large } z\n\\]\nNear the saddle point \\(u = 1\\), we approximate the exponent by a second-order Taylor expansion:\n\\[\n-zu + (z-1)\\log(u) \\approx -z + (z-1)\\log(z) - \\frac{z}{2}(u-1)^2\n\\]\nThe integral can now be approximated as:\n\\[\n\\Gamma(z) \\approx z^z e^{-z} e^{(z-1)\\log(z)} \\int_{-\\infty}^{\\infty} e^{-\\frac{z}{2}(u-1)^2} du\n\\]\nWith the Gaussian integral evaluates to:\n\\[\n\\int_{-\\infty}^{\\infty} e^{-\\frac{z}{2}(u-1)^2} du = \\sqrt{\\frac{2\\pi}{z}}\n\\]\nWe get:\n\\[\n\\Gamma(z) \\sim e^{-z} z^z \\left(\\frac{2\\pi}{z}\\right)^{\\frac{1}{2}}\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 09"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw09.html#airy-function",
    "href": "docs/courses/phys231/phys231_hw09.html#airy-function",
    "title": "Homework 09",
    "section": "2 Airy function",
    "text": "2 Airy function\n\nConsider the time-independent Schrodinger equation for a linear potential:\n\\[\n\\frac{d^2}{d x^2} \\psi(x)=x \\psi(x) \\text {. }\n\\]\n\nShow that the “Airy function” defined by\n\\[\nA i(x)=\\frac{1}{2 \\pi} \\int_{-\\infty}^{\\infty} e^{i x y+i y^3 / 3} d y\n\\]\nsolves the equation above.\nDetermine the saddle points of \\(i x y+i y^3 / 3\\) in the \\(y\\) plane and make a change of variables to the integral so that these saddle points are not moving. Determine the direction of steepest descent on the constant phase contours through these saddle points for each argument of complex \\(x\\).\nFind the steepest descent contour for \\(A i(x)\\) for \\(x \\rightarrow e^{i \\alpha} \\infty\\) for each \\(\\alpha\\). Determine the leading asymptotics for each \\(\\alpha\\).\n\n\n\n2.1 Verifying the Airy Function as a Solution\nTaking the Fourier transform on both sides of equation we get\n\\[\n\\mathcal{F}\\left(\\frac{d^2 y}{d x^2}\\right)=\\mathcal{F}(x y),\n\\]\nFor the L.H.S., we get\n\\[\n\\mathcal{F}\\left(\\frac{d^2 y}{d x^2}\\right)=\\frac{1}{2 \\pi} \\int_{-\\infty}^{+\\infty} \\frac{d^2 y}{d x^2} e^{-i k x} d x = =-k^2 \\mathcal{F}(y) .\n\\]\nFor the R.H.S. based on the derivative of the Fourier transform with respect to \\(k\\) we get,\n\\[\n\\frac{d}{d k} \\mathcal{F}(y)=\\frac{d}{d k}\\left(\\frac{1}{2 \\pi} \\int_{-\\infty}^{+\\infty} y e^{-i k x} d x\\right),\n\\]\nTherefore,\n\\[\n\\frac{d}{d k} \\mathcal{F}(y)=\\frac{1}{2 \\pi} \\int^{+\\infty} \\frac{d}{d k}\\left(y e^{-i k x}\\right) d x=\\frac{1}{2 \\pi} \\int^{+\\infty}(-i x) y e^{-i k x} d x\n\\]\nWe have\n\\[\n\\mathcal{F}(x y)=i \\frac{d \\mathcal{F}(y)}{d k},\n\\]\nSo the equation becomes\n\\[\n-k^2 \\mathcal{F}(y)=i \\frac{d \\mathcal{F}(y)}{d k},\n\\]\nthe only solution is\n\\[\n\\mathcal{F}(y)=e^{i \\frac{k^3}{3}},\n\\]\ntaking the inverse Fourier transform, we get a solution satisfying the differential equation. Hence we have the final solution as\n\\[\ny=A i(x)=\\frac{1}{2 \\pi} \\int_{-\\infty}^{+\\infty} e^{i\\left(k x+\\frac{k^3}{3}\\right)} d k .\n\\]\n\n\n2.2 Saddle Points\nThe exponent in the integral is \\(ixy + \\frac{i}{3}y^3\\). To find the saddle points, we set the derivative of this expression with respect to \\(y\\) equal to zero:\n\\[\nix + iy^2 = 0\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 09"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw09.html#zepsilon-function",
    "href": "docs/courses/phys231/phys231_hw09.html#zepsilon-function",
    "title": "Homework 09",
    "section": "3 \\(Z(\\epsilon)\\) function",
    "text": "3 \\(Z(\\epsilon)\\) function\n\nCompute the all-orders asymptotic series for\n\\[\nZ(\\epsilon)=\\int d x e^{-x^2-\\epsilon x^4} \\quad \\epsilon \\rightarrow 0^{+}\n\\]\nand then use Borel summation to evaluate the integral.\n\nThe expansion is based on the Taylor series of \\(e^{-\\epsilon x^4}\\) around \\(\\epsilon = 0\\):\n\\[\ne^{-\\epsilon x^4} = \\sum_{n=0}^{\\infty} \\frac{(-\\epsilon x^4)^n}{n!}\n\\]\nSubstituting this series into the integral and integrating term by term, we get:\n\\[\nZ(\\epsilon) = \\sum_{n=0}^{\\infty} \\frac{(-\\epsilon)^n}{n!} \\int dx\\, x^{4n} e^{-x^2}\n\\]\nEach term in this series can be integrated using standard methods, often involving gamma functions for even powers of \\(x\\).\nThe Borel sum is then given by an integral of the Borel transform against an exponential:\n\\[\n\\tilde{Z}(\\epsilon) = \\int_0^\\infty e^{-t} B(t \\epsilon) dt\n\\]\nwhere \\(B(t)\\) is the Borel transform of the series.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 09"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw05.html",
    "href": "docs/courses/phys231/phys231_hw05.html",
    "title": "Homework 05",
    "section": "",
    "text": "Compute this generalization of an integral we did in class:\n\\[\nI_{n,a}(k) = \\int^{∞}_{−∞} \\frac{ e^{ikx} }{ (x^2 + a^2)^n} dx\n\\]\nwhere \\(k, a \\in {\\mathbb{R}}, a &gt; 0\\) and \\(n \\in {\\mathbb{Z}}, n \\geq 1\\). What is the degree of differentiability of \\(I_{n,a}(k)\\) with respect to \\(k\\)? How does this relate to the decay of the integrand?\n\n\n\nComplex function \\(f(z) = \\frac{e^{ikz}}{(z^2 + a^2)^n}\\) has poles at \\(z = \\pm i a\\).\nThe residue at \\(z = + i a\\) pole\n\\[\n\\text{Res}(f, ia) = \\frac{1}{(n-1)!} \\lim_{z \\to ia} \\frac{d^{n-1}}{dz^{n-1}} \\left[ (z - ia)^n f(z) \\right]\n\\]\nConstruct a semicircular contour in the upper half-plane that consists of a line segment \\(C_1\\) from \\(−R\\) to \\(R\\) and a semicircular arc \\(C_2\\) of radius \\(R\\) centered at the origin.\nThe integral over the contour \\(C\\) is:\n\\[\n\\int_C f(z) dz = 2\\pi i \\times \\text{Res}(f, ia)\n\\]\nAs \\(R \\to \\infty\\), the integral over \\(C_2\\) vanishes for \\(k&gt;0\\) due to the exponential decay of \\(e^{ikz}\\) in the upper half-plane.\nThe original integral \\(I_{n,a}(k)\\) is equal to the integral over \\(C_1\\):\n\\[\nI_{n,a}(k) = 2\\pi i \\times \\text{Res}(f, ia)\n\\]\n\n\n\n\\[\nI_{n,a}'(k) = \\int^{∞}_{−∞} \\frac{ ix e^{ikx} }{ (x^2 + a^2)^n} dx\n\\]\nThe corresponding complex function\n\\[\nf_k(z) = \\frac{i z e^{ikz}}{(z^2 + a^2)^n}\n\\]\nhas poles at \\(z = \\pm i a\\).\nThe function \\(I_{n,a}(k)\\) will be infinitely differentiable with respect to \\(k\\) because the exponential function \\(e^{ikx}\\) is smooth and the denominator does not depend on \\(k\\).\n\n\n\nThe decay of the integrand as \\(x \\to \\pm\\infty\\) is crucial for the convergence of the integral. The factor \\((x^2 + a^2)^{-n}\\) ensures that the integrand decays sufficiently fast at infinity for the integral to converge.\nThe faster decay of the integrand at infinity, which is ensured by a higher \\(n\\), means that \\(I_{n,a}(k)\\) will be more regular (i.e., higher degree of differentiability).",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 05"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw05.html#integral-differentiability-and-decay-rate",
    "href": "docs/courses/phys231/phys231_hw05.html#integral-differentiability-and-decay-rate",
    "title": "Homework 05",
    "section": "",
    "text": "Compute this generalization of an integral we did in class:\n\\[\nI_{n,a}(k) = \\int^{∞}_{−∞} \\frac{ e^{ikx} }{ (x^2 + a^2)^n} dx\n\\]\nwhere \\(k, a \\in {\\mathbb{R}}, a &gt; 0\\) and \\(n \\in {\\mathbb{Z}}, n \\geq 1\\). What is the degree of differentiability of \\(I_{n,a}(k)\\) with respect to \\(k\\)? How does this relate to the decay of the integrand?\n\n\n\nComplex function \\(f(z) = \\frac{e^{ikz}}{(z^2 + a^2)^n}\\) has poles at \\(z = \\pm i a\\).\nThe residue at \\(z = + i a\\) pole\n\\[\n\\text{Res}(f, ia) = \\frac{1}{(n-1)!} \\lim_{z \\to ia} \\frac{d^{n-1}}{dz^{n-1}} \\left[ (z - ia)^n f(z) \\right]\n\\]\nConstruct a semicircular contour in the upper half-plane that consists of a line segment \\(C_1\\) from \\(−R\\) to \\(R\\) and a semicircular arc \\(C_2\\) of radius \\(R\\) centered at the origin.\nThe integral over the contour \\(C\\) is:\n\\[\n\\int_C f(z) dz = 2\\pi i \\times \\text{Res}(f, ia)\n\\]\nAs \\(R \\to \\infty\\), the integral over \\(C_2\\) vanishes for \\(k&gt;0\\) due to the exponential decay of \\(e^{ikz}\\) in the upper half-plane.\nThe original integral \\(I_{n,a}(k)\\) is equal to the integral over \\(C_1\\):\n\\[\nI_{n,a}(k) = 2\\pi i \\times \\text{Res}(f, ia)\n\\]\n\n\n\n\\[\nI_{n,a}'(k) = \\int^{∞}_{−∞} \\frac{ ix e^{ikx} }{ (x^2 + a^2)^n} dx\n\\]\nThe corresponding complex function\n\\[\nf_k(z) = \\frac{i z e^{ikz}}{(z^2 + a^2)^n}\n\\]\nhas poles at \\(z = \\pm i a\\).\nThe function \\(I_{n,a}(k)\\) will be infinitely differentiable with respect to \\(k\\) because the exponential function \\(e^{ikx}\\) is smooth and the denominator does not depend on \\(k\\).\n\n\n\nThe decay of the integrand as \\(x \\to \\pm\\infty\\) is crucial for the convergence of the integral. The factor \\((x^2 + a^2)^{-n}\\) ensures that the integrand decays sufficiently fast at infinity for the integral to converge.\nThe faster decay of the integrand at infinity, which is ensured by a higher \\(n\\), means that \\(I_{n,a}(k)\\) will be more regular (i.e., higher degree of differentiability).",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 05"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw05.html#integral-of-a-keyhole-contour",
    "href": "docs/courses/phys231/phys231_hw05.html#integral-of-a-keyhole-contour",
    "title": "Homework 05",
    "section": "2. Integral of a keyhole contour",
    "text": "2. Integral of a keyhole contour\n\nCompute the following integral by a choice of keyhole contour, where \\(a, b, c ∈ {\\mathbb{R}}\\) and \\(b, c &gt; 0\\):\n\\[\nI(a, b, c) = \\int^∞_{−∞} dx \\frac{\\log(x^2 + c^2)}{ (x − a)^2 + b^2}\n\\]\n\nThe complex function\n\\[\nf(z) = \\frac{\\log(z^2 + c^2)}{ (z − a)^2 + b^2} = \\frac{\\log(z+ ic)}{ (z − a)^2 + b^2} + \\frac{\\log(z - ic)}{ (z − a)^2 + b^2}\n\\]\nmay have branch point \\(𝑧 = \\pm 𝑖c\\) and have poles at \\(a \\pm ib\\).\nConsider the contour integral \\(\\oint_C dz f(z)\\)in the complex plane where \\(𝐶\\) is a semicircle of radius \\(R\\) in the upper half-plane with a detour down and up the imaginary axis about the branch point \\(z=ic\\).\n\nThe function \\(\\log(z + ic)\\) is holomorphic in the upper half plane if we choose its branch cut to lie in the lower half plane, so the integrand is holomorphic inside the contour of \\(C\\) except for a simple pole at \\(a + ib\\).\n\\[\n\\oint_C dz \\frac{\\log(z+ ic)}{ (z − a)^2 + b^2} = 2 \\pi i \\frac{\\log(a+ib+ic)}{2ib} = \\frac{\\pi}{b} \\log(a+ib+ic)\n\\]\nThe function \\(\\log(z - ic)\\) has a branch cut in the upper half plane. We have\n\\[\n\\oint_C dz \\frac{\\log(z - ic)}{ (z − a)^2 + b^2} = \\frac{\\pi}{b} \\log(a + ib - ic) + \\int_{ic}^{\\infty} \\frac{ \\log (iy-ic+\\epsilon) - \\log (iy-ic+\\epsilon)}{ (z-a)^2+b^2}\n\\]\nSince the contribution from the big semi-circle tends to zero as \\(R → ∞\\) and from the small circle around \\(ic\\) as its radius tends to zero. And\n\\[\n\\int_{ic}^{\\infty} \\frac{ \\log (iy-ic+\\epsilon) - \\log (iy-ic+\\epsilon)}{ (z-a)^2+b^2} = -2 \\pi \\int_c^{\\infty}dy \\frac{1}{(iy-a)^2+b^2} = - \\frac{\\pi}{b}\\log \\frac{a+ib-ic}{a-ib-ic}\n\\]\nSo\n\\[\n\\begin{align*}\nI(a, b, c)\n&= \\int^∞_{−∞} dx \\frac{\\log(x^2 + c^2)}{ (x − a)^2 + b^2} \\\\\n&= \\frac{\\pi}{b} \\log(a+ib+ic) + \\frac{\\pi}{b} \\log(a+ib-ic) - - \\frac{\\pi}{b}\\log \\frac{a+ib-ic}{a-ib-ic} \\\\\n&= \\frac{\\pi}{b} \\log(a^2+(b+c)^2)\n\\end{align*}\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 05"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw05.html#integral-and-laurent-expansion",
    "href": "docs/courses/phys231/phys231_hw05.html#integral-and-laurent-expansion",
    "title": "Homework 05",
    "section": "3. Integral and Laurent expansion",
    "text": "3. Integral and Laurent expansion\n\nConsider the integral\n\\[\n\\int_C dz \\frac{z + 2}{ z^2 − 9}\n\\]\nwhere \\(C\\) is a positively-oriented circle of radius 4. Compute this integral by taking the sum of the residues inside the circle, and then again by computing the “residue at \\(∞\\)” meaning using the outer Laurent expansion\n\nThe integrand\n\\[\nf(z) = \\frac{z + 2}{z^2 - 9}\n\\]\nhave simple poles at \\(z =\\pm 3\\).\n\\[\n\\text{Res}(f, 3) = \\lim_{z \\to 3} (z - 3) \\frac{z + 2}{z^2 - 9} = \\frac{5}{6}\n\\]\n\\[\n\\text{Res}(f, -3) = \\lim_{z \\to -3} (z + 3) \\frac{z + 2}{z^2 - 9} = \\frac{1}{6}\n\\]\nBy the residue theorem, the integral over the contour \\(C\\) is:\n\\[\n\\int_C f(z) , dz = 2\\pi i \\times (\\text{Res}(f, 3) + \\text{Res}(f, -3)) = 2\\pi i\n\\]\nUsing the outer Laurent expansion\n\\[\n\\frac{z + 2}{z^2 - 9} = \\frac{1}{z} + O[\\frac{1}{z^2}]\n\\]\nSo using residue at \\(∞\\)\n\\[\n\\text{Res}(f, ∞) = 1\n\\] \\[\n\\int_C f(z) , dz = 2\\pi i \\times \\text{Res}(f, ∞) = 2\\pi i\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 05"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw05.html#analytically-continuing",
    "href": "docs/courses/phys231/phys231_hw05.html#analytically-continuing",
    "title": "Homework 05",
    "section": "4. Analytically continuing",
    "text": "4. Analytically continuing\n\nCompute the integral\n\\[\n\\int^{2π}_{0} \\frac{dθ}{2 − \\cos θ  }\n\\]\nby analytically continuing the integrand and then using residues.\n\nPerform a change of variables to convert the integral into a contour integral in the complex plane.\nLet \\(z = e^{i\\theta}\\). Then, \\(dz = ie^{i\\theta}d\\theta = izd\\theta\\) and \\(d\\theta = \\frac{dz}{iz}\\). Also, \\(\\cos \\theta = \\frac{1}{2}(e^{i\\theta} + e^{-i\\theta}) = \\frac{1}{2}(z + \\frac{1}{z})\\).\nSubstituting these into the integral, we get:\n\\[\n\\int^{2π}_{0} \\frac{dθ}{2 − \\cos θ  } = \\int_{|z|=1} \\frac{1}{2 - \\frac{1}{2}(z + \\frac{1}{z})} \\times \\frac{dz}{iz}\n\\]\nSimplifying this, we have:\n\\[\n\\int_{|z|=1} \\frac{dz}{2iz - \\frac{1}{2}i(z^2 + 1)}\n\\]\nTo find the poles of the integrand, we set the denominator to zero:\n\\[\niz - \\frac{1}{2}i(z^2 + 1) =0\n\\]\n\\[\nz_1=2-\\sqrt{3}, z_2=2+\\sqrt{3}\n\\]\n\\(z_1\\) is within the contour, so\n\\[\n\\int_{|z|=1} \\frac{1}{2 - \\frac{1}{2}(z + \\frac{1}{z})} \\times \\frac{dz}{iz} = 2 \\pi i \\frac{2}{i(z_2-z_1)} = \\frac {2 \\pi}{\\sqrt 3}\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 05"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw05.html#gamma-function",
    "href": "docs/courses/phys231/phys231_hw05.html#gamma-function",
    "title": "Homework 05",
    "section": "5. Gamma function",
    "text": "5. Gamma function\n\nThe Gamma function is usually defined as\n\\[\nΓ(z) = \\int^∞_0 t^{z−1}e^{−t}dt\n\\]\n(This kind of integral is known as a Mellin transform, in this case of \\(e^{−t}\\), and we can equivalently write it as a two-sided Laplace transform of \\(e^{−e^s}\\) by taking \\(s = \\log t\\).) Verify this integral exists for \\(\\Re(z) &gt; 0\\) and that\n\\[\nzΓ(z) = Γ(z + 1)\n\\] \\[\nΓ(n + 1) = n!\n\\]\nThe first relation can be iterated to analytically continue the \\(Γ\\) function to the whole complex plane, except for poles at the nonpositive integers. However, there is a way to analytically continue it all at once:\nSplit the integral into two parts \\(\\int^∞_ 1 +\\int^1_0\\) . Show that the first part yields an entire function in \\(z\\), and that the second part equals\n\\[\n\\sum_{n=0}^\\infty \\frac{(−1)^n}{n!} \\frac{1}{ z + n}\n\\]\nwhich is an entire meromorphic function with poles at the non-positive integers, thus giving an analytic continuation of \\(Γ\\) as a meromorphic function on all of \\({\\mathbb{C}}\\).\n\nTo verify the properties of the Gamma function and its analytic continuation, we’ll break down the problem into parts.\n\nExistence\nWe prove this integral converges absolutely.\n\\[\n\\int\\limits_0^\\infty |t^{z-1}e^{-t}| dt  = \\int\\limits_0^\\infty t^{\\operatorname{Re} z-1}e^{-t} dt\n\\]\nFor \\(z \\in {\\mathbb{R}}\\),\n\\[\n\\int\\limits_0^\\infty t^{z-1}e^{-t}dt = \\int\\limits_0^1 t^{z-1}e^{-t}dt + \\int\\limits_1^\\infty t^{z-1}e^{-t}dt\n\\]\nwe have for large \\(N \\le t,\\) \\(t^{z-1}e^{-t}\\le e^{-t/2}\\)\n\\[\n0\\le t\\le N \\implies t^{z-1}e^{-t}\\le t^{z-1}\n\\;,\\;\\;\\text{and}\\;\\;\n\\int\\limits_0^N t^{z-1}dt=\\left.\\frac{t^z}z\\right|_0^N=\\frac{N^z}{z}\n\\]\n\\[\nN \\le t\\implies t^{z-1}e^{-t}\\le e^{-t/2}\n\\;,\\;\\;\\text{and}\\;\\;\n\\int\\limits_N^\\infty e^{-t/2} dt=\\left. -2 e^{-t/2}\\right|_N^\\infty= 2e^{-N/2}\n\\]\nSo\n\\[\n\\int\\limits_0^\\infty |t^{z-1}e^{-t}| dt  \\le \\infty\n\\]\nTherefore, this integral exists for \\(\\Re(z) &gt; 0\\).\n\n\n\\(zΓ(z) = Γ(z + 1)\\)\nBy definition:\n\\[\nz\\Gamma(z) = z \\int_{0}^{\\infty} t^{z-1}e^{-t} dt\n\\]\nUsing integration by parts, we get:\n\\[\n\\begin{aligned}\nz\\Gamma(z)\n&= \\left. t^z e^{-t} \\right| _{0}^{\\infty} - \\int_{0}^{\\infty} t^{z} (-e^{-t}) dt \\\\\n&= \\int_{0}^{\\infty} t^z e^{-t} dt \\\\\n&= \\Gamma(z + 1)\n\\end{aligned}\n\\]\n\n\n\\(Γ(n + 1) = n!\\)\n\\[\n{\\displaystyle {\\begin{aligned}\\Gamma (1)&=\\int _{0}^{\\infty }t^{1-1}e^{-t}\\,dt\\\\&=\\int _{0}^{\\infty }e^{-t}\\,dt\\\\&=1.\\end{aligned}}}\n\\]\nBy induction we have \\(Γ(n + 1) = n!\\)\n\n\nSplitting\nNow, to analytically continue the Gamma function, we split the integral into two parts:\n\\[\n\\Gamma(z) = \\int_{1}^{\\infty} t^{z-1}e^{-t} dt + \\int_{0}^{1} t^{z-1}e^{-t} dt\n\\]\n\nThe first part \\(\\int_{1}^{\\infty} t^{z-1}e^{-t} dt = (\\int_{1}^{N} + \\int_{N}^{\\infty}) t^{z-1}e^{-t} dt\\) converges for all \\(z\\) and is an entire function in \\(z\\).\nThe second part \\(\\int_{0}^{1} t^{z-1}e^{-t} dt\\) ) can be expressed as a power series using the Taylor expansion of \\(e^{-t}\\) :\n\n\\[\n\\int_{0}^{1} t^{z-1}e^{-t}dt\n= \\int_{0}^{1} t^{z-1} \\sum_{n=0}^{\\infty} \\frac{(-1)^n}{n!} t^n dt\n= \\sum_{n=0}^{\\infty} \\frac{(-1)^n}{n!} \\int_{0}^{1} t^{z + n - 1} dt\n= \\sum_{n=0}^{\\infty} \\frac{(-1)^n}{n!} \\frac{1}{z + n}\n\\]\nThis series converges for ( z ) not a non-positive integer and provides an analytic continuation of \\(\\Gamma\\) as a meromorphic function on all of \\(\\mathbb{C}\\), with poles at the non-positive integers.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 05"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw05.html#gamma-relation",
    "href": "docs/courses/phys231/phys231_hw05.html#gamma-relation",
    "title": "Homework 05",
    "section": "6. Gamma relation",
    "text": "6. Gamma relation\n\nProve the relation\n\\[\nΓ(z)Γ(1 − z) = \\frac{π} {\\sin πz}\n\\]\nby combining the two Gamma integrals into\n\\[\nΓ(z)Γ(1 − z) = \\int^∞_0 dt \\frac{t^{z−1}}{t + 1}\n\\]\nand evaluating this by residues.\n\n\\[\n\\Gamma(z) = \\int_{0}^{\\infty} t^{z-1}e^{-t} dt\n\\]\nFor fixed \\(t\\)\n\\[\n\\Gamma(1 - z)\n= \\int_{0}^{\\infty} t^{-z}e^{-t} dt\n= \\int_{0}^{\\infty} u^{-z}e^{-u} du\n= t \\int_{0}^{\\infty} (vt)^{-z}e^{-vt} dv\n\\]\nBy combining these two\n\\[\nΓ(z)Γ(1 − z)\n= \\int^∞_0\\int^∞_0  e^{-t(1+v)} v^{-z} dvdt\n= \\int^∞_0 dv \\frac{v^{z−1}}{v + 1}\n= \\int^∞_0 dt \\frac{t^{z−1}}{t + 1}\n= \\int^∞_{-∞} dt \\frac{e^{zx}}{ 1+e^x }\n\\]\nComplex function\n\\[\n\\frac{e^{zx}}{ 1+e^x }\n\\]\nhave pole at \\(\\pi i\\). Consider a contour \\(C_R\\) in the complex plane with vertices at \\(R\\), \\(−R\\), \\(R+2πi\\), and \\(−R+2πi\\), as \\(R\\) tends to infinity. We have\n\\[\n{\\displaystyle \\int _{C_{R}}{\\frac {e^{xz}}{1+e^{x}}} dx=-2\\pi ie^{z \\pi i}}\n\\] \\[\n\\int _{C_{R3}}{f(x,z)} dx = -e^{2\\pi i z} \\int _{C_{R1}}{f(x,z)} dx\n\\]\nThe right and left vertical sides of the rectangle tend to 0 as \\(R \\to \\infty\\) for \\(z \\in (0,1)\\).\n\\[\n\\int^∞_{-∞} dt \\frac{e^{zx}}{ 1+e^x } = \\frac{-2\\pi ie^{z \\pi i}}{1-e^{2\\pi i z}} = \\frac{\\pi}{\\sin \\pi z}\n\\]\nBy analytic continuation, this relation is true for all \\(z \\in {\\mathbb{C}}/\\ {\\mathbb{Z}}\\)",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 05"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw06.html",
    "href": "docs/courses/phys231/phys231_hw06.html",
    "title": "Homework 06",
    "section": "",
    "text": "Consider the equation\n\\[\nx^{\\prime \\prime}(t)+2 \\gamma x(t)+\\omega_0^2 x(t)=f(t) .\n\\]\nUsing the Green’s function for this equation, which satisfies\n\\[\nG^{\\prime \\prime}(t)+2 \\gamma G^{\\prime}(t)+\\omega_0^2 G(t)=\\delta(t)\n\\]\nderive the response \\(x(t)\\) to a square pulse\n\\[\nf(t)=\\left\\{\\begin{array}{ll}\n1 & 0 \\leq t \\leq 1 \\\\\n0 & \\text { otherwise }\n\\end{array} .\\right.\n\\]\nDo this by solving for \\(\\tilde{G}(\\omega)\\) in the Fourier domain and note\n\\[\n\\tilde{x}(\\omega)=\\tilde{G}(\\omega) \\tilde{f}(\\omega)\n\\]\n(Note that when inverting this Fourier transform it is important to treat this as a distribution.) Check that \\(x(t)\\) is causal and check that its Fourier transform \\(\\tilde{x}(\\omega)\\) satisfies the Kramers-Kronig relations.\n\nThe differential equation for \\(G(t)\\) in the Fourier domain is\n\\[\n(-\\omega^2 + 2i\\gamma\\omega + \\omega_0^2) \\tilde{G}(\\omega) = 1\n\\]\nSo\n\\[\n\\tilde{G}(\\omega) = \\frac{1}{-\\omega^2 + 2i \\gamma \\omega + \\omega_0^2}\n\\]\nIts Fourier transform \\(\\tilde{f}(\\omega)\\) is given by:\n\\[\n\\tilde{f}(\\omega) = \\int_{-\\infty}^{\\infty} f(t) e^{-i\\omega t} \\, dt = \\int_{0}^{1} e^{-i\\omega t} \\, dt\n\\]\n\\[\n\\tilde{f}(\\omega) = \\left. \\frac{-1}{i\\omega} e^{-i\\omega t} \\right|_0^1 = \\frac{1 - e^{-i\\omega}}{i\\omega}\n\\]\nNow, we use the relation \\(\\tilde{x}(\\omega) = \\tilde{G}(\\omega) \\tilde{f}(\\omega)\\):\n\\[\n\\tilde{x}(\\omega) = \\frac{1}{-\\omega^2 + 2i\\gamma\\omega + \\omega_0^2} \\cdot \\frac{1 - e^{-i\\omega}}{i\\omega}\n\\]\nTo find \\(x(t)\\), we compute the inverse Fourier transform of \\(\\tilde{x}(\\omega)\\).\n\\[\nx(t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\tilde{x}(\\omega) e^{i\\omega t} \\, d\\omega\n\\]\nWe use contour integration in the complex plane to calculate this.\n\\(\\tilde{x}(\\omega)\\) has poles at \\(p_1 = iγ+\\sqrt{\\omega_0^2-\\gamma^2}, p_2=iγ-\\sqrt{\\omega_0^2-\\gamma^2}\\)\nThe residue at \\(p_1\\) is\n\\[\n\\frac{\ne^{-\\gamma +\n  (\\gamma + \\sqrt{\\gamma^2 - \\omega_0^2}) (1 - t)} (e^\\gamma - e^{\n   \\sqrt{\\gamma^2 - \\omega_0^2}})\n}\n{2 \\sqrt{-\\gamma^2 +\n  \\omega_0^2} (-\\gamma +\\sqrt{\\gamma^2-\\omega_0^2})}\n\\]\n…\nWe can see that \\(x(t) = 0\\) for \\(t&lt;0\\), which means \\(x(t)\\) is causal.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 06"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw06.html#greens-function",
    "href": "docs/courses/phys231/phys231_hw06.html#greens-function",
    "title": "Homework 06",
    "section": "",
    "text": "Consider the equation\n\\[\nx^{\\prime \\prime}(t)+2 \\gamma x(t)+\\omega_0^2 x(t)=f(t) .\n\\]\nUsing the Green’s function for this equation, which satisfies\n\\[\nG^{\\prime \\prime}(t)+2 \\gamma G^{\\prime}(t)+\\omega_0^2 G(t)=\\delta(t)\n\\]\nderive the response \\(x(t)\\) to a square pulse\n\\[\nf(t)=\\left\\{\\begin{array}{ll}\n1 & 0 \\leq t \\leq 1 \\\\\n0 & \\text { otherwise }\n\\end{array} .\\right.\n\\]\nDo this by solving for \\(\\tilde{G}(\\omega)\\) in the Fourier domain and note\n\\[\n\\tilde{x}(\\omega)=\\tilde{G}(\\omega) \\tilde{f}(\\omega)\n\\]\n(Note that when inverting this Fourier transform it is important to treat this as a distribution.) Check that \\(x(t)\\) is causal and check that its Fourier transform \\(\\tilde{x}(\\omega)\\) satisfies the Kramers-Kronig relations.\n\nThe differential equation for \\(G(t)\\) in the Fourier domain is\n\\[\n(-\\omega^2 + 2i\\gamma\\omega + \\omega_0^2) \\tilde{G}(\\omega) = 1\n\\]\nSo\n\\[\n\\tilde{G}(\\omega) = \\frac{1}{-\\omega^2 + 2i \\gamma \\omega + \\omega_0^2}\n\\]\nIts Fourier transform \\(\\tilde{f}(\\omega)\\) is given by:\n\\[\n\\tilde{f}(\\omega) = \\int_{-\\infty}^{\\infty} f(t) e^{-i\\omega t} \\, dt = \\int_{0}^{1} e^{-i\\omega t} \\, dt\n\\]\n\\[\n\\tilde{f}(\\omega) = \\left. \\frac{-1}{i\\omega} e^{-i\\omega t} \\right|_0^1 = \\frac{1 - e^{-i\\omega}}{i\\omega}\n\\]\nNow, we use the relation \\(\\tilde{x}(\\omega) = \\tilde{G}(\\omega) \\tilde{f}(\\omega)\\):\n\\[\n\\tilde{x}(\\omega) = \\frac{1}{-\\omega^2 + 2i\\gamma\\omega + \\omega_0^2} \\cdot \\frac{1 - e^{-i\\omega}}{i\\omega}\n\\]\nTo find \\(x(t)\\), we compute the inverse Fourier transform of \\(\\tilde{x}(\\omega)\\).\n\\[\nx(t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\tilde{x}(\\omega) e^{i\\omega t} \\, d\\omega\n\\]\nWe use contour integration in the complex plane to calculate this.\n\\(\\tilde{x}(\\omega)\\) has poles at \\(p_1 = iγ+\\sqrt{\\omega_0^2-\\gamma^2}, p_2=iγ-\\sqrt{\\omega_0^2-\\gamma^2}\\)\nThe residue at \\(p_1\\) is\n\\[\n\\frac{\ne^{-\\gamma +\n  (\\gamma + \\sqrt{\\gamma^2 - \\omega_0^2}) (1 - t)} (e^\\gamma - e^{\n   \\sqrt{\\gamma^2 - \\omega_0^2}})\n}\n{2 \\sqrt{-\\gamma^2 +\n  \\omega_0^2} (-\\gamma +\\sqrt{\\gamma^2-\\omega_0^2})}\n\\]\n…\nWe can see that \\(x(t) = 0\\) for \\(t&lt;0\\), which means \\(x(t)\\) is causal.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 06"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw06.html#different-drive-function",
    "href": "docs/courses/phys231/phys231_hw06.html#different-drive-function",
    "title": "Homework 06",
    "section": "2 Different drive function",
    "text": "2 Different drive function\n\nSolve the equation in problem 1 with the drive\n\\[\nf(t)=\\left\\{\\begin{array}{ll}\ne^{-t} & t \\geq 0 \\\\\n0 & t&lt;0\n\\end{array} .\\right.\n\\]\n\nThe solution can be expressed as the convolution of the Green’s function with the driving force \\(f(t)\\):\n\\[\nx(t) = \\int_{-\\infty}^{\\infty} G(t - \\tau) f(\\tau) d\\tau\n\\]\nThe form of \\(G(t)\\) depends on the values of \\(\\gamma\\) and \\(\\omega_0\\). For simplicity, let’s assume \\(\\gamma &gt; 0\\) and \\(\\omega_0 &gt; 0\\). The exact form of \\(G(t)\\) depends on whether the system is underdamped, overdamped, or critically damped. Without loss of generality, let’s assume an underdamped system, where \\(\\gamma^2 &lt; \\omega_0^2\\), which gives a Green’s function of the form:\n\\[\nG(t) = \\Theta(t) \\frac{e^{-\\gamma t}}{\\omega_d} \\sin(\\omega_d t)\n\\]\nwhere \\(\\omega_d = \\sqrt{\\omega_0^2 - \\gamma^2}\\) and \\(\\Theta(t)\\) is the Heaviside step function.\nNow, we compute the convolution integral:\n\\[\nx(t) = \\int_{-\\infty}^{\\infty} G(t - \\tau) f(\\tau) d\\tau\n\\]\nSince \\(f(\\tau) = 0\\) for \\(\\tau &lt; 0\\), the integral simplifies to:\n\\[\nx(t) = \\int_{0}^{t} G(t - \\tau) e^{-\\tau} d\\tau\n\\]\nSubstitute the expression for \\(G(t - \\tau)\\) and carry out the integration:\n\\[\nx(t) = \\int_{0}^{t} \\Theta(t - \\tau) \\frac{e^{-\\gamma (t - \\tau)}}{\\omega_d} \\sin(\\omega_d (t - \\tau)) e^{-\\tau} d\\tau\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 06"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw06.html#greens-function-and-boundary-conditions",
    "href": "docs/courses/phys231/phys231_hw06.html#greens-function-and-boundary-conditions",
    "title": "Homework 06",
    "section": "3 Green’s function and boundary conditions",
    "text": "3 Green’s function and boundary conditions\n\nFind the Green’s function \\(G(x)\\) satisfying\n\\[\n\\frac{d^2}{d x^2} G(x, y)=\\delta(x-y)\n\\]\nwith the boundary conditions \\(G(0, y)=G(1, y)=0\\). Show that with this boundary condition,\n\\[\n\\phi(x)=\\int_0^1 G(x, y) f(y) d y\n\\]\nsatisfies\n\\[\n\\frac{d^2}{d x^2} \\phi(x)=f(x)\n\\]\nand the boundary conditions \\(\\phi(0)=\\phi(1)=0\\).\n\nWe consider two cases, \\(x &lt; y\\) and \\(x &gt; y\\), because the delta function \\(\\delta(x-y)\\) changes the behavior of the solution at \\(x = y\\). We define \\(G(x, y)\\) piecewise for these two cases:\n\nFor \\(x &lt; y\\), let \\(G(x, y) = A(y)x + C(y)\\).\nFor \\(x &gt; y\\), let \\(G(x, y) = B(y)(1 - x) + D(y)\\).\n\nApplying the boundary conditions\n\n\\(G(0, y) = 0\\) gives \\(C(y) = 0\\)\n\\(G(1, y) = 0\\) gives \\(D(y) = 0\\)\n\nThe function \\(G(x, y)\\) itself must be continuous at \\(x = y\\), this gives us:\n\\[\nA(y)y = B(y)(1 - y)\n\\]\nThe derivative \\(\\frac{d}{dx} G(x, y)\\) should have a discontinuity of 1 at \\(x = y\\) (this comes from the delta function). Therefore, the jump at \\(x = y\\) is\n\\[\nA(y) - (-B(y)) = 1\n\\]\nThe solutions for \\(A(y)\\) and \\(B(y)\\) are:\n\\[\nA(y)=1−y, B(y)=y\n\\]\nWith these, the Green’s function \\(G(x, y)\\) for \\(x &lt; y\\) and \\(x &gt; y\\) can be fully specified:\n\nFor \\(x &lt; y\\), \\(G(x, y) = A(y)x = (1 - y)x\\).\nFor \\(x &gt; y\\), \\(G(x, y) = B(y)(1 - x) = y(1 - x)\\).\n\n\nProving \\(\\phi(x)\\) Satisfies the Given Conditions:\nWe differentiate \\(\\phi(x)\\) twice with respect to \\(x\\):\n\\[\n\\frac{d^2}{dx^2} \\phi(x) = \\frac{d^2}{dx^2} \\int_0^1 G(x, y) f(y) dy\n\\]\nBecause \\(G(x, y)\\) is a Green’s function, its second derivative with respect to \\(x\\) is \\(\\delta(x-y)\\). Therefore, the integral becomes:\n\\[\n\\frac{d^2}{dx^2} \\phi(x) = \\int_0^1 \\delta(x-y) f(y) dy\n\\]\nThe delta function picks out the value of \\(f(y)\\) at \\(y = x\\), so:\n\\[\n\\frac{d^2}{dx^2} \\phi(x) = f(x)\n\\]\n\nSince \\(G(0, y) = 0\\), it follows that \\(\\phi(0) = \\int_0^1 G(0, y) f(y) dy = 0\\).\nSimilarly, since \\(G(1, y) = 0\\), it follows that \\(\\phi(1) = \\int_0^1 G(1, y) f(y) dy = 0\\).\n\nTherefore, \\(\\phi(x)\\) satisfies the differential equation with the boundary conditions \\(\\phi(0) = \\phi(1) = 0\\).",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 06"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw06.html#nyquistshannon-sampling-theorem",
    "href": "docs/courses/phys231/phys231_hw06.html#nyquistshannon-sampling-theorem",
    "title": "Homework 06",
    "section": "4 Nyquist–Shannon sampling theorem",
    "text": "4 Nyquist–Shannon sampling theorem\n\nSuppose \\(f(t)\\) is band-limited, meaning its Fourier transform satisfies \\(\\tilde{f}(\\omega)=0\\) for \\(|\\omega| \\geq 2 \\pi \\Lambda\\). If \\(T&lt;1 /(2 \\Lambda)\\), we showed it is possible to reconstruct \\(f(t)\\) from the set of sample values \\(f(n T)\\), where \\(n \\in \\mathbb{Z}\\). Give an explicit formula for \\(f(t)\\) in terms of the sample values.\n\nWhen \\(x(t)\\) is a function with a Fourier transform \\(X(f)\\) :\n\\[\nX(f) \\triangleq \\int_{-\\infty}^{\\infty} x(t) e^{-i 2 \\pi f t} \\mathrm{~d} t\n\\]\nthe Poisson summation formula indicates that the samples, \\(x(n T)\\), of \\(x(t)\\) are sufficient to create a periodic summation of \\(X(f)\\). The result is:\n\\[\nX_s(f) \\triangleq \\sum_{k=-\\infty}^{\\infty} X\\left(f-k f_s\\right)=\\sum_{n=-\\infty}^{\\infty} T \\cdot x(n T) e^{-i 2 \\pi n T f}\n\\]\nWhen there is no overlap of the copies (also known as “images”) of \\(X(f)\\), the \\(k=0\\) term of Eq. 1 can be recovered by the product:\n\\[\nX(f)=H(f) \\cdot X_s(f)\n\\]\nwhere:\n\\[\nH(f) \\triangleq \\begin{cases}1 & |f|&lt;B \\\\ 0 & |f|&gt;f_s-B\\end{cases}\n\\]\nThe sampling theorem is proved since \\(X(f)\\) uniquely determines \\(x(t)\\). All that remains is to derive the formula for reconstruction. \\(H(f)\\) need not be precisely defined in the region \\(\\left[B, f_s-B\\right]\\) because \\(X_s(f)\\) is zero in that region. However, the worst case is when \\(B=f_s / 2\\), the Nyquist frequency. A function that is sufficient for that and all less severe cases is:\n\\[\nH(f)=\\operatorname{rect}\\left(\\frac{f}{f_s}\\right)= \\begin{cases}1 & |f|&lt;\\frac{f_s}{2} \\\\ 0 & |f|&gt;\\frac{f_s}{2}\\end{cases}\n\\]\nwhere rect is the rectangular function. Therefore:\n\\[\n\\begin{aligned}\nX(f) & =\\operatorname{rect}\\left(\\frac{f}{f_s}\\right) \\cdot X_s(f) \\\\\n& =\\operatorname{rect}(T f) \\cdot \\sum_{n=-\\infty}^{\\infty} T \\cdot x(n T) e^{-i 2 \\pi n T f}  \\\\\n& =\\sum_{n=-\\infty}^{\\infty} x(n T) \\cdot \\underbrace{T \\cdot \\operatorname{rect}(T f) \\cdot e^{-i 2 \\pi n T f}}_{\\mathcal{F}\\left\\{\\operatorname{sinc}\\left(\\frac{t-n T}{T}\\right)\\right\\}}\n\\end{aligned}\n\\]\nThe inverse transform of both sides produces the Whittaker-Shannon interpolation formula:\n\\[\nx(t)=\\sum_{n=-\\infty}^{\\infty} x(n T) \\cdot \\operatorname{sinc}\\left(\\frac{t-n T}{T}\\right)\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 06"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw06.html#jacobi-theta-function",
    "href": "docs/courses/phys231/phys231_hw06.html#jacobi-theta-function",
    "title": "Homework 06",
    "section": "5 Jacobi theta function",
    "text": "5 Jacobi theta function\n\nConsider the Jacobi theta function\n\\[\n\\vartheta_3(\\tau)=\\sum_{n=-\\infty}^{\\infty} e^{i \\pi \\tau n^2}\n\\]\nShow by Poisson summation that\n\\[\n\\vartheta_3(-1 / \\tau)=\\sqrt{i \\tau} \\vartheta_3(\\tau)\n\\]\n\nConsider the function \\(f(x) = e^{i \\pi \\tau x^2}\\). The Fourier transform of \\(f(x)\\) is given by:\n\\[\n\\hat{f}(\\xi) = \\int_{-\\infty}^{\\infty} e^{i \\pi \\tau x^2} e^{-2 \\pi i x \\xi} dx\n\\]\nApplying the Poisson summation formula, we have:\n\\[\n\\sum_{n=-\\infty}^{\\infty} e^{i \\pi \\tau n^2} = \\sum_{m=-\\infty}^{\\infty} \\hat{f}(m)\n\\]\nSubstituting \\(\\hat{f}(m)\\) we get:\n\\[\n\\vartheta_3(\\tau) = \\sqrt{\\frac{i}{\\tau}} \\sum_{m=-\\infty}^{\\infty} e^{-\\pi i m^2 / \\tau}\n\\]\nChange of Variable: Let \\(\\tau' = -1/\\tau\\). Then \\(e^{-\\pi i m^2 / \\tau} = e^{i \\pi \\tau' m^2}\\). Therefore, the sum becomes:\n\\[\n\\vartheta_3(\\tau) = \\sqrt{\\frac{i}{\\tau}} \\sum_{m=-\\infty}^{\\infty} e^{i \\pi \\tau' m^2}\n\\]\nRecognizing the sum as \\(\\vartheta_3(\\tau')\\) with \\(\\tau' = -1/\\tau\\), we get:\n\\[\n\\vartheta_3(\\tau) = \\sqrt{\\frac{i}{\\tau}} \\vartheta_3\\left(-\\frac{1}{\\tau}\\right)\n\\]\nor equivalently:\n\\[\n\\vartheta_3\\left(-\\frac{1}{\\tau}\\right) = \\sqrt{i\\tau} \\vartheta_3(\\tau)\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 06"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw06.html#jacobi-theta-function-by-integral",
    "href": "docs/courses/phys231/phys231_hw06.html#jacobi-theta-function-by-integral",
    "title": "Homework 06",
    "section": "6 Jacobi theta function by integral",
    "text": "6 Jacobi theta function by integral\n\nShow another way by considering the integral\n\\[\nI_N(\\tau)=\\int_{\\gamma_N} \\frac{e^{-\\pi i z^2 \\tau}}{e^{2 \\pi i z}-1} d z\n\\]\nwhere \\(\\gamma_N\\) is a rectangular contour with vertices \\(\\pm(N+1 / 2) \\pm i\\). Compute this by residues and take the limit \\(N \\rightarrow \\infty\\) to show it equals \\(\\vartheta_3(\\tau)\\). Then argue we can rewrite the contour integral as\n\\[\n\\vartheta_3(\\tau)=\\int_{-\\infty-i \\epsilon}^{\\infty-i \\epsilon} \\frac{e^{-\\pi i z^2 \\tau}}{e^{2 \\pi i z}-1} d z-\\int_{-\\infty+i \\epsilon}^{\\infty+i \\epsilon} \\frac{e^{-\\pi i z^2 \\tau}}{e^{2 \\pi i z}-1} d z\n\\]\nand do geometric series expansions and direct Gaussian integration to show this is also \\(\\frac{1}{\\sqrt{i \\tau}} \\vartheta_3(-1 / \\tau)\\).\n\nCompute by Residues: Inside the contour \\(\\gamma_N\\), the poles of the integrand occur at integers. The residue at each pole \\(n\\) (an integer) is given by evaluating the limit as \\(z \\to n\\) of \\((z - n)\\) times the integrand. This leads to residues of the form \\(e^{-\\pi i n^2 \\tau}\\).\nSumming the residues for all poles within the contour, we get:\n\\[\n\\sum_{n=-N}^N e^{-\\pi i n^2 \\tau}\n\\]\nThis is a finite sum approximation of the theta function \\(\\vartheta_3(\\tau)\\). As \\(N \\to \\infty\\), this sum becomes \\(\\vartheta_3(\\tau)\\). So, we have:\n\\[\n\\lim_{N \\to \\infty} I_N(\\tau) = \\vartheta_3(\\tau)\n\\]\nThe contour integral can be rewritten as:\n\\[\n\\vartheta_3(\\tau) = \\int_{-\\infty-i\\epsilon}^{\\infty-i\\epsilon} \\frac{e^{-\\pi i z^2 \\tau}}{e^{2 \\pi i z} - 1} dz - \\int_{-\\infty+i\\epsilon}^{\\infty+i\\epsilon} \\frac{e^{-\\pi i z^2 \\tau}}{e^{2 \\pi i z} - 1} dz\n\\]\nHere, \\(\\epsilon\\) is a small positive number. The integrand can be expanded using the geometric series for \\(e^{2 \\pi i z}\\). This series converges absolutely for \\(|\\text{Im}(z)| &gt; 0\\). After the series expansion, the integrals involve terms of the form \\(e^{-\\pi i z^2 \\tau}\\) which are Gaussian integrals. These integrals can be evaluated directly, and due to the symmetry of the Gaussian, they will involve a factor of \\(\\frac{1}{\\sqrt{i \\tau}}\\). By summing these integrals, we obtain the identity:\n\\[\n\\vartheta_3(\\tau) = \\frac{1}{\\sqrt{i \\tau}} \\vartheta_3\\left(-\\frac{1}{\\tau}\\right)\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 06"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw03.html",
    "href": "docs/courses/phys231/phys231_hw03.html",
    "title": "Homework 03",
    "section": "",
    "text": "Complete PDF\nMathematica Notebook",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 03"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw03.html#conformal-map",
    "href": "docs/courses/phys231/phys231_hw03.html#conformal-map",
    "title": "Homework 03",
    "section": "1. Conformal map",
    "text": "1. Conformal map\n\nConsider the half-infinite strip\n\\[\nS = \\{z \\,|\\, \\text{Re}\\, z &gt; 0, 2i &lt; \\text{Im}\\, z &lt; 5i \\}\n\\]\nFind an invertible conformal map sending \\(S\\) to the upper half plane\n\\[\nH = \\{z \\,|\\, \\text{Im}\\, z &gt; 0 \\},\n\\]\n\nwe can proceed in steps using standard conformal mappings.\n\nTranslate the Strip: First, we translate the strip downwards \\(T(z) = z - 2i\\) so that its imaginary boundaries are on the real axis and at \\(3i\\).\nScale the Strip: Next, we scale the strip so that its width becomes \\(\\pi\\). Define the scaling map \\(D(z) = \\frac{\\pi}{3}z\\).\nApply the Exponential Function: The exponential function \\(E(z)=e^z\\) maps horizontal strips to \\(\\{z \\,|\\,\\text{Im}\\, z &gt; 0, |z| &gt; 1 \\}\\)\nMap to the Upper Half-Plane: \\(R(z)=\\frac{1}{2} (z + 1/z)\\) will map to the upper half-plane.\n\nSo, the complete conformal map \\(F\\) from \\(S\\) to \\(H\\) is the composition of these maps:\n\\[\nF(z) = R(E(D(T(z)))) = \\sqrt{e^{\\frac{\\pi}{3}(z - 3.5i)}}.\n\\]\nThis map is invertible and conformal.\nNote that the inverse map of \\(R(z)\\)\n\\[\nz = w+\\sqrt{w^2 − 1}\n\\]\nhas a branch cut at \\(w ∈ (−1, 1)\\). However, for \\(|z| &gt; 1\\), we have \\(\\text{Im}\\, w &gt; 0\\), so the maps are inevitable.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 03"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw03.html#saddle-point",
    "href": "docs/courses/phys231/phys231_hw03.html#saddle-point",
    "title": "Homework 03",
    "section": "2. Saddle point",
    "text": "2. Saddle point\n\nProve that if \\(f = u + iv\\) is holomorphic at \\(z = 0\\) and \\(f'(z)\\) has a zero of degree 1 at \\(z = 0\\), that both \\(u\\) and \\(v\\) have saddle points at \\(z = 0\\).\n\nAt \\(z=0\\), \\(f^{\\prime}=u_x+i v_x=0\\) \\[\n\\Rightarrow u_x(0)=0 \\text { and } v_x(0)=0\n\\]\n\\(f\\) is holomorphic\n\\[\n\\begin{array}{l}\nv_y=u_x=0 \\\\\nu_y=-v_x=0\n\\end{array}\n\\]\nSo the Hessian determinant is\n\\[\n\\begin{aligned}\nD_u=u_{x x} u_{y y}-\\left(u_{x y}\\right)^2 & =-v_{y x} v_{x y}-u_{x y}^2 \\\\\n& =-v_{x y}^2-u_{x y}^2 \\\\\nD_v=v_{x x} v_{y y}-\\left(v_{x y}\\right)^2= & -v_{x y}^2-u_{x y}^2\n\\end{aligned}\n\\]\nSince \\(f^{\\prime}\\) has a zero of degree \\(1 \\Rightarrow\\) second derivative of \\(u\\) and \\(v\\) are nonzero at \\(z=0\\), which gives \\(D_u&lt;0\\) and \\(D_\\nu&lt;0\\). Given first derivative is zero, \\(u\\) and \\(v\\) have saddle points at \\(z=0\\)",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 03"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw03.html#holomorphic-functions-agree",
    "href": "docs/courses/phys231/phys231_hw03.html#holomorphic-functions-agree",
    "title": "Homework 03",
    "section": "3. Holomorphic functions agree",
    "text": "3. Holomorphic functions agree\n\nShow that if two holomorphic functions agree on an interval of the real line, they agree everywhere.\n\nLet’s say two holomorphic function \\(f\\) and \\(g\\) agree on Interval \\(I\\). we show \\(h=f-g\\) if \\(h \\equiv 0\\) on \\(I\\), then \\(h\\) is 0 everywhere.\n\\[\nh(z)=\\sum_{n=0}^{\\infty} \\frac{(z-c)^n}{n !} h^{(n)}(c)\n\\]\nfor \\(c \\in I\\). On the real line, \\(h(x)\\) and all its derivatives with respect to \\(x\\) vanish. So \\(h^{(n)}(c) =0\\) for all \\(n\\ge0\\). And because \\(h\\) is an entire function the radius of convergence should be infinite. Therefore, for any \\(z ∈ C\\) lies within the circle of convergence, we have \\(h(z) = 0\\).",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 03"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw03.html#mobius-transformations",
    "href": "docs/courses/phys231/phys231_hw03.html#mobius-transformations",
    "title": "Homework 03",
    "section": "5. Mobius transformations",
    "text": "5. Mobius transformations\n\nShow that Mobius transformations send circles and lines to circles and lines.\n\nMobius transformations\n\\[\nf(z) = \\frac{a z+b}{c z+d} = \\frac{a}{c}+\\frac{e}{z+\\frac{d}{c}},\n\\]\ncan be decomposed into four simple transformation of translation, dilation, and inversion.\n\\[\nf=f_4 \\circ f_3 \\circ f_2 \\circ f_1 .\n\\]\nSince translation, dilation perserve geometrical lines and circles, we only need to show that inversion \\(I(z)=1/z\\) sends circles and lines to circles and lines.\n\\[\nI(z) = I(x+i y)=\\frac{1}{x+i y}=\\frac{x}{x^2+y^2}-\\frac{y i}{x^2+y^2}\n\\]\nSo \\(I\\) maps \\((x, y)\\) into a \\((u, v)\\) with\n\\[\nu=\\frac{x}{x^2+y^2} \\text { and } v=\\frac{-y}{x^2+y^2}\n\\]\nFor line of general form \\(Ax+By=C\\), we have\n\\[\n\\begin{aligned}\nAu - B v= (u^2+v^2)C\n\\end{aligned}\n\\]\nThus \\(I\\) maps a line to a circle (\\(C \\neq 0\\)) or a line (\\(C = 0\\)).\nFor cicrcle of general form \\(D x+E y+F\\left(x^2+y^2\\right)=R\\), we have\n\\[\nD u -E v + F = R\\left(u^2+v^2\\right)\n\\]\nThus \\(I\\) maps a circle to a circle (\\(R \\neq 0\\)) or a line (\\(R = 0\\)). Note here, \\(R\\) is not the radius of the original circle.",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 03"
    ]
  },
  {
    "objectID": "docs/courses/phys231/phys231_hw03.html#cross-ratio-under-simultaneous-mobius-transformations",
    "href": "docs/courses/phys231/phys231_hw03.html#cross-ratio-under-simultaneous-mobius-transformations",
    "title": "Homework 03",
    "section": "6. cross-ratio under simultaneous Mobius transformations",
    "text": "6. cross-ratio under simultaneous Mobius transformations\n\nShow that for any three points \\(z_1, z_2, z_3\\), there is precisely one Mobius transformation sending \\(z_1\\) to 0, \\(z_2\\) to 1, and \\(z_3\\) to infinity. The image of a fourth point \\(z_4\\) under this map defines the “cross-ratio” of \\(\\left(z_1, z_2, z_3, z_4\\right)\\). Show that the cross ratio is preserved under simultaneous Mobius transformations of these four points.\n\nLet Möbius transformation \\(f(z) = (a z+b) /(c z+d)\\), satisfying\n\\[\nf\\left(z_1\\right)=0, f\\left(z_2\\right)=1, f\\left(z_3\\right)=\\infty\n\\]\nThen the Möbius transformation is determined by\n\\[\n\\begin{aligned}\n& f\\left(z_1\\right)=0 \\Rightarrow a z_1 + b=0 \\\\\n& f\\left(z_2\\right)=1 \\Rightarrow a z_2 +b - c z_2 - d =0 \\\\\n& f\\left(z_3\\right)=\\infty \\Rightarrow c z_3 + d =0\n\\end{aligned}\n\\]\nThe three linear equations can be solved in the sense of their relative ratio.\nAnd the Möbius transformation can be written as\n\\[\nf(z)=\\frac{z_2-z_3}{z_2-z_1} \\frac{z-z_1}{z-z_3}\n\\]\nSo the cross ratio is\n\\[\n\\frac{z_2-z_3}{z_2-z_1} \\frac{z_4-z_1}{z_4-z_3}\n\\]\nThen the cross ratio of the image under the transformation of any \\(f\\) is\n\\[\n\\frac{f(z_2)-f(z_3)}{f(z_2)-f(z_1)} \\frac{f(z_4)-f(z_1)}{f(z_4)-f(z_3)}\n\\]\nNote that\n\\[\nf(x)-f(y)=\\frac{a x+b}{c x+d}-\\frac{a y+b}{c y+d}=\\frac{(a d-b c)(x-y)}{(c x+d)(c y+d)}\n\\]\nand\n\\[\n\\frac{f(x)-f(y)}{f(x)-f(z)} = \\frac{(x-y)(cz+d)}{(x-z)(cy+d)}\n\\]\nSo\n\\[\n\\frac{f(z_2)-f(z_3)}{f(z_2)-f(z_1)} \\frac{f(z_4)-f(z_1)}{f(z_4)-f(z_3)} =\n\\frac{(z_2-z_3)(c z_1 +d)}{(z_2-z_1)(c z_3 + d)} \\frac{(z_4-z_1)(c z_3 +d)}{(z_4-z_3)(c z_1 + d)}\n= \\frac{z_2-z_3}{z_2-z_1} \\frac{z_4-z_1}{z_4-z_3}\n\\]",
    "crumbs": [
      "Courses",
      "PHYSICS 231A",
      "Homework 03"
    ]
  },
  {
    "objectID": "docs/courses/epss265/project/project.html",
    "href": "docs/courses/epss265/project/project.html",
    "title": "Poor man’s magnetometer",
    "section": "",
    "text": "Plot the energy recorded (past the Al) versus the incident energy, for beams of various energies, and for different thickness (10nm, 100nm, …). Use H+, He+, O+. Use SPENVIS or GEANT-4 for your modeling.\n\nThe energy loss of particles depends on the nature of particles (mass, charge, etc), the incident energy, and the thickness of the Al layer.\nFor the two-layer detector, where the ﬁrst layer is Al and the second layer is Silicon, the thickness of the Al layer varies from 0 nm to 100 nm with the thickness of the Si layer ﬁxed to 2 mm.\nAs shown in Figure 1, heavier ions like O+ deposits more energy in the Al layer than lighter ions like He+ and H+, leading to a smaller energy recorded by the Si layer.\nAnd for O+ with low incoming energy below a certain energy threshold \\(E\\), the recorded deposited energy in Si layer will drop to zero. This threshold energy \\(E\\) depends on the thickness of the Al layer \\(d\\). The thicker the Al layer, the higher the threshold energy.\n\\[E=E(d)\\]\nMore generally, the threshold energy \\(E\\) also depends the incident particle \\(s\\).\n\\[E=E(d,s)\\]\n\n\nCode\nusing Pkg\nPkg.add([\n    \"YAML\",\n    \"DataFrames\",\n    \"Gadfly\",\n    \"Unitful\",\n])\n\nusing YAML\nusing DataFrames\nusing Gadfly\nusing Unitful\n\n\n\n\nCode\nfunction parse_result_line(line)\n    values = split(line, ',')\n    Layer = parse(Int, values[1])\n    Thickness = parse(Float64, values[2])  # Assuming thickness in cm\n    Density = parse(Float64, values[3])    # Assuming density in g/cm3\n    Dose = parse(Float64, values[4])       # Assuming dose in keV\n    Error = try\n        parse(Float64, values[5])\n    catch _\n        NaN\n    end  # Handle '-nan' and other errors\n\n    return (Layer, Thickness, Density, Dose, Error)\nend\n\nfunction convert_data(yaml_data)\n    # Iterate through the data and convert each field\n    for entry in yaml_data\n        entry[\"layer.Al.thickness\"] = parse(Float64, replace(entry[\"layer.Al.thickness\"], \" um\" =&gt; \"\")) * 1000 * u\"nm\"\n        entry[\"source\"][\"energy\"] = parse(Float64, replace(entry[\"source\"][\"energy\"], \" MeV\" =&gt; \"\")) * 1000\n        entry[\"result\"] = [parse_result_line(line) for line in split(entry[\"result\"], '\\n') if line != \"\"]\n    end\n\n    df = DataFrame(\n        IncidentEnergy=[entry[\"source\"][\"energy\"] for entry in yaml_data],\n        DepositedEnergy=[entry[\"result\"][3][4] for entry in yaml_data],\n        SourceParticle=[entry[\"source\"][\"particle\"] for entry in yaml_data],\n        LayerAlThickness=[entry[\"layer.Al.thickness\"] for entry in yaml_data],\n    )\n\n    return df\nend\n\n\nconvert_data (generic function with 1 method)\n\n\n\n\nCode\nfunction read_data(filename=\"result.yml\")\n    # Read YAML file or string\n    filepath = joinpath(@__DIR__, \"run\", filename)\n    # Parse YAML content\n    parsed_data = YAML.load_file(filepath)\n\n    # Convert data to DataFrame\n    df = convert_data(parsed_data)\n\n    return df\nend\n\n\nread_data (generic function with 2 methods)\n\n\nThe result from SPENVIS is stored in a yaml file. We parse it and convert it to DataFrame for analysis.\n\n\nCode\ndf = read_data()\n\n\n26×4 DataFrame\n\n\n\nRow\nIncidentEnergy\nDepositedEnergy\nSourceParticle\nLayerAlThickness\n\n\n\nFloat64\nFloat64\nString\nQuantity…\n\n\n\n\n1\n10.0\n9.13347\nproton\n10.0 nm\n\n\n2\n1000.0\n999.495\nproton\n10.0 nm\n\n\n3\n10.0\n4.21557\nproton\n100.0 nm\n\n\n4\n1000.0\n994.992\nproton\n100.0 nm\n\n\n5\n10.0\n9.2096\nalpha\n10.0 nm\n\n\n6\n1000.0\n996.43\nalpha\n10.0 nm\n\n\n7\n10.0\n1.48217\nalpha\n100.0 nm\n\n\n8\n1000.0\n964.217\nalpha\n100.0 nm\n\n\n9\n5.0\n4.15482\nalpha\n10.0 nm\n\n\n10\n5.0\n0.0332675\nalpha\n100.0 nm\n\n\n11\n10.0\n0.0\no+\n100.0 nm\n\n\n12\n1000.0\n854.274\no+\n100.0 nm\n\n\n13\n1000.0\n984.925\no+\n10.0 nm\n\n\n14\n100.0\n95.0629\no+\n10.0 nm\n\n\n15\n50.0\n45.8783\no+\n10.0 nm\n\n\n16\n20.0\n15.5834\no+\n10.0 nm\n\n\n17\n10.0\n2.62646\no+\n10.0 nm\n\n\n18\n8.0\n0.678313\no+\n10.0 nm\n\n\n19\n5.0\n0.0383982\no+\n10.0 nm\n\n\n20\n5.0\n0.757253\nproton\n100.0 nm\n\n\n21\n100.0\n86.8131\nproton\n100.0 nm\n\n\n22\n100.0\n75.4222\nalpha\n100.0 nm\n\n\n23\n100.0\n51.4169\no+\n100.0 nm\n\n\n24\n50.0\n2.86204\no+\n100.0 nm\n\n\n25\n40.0\n0.0961512\no+\n100.0 nm\n\n\n26\n40.0\n25.4273\nalpha\n100.0 nm\n\n\n\n\n\n\n\n\nCode\n# Plot data with x = IncidentEnergy, y = DepositedEnergy, color = SourceParticle, facet = LayerAlThickness, using log scale on x-axis and y-axis\n\nplot(df,\n    x=:IncidentEnergy,\n    y=:DepositedEnergy,\n    color=:SourceParticle,\n    shape=:SourceParticle,\n    xgroup=:LayerAlThickness,\n    Geom.subplot_grid(Geom.line, Geom.point),\n    Scale.x_log10, Scale.y_log10,\n)\n# plot(df, x=:IncidentEnergy, y=:DepositedEnergy, color=:SourceParticle, linestyle=:LayerAlThickness, Geom.line, Scale.x_log10, Scale.y_log10)\n\n\n\n\n\n\n\n\n  \n    \n  \n\n\n  \n    \n      \n        IncidentEnergy by LayerAlThickness\n      \n    \n  \n  \n    \n      \n        \n          proton\n        \n      \n      \n        \n          alpha\n        \n      \n      \n        \n          o+\n        \n      \n    \n    \n      \n        \n          \n        \n      \n      \n        \n          \n        \n      \n      \n        \n          \n        \n      \n    \n    \n      \n        \n          SourceParticle\n        \n      \n    \n  \n  \n    \n      \n        \n          \n          \n        \n        \n          \n            \n              100.0 nm\n            \n          \n        \n        \n          \n            \n              10.0 nm\n            \n          \n        \n        \n          \n            \n              100\n            \n          \n          \n            \n              101\n            \n          \n          \n            \n              102\n            \n          \n          \n            \n              103\n            \n          \n          \n            \n              100.0\n            \n          \n          \n            \n              100.1\n            \n          \n          \n            \n              100.2\n            \n          \n          \n            \n              100.3\n            \n          \n          \n            \n              100.4\n            \n          \n          \n            \n              100.5\n            \n          \n          \n            \n              100.6\n            \n          \n          \n            \n              100.7\n            \n          \n          \n            \n              100.8\n            \n          \n          \n            \n              100.9\n            \n          \n          \n            \n              101.0\n            \n          \n          \n            \n              101.1\n            \n          \n          \n            \n              101.2\n            \n          \n          \n            \n              101.3\n            \n          \n          \n            \n              101.4\n            \n          \n          \n            \n              101.5\n            \n          \n          \n            \n              101.6\n            \n          \n          \n            \n              101.7\n            \n          \n          \n            \n              101.8\n            \n          \n          \n            \n              101.9\n            \n          \n          \n            \n              102.0\n            \n          \n          \n            \n              102.1\n            \n          \n          \n            \n              102.2\n            \n          \n          \n            \n              102.3\n            \n          \n          \n            \n              102.4\n            \n          \n          \n            \n              102.5\n            \n          \n          \n            \n              102.6\n            \n          \n          \n            \n              102.7\n            \n          \n          \n            \n              102.8\n            \n          \n          \n            \n              102.9\n            \n          \n          \n            \n              103.0\n            \n          \n          \n            \n              100.00\n            \n          \n          \n            \n              100.01\n            \n          \n          \n            \n              100.02\n            \n          \n          \n            \n              100.03\n            \n          \n          \n            \n              100.04\n            \n          \n          \n            \n              100.05\n            \n          \n          \n            \n              100.06\n            \n          \n          \n            \n              100.07\n            \n          \n          \n            \n              100.08\n            \n          \n          \n            \n              100.09\n            \n          \n          \n            \n              100.10\n            \n          \n          \n            \n              100.11\n            \n          \n          \n            \n              100.12\n            \n          \n          \n            \n              100.13\n            \n          \n          \n            \n              100.14\n            \n          \n          \n            \n              100.15\n            \n          \n          \n            \n              100.16\n            \n          \n          \n            \n              100.17\n            \n          \n          \n            \n              100.18\n            \n          \n          \n            \n              100.19\n            \n          \n          \n            \n              100.20\n            \n          \n          \n            \n              100.21\n            \n          \n          \n            \n              100.22\n            \n          \n          \n            \n              100.23\n            \n          \n          \n            \n              100.24\n            \n          \n          \n            \n              100.25\n            \n          \n          \n            \n              100.26\n            \n          \n          \n            \n              100.27\n            \n          \n          \n            \n              100.28\n            \n          \n          \n            \n              100.29\n            \n          \n          \n            \n              100.30\n            \n          \n          \n            \n              100.31\n            \n          \n          \n            \n              100.32\n            \n          \n          \n            \n              100.33\n            \n          \n          \n            \n              100.34\n            \n          \n          \n            \n              100.35\n            \n          \n          \n            \n              100.36\n            \n          \n          \n            \n              100.37\n            \n          \n          \n            \n              100.38\n            \n          \n          \n            \n              100.39\n            \n          \n          \n            \n              100.40\n            \n          \n          \n            \n              100.41\n            \n          \n          \n            \n              100.42\n            \n          \n          \n            \n              100.43\n            \n          \n          \n            \n              100.44\n            \n          \n          \n            \n              100.45\n            \n          \n          \n            \n              100.46\n            \n          \n          \n            \n              100.47\n            \n          \n          \n            \n              100.48\n            \n          \n          \n            \n              100.49\n            \n          \n          \n            \n              100.50\n            \n          \n          \n            \n              100.51\n            \n          \n          \n            \n              100.52\n            \n          \n          \n            \n              100.53\n            \n          \n          \n            \n              100.54\n            \n          \n          \n            \n              100.55\n            \n          \n          \n            \n              100.56\n            \n          \n          \n            \n              100.57\n            \n          \n          \n            \n              100.58\n            \n          \n          \n            \n              100.59\n            \n          \n          \n            \n              100.60\n            \n          \n          \n            \n              100.61\n            \n          \n          \n            \n              100.62\n            \n          \n          \n            \n              100.63\n            \n          \n          \n            \n              100.64\n            \n          \n          \n            \n              100.65\n            \n          \n          \n            \n              100.66\n            \n          \n          \n            \n              100.67\n            \n          \n          \n            \n              100.68\n            \n          \n          \n            \n              100.69\n            \n          \n          \n            \n              100.70\n            \n          \n          \n            \n              100.71\n            \n          \n          \n            \n              100.72\n            \n          \n          \n            \n              100.73\n            \n          \n          \n            \n              100.74\n            \n          \n          \n            \n              100.75\n            \n          \n          \n            \n              100.76\n            \n          \n          \n            \n              100.77\n            \n          \n          \n            \n              100.78\n            \n          \n          \n            \n              100.79\n            \n          \n          \n            \n              100.80\n            \n          \n          \n            \n              100.81\n            \n          \n          \n            \n              100.82\n            \n          \n          \n            \n              100.83\n            \n          \n          \n            \n              100.84\n            \n          \n          \n            \n              100.85\n            \n          \n          \n            \n              100.86\n            \n          \n          \n            \n              100.87\n            \n          \n          \n            \n              100.88\n            \n          \n          \n            \n              100.89\n            \n          \n          \n            \n              100.90\n            \n          \n          \n            \n              100.91\n            \n          \n          \n            \n              100.92\n            \n          \n          \n            \n              100.93\n            \n          \n          \n            \n              100.94\n            \n          \n          \n            \n              100.95\n            \n          \n          \n            \n              100.96\n            \n          \n          \n            \n              100.97\n            \n          \n          \n            \n              100.98\n            \n          \n          \n            \n              100.99\n            \n          \n          \n            \n              101.00\n            \n          \n          \n            \n              101.01\n            \n          \n          \n            \n              101.02\n            \n          \n          \n            \n              101.03\n            \n          \n          \n            \n              101.04\n            \n          \n          \n            \n              101.05\n            \n          \n          \n            \n              101.06\n            \n          \n          \n            \n              101.07\n            \n          \n          \n            \n              101.08\n            \n          \n          \n            \n              101.09\n            \n          \n          \n            \n              101.10\n            \n          \n          \n            \n              101.11\n            \n          \n          \n            \n              101.12\n            \n          \n          \n            \n              101.13\n            \n          \n          \n            \n              101.14\n            \n          \n          \n            \n              101.15\n            \n          \n          \n            \n              101.16\n            \n          \n          \n            \n              101.17\n            \n          \n          \n            \n              101.18\n            \n          \n          \n            \n              101.19\n            \n          \n          \n            \n              101.20\n            \n          \n          \n            \n              101.21\n            \n          \n          \n            \n              101.22\n            \n          \n          \n            \n              101.23\n            \n          \n          \n            \n              101.24\n            \n          \n          \n            \n              101.25\n            \n          \n          \n            \n              101.26\n            \n          \n          \n            \n              101.27\n            \n          \n          \n            \n              101.28\n            \n          \n          \n            \n              101.29\n            \n          \n          \n            \n              101.30\n            \n          \n          \n            \n              101.31\n            \n          \n          \n            \n              101.32\n            \n          \n          \n            \n              101.33\n            \n          \n          \n            \n              101.34\n            \n          \n          \n            \n              101.35\n            \n          \n          \n            \n              101.36\n            \n          \n          \n            \n              101.37\n            \n          \n          \n            \n              101.38\n            \n          \n          \n            \n              101.39\n            \n          \n          \n            \n              101.40\n            \n          \n          \n            \n              101.41\n            \n          \n          \n            \n              101.42\n            \n          \n          \n            \n              101.43\n            \n          \n          \n            \n              101.44\n            \n          \n          \n            \n              101.45\n            \n          \n          \n            \n              101.46\n            \n          \n          \n            \n              101.47\n            \n          \n          \n            \n              101.48\n            \n          \n          \n            \n              101.49\n            \n          \n          \n            \n              101.50\n            \n          \n          \n            \n              101.51\n            \n          \n          \n            \n              101.52\n            \n          \n          \n            \n              101.53\n            \n          \n          \n            \n              101.54\n            \n          \n          \n            \n              101.55\n            \n          \n          \n            \n              101.56\n            \n          \n          \n            \n              101.57\n            \n          \n          \n            \n              101.58\n            \n          \n          \n            \n              101.59\n            \n          \n          \n            \n              101.60\n            \n          \n          \n            \n              101.61\n            \n          \n          \n            \n              101.62\n            \n          \n          \n            \n              101.63\n            \n          \n          \n            \n              101.64\n            \n          \n          \n            \n              101.65\n            \n          \n          \n            \n              101.66\n            \n          \n          \n            \n              101.67\n            \n          \n          \n            \n              101.68\n            \n          \n          \n            \n              101.69\n            \n          \n          \n            \n              101.70\n            \n          \n          \n            \n              101.71\n            \n          \n          \n            \n              101.72\n            \n          \n          \n            \n              101.73\n            \n          \n          \n            \n              101.74\n            \n          \n          \n            \n              101.75\n            \n          \n          \n            \n              101.76\n            \n          \n          \n            \n              101.77\n            \n          \n          \n            \n              101.78\n            \n          \n          \n            \n              101.79\n            \n          \n          \n            \n              101.80\n            \n          \n          \n            \n              101.81\n            \n          \n          \n            \n              101.82\n            \n          \n          \n            \n              101.83\n            \n          \n          \n            \n              101.84\n            \n          \n          \n            \n              101.85\n            \n          \n          \n            \n              101.86\n            \n          \n          \n            \n              101.87\n            \n          \n          \n            \n              101.88\n            \n          \n          \n            \n              101.89\n            \n          \n          \n            \n              101.90\n            \n          \n          \n            \n              101.91\n            \n          \n          \n            \n              101.92\n            \n          \n          \n            \n              101.93\n            \n          \n          \n            \n              101.94\n            \n          \n          \n            \n              101.95\n            \n          \n          \n            \n              101.96\n            \n          \n          \n            \n              101.97\n            \n          \n          \n            \n              101.98\n            \n          \n          \n            \n              101.99\n            \n          \n          \n            \n              102.00\n            \n          \n          \n            \n              102.01\n            \n          \n          \n            \n              102.02\n            \n          \n          \n            \n              102.03\n            \n          \n          \n            \n              102.04\n            \n          \n          \n            \n              102.05\n            \n          \n          \n            \n              102.06\n            \n          \n          \n            \n              102.07\n            \n          \n          \n            \n              102.08\n            \n          \n          \n            \n              102.09\n            \n          \n          \n            \n              102.10\n            \n          \n          \n            \n              102.11\n            \n          \n          \n            \n              102.12\n            \n          \n          \n            \n              102.13\n            \n          \n          \n            \n              102.14\n            \n          \n          \n            \n              102.15\n            \n          \n          \n            \n              102.16\n            \n          \n          \n            \n              102.17\n            \n          \n          \n            \n              102.18\n            \n          \n          \n            \n              102.19\n            \n          \n          \n            \n              102.20\n            \n          \n          \n            \n              102.21\n            \n          \n          \n            \n              102.22\n            \n          \n          \n            \n              102.23\n            \n          \n          \n            \n              102.24\n            \n          \n          \n            \n              102.25\n            \n          \n          \n            \n              102.26\n            \n          \n          \n            \n              102.27\n            \n          \n          \n            \n              102.28\n            \n          \n          \n            \n              102.29\n            \n          \n          \n            \n              102.30\n            \n          \n          \n            \n              102.31\n            \n          \n          \n            \n              102.32\n            \n          \n          \n            \n              102.33\n            \n          \n          \n            \n              102.34\n            \n          \n          \n            \n              102.35\n            \n          \n          \n            \n              102.36\n            \n          \n          \n            \n              102.37\n            \n          \n          \n            \n              102.38\n            \n          \n          \n            \n              102.39\n            \n          \n          \n            \n              102.40\n            \n          \n          \n            \n              102.41\n            \n          \n          \n            \n              102.42\n            \n          \n          \n            \n              102.43\n            \n          \n          \n            \n              102.44\n            \n          \n          \n            \n              102.45\n            \n          \n          \n            \n              102.46\n            \n          \n          \n            \n              102.47\n            \n          \n          \n            \n              102.48\n            \n          \n          \n            \n              102.49\n            \n          \n          \n            \n              102.50\n            \n          \n          \n            \n              102.51\n            \n          \n          \n            \n              102.52\n            \n          \n          \n            \n              102.53\n            \n          \n          \n            \n              102.54\n            \n          \n          \n            \n              102.55\n            \n          \n          \n            \n              102.56\n            \n          \n          \n            \n              102.57\n            \n          \n          \n            \n              102.58\n            \n          \n          \n            \n              102.59\n            \n          \n          \n            \n              102.60\n            \n          \n          \n            \n              102.61\n            \n          \n          \n            \n              102.62\n            \n          \n          \n            \n              102.63\n            \n          \n          \n            \n              102.64\n            \n          \n          \n            \n              102.65\n            \n          \n          \n            \n              102.66\n            \n          \n          \n            \n              102.67\n            \n          \n          \n            \n              102.68\n            \n          \n          \n            \n              102.69\n            \n          \n          \n            \n              102.70\n            \n          \n          \n            \n              102.71\n            \n          \n          \n            \n              102.72\n            \n          \n          \n            \n              102.73\n            \n          \n          \n            \n              102.74\n            \n          \n          \n            \n              102.75\n            \n          \n          \n            \n              102.76\n            \n          \n          \n            \n              102.77\n            \n          \n          \n            \n              102.78\n            \n          \n          \n            \n              102.79\n            \n          \n          \n            \n              102.80\n            \n          \n          \n            \n              102.81\n            \n          \n          \n            \n              102.82\n            \n          \n          \n            \n              102.83\n            \n          \n          \n            \n              102.84\n            \n          \n          \n            \n              102.85\n            \n          \n          \n            \n              102.86\n            \n          \n          \n            \n              102.87\n            \n          \n          \n            \n              102.88\n            \n          \n          \n            \n              102.89\n            \n          \n          \n            \n              102.90\n            \n          \n          \n            \n              102.91\n            \n          \n          \n            \n              102.92\n            \n          \n          \n            \n              102.93\n            \n          \n          \n            \n              102.94\n            \n          \n          \n            \n              102.95\n            \n          \n          \n            \n              102.96\n            \n          \n          \n            \n              102.97\n            \n          \n          \n            \n              102.98\n            \n          \n          \n            \n              102.99\n            \n          \n          \n            \n              103.00\n            \n          \n          \n            \n              100\n            \n          \n          \n            \n              103\n            \n          \n        \n        \n          \n            \n              100\n            \n          \n          \n            \n              101\n            \n          \n          \n            \n              102\n            \n          \n          \n            \n              103\n            \n          \n          \n            \n              100.0\n            \n          \n          \n            \n              100.1\n            \n          \n          \n            \n              100.2\n            \n          \n          \n            \n              100.3\n            \n          \n          \n            \n              100.4\n            \n          \n          \n            \n              100.5\n            \n          \n          \n            \n              100.6\n            \n          \n          \n            \n              100.7\n            \n          \n          \n            \n              100.8\n            \n          \n          \n            \n              100.9\n            \n          \n          \n            \n              101.0\n            \n          \n          \n            \n              101.1\n            \n          \n          \n            \n              101.2\n            \n          \n          \n            \n              101.3\n            \n          \n          \n            \n              101.4\n            \n          \n          \n            \n              101.5\n            \n          \n          \n            \n              101.6\n            \n          \n          \n            \n              101.7\n            \n          \n          \n            \n              101.8\n            \n          \n          \n            \n              101.9\n            \n          \n          \n            \n              102.0\n            \n          \n          \n            \n              102.1\n            \n          \n          \n            \n              102.2\n            \n          \n          \n            \n              102.3\n            \n          \n          \n            \n              102.4\n            \n          \n          \n            \n              102.5\n            \n          \n          \n            \n              102.6\n            \n          \n          \n            \n              102.7\n            \n          \n          \n            \n              102.8\n            \n          \n          \n            \n              102.9\n            \n          \n          \n            \n              103.0\n            \n          \n          \n            \n              100.00\n            \n          \n          \n            \n              100.01\n            \n          \n          \n            \n              100.02\n            \n          \n          \n            \n              100.03\n            \n          \n          \n            \n              100.04\n            \n          \n          \n            \n              100.05\n            \n          \n          \n            \n              100.06\n            \n          \n          \n            \n              100.07\n            \n          \n          \n            \n              100.08\n            \n          \n          \n            \n              100.09\n            \n          \n          \n            \n              100.10\n            \n          \n          \n            \n              100.11\n            \n          \n          \n            \n              100.12\n            \n          \n          \n            \n              100.13\n            \n          \n          \n            \n              100.14\n            \n          \n          \n            \n              100.15\n            \n          \n          \n            \n              100.16\n            \n          \n          \n            \n              100.17\n            \n          \n          \n            \n              100.18\n            \n          \n          \n            \n              100.19\n            \n          \n          \n            \n              100.20\n            \n          \n          \n            \n              100.21\n            \n          \n          \n            \n              100.22\n            \n          \n          \n            \n              100.23\n            \n          \n          \n            \n              100.24\n            \n          \n          \n            \n              100.25\n            \n          \n          \n            \n              100.26\n            \n          \n          \n            \n              100.27\n            \n          \n          \n            \n              100.28\n            \n          \n          \n            \n              100.29\n            \n          \n          \n            \n              100.30\n            \n          \n          \n            \n              100.31\n            \n          \n          \n            \n              100.32\n            \n          \n          \n            \n              100.33\n            \n          \n          \n            \n              100.34\n            \n          \n          \n            \n              100.35\n            \n          \n          \n            \n              100.36\n            \n          \n          \n            \n              100.37\n            \n          \n          \n            \n              100.38\n            \n          \n          \n            \n              100.39\n            \n          \n          \n            \n              100.40\n            \n          \n          \n            \n              100.41\n            \n          \n          \n            \n              100.42\n            \n          \n          \n            \n              100.43\n            \n          \n          \n            \n              100.44\n            \n          \n          \n            \n              100.45\n            \n          \n          \n            \n              100.46\n            \n          \n          \n            \n              100.47\n            \n          \n          \n            \n              100.48\n            \n          \n          \n            \n              100.49\n            \n          \n          \n            \n              100.50\n            \n          \n          \n            \n              100.51\n            \n          \n          \n            \n              100.52\n            \n          \n          \n            \n              100.53\n            \n          \n          \n            \n              100.54\n            \n          \n          \n            \n              100.55\n            \n          \n          \n            \n              100.56\n            \n          \n          \n            \n              100.57\n            \n          \n          \n            \n              100.58\n            \n          \n          \n            \n              100.59\n            \n          \n          \n            \n              100.60\n            \n          \n          \n            \n              100.61\n            \n          \n          \n            \n              100.62\n            \n          \n          \n            \n              100.63\n            \n          \n          \n            \n              100.64\n            \n          \n          \n            \n              100.65\n            \n          \n          \n            \n              100.66\n            \n          \n          \n            \n              100.67\n            \n          \n          \n            \n              100.68\n            \n          \n          \n            \n              100.69\n            \n          \n          \n            \n              100.70\n            \n          \n          \n            \n              100.71\n            \n          \n          \n            \n              100.72\n            \n          \n          \n            \n              100.73\n            \n          \n          \n            \n              100.74\n            \n          \n          \n            \n              100.75\n            \n          \n          \n            \n              100.76\n            \n          \n          \n            \n              100.77\n            \n          \n          \n            \n              100.78\n            \n          \n          \n            \n              100.79\n            \n          \n          \n            \n              100.80\n            \n          \n          \n            \n              100.81\n            \n          \n          \n            \n              100.82\n            \n          \n          \n            \n              100.83\n            \n          \n          \n            \n              100.84\n            \n          \n          \n            \n              100.85\n            \n          \n          \n            \n              100.86\n            \n          \n          \n            \n              100.87\n            \n          \n          \n            \n              100.88\n            \n          \n          \n            \n              100.89\n            \n          \n          \n            \n              100.90\n            \n          \n          \n            \n              100.91\n            \n          \n          \n            \n              100.92\n            \n          \n          \n            \n              100.93\n            \n          \n          \n            \n              100.94\n            \n          \n          \n            \n              100.95\n            \n          \n          \n            \n              100.96\n            \n          \n          \n            \n              100.97\n            \n          \n          \n            \n              100.98\n            \n          \n          \n            \n              100.99\n            \n          \n          \n            \n              101.00\n            \n          \n          \n            \n              101.01\n            \n          \n          \n            \n              101.02\n            \n          \n          \n            \n              101.03\n            \n          \n          \n            \n              101.04\n            \n          \n          \n            \n              101.05\n            \n          \n          \n            \n              101.06\n            \n          \n          \n            \n              101.07\n            \n          \n          \n            \n              101.08\n            \n          \n          \n            \n              101.09\n            \n          \n          \n            \n              101.10\n            \n          \n          \n            \n              101.11\n            \n          \n          \n            \n              101.12\n            \n          \n          \n            \n              101.13\n            \n          \n          \n            \n              101.14\n            \n          \n          \n            \n              101.15\n            \n          \n          \n            \n              101.16\n            \n          \n          \n            \n              101.17\n            \n          \n          \n            \n              101.18\n            \n          \n          \n            \n              101.19\n            \n          \n          \n            \n              101.20\n            \n          \n          \n            \n              101.21\n            \n          \n          \n            \n              101.22\n            \n          \n          \n            \n              101.23\n            \n          \n          \n            \n              101.24\n            \n          \n          \n            \n              101.25\n            \n          \n          \n            \n              101.26\n            \n          \n          \n            \n              101.27\n            \n          \n          \n            \n              101.28\n            \n          \n          \n            \n              101.29\n            \n          \n          \n            \n              101.30\n            \n          \n          \n            \n              101.31\n            \n          \n          \n            \n              101.32\n            \n          \n          \n            \n              101.33\n            \n          \n          \n            \n              101.34\n            \n          \n          \n            \n              101.35\n            \n          \n          \n            \n              101.36\n            \n          \n          \n            \n              101.37\n            \n          \n          \n            \n              101.38\n            \n          \n          \n            \n              101.39\n            \n          \n          \n            \n              101.40\n            \n          \n          \n            \n              101.41\n            \n          \n          \n            \n              101.42\n            \n          \n          \n            \n              101.43\n            \n          \n          \n            \n              101.44\n            \n          \n          \n            \n              101.45\n            \n          \n          \n            \n              101.46\n            \n          \n          \n            \n              101.47\n            \n          \n          \n            \n              101.48\n            \n          \n          \n            \n              101.49\n            \n          \n          \n            \n              101.50\n            \n          \n          \n            \n              101.51\n            \n          \n          \n            \n              101.52\n            \n          \n          \n            \n              101.53\n            \n          \n          \n            \n              101.54\n            \n          \n          \n            \n              101.55\n            \n          \n          \n            \n              101.56\n            \n          \n          \n            \n              101.57\n            \n          \n          \n            \n              101.58\n            \n          \n          \n            \n              101.59\n            \n          \n          \n            \n              101.60\n            \n          \n          \n            \n              101.61\n            \n          \n          \n            \n              101.62\n            \n          \n          \n            \n              101.63\n            \n          \n          \n            \n              101.64\n            \n          \n          \n            \n              101.65\n            \n          \n          \n            \n              101.66\n            \n          \n          \n            \n              101.67\n            \n          \n          \n            \n              101.68\n            \n          \n          \n            \n              101.69\n            \n          \n          \n            \n              101.70\n            \n          \n          \n            \n              101.71\n            \n          \n          \n            \n              101.72\n            \n          \n          \n            \n              101.73\n            \n          \n          \n            \n              101.74\n            \n          \n          \n            \n              101.75\n            \n          \n          \n            \n              101.76\n            \n          \n          \n            \n              101.77\n            \n          \n          \n            \n              101.78\n            \n          \n          \n            \n              101.79\n            \n          \n          \n            \n              101.80\n            \n          \n          \n            \n              101.81\n            \n          \n          \n            \n              101.82\n            \n          \n          \n            \n              101.83\n            \n          \n          \n            \n              101.84\n            \n          \n          \n            \n              101.85\n            \n          \n          \n            \n              101.86\n            \n          \n          \n            \n              101.87\n            \n          \n          \n            \n              101.88\n            \n          \n          \n            \n              101.89\n            \n          \n          \n            \n              101.90\n            \n          \n          \n            \n              101.91\n            \n          \n          \n            \n              101.92\n            \n          \n          \n            \n              101.93\n            \n          \n          \n            \n              101.94\n            \n          \n          \n            \n              101.95\n            \n          \n          \n            \n              101.96\n            \n          \n          \n            \n              101.97\n            \n          \n          \n            \n              101.98\n            \n          \n          \n            \n              101.99\n            \n          \n          \n            \n              102.00\n            \n          \n          \n            \n              102.01\n            \n          \n          \n            \n              102.02\n            \n          \n          \n            \n              102.03\n            \n          \n          \n            \n              102.04\n            \n          \n          \n            \n              102.05\n            \n          \n          \n            \n              102.06\n            \n          \n          \n            \n              102.07\n            \n          \n          \n            \n              102.08\n            \n          \n          \n            \n              102.09\n            \n          \n          \n            \n              102.10\n            \n          \n          \n            \n              102.11\n            \n          \n          \n            \n              102.12\n            \n          \n          \n            \n              102.13\n            \n          \n          \n            \n              102.14\n            \n          \n          \n            \n              102.15\n            \n          \n          \n            \n              102.16\n            \n          \n          \n            \n              102.17\n            \n          \n          \n            \n              102.18\n            \n          \n          \n            \n              102.19\n            \n          \n          \n            \n              102.20\n            \n          \n          \n            \n              102.21\n            \n          \n          \n            \n              102.22\n            \n          \n          \n            \n              102.23\n            \n          \n          \n            \n              102.24\n            \n          \n          \n            \n              102.25\n            \n          \n          \n            \n              102.26\n            \n          \n          \n            \n              102.27\n            \n          \n          \n            \n              102.28\n            \n          \n          \n            \n              102.29\n            \n          \n          \n            \n              102.30\n            \n          \n          \n            \n              102.31\n            \n          \n          \n            \n              102.32\n            \n          \n          \n            \n              102.33\n            \n          \n          \n            \n              102.34\n            \n          \n          \n            \n              102.35\n            \n          \n          \n            \n              102.36\n            \n          \n          \n            \n              102.37\n            \n          \n          \n            \n              102.38\n            \n          \n          \n            \n              102.39\n            \n          \n          \n            \n              102.40\n            \n          \n          \n            \n              102.41\n            \n          \n          \n            \n              102.42\n            \n          \n          \n            \n              102.43\n            \n          \n          \n            \n              102.44\n            \n          \n          \n            \n              102.45\n            \n          \n          \n            \n              102.46\n            \n          \n          \n            \n              102.47\n            \n          \n          \n            \n              102.48\n            \n          \n          \n            \n              102.49\n            \n          \n          \n            \n              102.50\n            \n          \n          \n            \n              102.51\n            \n          \n          \n            \n              102.52\n            \n          \n          \n            \n              102.53\n            \n          \n          \n            \n              102.54\n            \n          \n          \n            \n              102.55\n            \n          \n          \n            \n              102.56\n            \n          \n          \n            \n              102.57\n            \n          \n          \n            \n              102.58\n            \n          \n          \n            \n              102.59\n            \n          \n          \n            \n              102.60\n            \n          \n          \n            \n              102.61\n            \n          \n          \n            \n              102.62\n            \n          \n          \n            \n              102.63\n            \n          \n          \n            \n              102.64\n            \n          \n          \n            \n              102.65\n            \n          \n          \n            \n              102.66\n            \n          \n          \n            \n              102.67\n            \n          \n          \n            \n              102.68\n            \n          \n          \n            \n              102.69\n            \n          \n          \n            \n              102.70\n            \n          \n          \n            \n              102.71\n            \n          \n          \n            \n              102.72\n            \n          \n          \n            \n              102.73\n            \n          \n          \n            \n              102.74\n            \n          \n          \n            \n              102.75\n            \n          \n          \n            \n              102.76\n            \n          \n          \n            \n              102.77\n            \n          \n          \n            \n              102.78\n            \n          \n          \n            \n              102.79\n            \n          \n          \n            \n              102.80\n            \n          \n          \n            \n              102.81\n            \n          \n          \n            \n              102.82\n            \n          \n          \n            \n              102.83\n            \n          \n          \n            \n              102.84\n            \n          \n          \n            \n              102.85\n            \n          \n          \n            \n              102.86\n            \n          \n          \n            \n              102.87\n            \n          \n          \n            \n              102.88\n            \n          \n          \n            \n              102.89\n            \n          \n          \n            \n              102.90\n            \n          \n          \n            \n              102.91\n            \n          \n          \n            \n              102.92\n            \n          \n          \n            \n              102.93\n            \n          \n          \n            \n              102.94\n            \n          \n          \n            \n              102.95\n            \n          \n          \n            \n              102.96\n            \n          \n          \n            \n              102.97\n            \n          \n          \n            \n              102.98\n            \n          \n          \n            \n              102.99\n            \n          \n          \n            \n              103.00\n            \n          \n          \n            \n              100\n            \n          \n          \n            \n              103\n            \n          \n        \n        \n          \n            \n              \n                \n              \n            \n            \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n            \n            \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n            \n            \n              \n                \n                \n              \n              \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.60205999132796231.4053007594228677\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.6020599913279623-1.0170453815831295\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.69897000433601870.4566763061569218\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        2.01.7111056354514849\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        2.01.8774990810832295\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        2.01.9385852646746489\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        0.6989700043360189-0.1207589401012299\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        3.02.931597137886862\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.0,-Inf\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        0.6989700043360189-1.4779802260869588\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        3.02.98417482925214\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.00.17089743261618665\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        3.02.9978197635088732\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.00.6248567172906062\n                      \n                    \n                  \n                \n              \n              \n                \n                  \n                \n                \n                  \n                \n                \n                  \n                \n              \n            \n          \n        \n        \n          \n            \n              \n                \n              \n            \n            \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n            \n            \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n            \n            \n              \n                \n                \n              \n              \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        0.6989700043360189-1.415689472972055\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        0.9030899869919435-0.16856960341474359\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.00.4193712871079017\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.30102999566398131.1926613823570411\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.69897000433601871.6616075062630538\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        2.01.978011058799333\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        3.02.993403028848327\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        0.69897000433601890.6185523180390649\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        3.02.9984467945753503\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.00.9642406736070522\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        3.02.9997807127927865\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.00.9606359017187183\n                      \n                    \n                  \n                \n              \n              \n                \n                  \n                \n                \n                  \n                \n                \n                  \n                \n              \n            \n          \n        \n        \n          \n            \n              10-2\n            \n          \n          \n            \n              10-1\n            \n          \n          \n            \n              100\n            \n          \n          \n            \n              101\n            \n          \n          \n            \n              102\n            \n          \n          \n            \n              103\n            \n          \n          \n            \n              10-2.0\n            \n          \n          \n            \n              10-1.8\n            \n          \n          \n            \n              10-1.6\n            \n          \n          \n            \n              10-1.4\n            \n          \n          \n            \n              10-1.2\n            \n          \n          \n            \n              10-1.0\n            \n          \n          \n            \n              10-0.8\n            \n          \n          \n            \n              10-0.6\n            \n          \n          \n            \n              10-0.4\n            \n          \n          \n            \n              10-0.2\n            \n          \n          \n            \n              100.0\n            \n          \n          \n            \n              100.2\n            \n          \n          \n            \n              100.4\n            \n          \n          \n            \n              100.6\n            \n          \n          \n            \n              100.8\n            \n          \n          \n            \n              101.0\n            \n          \n          \n            \n              101.2\n            \n          \n          \n            \n              101.4\n            \n          \n          \n            \n              101.6\n            \n          \n          \n            \n              101.8\n            \n          \n          \n            \n              102.0\n            \n          \n          \n            \n              102.2\n            \n          \n          \n            \n              102.4\n            \n          \n          \n            \n              102.6\n            \n          \n          \n            \n              102.8\n            \n          \n          \n            \n              103.0\n            \n          \n          \n            \n              10-2.00\n            \n          \n          \n            \n              10-1.98\n            \n          \n          \n            \n              10-1.96\n            \n          \n          \n            \n              10-1.94\n            \n          \n          \n            \n              10-1.92\n            \n          \n          \n            \n              10-1.90\n            \n          \n          \n            \n              10-1.88\n            \n          \n          \n            \n              10-1.86\n            \n          \n          \n            \n              10-1.84\n            \n          \n          \n            \n              10-1.82\n            \n          \n          \n            \n              10-1.80\n            \n          \n          \n            \n              10-1.78\n            \n          \n          \n            \n              10-1.76\n            \n          \n          \n            \n              10-1.74\n            \n          \n          \n            \n              10-1.72\n            \n          \n          \n            \n              10-1.70\n            \n          \n          \n            \n              10-1.68\n            \n          \n          \n            \n              10-1.66\n            \n          \n          \n            \n              10-1.64\n            \n          \n          \n            \n              10-1.62\n            \n          \n          \n            \n              10-1.60\n            \n          \n          \n            \n              10-1.58\n            \n          \n          \n            \n              10-1.56\n            \n          \n          \n            \n              10-1.54\n            \n          \n          \n            \n              10-1.52\n            \n          \n          \n            \n              10-1.50\n            \n          \n          \n            \n              10-1.48\n            \n          \n          \n            \n              10-1.46\n            \n          \n          \n            \n              10-1.44\n            \n          \n          \n            \n              10-1.42\n            \n          \n          \n            \n              10-1.40\n            \n          \n          \n            \n              10-1.38\n            \n          \n          \n            \n              10-1.36\n            \n          \n          \n            \n              10-1.34\n            \n          \n          \n            \n              10-1.32\n            \n          \n          \n            \n              10-1.30\n            \n          \n          \n            \n              10-1.28\n            \n          \n          \n            \n              10-1.26\n            \n          \n          \n            \n              10-1.24\n            \n          \n          \n            \n              10-1.22\n            \n          \n          \n            \n              10-1.20\n            \n          \n          \n            \n              10-1.18\n            \n          \n          \n            \n              10-1.16\n            \n          \n          \n            \n              10-1.14\n            \n          \n          \n            \n              10-1.12\n            \n          \n          \n            \n              10-1.10\n            \n          \n          \n            \n              10-1.08\n            \n          \n          \n            \n              10-1.06\n            \n          \n          \n            \n              10-1.04\n            \n          \n          \n            \n              10-1.02\n            \n          \n          \n            \n              10-1.00\n            \n          \n          \n            \n              10-0.98\n            \n          \n          \n            \n              10-0.96\n            \n          \n          \n            \n              10-0.94\n            \n          \n          \n            \n              10-0.92\n            \n          \n          \n            \n              10-0.90\n            \n          \n          \n            \n              10-0.88\n            \n          \n          \n            \n              10-0.86\n            \n          \n          \n            \n              10-0.84\n            \n          \n          \n            \n              10-0.82\n            \n          \n          \n            \n              10-0.80\n            \n          \n          \n            \n              10-0.78\n            \n          \n          \n            \n              10-0.76\n            \n          \n          \n            \n              10-0.74\n            \n          \n          \n            \n              10-0.72\n            \n          \n          \n            \n              10-0.70\n            \n          \n          \n            \n              10-0.68\n            \n          \n          \n            \n              10-0.66\n            \n          \n          \n            \n              10-0.64\n            \n          \n          \n            \n              10-0.62\n            \n          \n          \n            \n              10-0.60\n            \n          \n          \n            \n              10-0.58\n            \n          \n          \n            \n              10-0.56\n            \n          \n          \n            \n              10-0.54\n            \n          \n          \n            \n              10-0.52\n            \n          \n          \n            \n              10-0.50\n            \n          \n          \n            \n              10-0.48\n            \n          \n          \n            \n              10-0.46\n            \n          \n          \n            \n              10-0.44\n            \n          \n          \n            \n              10-0.42\n            \n          \n          \n            \n              10-0.40\n            \n          \n          \n            \n              10-0.38\n            \n          \n          \n            \n              10-0.36\n            \n          \n          \n            \n              10-0.34\n            \n          \n          \n            \n              10-0.32\n            \n          \n          \n            \n              10-0.30\n            \n          \n          \n            \n              10-0.28\n            \n          \n          \n            \n              10-0.26\n            \n          \n          \n            \n              10-0.24\n            \n          \n          \n            \n              10-0.22\n            \n          \n          \n            \n              10-0.20\n            \n          \n          \n            \n              10-0.18\n            \n          \n          \n            \n              10-0.16\n            \n          \n          \n            \n              10-0.14\n            \n          \n          \n            \n              10-0.12\n            \n          \n          \n            \n              10-0.10\n            \n          \n          \n            \n              10-0.08\n            \n          \n          \n            \n              10-0.06\n            \n          \n          \n            \n              10-0.04\n            \n          \n          \n            \n              10-0.02\n            \n          \n          \n            \n              100.00\n            \n          \n          \n            \n              100.02\n            \n          \n          \n            \n              100.04\n            \n          \n          \n            \n              100.06\n            \n          \n          \n            \n              100.08\n            \n          \n          \n            \n              100.10\n            \n          \n          \n            \n              100.12\n            \n          \n          \n            \n              100.14\n            \n          \n          \n            \n              100.16\n            \n          \n          \n            \n              100.18\n            \n          \n          \n            \n              100.20\n            \n          \n          \n            \n              100.22\n            \n          \n          \n            \n              100.24\n            \n          \n          \n            \n              100.26\n            \n          \n          \n            \n              100.28\n            \n          \n          \n            \n              100.30\n            \n          \n          \n            \n              100.32\n            \n          \n          \n            \n              100.34\n            \n          \n          \n            \n              100.36\n            \n          \n          \n            \n              100.38\n            \n          \n          \n            \n              100.40\n            \n          \n          \n            \n              100.42\n            \n          \n          \n            \n              100.44\n            \n          \n          \n            \n              100.46\n            \n          \n          \n            \n              100.48\n            \n          \n          \n            \n              100.50\n            \n          \n          \n            \n              100.52\n            \n          \n          \n            \n              100.54\n            \n          \n          \n            \n              100.56\n            \n          \n          \n            \n              100.58\n            \n          \n          \n            \n              100.60\n            \n          \n          \n            \n              100.62\n            \n          \n          \n            \n              100.64\n            \n          \n          \n            \n              100.66\n            \n          \n          \n            \n              100.68\n            \n          \n          \n            \n              100.70\n            \n          \n          \n            \n              100.72\n            \n          \n          \n            \n              100.74\n            \n          \n          \n            \n              100.76\n            \n          \n          \n            \n              100.78\n            \n          \n          \n            \n              100.80\n            \n          \n          \n            \n              100.82\n            \n          \n          \n            \n              100.84\n            \n          \n          \n            \n              100.86\n            \n          \n          \n            \n              100.88\n            \n          \n          \n            \n              100.90\n            \n          \n          \n            \n              100.92\n            \n          \n          \n            \n              100.94\n            \n          \n          \n            \n              100.96\n            \n          \n          \n            \n              100.98\n            \n          \n          \n            \n              101.00\n            \n          \n          \n            \n              101.02\n            \n          \n          \n            \n              101.04\n            \n          \n          \n            \n              101.06\n            \n          \n          \n            \n              101.08\n            \n          \n          \n            \n              101.10\n            \n          \n          \n            \n              101.12\n            \n          \n          \n            \n              101.14\n            \n          \n          \n            \n              101.16\n            \n          \n          \n            \n              101.18\n            \n          \n          \n            \n              101.20\n            \n          \n          \n            \n              101.22\n            \n          \n          \n            \n              101.24\n            \n          \n          \n            \n              101.26\n            \n          \n          \n            \n              101.28\n            \n          \n          \n            \n              101.30\n            \n          \n          \n            \n              101.32\n            \n          \n          \n            \n              101.34\n            \n          \n          \n            \n              101.36\n            \n          \n          \n            \n              101.38\n            \n          \n          \n            \n              101.40\n            \n          \n          \n            \n              101.42\n            \n          \n          \n            \n              101.44\n            \n          \n          \n            \n              101.46\n            \n          \n          \n            \n              101.48\n            \n          \n          \n            \n              101.50\n            \n          \n          \n            \n              101.52\n            \n          \n          \n            \n              101.54\n            \n          \n          \n            \n              101.56\n            \n          \n          \n            \n              101.58\n            \n          \n          \n            \n              101.60\n            \n          \n          \n            \n              101.62\n            \n          \n          \n            \n              101.64\n            \n          \n          \n            \n              101.66\n            \n          \n          \n            \n              101.68\n            \n          \n          \n            \n              101.70\n            \n          \n          \n            \n              101.72\n            \n          \n          \n            \n              101.74\n            \n          \n          \n            \n              101.76\n            \n          \n          \n            \n              101.78\n            \n          \n          \n            \n              101.80\n            \n          \n          \n            \n              101.82\n            \n          \n          \n            \n              101.84\n            \n          \n          \n            \n              101.86\n            \n          \n          \n            \n              101.88\n            \n          \n          \n            \n              101.90\n            \n          \n          \n            \n              101.92\n            \n          \n          \n            \n              101.94\n            \n          \n          \n            \n              101.96\n            \n          \n          \n            \n              101.98\n            \n          \n          \n            \n              102.00\n            \n          \n          \n            \n              102.02\n            \n          \n          \n            \n              102.04\n            \n          \n          \n            \n              102.06\n            \n          \n          \n            \n              102.08\n            \n          \n          \n            \n              102.10\n            \n          \n          \n            \n              102.12\n            \n          \n          \n            \n              102.14\n            \n          \n          \n            \n              102.16\n            \n          \n          \n            \n              102.18\n            \n          \n          \n            \n              102.20\n            \n          \n          \n            \n              102.22\n            \n          \n          \n            \n              102.24\n            \n          \n          \n            \n              102.26\n            \n          \n          \n            \n              102.28\n            \n          \n          \n            \n              102.30\n            \n          \n          \n            \n              102.32\n            \n          \n          \n            \n              102.34\n            \n          \n          \n            \n              102.36\n            \n          \n          \n            \n              102.38\n            \n          \n          \n            \n              102.40\n            \n          \n          \n            \n              102.42\n            \n          \n          \n            \n              102.44\n            \n          \n          \n            \n              102.46\n            \n          \n          \n            \n              102.48\n            \n          \n          \n            \n              102.50\n            \n          \n          \n            \n              102.52\n            \n          \n          \n            \n              102.54\n            \n          \n          \n            \n              102.56\n            \n          \n          \n            \n              102.58\n            \n          \n          \n            \n              102.60\n            \n          \n          \n            \n              102.62\n            \n          \n          \n            \n              102.64\n            \n          \n          \n            \n              102.66\n            \n          \n          \n            \n              102.68\n            \n          \n          \n            \n              102.70\n            \n          \n          \n            \n              102.72\n            \n          \n          \n            \n              102.74\n            \n          \n          \n            \n              102.76\n            \n          \n          \n            \n              102.78\n            \n          \n          \n            \n              102.80\n            \n          \n          \n            \n              102.82\n            \n          \n          \n            \n              102.84\n            \n          \n          \n            \n              102.86\n            \n          \n          \n            \n              102.88\n            \n          \n          \n            \n              102.90\n            \n          \n          \n            \n              102.92\n            \n          \n          \n            \n              102.94\n            \n          \n          \n            \n              102.96\n            \n          \n          \n            \n              102.98\n            \n          \n          \n            \n              103.00\n            \n          \n          \n            \n              10-3\n            \n          \n          \n            \n              100\n            \n          \n          \n            \n              103\n            \n          \n        \n      \n    \n  \n  \n    \n      \n        DepositedEnergy\n      \n    \n  \n\n\n  \n    \n  \n  \n    \n  \n  \n    \n  \n\n\n\n\n\n\n\n\nFigure 1: Deposited energy as a function of incident energy with diﬀerent Al layer thickness.",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Project",
      "Poor man's magnetometer"
    ]
  },
  {
    "objectID": "docs/courses/epss265/project/project.html#plot-the-energy-recorded-versus-the-incident-energy",
    "href": "docs/courses/epss265/project/project.html#plot-the-energy-recorded-versus-the-incident-energy",
    "title": "Poor man’s magnetometer",
    "section": "",
    "text": "Plot the energy recorded (past the Al) versus the incident energy, for beams of various energies, and for different thickness (10nm, 100nm, …). Use H+, He+, O+. Use SPENVIS or GEANT-4 for your modeling.\n\nThe energy loss of particles depends on the nature of particles (mass, charge, etc), the incident energy, and the thickness of the Al layer.\nFor the two-layer detector, where the ﬁrst layer is Al and the second layer is Silicon, the thickness of the Al layer varies from 0 nm to 100 nm with the thickness of the Si layer ﬁxed to 2 mm.\nAs shown in Figure 1, heavier ions like O+ deposits more energy in the Al layer than lighter ions like He+ and H+, leading to a smaller energy recorded by the Si layer.\nAnd for O+ with low incoming energy below a certain energy threshold \\(E\\), the recorded deposited energy in Si layer will drop to zero. This threshold energy \\(E\\) depends on the thickness of the Al layer \\(d\\). The thicker the Al layer, the higher the threshold energy.\n\\[E=E(d)\\]\nMore generally, the threshold energy \\(E\\) also depends the incident particle \\(s\\).\n\\[E=E(d,s)\\]\n\n\nCode\nusing Pkg\nPkg.add([\n    \"YAML\",\n    \"DataFrames\",\n    \"Gadfly\",\n    \"Unitful\",\n])\n\nusing YAML\nusing DataFrames\nusing Gadfly\nusing Unitful\n\n\n\n\nCode\nfunction parse_result_line(line)\n    values = split(line, ',')\n    Layer = parse(Int, values[1])\n    Thickness = parse(Float64, values[2])  # Assuming thickness in cm\n    Density = parse(Float64, values[3])    # Assuming density in g/cm3\n    Dose = parse(Float64, values[4])       # Assuming dose in keV\n    Error = try\n        parse(Float64, values[5])\n    catch _\n        NaN\n    end  # Handle '-nan' and other errors\n\n    return (Layer, Thickness, Density, Dose, Error)\nend\n\nfunction convert_data(yaml_data)\n    # Iterate through the data and convert each field\n    for entry in yaml_data\n        entry[\"layer.Al.thickness\"] = parse(Float64, replace(entry[\"layer.Al.thickness\"], \" um\" =&gt; \"\")) * 1000 * u\"nm\"\n        entry[\"source\"][\"energy\"] = parse(Float64, replace(entry[\"source\"][\"energy\"], \" MeV\" =&gt; \"\")) * 1000\n        entry[\"result\"] = [parse_result_line(line) for line in split(entry[\"result\"], '\\n') if line != \"\"]\n    end\n\n    df = DataFrame(\n        IncidentEnergy=[entry[\"source\"][\"energy\"] for entry in yaml_data],\n        DepositedEnergy=[entry[\"result\"][3][4] for entry in yaml_data],\n        SourceParticle=[entry[\"source\"][\"particle\"] for entry in yaml_data],\n        LayerAlThickness=[entry[\"layer.Al.thickness\"] for entry in yaml_data],\n    )\n\n    return df\nend\n\n\nconvert_data (generic function with 1 method)\n\n\n\n\nCode\nfunction read_data(filename=\"result.yml\")\n    # Read YAML file or string\n    filepath = joinpath(@__DIR__, \"run\", filename)\n    # Parse YAML content\n    parsed_data = YAML.load_file(filepath)\n\n    # Convert data to DataFrame\n    df = convert_data(parsed_data)\n\n    return df\nend\n\n\nread_data (generic function with 2 methods)\n\n\nThe result from SPENVIS is stored in a yaml file. We parse it and convert it to DataFrame for analysis.\n\n\nCode\ndf = read_data()\n\n\n26×4 DataFrame\n\n\n\nRow\nIncidentEnergy\nDepositedEnergy\nSourceParticle\nLayerAlThickness\n\n\n\nFloat64\nFloat64\nString\nQuantity…\n\n\n\n\n1\n10.0\n9.13347\nproton\n10.0 nm\n\n\n2\n1000.0\n999.495\nproton\n10.0 nm\n\n\n3\n10.0\n4.21557\nproton\n100.0 nm\n\n\n4\n1000.0\n994.992\nproton\n100.0 nm\n\n\n5\n10.0\n9.2096\nalpha\n10.0 nm\n\n\n6\n1000.0\n996.43\nalpha\n10.0 nm\n\n\n7\n10.0\n1.48217\nalpha\n100.0 nm\n\n\n8\n1000.0\n964.217\nalpha\n100.0 nm\n\n\n9\n5.0\n4.15482\nalpha\n10.0 nm\n\n\n10\n5.0\n0.0332675\nalpha\n100.0 nm\n\n\n11\n10.0\n0.0\no+\n100.0 nm\n\n\n12\n1000.0\n854.274\no+\n100.0 nm\n\n\n13\n1000.0\n984.925\no+\n10.0 nm\n\n\n14\n100.0\n95.0629\no+\n10.0 nm\n\n\n15\n50.0\n45.8783\no+\n10.0 nm\n\n\n16\n20.0\n15.5834\no+\n10.0 nm\n\n\n17\n10.0\n2.62646\no+\n10.0 nm\n\n\n18\n8.0\n0.678313\no+\n10.0 nm\n\n\n19\n5.0\n0.0383982\no+\n10.0 nm\n\n\n20\n5.0\n0.757253\nproton\n100.0 nm\n\n\n21\n100.0\n86.8131\nproton\n100.0 nm\n\n\n22\n100.0\n75.4222\nalpha\n100.0 nm\n\n\n23\n100.0\n51.4169\no+\n100.0 nm\n\n\n24\n50.0\n2.86204\no+\n100.0 nm\n\n\n25\n40.0\n0.0961512\no+\n100.0 nm\n\n\n26\n40.0\n25.4273\nalpha\n100.0 nm\n\n\n\n\n\n\n\n\nCode\n# Plot data with x = IncidentEnergy, y = DepositedEnergy, color = SourceParticle, facet = LayerAlThickness, using log scale on x-axis and y-axis\n\nplot(df,\n    x=:IncidentEnergy,\n    y=:DepositedEnergy,\n    color=:SourceParticle,\n    shape=:SourceParticle,\n    xgroup=:LayerAlThickness,\n    Geom.subplot_grid(Geom.line, Geom.point),\n    Scale.x_log10, Scale.y_log10,\n)\n# plot(df, x=:IncidentEnergy, y=:DepositedEnergy, color=:SourceParticle, linestyle=:LayerAlThickness, Geom.line, Scale.x_log10, Scale.y_log10)\n\n\n\n\n\n\n\n\n  \n    \n  \n\n\n  \n    \n      \n        IncidentEnergy by LayerAlThickness\n      \n    \n  \n  \n    \n      \n        \n          proton\n        \n      \n      \n        \n          alpha\n        \n      \n      \n        \n          o+\n        \n      \n    \n    \n      \n        \n          \n        \n      \n      \n        \n          \n        \n      \n      \n        \n          \n        \n      \n    \n    \n      \n        \n          SourceParticle\n        \n      \n    \n  \n  \n    \n      \n        \n          \n          \n        \n        \n          \n            \n              100.0 nm\n            \n          \n        \n        \n          \n            \n              10.0 nm\n            \n          \n        \n        \n          \n            \n              100\n            \n          \n          \n            \n              101\n            \n          \n          \n            \n              102\n            \n          \n          \n            \n              103\n            \n          \n          \n            \n              100.0\n            \n          \n          \n            \n              100.1\n            \n          \n          \n            \n              100.2\n            \n          \n          \n            \n              100.3\n            \n          \n          \n            \n              100.4\n            \n          \n          \n            \n              100.5\n            \n          \n          \n            \n              100.6\n            \n          \n          \n            \n              100.7\n            \n          \n          \n            \n              100.8\n            \n          \n          \n            \n              100.9\n            \n          \n          \n            \n              101.0\n            \n          \n          \n            \n              101.1\n            \n          \n          \n            \n              101.2\n            \n          \n          \n            \n              101.3\n            \n          \n          \n            \n              101.4\n            \n          \n          \n            \n              101.5\n            \n          \n          \n            \n              101.6\n            \n          \n          \n            \n              101.7\n            \n          \n          \n            \n              101.8\n            \n          \n          \n            \n              101.9\n            \n          \n          \n            \n              102.0\n            \n          \n          \n            \n              102.1\n            \n          \n          \n            \n              102.2\n            \n          \n          \n            \n              102.3\n            \n          \n          \n            \n              102.4\n            \n          \n          \n            \n              102.5\n            \n          \n          \n            \n              102.6\n            \n          \n          \n            \n              102.7\n            \n          \n          \n            \n              102.8\n            \n          \n          \n            \n              102.9\n            \n          \n          \n            \n              103.0\n            \n          \n          \n            \n              100.00\n            \n          \n          \n            \n              100.01\n            \n          \n          \n            \n              100.02\n            \n          \n          \n            \n              100.03\n            \n          \n          \n            \n              100.04\n            \n          \n          \n            \n              100.05\n            \n          \n          \n            \n              100.06\n            \n          \n          \n            \n              100.07\n            \n          \n          \n            \n              100.08\n            \n          \n          \n            \n              100.09\n            \n          \n          \n            \n              100.10\n            \n          \n          \n            \n              100.11\n            \n          \n          \n            \n              100.12\n            \n          \n          \n            \n              100.13\n            \n          \n          \n            \n              100.14\n            \n          \n          \n            \n              100.15\n            \n          \n          \n            \n              100.16\n            \n          \n          \n            \n              100.17\n            \n          \n          \n            \n              100.18\n            \n          \n          \n            \n              100.19\n            \n          \n          \n            \n              100.20\n            \n          \n          \n            \n              100.21\n            \n          \n          \n            \n              100.22\n            \n          \n          \n            \n              100.23\n            \n          \n          \n            \n              100.24\n            \n          \n          \n            \n              100.25\n            \n          \n          \n            \n              100.26\n            \n          \n          \n            \n              100.27\n            \n          \n          \n            \n              100.28\n            \n          \n          \n            \n              100.29\n            \n          \n          \n            \n              100.30\n            \n          \n          \n            \n              100.31\n            \n          \n          \n            \n              100.32\n            \n          \n          \n            \n              100.33\n            \n          \n          \n            \n              100.34\n            \n          \n          \n            \n              100.35\n            \n          \n          \n            \n              100.36\n            \n          \n          \n            \n              100.37\n            \n          \n          \n            \n              100.38\n            \n          \n          \n            \n              100.39\n            \n          \n          \n            \n              100.40\n            \n          \n          \n            \n              100.41\n            \n          \n          \n            \n              100.42\n            \n          \n          \n            \n              100.43\n            \n          \n          \n            \n              100.44\n            \n          \n          \n            \n              100.45\n            \n          \n          \n            \n              100.46\n            \n          \n          \n            \n              100.47\n            \n          \n          \n            \n              100.48\n            \n          \n          \n            \n              100.49\n            \n          \n          \n            \n              100.50\n            \n          \n          \n            \n              100.51\n            \n          \n          \n            \n              100.52\n            \n          \n          \n            \n              100.53\n            \n          \n          \n            \n              100.54\n            \n          \n          \n            \n              100.55\n            \n          \n          \n            \n              100.56\n            \n          \n          \n            \n              100.57\n            \n          \n          \n            \n              100.58\n            \n          \n          \n            \n              100.59\n            \n          \n          \n            \n              100.60\n            \n          \n          \n            \n              100.61\n            \n          \n          \n            \n              100.62\n            \n          \n          \n            \n              100.63\n            \n          \n          \n            \n              100.64\n            \n          \n          \n            \n              100.65\n            \n          \n          \n            \n              100.66\n            \n          \n          \n            \n              100.67\n            \n          \n          \n            \n              100.68\n            \n          \n          \n            \n              100.69\n            \n          \n          \n            \n              100.70\n            \n          \n          \n            \n              100.71\n            \n          \n          \n            \n              100.72\n            \n          \n          \n            \n              100.73\n            \n          \n          \n            \n              100.74\n            \n          \n          \n            \n              100.75\n            \n          \n          \n            \n              100.76\n            \n          \n          \n            \n              100.77\n            \n          \n          \n            \n              100.78\n            \n          \n          \n            \n              100.79\n            \n          \n          \n            \n              100.80\n            \n          \n          \n            \n              100.81\n            \n          \n          \n            \n              100.82\n            \n          \n          \n            \n              100.83\n            \n          \n          \n            \n              100.84\n            \n          \n          \n            \n              100.85\n            \n          \n          \n            \n              100.86\n            \n          \n          \n            \n              100.87\n            \n          \n          \n            \n              100.88\n            \n          \n          \n            \n              100.89\n            \n          \n          \n            \n              100.90\n            \n          \n          \n            \n              100.91\n            \n          \n          \n            \n              100.92\n            \n          \n          \n            \n              100.93\n            \n          \n          \n            \n              100.94\n            \n          \n          \n            \n              100.95\n            \n          \n          \n            \n              100.96\n            \n          \n          \n            \n              100.97\n            \n          \n          \n            \n              100.98\n            \n          \n          \n            \n              100.99\n            \n          \n          \n            \n              101.00\n            \n          \n          \n            \n              101.01\n            \n          \n          \n            \n              101.02\n            \n          \n          \n            \n              101.03\n            \n          \n          \n            \n              101.04\n            \n          \n          \n            \n              101.05\n            \n          \n          \n            \n              101.06\n            \n          \n          \n            \n              101.07\n            \n          \n          \n            \n              101.08\n            \n          \n          \n            \n              101.09\n            \n          \n          \n            \n              101.10\n            \n          \n          \n            \n              101.11\n            \n          \n          \n            \n              101.12\n            \n          \n          \n            \n              101.13\n            \n          \n          \n            \n              101.14\n            \n          \n          \n            \n              101.15\n            \n          \n          \n            \n              101.16\n            \n          \n          \n            \n              101.17\n            \n          \n          \n            \n              101.18\n            \n          \n          \n            \n              101.19\n            \n          \n          \n            \n              101.20\n            \n          \n          \n            \n              101.21\n            \n          \n          \n            \n              101.22\n            \n          \n          \n            \n              101.23\n            \n          \n          \n            \n              101.24\n            \n          \n          \n            \n              101.25\n            \n          \n          \n            \n              101.26\n            \n          \n          \n            \n              101.27\n            \n          \n          \n            \n              101.28\n            \n          \n          \n            \n              101.29\n            \n          \n          \n            \n              101.30\n            \n          \n          \n            \n              101.31\n            \n          \n          \n            \n              101.32\n            \n          \n          \n            \n              101.33\n            \n          \n          \n            \n              101.34\n            \n          \n          \n            \n              101.35\n            \n          \n          \n            \n              101.36\n            \n          \n          \n            \n              101.37\n            \n          \n          \n            \n              101.38\n            \n          \n          \n            \n              101.39\n            \n          \n          \n            \n              101.40\n            \n          \n          \n            \n              101.41\n            \n          \n          \n            \n              101.42\n            \n          \n          \n            \n              101.43\n            \n          \n          \n            \n              101.44\n            \n          \n          \n            \n              101.45\n            \n          \n          \n            \n              101.46\n            \n          \n          \n            \n              101.47\n            \n          \n          \n            \n              101.48\n            \n          \n          \n            \n              101.49\n            \n          \n          \n            \n              101.50\n            \n          \n          \n            \n              101.51\n            \n          \n          \n            \n              101.52\n            \n          \n          \n            \n              101.53\n            \n          \n          \n            \n              101.54\n            \n          \n          \n            \n              101.55\n            \n          \n          \n            \n              101.56\n            \n          \n          \n            \n              101.57\n            \n          \n          \n            \n              101.58\n            \n          \n          \n            \n              101.59\n            \n          \n          \n            \n              101.60\n            \n          \n          \n            \n              101.61\n            \n          \n          \n            \n              101.62\n            \n          \n          \n            \n              101.63\n            \n          \n          \n            \n              101.64\n            \n          \n          \n            \n              101.65\n            \n          \n          \n            \n              101.66\n            \n          \n          \n            \n              101.67\n            \n          \n          \n            \n              101.68\n            \n          \n          \n            \n              101.69\n            \n          \n          \n            \n              101.70\n            \n          \n          \n            \n              101.71\n            \n          \n          \n            \n              101.72\n            \n          \n          \n            \n              101.73\n            \n          \n          \n            \n              101.74\n            \n          \n          \n            \n              101.75\n            \n          \n          \n            \n              101.76\n            \n          \n          \n            \n              101.77\n            \n          \n          \n            \n              101.78\n            \n          \n          \n            \n              101.79\n            \n          \n          \n            \n              101.80\n            \n          \n          \n            \n              101.81\n            \n          \n          \n            \n              101.82\n            \n          \n          \n            \n              101.83\n            \n          \n          \n            \n              101.84\n            \n          \n          \n            \n              101.85\n            \n          \n          \n            \n              101.86\n            \n          \n          \n            \n              101.87\n            \n          \n          \n            \n              101.88\n            \n          \n          \n            \n              101.89\n            \n          \n          \n            \n              101.90\n            \n          \n          \n            \n              101.91\n            \n          \n          \n            \n              101.92\n            \n          \n          \n            \n              101.93\n            \n          \n          \n            \n              101.94\n            \n          \n          \n            \n              101.95\n            \n          \n          \n            \n              101.96\n            \n          \n          \n            \n              101.97\n            \n          \n          \n            \n              101.98\n            \n          \n          \n            \n              101.99\n            \n          \n          \n            \n              102.00\n            \n          \n          \n            \n              102.01\n            \n          \n          \n            \n              102.02\n            \n          \n          \n            \n              102.03\n            \n          \n          \n            \n              102.04\n            \n          \n          \n            \n              102.05\n            \n          \n          \n            \n              102.06\n            \n          \n          \n            \n              102.07\n            \n          \n          \n            \n              102.08\n            \n          \n          \n            \n              102.09\n            \n          \n          \n            \n              102.10\n            \n          \n          \n            \n              102.11\n            \n          \n          \n            \n              102.12\n            \n          \n          \n            \n              102.13\n            \n          \n          \n            \n              102.14\n            \n          \n          \n            \n              102.15\n            \n          \n          \n            \n              102.16\n            \n          \n          \n            \n              102.17\n            \n          \n          \n            \n              102.18\n            \n          \n          \n            \n              102.19\n            \n          \n          \n            \n              102.20\n            \n          \n          \n            \n              102.21\n            \n          \n          \n            \n              102.22\n            \n          \n          \n            \n              102.23\n            \n          \n          \n            \n              102.24\n            \n          \n          \n            \n              102.25\n            \n          \n          \n            \n              102.26\n            \n          \n          \n            \n              102.27\n            \n          \n          \n            \n              102.28\n            \n          \n          \n            \n              102.29\n            \n          \n          \n            \n              102.30\n            \n          \n          \n            \n              102.31\n            \n          \n          \n            \n              102.32\n            \n          \n          \n            \n              102.33\n            \n          \n          \n            \n              102.34\n            \n          \n          \n            \n              102.35\n            \n          \n          \n            \n              102.36\n            \n          \n          \n            \n              102.37\n            \n          \n          \n            \n              102.38\n            \n          \n          \n            \n              102.39\n            \n          \n          \n            \n              102.40\n            \n          \n          \n            \n              102.41\n            \n          \n          \n            \n              102.42\n            \n          \n          \n            \n              102.43\n            \n          \n          \n            \n              102.44\n            \n          \n          \n            \n              102.45\n            \n          \n          \n            \n              102.46\n            \n          \n          \n            \n              102.47\n            \n          \n          \n            \n              102.48\n            \n          \n          \n            \n              102.49\n            \n          \n          \n            \n              102.50\n            \n          \n          \n            \n              102.51\n            \n          \n          \n            \n              102.52\n            \n          \n          \n            \n              102.53\n            \n          \n          \n            \n              102.54\n            \n          \n          \n            \n              102.55\n            \n          \n          \n            \n              102.56\n            \n          \n          \n            \n              102.57\n            \n          \n          \n            \n              102.58\n            \n          \n          \n            \n              102.59\n            \n          \n          \n            \n              102.60\n            \n          \n          \n            \n              102.61\n            \n          \n          \n            \n              102.62\n            \n          \n          \n            \n              102.63\n            \n          \n          \n            \n              102.64\n            \n          \n          \n            \n              102.65\n            \n          \n          \n            \n              102.66\n            \n          \n          \n            \n              102.67\n            \n          \n          \n            \n              102.68\n            \n          \n          \n            \n              102.69\n            \n          \n          \n            \n              102.70\n            \n          \n          \n            \n              102.71\n            \n          \n          \n            \n              102.72\n            \n          \n          \n            \n              102.73\n            \n          \n          \n            \n              102.74\n            \n          \n          \n            \n              102.75\n            \n          \n          \n            \n              102.76\n            \n          \n          \n            \n              102.77\n            \n          \n          \n            \n              102.78\n            \n          \n          \n            \n              102.79\n            \n          \n          \n            \n              102.80\n            \n          \n          \n            \n              102.81\n            \n          \n          \n            \n              102.82\n            \n          \n          \n            \n              102.83\n            \n          \n          \n            \n              102.84\n            \n          \n          \n            \n              102.85\n            \n          \n          \n            \n              102.86\n            \n          \n          \n            \n              102.87\n            \n          \n          \n            \n              102.88\n            \n          \n          \n            \n              102.89\n            \n          \n          \n            \n              102.90\n            \n          \n          \n            \n              102.91\n            \n          \n          \n            \n              102.92\n            \n          \n          \n            \n              102.93\n            \n          \n          \n            \n              102.94\n            \n          \n          \n            \n              102.95\n            \n          \n          \n            \n              102.96\n            \n          \n          \n            \n              102.97\n            \n          \n          \n            \n              102.98\n            \n          \n          \n            \n              102.99\n            \n          \n          \n            \n              103.00\n            \n          \n          \n            \n              100\n            \n          \n          \n            \n              103\n            \n          \n        \n        \n          \n            \n              100\n            \n          \n          \n            \n              101\n            \n          \n          \n            \n              102\n            \n          \n          \n            \n              103\n            \n          \n          \n            \n              100.0\n            \n          \n          \n            \n              100.1\n            \n          \n          \n            \n              100.2\n            \n          \n          \n            \n              100.3\n            \n          \n          \n            \n              100.4\n            \n          \n          \n            \n              100.5\n            \n          \n          \n            \n              100.6\n            \n          \n          \n            \n              100.7\n            \n          \n          \n            \n              100.8\n            \n          \n          \n            \n              100.9\n            \n          \n          \n            \n              101.0\n            \n          \n          \n            \n              101.1\n            \n          \n          \n            \n              101.2\n            \n          \n          \n            \n              101.3\n            \n          \n          \n            \n              101.4\n            \n          \n          \n            \n              101.5\n            \n          \n          \n            \n              101.6\n            \n          \n          \n            \n              101.7\n            \n          \n          \n            \n              101.8\n            \n          \n          \n            \n              101.9\n            \n          \n          \n            \n              102.0\n            \n          \n          \n            \n              102.1\n            \n          \n          \n            \n              102.2\n            \n          \n          \n            \n              102.3\n            \n          \n          \n            \n              102.4\n            \n          \n          \n            \n              102.5\n            \n          \n          \n            \n              102.6\n            \n          \n          \n            \n              102.7\n            \n          \n          \n            \n              102.8\n            \n          \n          \n            \n              102.9\n            \n          \n          \n            \n              103.0\n            \n          \n          \n            \n              100.00\n            \n          \n          \n            \n              100.01\n            \n          \n          \n            \n              100.02\n            \n          \n          \n            \n              100.03\n            \n          \n          \n            \n              100.04\n            \n          \n          \n            \n              100.05\n            \n          \n          \n            \n              100.06\n            \n          \n          \n            \n              100.07\n            \n          \n          \n            \n              100.08\n            \n          \n          \n            \n              100.09\n            \n          \n          \n            \n              100.10\n            \n          \n          \n            \n              100.11\n            \n          \n          \n            \n              100.12\n            \n          \n          \n            \n              100.13\n            \n          \n          \n            \n              100.14\n            \n          \n          \n            \n              100.15\n            \n          \n          \n            \n              100.16\n            \n          \n          \n            \n              100.17\n            \n          \n          \n            \n              100.18\n            \n          \n          \n            \n              100.19\n            \n          \n          \n            \n              100.20\n            \n          \n          \n            \n              100.21\n            \n          \n          \n            \n              100.22\n            \n          \n          \n            \n              100.23\n            \n          \n          \n            \n              100.24\n            \n          \n          \n            \n              100.25\n            \n          \n          \n            \n              100.26\n            \n          \n          \n            \n              100.27\n            \n          \n          \n            \n              100.28\n            \n          \n          \n            \n              100.29\n            \n          \n          \n            \n              100.30\n            \n          \n          \n            \n              100.31\n            \n          \n          \n            \n              100.32\n            \n          \n          \n            \n              100.33\n            \n          \n          \n            \n              100.34\n            \n          \n          \n            \n              100.35\n            \n          \n          \n            \n              100.36\n            \n          \n          \n            \n              100.37\n            \n          \n          \n            \n              100.38\n            \n          \n          \n            \n              100.39\n            \n          \n          \n            \n              100.40\n            \n          \n          \n            \n              100.41\n            \n          \n          \n            \n              100.42\n            \n          \n          \n            \n              100.43\n            \n          \n          \n            \n              100.44\n            \n          \n          \n            \n              100.45\n            \n          \n          \n            \n              100.46\n            \n          \n          \n            \n              100.47\n            \n          \n          \n            \n              100.48\n            \n          \n          \n            \n              100.49\n            \n          \n          \n            \n              100.50\n            \n          \n          \n            \n              100.51\n            \n          \n          \n            \n              100.52\n            \n          \n          \n            \n              100.53\n            \n          \n          \n            \n              100.54\n            \n          \n          \n            \n              100.55\n            \n          \n          \n            \n              100.56\n            \n          \n          \n            \n              100.57\n            \n          \n          \n            \n              100.58\n            \n          \n          \n            \n              100.59\n            \n          \n          \n            \n              100.60\n            \n          \n          \n            \n              100.61\n            \n          \n          \n            \n              100.62\n            \n          \n          \n            \n              100.63\n            \n          \n          \n            \n              100.64\n            \n          \n          \n            \n              100.65\n            \n          \n          \n            \n              100.66\n            \n          \n          \n            \n              100.67\n            \n          \n          \n            \n              100.68\n            \n          \n          \n            \n              100.69\n            \n          \n          \n            \n              100.70\n            \n          \n          \n            \n              100.71\n            \n          \n          \n            \n              100.72\n            \n          \n          \n            \n              100.73\n            \n          \n          \n            \n              100.74\n            \n          \n          \n            \n              100.75\n            \n          \n          \n            \n              100.76\n            \n          \n          \n            \n              100.77\n            \n          \n          \n            \n              100.78\n            \n          \n          \n            \n              100.79\n            \n          \n          \n            \n              100.80\n            \n          \n          \n            \n              100.81\n            \n          \n          \n            \n              100.82\n            \n          \n          \n            \n              100.83\n            \n          \n          \n            \n              100.84\n            \n          \n          \n            \n              100.85\n            \n          \n          \n            \n              100.86\n            \n          \n          \n            \n              100.87\n            \n          \n          \n            \n              100.88\n            \n          \n          \n            \n              100.89\n            \n          \n          \n            \n              100.90\n            \n          \n          \n            \n              100.91\n            \n          \n          \n            \n              100.92\n            \n          \n          \n            \n              100.93\n            \n          \n          \n            \n              100.94\n            \n          \n          \n            \n              100.95\n            \n          \n          \n            \n              100.96\n            \n          \n          \n            \n              100.97\n            \n          \n          \n            \n              100.98\n            \n          \n          \n            \n              100.99\n            \n          \n          \n            \n              101.00\n            \n          \n          \n            \n              101.01\n            \n          \n          \n            \n              101.02\n            \n          \n          \n            \n              101.03\n            \n          \n          \n            \n              101.04\n            \n          \n          \n            \n              101.05\n            \n          \n          \n            \n              101.06\n            \n          \n          \n            \n              101.07\n            \n          \n          \n            \n              101.08\n            \n          \n          \n            \n              101.09\n            \n          \n          \n            \n              101.10\n            \n          \n          \n            \n              101.11\n            \n          \n          \n            \n              101.12\n            \n          \n          \n            \n              101.13\n            \n          \n          \n            \n              101.14\n            \n          \n          \n            \n              101.15\n            \n          \n          \n            \n              101.16\n            \n          \n          \n            \n              101.17\n            \n          \n          \n            \n              101.18\n            \n          \n          \n            \n              101.19\n            \n          \n          \n            \n              101.20\n            \n          \n          \n            \n              101.21\n            \n          \n          \n            \n              101.22\n            \n          \n          \n            \n              101.23\n            \n          \n          \n            \n              101.24\n            \n          \n          \n            \n              101.25\n            \n          \n          \n            \n              101.26\n            \n          \n          \n            \n              101.27\n            \n          \n          \n            \n              101.28\n            \n          \n          \n            \n              101.29\n            \n          \n          \n            \n              101.30\n            \n          \n          \n            \n              101.31\n            \n          \n          \n            \n              101.32\n            \n          \n          \n            \n              101.33\n            \n          \n          \n            \n              101.34\n            \n          \n          \n            \n              101.35\n            \n          \n          \n            \n              101.36\n            \n          \n          \n            \n              101.37\n            \n          \n          \n            \n              101.38\n            \n          \n          \n            \n              101.39\n            \n          \n          \n            \n              101.40\n            \n          \n          \n            \n              101.41\n            \n          \n          \n            \n              101.42\n            \n          \n          \n            \n              101.43\n            \n          \n          \n            \n              101.44\n            \n          \n          \n            \n              101.45\n            \n          \n          \n            \n              101.46\n            \n          \n          \n            \n              101.47\n            \n          \n          \n            \n              101.48\n            \n          \n          \n            \n              101.49\n            \n          \n          \n            \n              101.50\n            \n          \n          \n            \n              101.51\n            \n          \n          \n            \n              101.52\n            \n          \n          \n            \n              101.53\n            \n          \n          \n            \n              101.54\n            \n          \n          \n            \n              101.55\n            \n          \n          \n            \n              101.56\n            \n          \n          \n            \n              101.57\n            \n          \n          \n            \n              101.58\n            \n          \n          \n            \n              101.59\n            \n          \n          \n            \n              101.60\n            \n          \n          \n            \n              101.61\n            \n          \n          \n            \n              101.62\n            \n          \n          \n            \n              101.63\n            \n          \n          \n            \n              101.64\n            \n          \n          \n            \n              101.65\n            \n          \n          \n            \n              101.66\n            \n          \n          \n            \n              101.67\n            \n          \n          \n            \n              101.68\n            \n          \n          \n            \n              101.69\n            \n          \n          \n            \n              101.70\n            \n          \n          \n            \n              101.71\n            \n          \n          \n            \n              101.72\n            \n          \n          \n            \n              101.73\n            \n          \n          \n            \n              101.74\n            \n          \n          \n            \n              101.75\n            \n          \n          \n            \n              101.76\n            \n          \n          \n            \n              101.77\n            \n          \n          \n            \n              101.78\n            \n          \n          \n            \n              101.79\n            \n          \n          \n            \n              101.80\n            \n          \n          \n            \n              101.81\n            \n          \n          \n            \n              101.82\n            \n          \n          \n            \n              101.83\n            \n          \n          \n            \n              101.84\n            \n          \n          \n            \n              101.85\n            \n          \n          \n            \n              101.86\n            \n          \n          \n            \n              101.87\n            \n          \n          \n            \n              101.88\n            \n          \n          \n            \n              101.89\n            \n          \n          \n            \n              101.90\n            \n          \n          \n            \n              101.91\n            \n          \n          \n            \n              101.92\n            \n          \n          \n            \n              101.93\n            \n          \n          \n            \n              101.94\n            \n          \n          \n            \n              101.95\n            \n          \n          \n            \n              101.96\n            \n          \n          \n            \n              101.97\n            \n          \n          \n            \n              101.98\n            \n          \n          \n            \n              101.99\n            \n          \n          \n            \n              102.00\n            \n          \n          \n            \n              102.01\n            \n          \n          \n            \n              102.02\n            \n          \n          \n            \n              102.03\n            \n          \n          \n            \n              102.04\n            \n          \n          \n            \n              102.05\n            \n          \n          \n            \n              102.06\n            \n          \n          \n            \n              102.07\n            \n          \n          \n            \n              102.08\n            \n          \n          \n            \n              102.09\n            \n          \n          \n            \n              102.10\n            \n          \n          \n            \n              102.11\n            \n          \n          \n            \n              102.12\n            \n          \n          \n            \n              102.13\n            \n          \n          \n            \n              102.14\n            \n          \n          \n            \n              102.15\n            \n          \n          \n            \n              102.16\n            \n          \n          \n            \n              102.17\n            \n          \n          \n            \n              102.18\n            \n          \n          \n            \n              102.19\n            \n          \n          \n            \n              102.20\n            \n          \n          \n            \n              102.21\n            \n          \n          \n            \n              102.22\n            \n          \n          \n            \n              102.23\n            \n          \n          \n            \n              102.24\n            \n          \n          \n            \n              102.25\n            \n          \n          \n            \n              102.26\n            \n          \n          \n            \n              102.27\n            \n          \n          \n            \n              102.28\n            \n          \n          \n            \n              102.29\n            \n          \n          \n            \n              102.30\n            \n          \n          \n            \n              102.31\n            \n          \n          \n            \n              102.32\n            \n          \n          \n            \n              102.33\n            \n          \n          \n            \n              102.34\n            \n          \n          \n            \n              102.35\n            \n          \n          \n            \n              102.36\n            \n          \n          \n            \n              102.37\n            \n          \n          \n            \n              102.38\n            \n          \n          \n            \n              102.39\n            \n          \n          \n            \n              102.40\n            \n          \n          \n            \n              102.41\n            \n          \n          \n            \n              102.42\n            \n          \n          \n            \n              102.43\n            \n          \n          \n            \n              102.44\n            \n          \n          \n            \n              102.45\n            \n          \n          \n            \n              102.46\n            \n          \n          \n            \n              102.47\n            \n          \n          \n            \n              102.48\n            \n          \n          \n            \n              102.49\n            \n          \n          \n            \n              102.50\n            \n          \n          \n            \n              102.51\n            \n          \n          \n            \n              102.52\n            \n          \n          \n            \n              102.53\n            \n          \n          \n            \n              102.54\n            \n          \n          \n            \n              102.55\n            \n          \n          \n            \n              102.56\n            \n          \n          \n            \n              102.57\n            \n          \n          \n            \n              102.58\n            \n          \n          \n            \n              102.59\n            \n          \n          \n            \n              102.60\n            \n          \n          \n            \n              102.61\n            \n          \n          \n            \n              102.62\n            \n          \n          \n            \n              102.63\n            \n          \n          \n            \n              102.64\n            \n          \n          \n            \n              102.65\n            \n          \n          \n            \n              102.66\n            \n          \n          \n            \n              102.67\n            \n          \n          \n            \n              102.68\n            \n          \n          \n            \n              102.69\n            \n          \n          \n            \n              102.70\n            \n          \n          \n            \n              102.71\n            \n          \n          \n            \n              102.72\n            \n          \n          \n            \n              102.73\n            \n          \n          \n            \n              102.74\n            \n          \n          \n            \n              102.75\n            \n          \n          \n            \n              102.76\n            \n          \n          \n            \n              102.77\n            \n          \n          \n            \n              102.78\n            \n          \n          \n            \n              102.79\n            \n          \n          \n            \n              102.80\n            \n          \n          \n            \n              102.81\n            \n          \n          \n            \n              102.82\n            \n          \n          \n            \n              102.83\n            \n          \n          \n            \n              102.84\n            \n          \n          \n            \n              102.85\n            \n          \n          \n            \n              102.86\n            \n          \n          \n            \n              102.87\n            \n          \n          \n            \n              102.88\n            \n          \n          \n            \n              102.89\n            \n          \n          \n            \n              102.90\n            \n          \n          \n            \n              102.91\n            \n          \n          \n            \n              102.92\n            \n          \n          \n            \n              102.93\n            \n          \n          \n            \n              102.94\n            \n          \n          \n            \n              102.95\n            \n          \n          \n            \n              102.96\n            \n          \n          \n            \n              102.97\n            \n          \n          \n            \n              102.98\n            \n          \n          \n            \n              102.99\n            \n          \n          \n            \n              103.00\n            \n          \n          \n            \n              100\n            \n          \n          \n            \n              103\n            \n          \n        \n        \n          \n            \n              \n                \n              \n            \n            \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n            \n            \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n            \n            \n              \n                \n                \n              \n              \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.60205999132796231.4053007594228677\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.6020599913279623-1.0170453815831295\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.69897000433601870.4566763061569218\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        2.01.7111056354514849\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        2.01.8774990810832295\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        2.01.9385852646746489\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        0.6989700043360189-0.1207589401012299\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        3.02.931597137886862\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.0,-Inf\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        0.6989700043360189-1.4779802260869588\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        3.02.98417482925214\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.00.17089743261618665\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        3.02.9978197635088732\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.00.6248567172906062\n                      \n                    \n                  \n                \n              \n              \n                \n                  \n                \n                \n                  \n                \n                \n                  \n                \n              \n            \n          \n        \n        \n          \n            \n              \n                \n              \n            \n            \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n            \n            \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n              \n                \n              \n            \n            \n              \n                \n                \n              \n              \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        0.6989700043360189-1.415689472972055\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        0.9030899869919435-0.16856960341474359\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.00.4193712871079017\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.30102999566398131.1926613823570411\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.69897000433601871.6616075062630538\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        2.01.978011058799333\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        3.02.993403028848327\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        0.69897000433601890.6185523180390649\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        3.02.9984467945753503\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.00.9642406736070522\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        3.02.9997807127927865\n                      \n                    \n                  \n                \n                \n                  \n                    \n                      \n                    \n                  \n                  \n                    \n                      \n                        1.00.9606359017187183\n                      \n                    \n                  \n                \n              \n              \n                \n                  \n                \n                \n                  \n                \n                \n                  \n                \n              \n            \n          \n        \n        \n          \n            \n              10-2\n            \n          \n          \n            \n              10-1\n            \n          \n          \n            \n              100\n            \n          \n          \n            \n              101\n            \n          \n          \n            \n              102\n            \n          \n          \n            \n              103\n            \n          \n          \n            \n              10-2.0\n            \n          \n          \n            \n              10-1.8\n            \n          \n          \n            \n              10-1.6\n            \n          \n          \n            \n              10-1.4\n            \n          \n          \n            \n              10-1.2\n            \n          \n          \n            \n              10-1.0\n            \n          \n          \n            \n              10-0.8\n            \n          \n          \n            \n              10-0.6\n            \n          \n          \n            \n              10-0.4\n            \n          \n          \n            \n              10-0.2\n            \n          \n          \n            \n              100.0\n            \n          \n          \n            \n              100.2\n            \n          \n          \n            \n              100.4\n            \n          \n          \n            \n              100.6\n            \n          \n          \n            \n              100.8\n            \n          \n          \n            \n              101.0\n            \n          \n          \n            \n              101.2\n            \n          \n          \n            \n              101.4\n            \n          \n          \n            \n              101.6\n            \n          \n          \n            \n              101.8\n            \n          \n          \n            \n              102.0\n            \n          \n          \n            \n              102.2\n            \n          \n          \n            \n              102.4\n            \n          \n          \n            \n              102.6\n            \n          \n          \n            \n              102.8\n            \n          \n          \n            \n              103.0\n            \n          \n          \n            \n              10-2.00\n            \n          \n          \n            \n              10-1.98\n            \n          \n          \n            \n              10-1.96\n            \n          \n          \n            \n              10-1.94\n            \n          \n          \n            \n              10-1.92\n            \n          \n          \n            \n              10-1.90\n            \n          \n          \n            \n              10-1.88\n            \n          \n          \n            \n              10-1.86\n            \n          \n          \n            \n              10-1.84\n            \n          \n          \n            \n              10-1.82\n            \n          \n          \n            \n              10-1.80\n            \n          \n          \n            \n              10-1.78\n            \n          \n          \n            \n              10-1.76\n            \n          \n          \n            \n              10-1.74\n            \n          \n          \n            \n              10-1.72\n            \n          \n          \n            \n              10-1.70\n            \n          \n          \n            \n              10-1.68\n            \n          \n          \n            \n              10-1.66\n            \n          \n          \n            \n              10-1.64\n            \n          \n          \n            \n              10-1.62\n            \n          \n          \n            \n              10-1.60\n            \n          \n          \n            \n              10-1.58\n            \n          \n          \n            \n              10-1.56\n            \n          \n          \n            \n              10-1.54\n            \n          \n          \n            \n              10-1.52\n            \n          \n          \n            \n              10-1.50\n            \n          \n          \n            \n              10-1.48\n            \n          \n          \n            \n              10-1.46\n            \n          \n          \n            \n              10-1.44\n            \n          \n          \n            \n              10-1.42\n            \n          \n          \n            \n              10-1.40\n            \n          \n          \n            \n              10-1.38\n            \n          \n          \n            \n              10-1.36\n            \n          \n          \n            \n              10-1.34\n            \n          \n          \n            \n              10-1.32\n            \n          \n          \n            \n              10-1.30\n            \n          \n          \n            \n              10-1.28\n            \n          \n          \n            \n              10-1.26\n            \n          \n          \n            \n              10-1.24\n            \n          \n          \n            \n              10-1.22\n            \n          \n          \n            \n              10-1.20\n            \n          \n          \n            \n              10-1.18\n            \n          \n          \n            \n              10-1.16\n            \n          \n          \n            \n              10-1.14\n            \n          \n          \n            \n              10-1.12\n            \n          \n          \n            \n              10-1.10\n            \n          \n          \n            \n              10-1.08\n            \n          \n          \n            \n              10-1.06\n            \n          \n          \n            \n              10-1.04\n            \n          \n          \n            \n              10-1.02\n            \n          \n          \n            \n              10-1.00\n            \n          \n          \n            \n              10-0.98\n            \n          \n          \n            \n              10-0.96\n            \n          \n          \n            \n              10-0.94\n            \n          \n          \n            \n              10-0.92\n            \n          \n          \n            \n              10-0.90\n            \n          \n          \n            \n              10-0.88\n            \n          \n          \n            \n              10-0.86\n            \n          \n          \n            \n              10-0.84\n            \n          \n          \n            \n              10-0.82\n            \n          \n          \n            \n              10-0.80\n            \n          \n          \n            \n              10-0.78\n            \n          \n          \n            \n              10-0.76\n            \n          \n          \n            \n              10-0.74\n            \n          \n          \n            \n              10-0.72\n            \n          \n          \n            \n              10-0.70\n            \n          \n          \n            \n              10-0.68\n            \n          \n          \n            \n              10-0.66\n            \n          \n          \n            \n              10-0.64\n            \n          \n          \n            \n              10-0.62\n            \n          \n          \n            \n              10-0.60\n            \n          \n          \n            \n              10-0.58\n            \n          \n          \n            \n              10-0.56\n            \n          \n          \n            \n              10-0.54\n            \n          \n          \n            \n              10-0.52\n            \n          \n          \n            \n              10-0.50\n            \n          \n          \n            \n              10-0.48\n            \n          \n          \n            \n              10-0.46\n            \n          \n          \n            \n              10-0.44\n            \n          \n          \n            \n              10-0.42\n            \n          \n          \n            \n              10-0.40\n            \n          \n          \n            \n              10-0.38\n            \n          \n          \n            \n              10-0.36\n            \n          \n          \n            \n              10-0.34\n            \n          \n          \n            \n              10-0.32\n            \n          \n          \n            \n              10-0.30\n            \n          \n          \n            \n              10-0.28\n            \n          \n          \n            \n              10-0.26\n            \n          \n          \n            \n              10-0.24\n            \n          \n          \n            \n              10-0.22\n            \n          \n          \n            \n              10-0.20\n            \n          \n          \n            \n              10-0.18\n            \n          \n          \n            \n              10-0.16\n            \n          \n          \n            \n              10-0.14\n            \n          \n          \n            \n              10-0.12\n            \n          \n          \n            \n              10-0.10\n            \n          \n          \n            \n              10-0.08\n            \n          \n          \n            \n              10-0.06\n            \n          \n          \n            \n              10-0.04\n            \n          \n          \n            \n              10-0.02\n            \n          \n          \n            \n              100.00\n            \n          \n          \n            \n              100.02\n            \n          \n          \n            \n              100.04\n            \n          \n          \n            \n              100.06\n            \n          \n          \n            \n              100.08\n            \n          \n          \n            \n              100.10\n            \n          \n          \n            \n              100.12\n            \n          \n          \n            \n              100.14\n            \n          \n          \n            \n              100.16\n            \n          \n          \n            \n              100.18\n            \n          \n          \n            \n              100.20\n            \n          \n          \n            \n              100.22\n            \n          \n          \n            \n              100.24\n            \n          \n          \n            \n              100.26\n            \n          \n          \n            \n              100.28\n            \n          \n          \n            \n              100.30\n            \n          \n          \n            \n              100.32\n            \n          \n          \n            \n              100.34\n            \n          \n          \n            \n              100.36\n            \n          \n          \n            \n              100.38\n            \n          \n          \n            \n              100.40\n            \n          \n          \n            \n              100.42\n            \n          \n          \n            \n              100.44\n            \n          \n          \n            \n              100.46\n            \n          \n          \n            \n              100.48\n            \n          \n          \n            \n              100.50\n            \n          \n          \n            \n              100.52\n            \n          \n          \n            \n              100.54\n            \n          \n          \n            \n              100.56\n            \n          \n          \n            \n              100.58\n            \n          \n          \n            \n              100.60\n            \n          \n          \n            \n              100.62\n            \n          \n          \n            \n              100.64\n            \n          \n          \n            \n              100.66\n            \n          \n          \n            \n              100.68\n            \n          \n          \n            \n              100.70\n            \n          \n          \n            \n              100.72\n            \n          \n          \n            \n              100.74\n            \n          \n          \n            \n              100.76\n            \n          \n          \n            \n              100.78\n            \n          \n          \n            \n              100.80\n            \n          \n          \n            \n              100.82\n            \n          \n          \n            \n              100.84\n            \n          \n          \n            \n              100.86\n            \n          \n          \n            \n              100.88\n            \n          \n          \n            \n              100.90\n            \n          \n          \n            \n              100.92\n            \n          \n          \n            \n              100.94\n            \n          \n          \n            \n              100.96\n            \n          \n          \n            \n              100.98\n            \n          \n          \n            \n              101.00\n            \n          \n          \n            \n              101.02\n            \n          \n          \n            \n              101.04\n            \n          \n          \n            \n              101.06\n            \n          \n          \n            \n              101.08\n            \n          \n          \n            \n              101.10\n            \n          \n          \n            \n              101.12\n            \n          \n          \n            \n              101.14\n            \n          \n          \n            \n              101.16\n            \n          \n          \n            \n              101.18\n            \n          \n          \n            \n              101.20\n            \n          \n          \n            \n              101.22\n            \n          \n          \n            \n              101.24\n            \n          \n          \n            \n              101.26\n            \n          \n          \n            \n              101.28\n            \n          \n          \n            \n              101.30\n            \n          \n          \n            \n              101.32\n            \n          \n          \n            \n              101.34\n            \n          \n          \n            \n              101.36\n            \n          \n          \n            \n              101.38\n            \n          \n          \n            \n              101.40\n            \n          \n          \n            \n              101.42\n            \n          \n          \n            \n              101.44\n            \n          \n          \n            \n              101.46\n            \n          \n          \n            \n              101.48\n            \n          \n          \n            \n              101.50\n            \n          \n          \n            \n              101.52\n            \n          \n          \n            \n              101.54\n            \n          \n          \n            \n              101.56\n            \n          \n          \n            \n              101.58\n            \n          \n          \n            \n              101.60\n            \n          \n          \n            \n              101.62\n            \n          \n          \n            \n              101.64\n            \n          \n          \n            \n              101.66\n            \n          \n          \n            \n              101.68\n            \n          \n          \n            \n              101.70\n            \n          \n          \n            \n              101.72\n            \n          \n          \n            \n              101.74\n            \n          \n          \n            \n              101.76\n            \n          \n          \n            \n              101.78\n            \n          \n          \n            \n              101.80\n            \n          \n          \n            \n              101.82\n            \n          \n          \n            \n              101.84\n            \n          \n          \n            \n              101.86\n            \n          \n          \n            \n              101.88\n            \n          \n          \n            \n              101.90\n            \n          \n          \n            \n              101.92\n            \n          \n          \n            \n              101.94\n            \n          \n          \n            \n              101.96\n            \n          \n          \n            \n              101.98\n            \n          \n          \n            \n              102.00\n            \n          \n          \n            \n              102.02\n            \n          \n          \n            \n              102.04\n            \n          \n          \n            \n              102.06\n            \n          \n          \n            \n              102.08\n            \n          \n          \n            \n              102.10\n            \n          \n          \n            \n              102.12\n            \n          \n          \n            \n              102.14\n            \n          \n          \n            \n              102.16\n            \n          \n          \n            \n              102.18\n            \n          \n          \n            \n              102.20\n            \n          \n          \n            \n              102.22\n            \n          \n          \n            \n              102.24\n            \n          \n          \n            \n              102.26\n            \n          \n          \n            \n              102.28\n            \n          \n          \n            \n              102.30\n            \n          \n          \n            \n              102.32\n            \n          \n          \n            \n              102.34\n            \n          \n          \n            \n              102.36\n            \n          \n          \n            \n              102.38\n            \n          \n          \n            \n              102.40\n            \n          \n          \n            \n              102.42\n            \n          \n          \n            \n              102.44\n            \n          \n          \n            \n              102.46\n            \n          \n          \n            \n              102.48\n            \n          \n          \n            \n              102.50\n            \n          \n          \n            \n              102.52\n            \n          \n          \n            \n              102.54\n            \n          \n          \n            \n              102.56\n            \n          \n          \n            \n              102.58\n            \n          \n          \n            \n              102.60\n            \n          \n          \n            \n              102.62\n            \n          \n          \n            \n              102.64\n            \n          \n          \n            \n              102.66\n            \n          \n          \n            \n              102.68\n            \n          \n          \n            \n              102.70\n            \n          \n          \n            \n              102.72\n            \n          \n          \n            \n              102.74\n            \n          \n          \n            \n              102.76\n            \n          \n          \n            \n              102.78\n            \n          \n          \n            \n              102.80\n            \n          \n          \n            \n              102.82\n            \n          \n          \n            \n              102.84\n            \n          \n          \n            \n              102.86\n            \n          \n          \n            \n              102.88\n            \n          \n          \n            \n              102.90\n            \n          \n          \n            \n              102.92\n            \n          \n          \n            \n              102.94\n            \n          \n          \n            \n              102.96\n            \n          \n          \n            \n              102.98\n            \n          \n          \n            \n              103.00\n            \n          \n          \n            \n              10-3\n            \n          \n          \n            \n              100\n            \n          \n          \n            \n              103\n            \n          \n        \n      \n    \n  \n  \n    \n      \n        DepositedEnergy\n      \n    \n  \n\n\n  \n    \n  \n  \n    \n  \n  \n    \n  \n\n\n\n\n\n\n\n\nFigure 1: Deposited energy as a function of incident energy with diﬀerent Al layer thickness.",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Project",
      "Poor man's magnetometer"
    ]
  },
  {
    "objectID": "docs/courses/epss265/project/project.html#differentiate-monoenergetic-ions",
    "href": "docs/courses/epss265/project/project.html#differentiate-monoenergetic-ions",
    "title": "Poor man’s magnetometer",
    "section": "Differentiate monoenergetic ions",
    "text": "Differentiate monoenergetic ions\n\nDemonstrate that with a sufficient number of detectors you could differentiate monoenergetic protons, He+ and O+.\n\nAssuming the Protons constitute \\(n_1\\) percen, He+ \\(n_2\\), and O+ \\(n_3\\) of the incoming beam. For three unknown variables \\(n_1\\), \\(n_2\\), \\(n_3\\), we need at least three detectors to solve the equation system. With the first detector recording the total incoming energy \\(E_1\\), the second detector \\(E_2\\), and the third detector \\(E_3\\), we have the following equation system:\n\\[E_1 = n_1 E + n_2 E + n_3 E\\]\n\\[E_2 = n_1 \\alpha_{2,p} E + n_2 \\alpha_{2,He+} E + n_3 \\alpha_{2,O+} E\\]\n\\[E_3 = n_1 \\alpha_{3,p} E + n_2 \\alpha_{3,He+} E + n_3 \\alpha_{3,O+} E\\]\nwhere \\(\\alpha_{2,p}\\), \\(\\alpha_{2,He+}\\), \\(\\alpha_{2,O+}\\), \\(\\alpha_{3,p}\\), \\(\\alpha_{3,He+}\\), \\(\\alpha_{3,O+}\\) are 1- the energy loss ratio of protons, He+ and O+ in the Al layer of the second and third detector respectively.\nSince \\(\\alpha_{i,p}\\) can be determined from experiment/simulation, we can solve the above equation to get \\(n_1\\), \\(n_2\\), \\(n_3\\).\nIf we want to well differentiate monoenergetic protons, He+ and O+ with energy \\(E\\), we can reverse the relationship \\(E=E(d,s)\\) to get the thickness of the Al layer \\(d\\) for each ion. This is possible because theoretically the threshold energy \\(E\\) is a monotonic increasing function of the thickness of the Al layer \\(d\\).\n\\[d=d(E,s)\\]\nSo for a detector with a thickness \\(d_{O+}=d(E,O+)\\) of the Al layer, we only detect the deposited energy of protons and He+ in the Si layer. And for a detector with a thickness \\(d_{He+}=d(E,He+)\\) of the Al layer, we only detect the deposited energy of protons in the Si layer.\nThen we have additional \\(\\alpha_{2,O+}=0\\) and \\(\\alpha_{3,O+}=\\alpha_{3,He+}=0\\) in the equation system, simplifying the equation system to:\n\\[E_1 = n_1 E + n_2 E + n_3 E\\]\n\\[E_2 = n_1 \\alpha_{2,p} E + n_2 \\alpha_{2,He+} E\\]\n\\[E_3 = n_1 \\alpha_{3,p} E\\]\nTo demonstrate the differentiation, suppose the energy of the incoming beam is \\(E=100\\) keV.\nFrom the Figure 2, we can use the following thickness of the Al layer to differentiate the three ions:\n\n\\(d_{1} = d_{O+} \\approx 300 nm\\)\n\\(d_{2} = d_{He+} \\approx 610 nm\\)\n\nAnd we have \\(\\alpha_{2,p} \\approx 0.59\\), \\(\\alpha_{2,He+} \\approx 0.38\\) and \\(\\alpha_{3,p} \\approx 0.22\\) from the simulation. The equation is solvable.\n\n\nCode\ndf2 = read_data(\"result_2.yml\")\n\n\n15×4 DataFrame\n\n\n\nRow\nIncidentEnergy\nDepositedEnergy\nSourceParticle\nLayerAlThickness\n\n\n\nFloat64\nFloat64\nString\nQuantity…\n\n\n\n\n1\n100.0\n54.2355\nalpha\n200.0 nm\n\n\n2\n100.0\n36.5835\nalpha\n300.0 nm\n\n\n3\n100.0\n25.0133\nalpha\n400.0 nm\n\n\n4\n100.0\n20.4553\nalpha\n500.0 nm\n\n\n5\n100.0\n17.9386\nalpha\n600.0 nm\n\n\n6\n100.0\n17.4216\nalpha\n605.0 nm\n\n\n7\n100.0\n0.0\nalpha\n610.0 nm\n\n\n8\n100.0\n0.0\nalpha\n650.0 nm\n\n\n9\n100.0\n22.0127\nproton\n610.0 nm\n\n\n10\n100.0\n51.4169\nO+\n100.0 nm\n\n\n11\n100.0\n23.1507\nO+\n150.0 nm\n\n\n12\n100.0\n5.50822\nO+\n200.0 nm\n\n\n13\n100.0\n0.613181\nO+\n250.0 nm\n\n\n14\n100.0\n0.0124996\nO+\n300.0 nm\n\n\n15\n100.0\n59.3796\nproton\n300.0 nm\n\n\n\n\n\n\n\n\nCode\n# Plot data with x = LayerAlThickness, y = DepositedEnergy, color = SourceParticle\n\nplot(df2,\n    x=:LayerAlThickness,\n    y=:DepositedEnergy,\n    color=:SourceParticle,\n    Geom.line, Geom.point,\n)\n\n\n\n\n\n\n\n\n  \n    \n  \n\n\n  \n    \n      \n        LayerAlThickness\n      \n    \n  \n  \n    \n      \n        0.0 nm\n      \n    \n    \n      \n        200.0 nm\n      \n    \n    \n      \n        400.0 nm\n      \n    \n    \n      \n        600.0 nm\n      \n    \n    \n      \n        800.0 nm\n      \n    \n    \n      \n        0.0 nm\n      \n    \n    \n      \n        50.0 nm\n      \n    \n    \n      \n        100.0 nm\n      \n    \n    \n      \n        150.0 nm\n      \n    \n    \n      \n        200.0 nm\n      \n    \n    \n      \n        250.0 nm\n      \n    \n    \n      \n        300.0 nm\n      \n    \n    \n      \n        350.0 nm\n      \n    \n    \n      \n        400.0 nm\n      \n    \n    \n      \n        450.0 nm\n      \n    \n    \n      \n        500.0 nm\n      \n    \n    \n      \n        550.0 nm\n      \n    \n    \n      \n        600.0 nm\n      \n    \n    \n      \n        650.0 nm\n      \n    \n    \n      \n        700.0 nm\n      \n    \n    \n      \n        750.0 nm\n      \n    \n    \n      \n        800.0 nm\n      \n    \n    \n      \n        0.0 nm\n      \n    \n    \n      \n        5.0 nm\n      \n    \n    \n      \n        10.0 nm\n      \n    \n    \n      \n        15.0 nm\n      \n    \n    \n      \n        20.0 nm\n      \n    \n    \n      \n        25.0 nm\n      \n    \n    \n      \n        30.0 nm\n      \n    \n    \n      \n        35.0 nm\n      \n    \n    \n      \n        40.0 nm\n      \n    \n    \n      \n        45.0 nm\n      \n    \n    \n      \n        50.0 nm\n      \n    \n    \n      \n        55.0 nm\n      \n    \n    \n      \n        60.0 nm\n      \n    \n    \n      \n        65.0 nm\n      \n    \n    \n      \n        70.0 nm\n      \n    \n    \n      \n        75.0 nm\n      \n    \n    \n      \n        80.0 nm\n      \n    \n    \n      \n        85.0 nm\n      \n    \n    \n      \n        90.0 nm\n      \n    \n    \n      \n        95.0 nm\n      \n    \n    \n      \n        100.0 nm\n      \n    \n    \n      \n        105.0 nm\n      \n    \n    \n      \n        110.0 nm\n      \n    \n    \n      \n        115.0 nm\n      \n    \n    \n      \n        120.0 nm\n      \n    \n    \n      \n        125.0 nm\n      \n    \n    \n      \n        130.0 nm\n      \n    \n    \n      \n        135.0 nm\n      \n    \n    \n      \n        140.0 nm\n      \n    \n    \n      \n        145.0 nm\n      \n    \n    \n      \n        150.0 nm\n      \n    \n    \n      \n        155.0 nm\n      \n    \n    \n      \n        160.0 nm\n      \n    \n    \n      \n        165.0 nm\n      \n    \n    \n      \n        170.0 nm\n      \n    \n    \n      \n        175.0 nm\n      \n    \n    \n      \n        180.0 nm\n      \n    \n    \n      \n        185.0 nm\n      \n    \n    \n      \n        190.0 nm\n      \n    \n    \n      \n        195.0 nm\n      \n    \n    \n      \n        200.0 nm\n      \n    \n    \n      \n        205.0 nm\n      \n    \n    \n      \n        210.0 nm\n      \n    \n    \n      \n        215.0 nm\n      \n    \n    \n      \n        220.0 nm\n      \n    \n    \n      \n        225.0 nm\n      \n    \n    \n      \n        230.0 nm\n      \n    \n    \n      \n        235.0 nm\n      \n    \n    \n      \n        240.0 nm\n      \n    \n    \n      \n        245.0 nm\n      \n    \n    \n      \n        250.0 nm\n      \n    \n    \n      \n        255.0 nm\n      \n    \n    \n      \n        260.0 nm\n      \n    \n    \n      \n        265.0 nm\n      \n    \n    \n      \n        270.0 nm\n      \n    \n    \n      \n        275.0 nm\n      \n    \n    \n      \n        280.0 nm\n      \n    \n    \n      \n        285.0 nm\n      \n    \n    \n      \n        290.0 nm\n      \n    \n    \n      \n        295.0 nm\n      \n    \n    \n      \n        300.0 nm\n      \n    \n    \n      \n        305.0 nm\n      \n    \n    \n      \n        310.0 nm\n      \n    \n    \n      \n        315.0 nm\n      \n    \n    \n      \n        320.0 nm\n      \n    \n    \n      \n        325.0 nm\n      \n    \n    \n      \n        330.0 nm\n      \n    \n    \n      \n        335.0 nm\n      \n    \n    \n      \n        340.0 nm\n      \n    \n    \n      \n        345.0 nm\n      \n    \n    \n      \n        350.0 nm\n      \n    \n    \n      \n        355.0 nm\n      \n    \n    \n      \n        360.0 nm\n      \n    \n    \n      \n        365.0 nm\n      \n    \n    \n      \n        370.0 nm\n      \n    \n    \n      \n        375.0 nm\n      \n    \n    \n      \n        380.0 nm\n      \n    \n    \n      \n        385.0 nm\n      \n    \n    \n      \n        390.0 nm\n      \n    \n    \n      \n        395.0 nm\n      \n    \n    \n      \n        400.0 nm\n      \n    \n    \n      \n        405.0 nm\n      \n    \n    \n      \n        410.0 nm\n      \n    \n    \n      \n        415.0 nm\n      \n    \n    \n      \n        420.0 nm\n      \n    \n    \n      \n        425.0 nm\n      \n    \n    \n      \n        430.0 nm\n      \n    \n    \n      \n        435.0 nm\n      \n    \n    \n      \n        440.0 nm\n      \n    \n    \n      \n        445.0 nm\n      \n    \n    \n      \n        450.0 nm\n      \n    \n    \n      \n        455.0 nm\n      \n    \n    \n      \n        460.0 nm\n      \n    \n    \n      \n        465.0 nm\n      \n    \n    \n      \n        470.0 nm\n      \n    \n    \n      \n        475.0 nm\n      \n    \n    \n      \n        480.0 nm\n      \n    \n    \n      \n        485.0 nm\n      \n    \n    \n      \n        490.0 nm\n      \n    \n    \n      \n        495.0 nm\n      \n    \n    \n      \n        500.0 nm\n      \n    \n    \n      \n        505.0 nm\n      \n    \n    \n      \n        510.0 nm\n      \n    \n    \n      \n        515.0 nm\n      \n    \n    \n      \n        520.0 nm\n      \n    \n    \n      \n        525.0 nm\n      \n    \n    \n      \n        530.0 nm\n      \n    \n    \n      \n        535.0 nm\n      \n    \n    \n      \n        540.0 nm\n      \n    \n    \n      \n        545.0 nm\n      \n    \n    \n      \n        550.0 nm\n      \n    \n    \n      \n        555.0 nm\n      \n    \n    \n      \n        560.0 nm\n      \n    \n    \n      \n        565.0 nm\n      \n    \n    \n      \n        570.0 nm\n      \n    \n    \n      \n        575.0 nm\n      \n    \n    \n      \n        580.0 nm\n      \n    \n    \n      \n        585.0 nm\n      \n    \n    \n      \n        590.0 nm\n      \n    \n    \n      \n        595.0 nm\n      \n    \n    \n      \n        600.0 nm\n      \n    \n    \n      \n        605.0 nm\n      \n    \n    \n      \n        610.0 nm\n      \n    \n    \n      \n        615.0 nm\n      \n    \n    \n      \n        620.0 nm\n      \n    \n    \n      \n        625.0 nm\n      \n    \n    \n      \n        630.0 nm\n      \n    \n    \n      \n        635.0 nm\n      \n    \n    \n      \n        640.0 nm\n      \n    \n    \n      \n        645.0 nm\n      \n    \n    \n      \n        650.0 nm\n      \n    \n    \n      \n        655.0 nm\n      \n    \n    \n      \n        660.0 nm\n      \n    \n    \n      \n        665.0 nm\n      \n    \n    \n      \n        670.0 nm\n      \n    \n    \n      \n        675.0 nm\n      \n    \n    \n      \n        680.0 nm\n      \n    \n    \n      \n        685.0 nm\n      \n    \n    \n      \n        690.0 nm\n      \n    \n    \n      \n        695.0 nm\n      \n    \n    \n      \n        700.0 nm\n      \n    \n    \n      \n        705.0 nm\n      \n    \n    \n      \n        710.0 nm\n      \n    \n    \n      \n        715.0 nm\n      \n    \n    \n      \n        720.0 nm\n      \n    \n    \n      \n        725.0 nm\n      \n    \n    \n      \n        730.0 nm\n      \n    \n    \n      \n        735.0 nm\n      \n    \n    \n      \n        740.0 nm\n      \n    \n    \n      \n        745.0 nm\n      \n    \n    \n      \n        750.0 nm\n      \n    \n    \n      \n        755.0 nm\n      \n    \n    \n      \n        760.0 nm\n      \n    \n    \n      \n        765.0 nm\n      \n    \n    \n      \n        770.0 nm\n      \n    \n    \n      \n        775.0 nm\n      \n    \n    \n      \n        780.0 nm\n      \n    \n    \n      \n        785.0 nm\n      \n    \n    \n      \n        790.0 nm\n      \n    \n    \n      \n        795.0 nm\n      \n    \n    \n      \n        800.0 nm\n      \n    \n    \n      \n        0.0 nm\n      \n    \n    \n      \n        1000.0 nm\n      \n    \n  \n  \n    \n      \n        \n          alpha\n        \n      \n      \n        \n          proton\n        \n      \n      \n        \n          O+\n        \n      \n    \n    \n      \n        \n      \n      \n        \n      \n      \n        \n      \n    \n    \n      \n        \n          SourceParticle\n        \n      \n    \n  \n  \n    \n      \n        \n          \n        \n      \n      \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n      \n      \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n        \n          \n        \n      \n      \n        \n          \n          \n        \n        \n          \n            \n              \n                \n              \n            \n            \n              \n                \n                  300.0 nm59.37965\n                \n              \n            \n          \n          \n            \n              \n                \n              \n            \n            \n              \n                \n                  300.0 nm0.01249959\n                \n              \n            \n          \n          \n            \n              \n                \n              \n            \n            \n              \n                \n                  250.0 nm0.6131813\n                \n              \n            \n          \n          \n            \n              \n                \n              \n            \n            \n              \n                \n                  200.0 nm5.508216\n                \n              \n            \n          \n          \n            \n              \n                \n              \n            \n            \n              \n                \n                  150.0 nm23.15073\n                \n              \n            \n          \n          \n            \n              \n                \n              \n            \n            \n              \n                \n                  100.0 nm51.41687\n                \n              \n            \n          \n          \n            \n              \n                \n              \n            \n            \n              \n                \n                  610.0 nm22.01271\n                \n              \n            \n          \n          \n            \n              \n                \n              \n            \n            \n              \n                \n                  650.0 nm0.0\n                \n              \n            \n          \n          \n            \n              \n                \n              \n            \n            \n              \n                \n                  610.0 nm0.0\n                \n              \n            \n          \n          \n            \n              \n                \n              \n            \n            \n              \n                \n                  605.0 nm17.42164\n                \n              \n            \n          \n          \n            \n              \n                \n              \n            \n            \n              \n                \n                  600.0 nm17.93862\n                \n              \n            \n          \n          \n            \n              \n                \n              \n            \n            \n              \n                \n                  500.0 nm20.45534\n                \n              \n            \n          \n          \n            \n              \n                \n              \n            \n            \n              \n                \n                  400.0 nm25.01331\n                \n              \n            \n          \n          \n            \n              \n                \n              \n            \n            \n              \n                \n                  300.0 nm36.58353\n                \n              \n            \n          \n          \n            \n              \n                \n              \n            \n            \n              \n                \n                  200.0 nm54.2355\n                \n              \n            \n          \n        \n        \n          \n            \n          \n          \n            \n          \n          \n            \n          \n        \n      \n      \n        \n          \n            \n              \n            \n          \n        \n      \n      \n        \n          \n            \n              \n            \n          \n          \n            \n              \n                h,j,k,l,arrows,drag to pan\n              \n            \n            \n              \n                i,o,+,-,scroll,shift-drag to zoom\n              \n            \n            \n              \n                r,dbl-click to reset\n              \n            \n            \n              \n                c for coordinates\n              \n            \n            \n              \n                ? for help\n              \n            \n          \n        \n      \n      \n        \n          \n            \n              ?\n            \n          \n        \n      \n    \n  \n  \n    \n      \n        0\n      \n    \n    \n      \n        10\n      \n    \n    \n      \n        20\n      \n    \n    \n      \n        30\n      \n    \n    \n      \n        40\n      \n    \n    \n      \n        50\n      \n    \n    \n      \n        60\n      \n    \n    \n      \n        0.0\n      \n    \n    \n      \n        2.5\n      \n    \n    \n      \n        5.0\n      \n    \n    \n      \n        7.5\n      \n    \n    \n      \n        10.0\n      \n    \n    \n      \n        12.5\n      \n    \n    \n      \n        15.0\n      \n    \n    \n      \n        17.5\n      \n    \n    \n      \n        20.0\n      \n    \n    \n      \n        22.5\n      \n    \n    \n      \n        25.0\n      \n    \n    \n      \n        27.5\n      \n    \n    \n      \n        30.0\n      \n    \n    \n      \n        32.5\n      \n    \n    \n      \n        35.0\n      \n    \n    \n      \n        37.5\n      \n    \n    \n      \n        40.0\n      \n    \n    \n      \n        42.5\n      \n    \n    \n      \n        45.0\n      \n    \n    \n      \n        47.5\n      \n    \n    \n      \n        50.0\n      \n    \n    \n      \n        52.5\n      \n    \n    \n      \n        55.0\n      \n    \n    \n      \n        57.5\n      \n    \n    \n      \n        60.0\n      \n    \n    \n      \n        0.0\n      \n    \n    \n      \n        0.2\n      \n    \n    \n      \n        0.4\n      \n    \n    \n      \n        0.6\n      \n    \n    \n      \n        0.8\n      \n    \n    \n      \n        1.0\n      \n    \n    \n      \n        1.2\n      \n    \n    \n      \n        1.4\n      \n    \n    \n      \n        1.6\n      \n    \n    \n      \n        1.8\n      \n    \n    \n      \n        2.0\n      \n    \n    \n      \n        2.2\n      \n    \n    \n      \n        2.4\n      \n    \n    \n      \n        2.6\n      \n    \n    \n      \n        2.8\n      \n    \n    \n      \n        3.0\n      \n    \n    \n      \n        3.2\n      \n    \n    \n      \n        3.4\n      \n    \n    \n      \n        3.6\n      \n    \n    \n      \n        3.8\n      \n    \n    \n      \n        4.0\n      \n    \n    \n      \n        4.2\n      \n    \n    \n      \n        4.4\n      \n    \n    \n      \n        4.6\n      \n    \n    \n      \n        4.8\n      \n    \n    \n      \n        5.0\n      \n    \n    \n      \n        5.2\n      \n    \n    \n      \n        5.4\n      \n    \n    \n      \n        5.6\n      \n    \n    \n      \n        5.8\n      \n    \n    \n      \n        6.0\n      \n    \n    \n      \n        6.2\n      \n    \n    \n      \n        6.4\n      \n    \n    \n      \n        6.6\n      \n    \n    \n      \n        6.8\n      \n    \n    \n      \n        7.0\n      \n    \n    \n      \n        7.2\n      \n    \n    \n      \n        7.4\n      \n    \n    \n      \n        7.6\n      \n    \n    \n      \n        7.8\n      \n    \n    \n      \n        8.0\n      \n    \n    \n      \n        8.2\n      \n    \n    \n      \n        8.4\n      \n    \n    \n      \n        8.6\n      \n    \n    \n      \n        8.8\n      \n    \n    \n      \n        9.0\n      \n    \n    \n      \n        9.2\n      \n    \n    \n      \n        9.4\n      \n    \n    \n      \n        9.6\n      \n    \n    \n      \n        9.8\n      \n    \n    \n      \n        10.0\n      \n    \n    \n      \n        10.2\n      \n    \n    \n      \n        10.4\n      \n    \n    \n      \n        10.6\n      \n    \n    \n      \n        10.8\n      \n    \n    \n      \n        11.0\n      \n    \n    \n      \n        11.2\n      \n    \n    \n      \n        11.4\n      \n    \n    \n      \n        11.6\n      \n    \n    \n      \n        11.8\n      \n    \n    \n      \n        12.0\n      \n    \n    \n      \n        12.2\n      \n    \n    \n      \n        12.4\n      \n    \n    \n      \n        12.6\n      \n    \n    \n      \n        12.8\n      \n    \n    \n      \n        13.0\n      \n    \n    \n      \n        13.2\n      \n    \n    \n      \n        13.4\n      \n    \n    \n      \n        13.6\n      \n    \n    \n      \n        13.8\n      \n    \n    \n      \n        14.0\n      \n    \n    \n      \n        14.2\n      \n    \n    \n      \n        14.4\n      \n    \n    \n      \n        14.6\n      \n    \n    \n      \n        14.8\n      \n    \n    \n      \n        15.0\n      \n    \n    \n      \n        15.2\n      \n    \n    \n      \n        15.4\n      \n    \n    \n      \n        15.6\n      \n    \n    \n      \n        15.8\n      \n    \n    \n      \n        16.0\n      \n    \n    \n      \n        16.2\n      \n    \n    \n      \n        16.4\n      \n    \n    \n      \n        16.6\n      \n    \n    \n      \n        16.8\n      \n    \n    \n      \n        17.0\n      \n    \n    \n      \n        17.2\n      \n    \n    \n      \n        17.4\n      \n    \n    \n      \n        17.6\n      \n    \n    \n      \n        17.8\n      \n    \n    \n      \n        18.0\n      \n    \n    \n      \n        18.2\n      \n    \n    \n      \n        18.4\n      \n    \n    \n      \n        18.6\n      \n    \n    \n      \n        18.8\n      \n    \n    \n      \n        19.0\n      \n    \n    \n      \n        19.2\n      \n    \n    \n      \n        19.4\n      \n    \n    \n      \n        19.6\n      \n    \n    \n      \n        19.8\n      \n    \n    \n      \n        20.0\n      \n    \n    \n      \n        20.2\n      \n    \n    \n      \n        20.4\n      \n    \n    \n      \n        20.6\n      \n    \n    \n      \n        20.8\n      \n    \n    \n      \n        21.0\n      \n    \n    \n      \n        21.2\n      \n    \n    \n      \n        21.4\n      \n    \n    \n      \n        21.6\n      \n    \n    \n      \n        21.8\n      \n    \n    \n      \n        22.0\n      \n    \n    \n      \n        22.2\n      \n    \n    \n      \n        22.4\n      \n    \n    \n      \n        22.6\n      \n    \n    \n      \n        22.8\n      \n    \n    \n      \n        23.0\n      \n    \n    \n      \n        23.2\n      \n    \n    \n      \n        23.4\n      \n    \n    \n      \n        23.6\n      \n    \n    \n      \n        23.8\n      \n    \n    \n      \n        24.0\n      \n    \n    \n      \n        24.2\n      \n    \n    \n      \n        24.4\n      \n    \n    \n      \n        24.6\n      \n    \n    \n      \n        24.8\n      \n    \n    \n      \n        25.0\n      \n    \n    \n      \n        25.2\n      \n    \n    \n      \n        25.4\n      \n    \n    \n      \n        25.6\n      \n    \n    \n      \n        25.8\n      \n    \n    \n      \n        26.0\n      \n    \n    \n      \n        26.2\n      \n    \n    \n      \n        26.4\n      \n    \n    \n      \n        26.6\n      \n    \n    \n      \n        26.8\n      \n    \n    \n      \n        27.0\n      \n    \n    \n      \n        27.2\n      \n    \n    \n      \n        27.4\n      \n    \n    \n      \n        27.6\n      \n    \n    \n      \n        27.8\n      \n    \n    \n      \n        28.0\n      \n    \n    \n      \n        28.2\n      \n    \n    \n      \n        28.4\n      \n    \n    \n      \n        28.6\n      \n    \n    \n      \n        28.8\n      \n    \n    \n      \n        29.0\n      \n    \n    \n      \n        29.2\n      \n    \n    \n      \n        29.4\n      \n    \n    \n      \n        29.6\n      \n    \n    \n      \n        29.8\n      \n    \n    \n      \n        30.0\n      \n    \n    \n      \n        30.2\n      \n    \n    \n      \n        30.4\n      \n    \n    \n      \n        30.6\n      \n    \n    \n      \n        30.8\n      \n    \n    \n      \n        31.0\n      \n    \n    \n      \n        31.2\n      \n    \n    \n      \n        31.4\n      \n    \n    \n      \n        31.6\n      \n    \n    \n      \n        31.8\n      \n    \n    \n      \n        32.0\n      \n    \n    \n      \n        32.2\n      \n    \n    \n      \n        32.4\n      \n    \n    \n      \n        32.6\n      \n    \n    \n      \n        32.8\n      \n    \n    \n      \n        33.0\n      \n    \n    \n      \n        33.2\n      \n    \n    \n      \n        33.4\n      \n    \n    \n      \n        33.6\n      \n    \n    \n      \n        33.8\n      \n    \n    \n      \n        34.0\n      \n    \n    \n      \n        34.2\n      \n    \n    \n      \n        34.4\n      \n    \n    \n      \n        34.6\n      \n    \n    \n      \n        34.8\n      \n    \n    \n      \n        35.0\n      \n    \n    \n      \n        35.2\n      \n    \n    \n      \n        35.4\n      \n    \n    \n      \n        35.6\n      \n    \n    \n      \n        35.8\n      \n    \n    \n      \n        36.0\n      \n    \n    \n      \n        36.2\n      \n    \n    \n      \n        36.4\n      \n    \n    \n      \n        36.6\n      \n    \n    \n      \n        36.8\n      \n    \n    \n      \n        37.0\n      \n    \n    \n      \n        37.2\n      \n    \n    \n      \n        37.4\n      \n    \n    \n      \n        37.6\n      \n    \n    \n      \n        37.8\n      \n    \n    \n      \n        38.0\n      \n    \n    \n      \n        38.2\n      \n    \n    \n      \n        38.4\n      \n    \n    \n      \n        38.6\n      \n    \n    \n      \n        38.8\n      \n    \n    \n      \n        39.0\n      \n    \n    \n      \n        39.2\n      \n    \n    \n      \n        39.4\n      \n    \n    \n      \n        39.6\n      \n    \n    \n      \n        39.8\n      \n    \n    \n      \n        40.0\n      \n    \n    \n      \n        40.2\n      \n    \n    \n      \n        40.4\n      \n    \n    \n      \n        40.6\n      \n    \n    \n      \n        40.8\n      \n    \n    \n      \n        41.0\n      \n    \n    \n      \n        41.2\n      \n    \n    \n      \n        41.4\n      \n    \n    \n      \n        41.6\n      \n    \n    \n      \n        41.8\n      \n    \n    \n      \n        42.0\n      \n    \n    \n      \n        42.2\n      \n    \n    \n      \n        42.4\n      \n    \n    \n      \n        42.6\n      \n    \n    \n      \n        42.8\n      \n    \n    \n      \n        43.0\n      \n    \n    \n      \n        43.2\n      \n    \n    \n      \n        43.4\n      \n    \n    \n      \n        43.6\n      \n    \n    \n      \n        43.8\n      \n    \n    \n      \n        44.0\n      \n    \n    \n      \n        44.2\n      \n    \n    \n      \n        44.4\n      \n    \n    \n      \n        44.6\n      \n    \n    \n      \n        44.8\n      \n    \n    \n      \n        45.0\n      \n    \n    \n      \n        45.2\n      \n    \n    \n      \n        45.4\n      \n    \n    \n      \n        45.6\n      \n    \n    \n      \n        45.8\n      \n    \n    \n      \n        46.0\n      \n    \n    \n      \n        46.2\n      \n    \n    \n      \n        46.4\n      \n    \n    \n      \n        46.6\n      \n    \n    \n      \n        46.8\n      \n    \n    \n      \n        47.0\n      \n    \n    \n      \n        47.2\n      \n    \n    \n      \n        47.4\n      \n    \n    \n      \n        47.6\n      \n    \n    \n      \n        47.8\n      \n    \n    \n      \n        48.0\n      \n    \n    \n      \n        48.2\n      \n    \n    \n      \n        48.4\n      \n    \n    \n      \n        48.6\n      \n    \n    \n      \n        48.8\n      \n    \n    \n      \n        49.0\n      \n    \n    \n      \n        49.2\n      \n    \n    \n      \n        49.4\n      \n    \n    \n      \n        49.6\n      \n    \n    \n      \n        49.8\n      \n    \n    \n      \n        50.0\n      \n    \n    \n      \n        50.2\n      \n    \n    \n      \n        50.4\n      \n    \n    \n      \n        50.6\n      \n    \n    \n      \n        50.8\n      \n    \n    \n      \n        51.0\n      \n    \n    \n      \n        51.2\n      \n    \n    \n      \n        51.4\n      \n    \n    \n      \n        51.6\n      \n    \n    \n      \n        51.8\n      \n    \n    \n      \n        52.0\n      \n    \n    \n      \n        52.2\n      \n    \n    \n      \n        52.4\n      \n    \n    \n      \n        52.6\n      \n    \n    \n      \n        52.8\n      \n    \n    \n      \n        53.0\n      \n    \n    \n      \n        53.2\n      \n    \n    \n      \n        53.4\n      \n    \n    \n      \n        53.6\n      \n    \n    \n      \n        53.8\n      \n    \n    \n      \n        54.0\n      \n    \n    \n      \n        54.2\n      \n    \n    \n      \n        54.4\n      \n    \n    \n      \n        54.6\n      \n    \n    \n      \n        54.8\n      \n    \n    \n      \n        55.0\n      \n    \n    \n      \n        55.2\n      \n    \n    \n      \n        55.4\n      \n    \n    \n      \n        55.6\n      \n    \n    \n      \n        55.8\n      \n    \n    \n      \n        56.0\n      \n    \n    \n      \n        56.2\n      \n    \n    \n      \n        56.4\n      \n    \n    \n      \n        56.6\n      \n    \n    \n      \n        56.8\n      \n    \n    \n      \n        57.0\n      \n    \n    \n      \n        57.2\n      \n    \n    \n      \n        57.4\n      \n    \n    \n      \n        57.6\n      \n    \n    \n      \n        57.8\n      \n    \n    \n      \n        58.0\n      \n    \n    \n      \n        58.2\n      \n    \n    \n      \n        58.4\n      \n    \n    \n      \n        58.6\n      \n    \n    \n      \n        58.8\n      \n    \n    \n      \n        59.0\n      \n    \n    \n      \n        59.2\n      \n    \n    \n      \n        59.4\n      \n    \n    \n      \n        59.6\n      \n    \n    \n      \n        59.8\n      \n    \n    \n      \n        60.0\n      \n    \n    \n      \n        0\n      \n    \n    \n      \n        100\n      \n    \n  \n  \n    \n      \n        DepositedEnergy\n      \n    \n  \n\n\n  \n    \n  \n\n\n\n\n\n\n\n\nFigure 2: Deposited energy as a function of incident energy with diﬀerent Al layer thickness.",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Project",
      "Poor man's magnetometer"
    ]
  },
  {
    "objectID": "docs/courses/epss265/project/project.html#others",
    "href": "docs/courses/epss265/project/project.html#others",
    "title": "Poor man’s magnetometer",
    "section": "Others",
    "text": "Others\n\nDirections\n\n\nGeometry Definition\nSource particles\n\nHe+\n\nAtomic number: 2\nNucleon number: 4\n\n\nMaterial Definition\n\nThis will be done by creating a plot of energy deposited in Si as function of input energy. You will use freeware Geant-4 which simulates particle interaction with matter, through a portal: SPENVIS. Various models exist there (very useful site!).\nFirst you have to register, then create a project, then input your model input and output parameters, then make a run and get results one-energy-at-a-time. Once you know how to do that, then you must create an array of inputs and outputs outside of SPENVIS in your favorite plotting package (e.g., excel, python or other). You will then record those results and plot them, one array for protons, another for He+ and another for O+. You can try other species as well, for example O2+ which may be present in the low altitude ionosphere.\n\nAssume monoenergetic beams. The program allows you to use a simple ion spectrum. (For the bonus question you have to make a guess on the instrument response function, model it in a simple analytical form, then prove it can be done using Geant-4. You do not have to do the bonus.)\n\nFor your report, you should not repeat the steps I mention below, but just execute your outline above and go right to the findings, plots and discussion. In the discussion explain how you use the model to design a detector system (how many detectors, thicknesses, orientations etc) that does the job.\n\nOn SPENVIS after registration, name your project and proceed to use Geant-4 “MULASSIS”. You can save your run, and come back to it later.\nYour system will be a 3 layer system, where the first layer is air, the second Al of variable thickness and the third Silicon of a mm or two... enough to stop the highest energy of interest. You shoot some particles (10,000 is a good number), and record how much energy is deposited in Si. Excluding losses in the Si (phonons) the lost energy is mainly due to losses in the Aluminum. Pick the source parameters: How many/which ions, charge angle (-22 deg -&gt; 22 deg).\nFor Geometry you pick the layers above, and for Al choose 0, 1, 10 100 nm, one thickness at a time.\nSpecify the input as monoenergetic beam.\nSpecify analysis parameters as mean energy (the mean energy deposited based on the 10,000 particle run)\nCreate a macro (a bunch of commands that tell Geant-4 what to do) and Run.\nSee the plot\nOutput results (2 numbers) into your program next to input energy to build the in/out energy curve.\nRepeat, one point at a time.\nPlot results for one species and then (in different color) for other species.\nRepeat for different Al thicknesses.",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Project",
      "Poor man's magnetometer"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw06.html",
    "href": "docs/courses/epss265/homeworks/epss265_hw06.html",
    "title": "06 - FPI",
    "section": "",
    "text": "For an event/spacecraft of your choice from MMS (other than MMS3 for the event in the above crib provided), introduce L2 FPI ion and electron moments and eflux energy spectrograms. Explain what the region of space is (why the data are consistent with that region). Magnetic field is always useful to include. Use a geophysical coordinate system (GSM, GSE a\nal., Science 2016 and Torbert et al., Science 2018.\nUsing standard tools in mms_part_products, obtain gyro-velocity spectra of high-energy (5-10keV or 20-30keV) ions. Can you tell the gradient of those ions at the magnetopause, or the plasma sheet boundary layer from their duskward anisotropy?\nAlso using mms_part_products, obtain pitch angle spectra from FPI for low (100-1000eV) and high (10-20keV) electrons in a region surrounding magnetic reconnection (1-2min before and after). Can you tell where the anisotropy reverses from towards to away from the RX region? How do you interpret this reversal?\nWe choose MMS for this question. And the data is from 2015-10-16 13:00-14:00UT.\nIts locations plot together with related quicklook plots are shown below copied from (Burch et al. 2016) paper.\nFPI visualizations are shown below obtained from MMS/FPI Website.\nCode\nimport pyspedas\nfrom pyspedas import tcopy\nfrom pyspedas.mms.particles.mms_part_getspec import mms_part_getspec\nfrom pytplot import tplot, store_data, options\nCode\ntrangeOfInterest = [\"2015-10-16T13:05:30\", \"2015-10-16T13:08:30\"]\nmms_num = \"2\"\nfpi_data_rate = \"brst\"\nCode\nmms_sc = \"mms\" + mms_num\nmms_sc_f = mms_sc + \"_\"\nfpi_dr_f = \"_\" + fpi_data_rate\nCode\npyspedas.mms.fgm(trange=trangeOfInterest, probe=mms_num, time_clip=True)\npyspedas.mms.fpi(\n    trange=trangeOfInterest, probe=mms_num, time_clip=True, data_rate=fpi_data_rate\n)",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "06 - FPI"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw06.html#part-1",
    "href": "docs/courses/epss265/homeworks/epss265_hw06.html#part-1",
    "title": "06 - FPI",
    "section": "Part 1",
    "text": "Part 1\n\nMagnetic field panel\n\n\nCode\nfgm_tvar = \"fgm_b_gsm_srvy_l2_bvec\"\nfgm_tvar_f = mms_sc_f + fgm_tvar\nmag_panel = fgm_tvar_f\noptions(mag_panel, \"ytitle\", \"FGM \\n magnetic field\")\n\n\n\n\nEnergy panel\n\n\nCode\ni_energy_spectr_tvar = \"dis_energyspectr_omni\"\ne_energy_spectr_tvar = \"des_energyspectr_omni\"\n\ni_spectr_panel = mms_sc_f + i_energy_spectr_tvar + fpi_dr_f\ne_spectr_panel = mms_sc_f + e_energy_spectr_tvar + fpi_dr_f\noptions(i_spectr_panel, \"ytitle\", \"Ion \\n OMNI spectrum\")\noptions(e_spectr_panel, \"ytitle\", \"Electron \\n OMNI spectrum\")\n\n\n\n\nDensity panel\n\n\nCode\nnumberdensity_tvars = [\"des_numberdensity\", \"dis_numberdensity\"]\nnumberdensity_tvars_f = [mms_sc_f + tvar + fpi_dr_f for tvar in numberdensity_tvars]\n\nnumberdensity_panel = mms_sc_f + \"numberdensity\" + fpi_dr_f\n\nstore_data(numberdensity_panel, numberdensity_tvars_f)\noptions(numberdensity_panel, \"Color\", [\"black\", \"red\"])\noptions(numberdensity_panel, \"ytitle\", \"Number \\n density\")\n\n\n\n\nVelocity panel\n\n\nCode\ni_velocity_tvar = \"dis_bulkv_gse\"\ne_velocity_tvar = \"des_bulkv_gse\"\n\ni_velocity_panel = mms_sc_f + i_velocity_tvar + fpi_dr_f\ne_velocity_panel = mms_sc_f + e_velocity_tvar + fpi_dr_f\n\noptions(i_velocity_panel, \"ytitle\", \"Ion \\n velocity\")\noptions(e_velocity_panel, \"ytitle\", \"Electron \\n velocity\")\n\n\n\n\nTemperature panel\n\n\nCode\ni_temperature_tvars = [\"dis_temppara\", \"dis_tempperp\"]\ne_temperature_tvars = [\"des_temppara\", \"des_tempperp\"]\n\n\ni_temperature_tvars_f0 = [mms_sc_f + tvar + fpi_dr_f for tvar in i_temperature_tvars]\ne_temperature_tvars_f0 = [mms_sc_f + tvar + fpi_dr_f for tvar in e_temperature_tvars]\n\ni_temperature_panel = mms_sc_f + \"dis_temp\" + fpi_dr_f\ne_temperature_panel = mms_sc_f + \"des_temp\" + fpi_dr_f\n\nstore_data(i_temperature_panel, i_temperature_tvars_f0)\noptions(i_temperature_panel, \"Color\", [\"blue\", \"red\"])\noptions(i_temperature_panel, \"ytitle\", \"Ion \\n temperature\")\n\nstore_data(e_temperature_panel, e_temperature_tvars_f0)\noptions(e_temperature_panel, \"Color\", [\"blue\", \"red\"])\noptions(e_temperature_panel, \"ytitle\", \"Electron \\n temperature\")\n\n\n\n\nAll panels\n\n\nCode\ntvars2plot = [\n    mag_panel,\n    i_spectr_panel,\n    e_spectr_panel,\n    numberdensity_panel,\n    i_velocity_panel,\n    e_velocity_panel,\n    i_temperature_panel,\n    e_temperature_panel,\n]\ntplot(tvars2plot)\n\n\n\n\n\n\n\n\n\nWe can see that the spacecraft is crossing the magnetopause from the magnetosphere to the magnetosheath. The magnetic field is changing violently during the crossing. The density is increasing and the temperature is decreasing.",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "06 - FPI"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw06.html#part-2",
    "href": "docs/courses/epss265/homeworks/epss265_hw06.html#part-2",
    "title": "06 - FPI",
    "section": "Part 2",
    "text": "Part 2\n\nUsing standard tools in mms_part_products, obtain gyro-velocity spectra of high-energy (5-10keV or 20-30keV) ions. Can you tell the gradient of those ions at the magnetopause, or the plasma sheet boundary layer from their duskward anisotropy?\n\nWe can see from the figure below that the ions have aniostropy in the gryo-velocity spectra after the spacecraft crosses the magnetopause. The ion becomes more isotropic in the reconnecting region and in the magnetosphere.\nNote: burst mode data is super slow to calculate the spectra. So we use fast mode data instead.\n\n\nCode\nfpi_data_rate = \"fast\"\n\nlow_energy_range = [100, 1e3]\nhigh_energy_range = [1e4, 3e4]\n\n\n\n\nCode\ntvars2plot = mms_part_getspec(\n    trange=trangeOfInterest,\n    probe=mms_num,\n    species=\"i\",\n    data_rate=fpi_data_rate,\n    units=\"eflux\",\n    output=\"gyro\",\n    pitch=[45.0, 135.0],\n    energy=high_energy_range,\n)\n\n\n\n\nCode\ntplot(tvars2plot)",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "06 - FPI"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw06.html#part-3",
    "href": "docs/courses/epss265/homeworks/epss265_hw06.html#part-3",
    "title": "06 - FPI",
    "section": "Part 3",
    "text": "Part 3\n\nAlso using mms_part_products, obtain pitch angle spectra from FPI for low (100-1000eV) and high (10-20keV) electrons in a region surrounding magnetic reconnection (1-2min before and after). Can you tell where the anisotropy reverses from towards to away from the RX region? How do you interpret this reversal?\n\nParticles that travel parallel and antiparallel to the magnetic field are respectively located near the bottom and the top of the pitch angle spectrum.\nAlthough the particles travelling antiparallel to the magnetic field increase after the spacecraft crosses the magnetopause, the particles travelling parallel to the magnetic field still dominate the pitch angle spectrum for low energy electrons.\nFor the high energy electrons, this is no clear anisotropy in the pitch angle spectrum, which may be due to the use of fast mode data instead of burst mode data.\n\n\nCode\nspecies = \"e\"\nfpi_data_rate = \"fast\"\noutput=\"pa\"\n\nlow_energy_range = [100, 1e3]\nhigh_energy_range = [1e4, 2e4]\n\n\n\n\nCode\ntemp_tvar = mms_part_getspec(\n    trange=trangeOfInterest,\n    probe=mms_num,\n    species=species,\n    data_rate=fpi_data_rate,\n    output=output,\n    energy=low_energy_range\n)\ntcopy(temp_tvar[0], \"low_energy_electron_pa\")\n\ntemp_tvar = mms_part_getspec(\n    trange=trangeOfInterest,\n    probe=mms_num,\n    species=species,\n    data_rate=fpi_data_rate,\n    output=output,\n    energy=high_energy_range\n)\ntcopy(temp_tvar[0], \"high_energy_electron_pa\")\n\n\n\n\nCode\ntplot([\"low_energy_electron_pa\", \"high_energy_electron_pa\"])",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "06 - FPI"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw02.html",
    "href": "docs/courses/epss265/homeworks/epss265_hw02.html",
    "title": "02 - FGM Basics",
    "section": "",
    "text": "Obtain FGM data from THM (Level 1) or MMS (L2) or from ground based magnetometers (gmags) and plot it using SPEDAS (cmd line or gui, IDL or python).\nIf you are unsure which date to pick you can use:\n\nFor THEMIS data: 2008-02-26/04-06 UT (P3-5 or D,E,A) [see plots here]\nFor ground-based magnetometer data: same as above (e.g., stations Gillam, or Carson City, NV) [plots here]\nFor MMS data: 2015-10-16/08-14 UT (MMS1-4) [see plot here]\n\n\n\n\nCode\nimport pyspedas\nfrom pytplot import tplot, get_data, store_data, options\nfrom pipe import select\n\n\n\n\nCode\ntrange = ['2008-02-26T04:00', '2008-02-26T06:00']\nprobes = ['d', 'e', 'a']\n\npyspedas.themis.fgm(trange=trange, probe=probes, level='l1', time_clip=True)\n\n\n\n\nCode\ndatatype = 'fgl'\ntvar_format = \"th{probe}_{datatype}\"\ntvars =  list(probes | select(lambda x: tvar_format.format(probe=x, datatype=datatype)))\n\ntplot(tvars)",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "02 - FGM Basics"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw02.html#question-1",
    "href": "docs/courses/epss265/homeworks/epss265_hw02.html#question-1",
    "title": "02 - FGM Basics",
    "section": "",
    "text": "Obtain FGM data from THM (Level 1) or MMS (L2) or from ground based magnetometers (gmags) and plot it using SPEDAS (cmd line or gui, IDL or python).\nIf you are unsure which date to pick you can use:\n\nFor THEMIS data: 2008-02-26/04-06 UT (P3-5 or D,E,A) [see plots here]\nFor ground-based magnetometer data: same as above (e.g., stations Gillam, or Carson City, NV) [plots here]\nFor MMS data: 2015-10-16/08-14 UT (MMS1-4) [see plot here]\n\n\n\n\nCode\nimport pyspedas\nfrom pytplot import tplot, get_data, store_data, options\nfrom pipe import select\n\n\n\n\nCode\ntrange = ['2008-02-26T04:00', '2008-02-26T06:00']\nprobes = ['d', 'e', 'a']\n\npyspedas.themis.fgm(trange=trange, probe=probes, level='l1', time_clip=True)\n\n\n\n\nCode\ndatatype = 'fgl'\ntvar_format = \"th{probe}_{datatype}\"\ntvars =  list(probes | select(lambda x: tvar_format.format(probe=x, datatype=datatype)))\n\ntplot(tvars)",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "02 - FGM Basics"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw02.html#question-2",
    "href": "docs/courses/epss265/homeworks/epss265_hw02.html#question-2",
    "title": "02 - FGM Basics",
    "section": "Question 2",
    "text": "Question 2\n\nProcess your data: compute the total field from its components and plot it in the same panel as the three components using colors b/g/r/black for x/y/z/t.\n\n\n\nCode\nfrom xarray_einstats import linalg\nfrom pytplot import split_vec, join_vec\n\n\nWe define a utility function to compute the total field from its components, see below\n\n\nCode\n\ndef _tvectot(tvar: str, new_name: str, join_component: bool):\n    data = get_data(tvar, xarray=True)\n    new_data = linalg.norm(data, dims=\"v_dim\")\n    store_data(new_name, new_data, xarray=True)\n    \n    if join_vec:\n        join_vec(split_vec(tvar)+[new_name], new_name)\n        options(new_name, 'legend_names', ['x', 'y', 'z', 'Magnitude'])\n    else:\n        options(new_name, 'legend_names', 'Magnitude')\n    return new_name\n\ndef tvectot(tvars: str | list[str], newnames: str | list[str] = None, suffix=\"_mag\", join_component=False) -&gt; str | list[str]:\n    \"\"\"\n    Computes the magnitude of a vector time series.\n\n    Parameters\n    ----------\n    - tvars : Names of the tplot variables.\n    - new_names: Names for the resultant magnitude tplot variables. If not provided, it appends the suffix to `tvars`.\n    - suffix: The suffix to append to tensor_names to form new_names if new_names is not provided.\n    - join_component: If True, the magnitude tplot variable is joined with the component tplot variables.\n\n    Returns\n    -------\n    Names of the magnitude tplot variables.\n    \"\"\"\n    tvars_type = type(tvars)\n    if tvars_type == str:\n        tvars = [tvars]\n    if join_vec:\n        suffix = \"_tot\"\n\n    if newnames is None:\n        newnames = [tvar + suffix for tvar in tvars]\n\n    for tvar, newname in zip(tvars, newnames):\n        _tvectot(tvar, newname, join_component)\n    \n    if tvars_type == str:\n        return newnames[0]\n    else:\n        return newnames\n\n\n\n\nCode\ntvar_tots = tvectot(tvars, join_component=True)\ntplot(tvar_tots)",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "02 - FGM Basics"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw02.html#question-3",
    "href": "docs/courses/epss265/homeworks/epss265_hw02.html#question-3",
    "title": "02 - FGM Basics",
    "section": "Question 3",
    "text": "Question 3\n\nShow the locations of the spacecraft or the ground-based station you used above in relevant geophysical coordinates (GSE, GSM, MAG, …) from a webbased tool (tipsod or other) or plot it in SPEDAS (you can find cribs for that).\n\nTHEMIS website provides good summary plot of the spacecraft locations in various coordinate systems, see here\nIt is also possible to use SSC Locator Graphics, which is also more general.",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "02 - FGM Basics"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw03.html",
    "href": "docs/courses/epss265/homeworks/epss265_hw03.html",
    "title": "03 - SCM Noise Curves",
    "section": "",
    "text": "NASA’s Science Mission Directorate (SMD) held its Fall Quarterly town hall meeting with the public. The event was led by NASA’s Associate Administrator for Science, Dr. Nicky Fox, and representatives of all SMD Divisions who answered questions submitted by the public on October 19. This one-hour event was advertised in advance at smd@listsrv2.nasaprs.com (enlist if you like). Watch the recorded video from that here.\n\nHow does NASA deal with starts for new missions, like UOP, if budgets are tight?\nHow does NASA deal with continuing resolutions (CRs) and with government shutdowns?\nHow will NASA/Biological Physical sciences respond to its recent NAS Decadal Survey?\nWhat are the 2 most interesting science highlights presented by the various divisions?\n\n\n\nGenerally, NASA will reallocate budget: it may adjust its portfolio to prioritize high-priority missions. This could mean delaying or scaling back other projects or seeking additional funds specifically earmarked for the mission. For Uranus Orbiter and Probe (UOP) specifically, NASA most likely will not initialize it in the next few years.\nDuring a Continuing Resolution, NASA can generally continue its operations at funding levels approved in the previous fiscal year but cannot start new projects and pend the amount of fundings. In the case of a government shutdown, non-essential operations are suspended, and only critical mission operations, like support for the International Space Station and maintaining mission properties. Scheduled launches will be postponed and administrative functions will be suspended.\nNASA’s Biological and Physical Sciences division would typically use the recommendations from the National Academies of Sciences (NAS) Decadal Survey to shape its research agenda. The division will hold a townhall which shares and discusses their responds. The survey is influential in determining funding priorities and research directions. The agency may: adjust its research priorities, reallocate resources and personnel as identified in the survey.\nHighlights\n\nAstro highlight:\n\nWebb Discovers Methane, Carbon Dioxide in Atmosphere of K2-18 b\nLaunch of XRISM and Euclid missions\n\nBiological and Physical Sciences highlight:\n\nGene transcription (gravity variable)\n\nPlanetary highlight:\n\nSample return OSIRIS-REx and first analysis\nCelebration of DART success\nLaunch of Psyche mission\nDinkinesh Flyby of Lucy mission\n\nHeliophysics highlight:\n\nHeliophysics Big Year, a global celebration of solar science\nSolar Eclipse\nLaunch of AWE (Atmospheric Waves Experiment) mission\n\nEarth highlight:\n\nLaunch of TEMPO (Tropospheric Emissions: Monitoring of Pollution) mission\nLaunch of Earth Surface Mineral Dust Source Investigation (EMIT) and OCO-3 instruments",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "03 - SCM Noise Curves"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw03.html#question-1",
    "href": "docs/courses/epss265/homeworks/epss265_hw03.html#question-1",
    "title": "03 - SCM Noise Curves",
    "section": "",
    "text": "NASA’s Science Mission Directorate (SMD) held its Fall Quarterly town hall meeting with the public. The event was led by NASA’s Associate Administrator for Science, Dr. Nicky Fox, and representatives of all SMD Divisions who answered questions submitted by the public on October 19. This one-hour event was advertised in advance at smd@listsrv2.nasaprs.com (enlist if you like). Watch the recorded video from that here.\n\nHow does NASA deal with starts for new missions, like UOP, if budgets are tight?\nHow does NASA deal with continuing resolutions (CRs) and with government shutdowns?\nHow will NASA/Biological Physical sciences respond to its recent NAS Decadal Survey?\nWhat are the 2 most interesting science highlights presented by the various divisions?\n\n\n\nGenerally, NASA will reallocate budget: it may adjust its portfolio to prioritize high-priority missions. This could mean delaying or scaling back other projects or seeking additional funds specifically earmarked for the mission. For Uranus Orbiter and Probe (UOP) specifically, NASA most likely will not initialize it in the next few years.\nDuring a Continuing Resolution, NASA can generally continue its operations at funding levels approved in the previous fiscal year but cannot start new projects and pend the amount of fundings. In the case of a government shutdown, non-essential operations are suspended, and only critical mission operations, like support for the International Space Station and maintaining mission properties. Scheduled launches will be postponed and administrative functions will be suspended.\nNASA’s Biological and Physical Sciences division would typically use the recommendations from the National Academies of Sciences (NAS) Decadal Survey to shape its research agenda. The division will hold a townhall which shares and discusses their responds. The survey is influential in determining funding priorities and research directions. The agency may: adjust its research priorities, reallocate resources and personnel as identified in the survey.\nHighlights\n\nAstro highlight:\n\nWebb Discovers Methane, Carbon Dioxide in Atmosphere of K2-18 b\nLaunch of XRISM and Euclid missions\n\nBiological and Physical Sciences highlight:\n\nGene transcription (gravity variable)\n\nPlanetary highlight:\n\nSample return OSIRIS-REx and first analysis\nCelebration of DART success\nLaunch of Psyche mission\nDinkinesh Flyby of Lucy mission\n\nHeliophysics highlight:\n\nHeliophysics Big Year, a global celebration of solar science\nSolar Eclipse\nLaunch of AWE (Atmospheric Waves Experiment) mission\n\nEarth highlight:\n\nLaunch of TEMPO (Tropospheric Emissions: Monitoring of Pollution) mission\nLaunch of Earth Surface Mineral Dust Source Investigation (EMIT) and OCO-3 instruments",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "03 - SCM Noise Curves"
    ]
  },
  {
    "objectID": "docs/courses/epss265/homeworks/epss265_hw03.html#question-2",
    "href": "docs/courses/epss265/homeworks/epss265_hw03.html#question-2",
    "title": "03 - SCM Noise Curves",
    "section": "Question 2",
    "text": "Question 2\n\nFor a day/time of interestNote1 from THEMIS or MMS, based on your perusal of the overview plots at the mission website, and using standard tools:\n\nPlot SCM time-series data in 2 different coordinate systems: one that you introduce from L2 files and one you create by rotating the data using cotrans (e.g., GSE and SM coord’s).\nDo a time-series spectrogram of a SCM component in some geophysical coordinates in survey and burst mode up to a high frequency, several kHz (use waveburst from THEMIS or “hb” from MMS).\nSelect a time when the geophysical signal (plasma waves) is at minimum (a quiet period) by looking at the dynamic power spectrum first. Compare the quiet time spectrum (a line spectrum) plot with published instrument noise curves: Point out the characteristic noise curve, a decreasing noise density as a function of frequency at low frequencies, a minimum near the resonance, and an increasing noise level at high frequencies – does it match expectation? Can you point out the plasma waves in the dynamic power spectrum?\n\nNote1: A good day for THEMIS is the first results Space Sci. Rev. paper (2007-03-23 13-16UT,) or the first Science paper (2008-02-26 4- 6UT) from any THEMIS spacecraft. A good day for MMS is the first Science paper (2015-10-16 13:00-14:00UT) from any MMS spacecraft.\n\nWe choose MMS for this question. And the data is from 2015-10-16 13:00-14:00UT.\nIts overall summary plot together with SCM quicklook plots are shown below.\n\n\n\n\n\n\n\n\nMMS Overall Summary\n\n\n\n\n\nMMS Overall Summary\n\n\n\n\n\n\n\n\n\n\n\n\nMMS SCM L2 SURVEY SCSRV\n\n\n\n\n\nMMS SCM L2 BRST SCB\n\n\n\n\nReferences:\n\nLe Contel, O., P. Leroy, A. Roux, C. Coillot, D. Alison, A. Bouabdellah, L. Mirioni, et al. “The Search-Coil Magnetometer for MMS.” Space Science Reviews 199, no. 1 (March 1, 2016): 257–82. https://doi.org/10.1007/s11214-014-0096-9.\nLPP - Laboratoire de Physique des Plasmas - UMR 7648 - MMS/SCM\nMMS SCM Quicklooks webpage\n\n\nTransforming coordinates\n\n\nCode\nimport pyspedas\nfrom pytplot import tplot, get_data\n\n\n\n\nCode\ntime_range = ['2015-10-16T13:05:30', '2015-10-16T13:07:30']\n\ntvars = pyspedas.mms.scm(trange=time_range, data_rate='brst', time_clip=True, probe='1')\ntplot(tvars)\n\n\n03-Nov-23 23:04:53: Loading /Users/zijin/data/mms/mms1/scm/brst/l2/schb/2015/10/16/mms1_scm_brst_l2_schb_20151016130524_v2.2.0.cdf\n03-Nov-23 23:04:53: Loading /Users/zijin/data/mms/mms1/scm/brst/l2/scb/2015/10/16/mms1_scm_brst_l2_scb_20151016130524_v2.2.0.cdf\n03-Nov-23 23:04:57: Time clip was applied to: mms1_scm_acb_gse_scb_brst_l2\n03-Nov-23 23:04:57: Time clip was applied to: mms1_scm_acb_gse_schb_brst_l2\n03-Nov-23 23:04:57: Loaded variables:\n03-Nov-23 23:04:57: mms1_scm_acb_gse_scb_brst_l2\n03-Nov-23 23:04:57: mms1_scm_acb_gse_schb_brst_l2\n\n\n\n\n\n\n\n\n\n\n\nCode\ntvars_sm = []\ncoord_out = 'sm'\nfor tvar in tvars:\n    pyspedas.cotrans(tvar, coord_out=coord_out)\n    tvar_sm = tvar + '_' + coord_out\n    tvars_sm.append(tvar_sm)\n\ntplot(tvars_sm)\n\n\n03-Nov-23 23:04:58: ['gse', 'gsm', 'sm']\n03-Nov-23 23:05:01: Running transformation: subgse2gsm\n03-Nov-23 23:05:03: Running transformation: subgsm2sm\n03-Nov-23 23:05:03: Output variable: mms1_scm_acb_gse_scb_brst_l2_sm\n03-Nov-23 23:05:03: ['gse', 'gsm', 'sm']\n03-Nov-23 23:05:04: Running transformation: subgse2gsm\n03-Nov-23 23:05:05: Running transformation: subgsm2sm\n03-Nov-23 23:05:05: Output variable: mms1_scm_acb_gse_schb_brst_l2_sm\n\n\n\n\n\n\n\n\n\n\n\nSpectrogram\n\n\nCode\ntvar_tdpwrspc = pyspedas.tdpwrspc('mms1_scm_acb_gse_schb_brst_l2_sm')\ntplot(tvar_tdpwrspc[0])\n\ntvar_tdpwrspc = pyspedas.tdpwrspc('mms1_scm_acb_gse_scb_brst_l2_sm')\ntplot(tvar_tdpwrspc)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nQuiet time spectrum\n\nThe SCM provides the three components of the magnetic fluctuations in the 1 Hz – 6 kHz nominal frequency range. The noise equivalent magnetic induction (NEMI or sensitivity) of the search-coil antenna is less than or equal to : 2 pT/sqrt(Hz) at 10 Hz, 0.3 pT/sqrt(Hz) at 100 Hz and 0.05 pT/sqrt(Hz) at 1 kHz (Fig. 6). The SCM resolution at 1k Hz is 0.15pT.\n\n\n\n\n\n\n\n\n\nFigure 6. Noise curve in magnetic field (” NEMI “) of each axis of the triaxe fluxmeter.\n\n\n\n\n\n\n\n\n\nCode\nimport matplotlib.pyplot as plt\nimport numpy as np\n\n\nFrom quickplot, we visually find the quiet time is around 2015-10-16T13:06:16. It mathchs expectation and looks quite like the NEMI from publications : resonance near 1kz with minimum noise level, together with a decreasing noise density at low frequencies, and an increasing noise level at high frequencies.\nFrom the quickplot spectrum, we can see there are some waves of 50-200 Hz between 13:06:50 and 13:07:00. Also observed is weak wave near 800 hz before 13:05:40.\n\n\nCode\ndata = get_data(tvar_tdpwrspc[0], xarray=True)\nquiet_time_data = data.sel(time='2015-10-16T13:06:16')\n\nfig, ax = plt.subplots()\n\nax.loglog(quiet_time_data.spec_bins.data[0], np.sqrt(quiet_time_data.data[0])*1000)\n\nax.set_xlabel(\"Freq (Hz)\")\nax.set_ylabel(\"NEMI (pT/sqrt(Hz))\")\nplt.show()",
    "crumbs": [
      "Courses",
      "EPSS 265",
      "Homework",
      "03 - SCM Noise Curves"
    ]
  },
  {
    "objectID": "research/projects/2024_Zijin_finesst/index.html#overview",
    "href": "research/projects/2024_Zijin_finesst/index.html#overview",
    "title": "Solar wind discontinuities",
    "section": "Overview",
    "text": "Overview\nParker Solar Probe (PSP) is a NASA mission to study the Sun’s corona and inner heliosphere.\nPSP timeline:\n\n2018-08-12: Launch\n2018-10-03: First Venus flyby\n2018-11-05: First perihelion\n2019-01-19: First aphehion\n…\n\n\n\n\nParker Solar Probe orbits\n\n\n\n\n\nMultiple satellites orbits\n\n\n\n\n\nJuno orbit"
  },
  {
    "objectID": "research/projects/2024_Zijin_finesst/index.html#discontinuities-observed-by-different-spacecrafts",
    "href": "research/projects/2024_Zijin_finesst/index.html#discontinuities-observed-by-different-spacecrafts",
    "title": "Solar wind discontinuities",
    "section": "Discontinuities observed by different spacecrafts",
    "text": "Discontinuities observed by different spacecrafts\nJuno, Parker Solar Probe, Wind and Stereo."
  },
  {
    "objectID": "research/projects/2024_Zijin_finesst/index.html#occurrence-rate-of-discontinuities",
    "href": "research/projects/2024_Zijin_finesst/index.html#occurrence-rate-of-discontinuities",
    "title": "Solar wind discontinuities",
    "section": "Occurrence rate of discontinuities",
    "text": "Occurrence rate of discontinuities"
  },
  {
    "objectID": "research/projects/2024_Zijin_finesst/index.html#model-validation",
    "href": "research/projects/2024_Zijin_finesst/index.html#model-validation",
    "title": "Solar wind discontinuities",
    "section": "Model validation",
    "text": "Model validation"
  },
  {
    "objectID": "research/projects/2024_Zijin_finesst/index.html#solar-wind-properties",
    "href": "research/projects/2024_Zijin_finesst/index.html#solar-wind-properties",
    "title": "Solar wind discontinuities",
    "section": "Solar wind properties",
    "text": "Solar wind properties"
  },
  {
    "objectID": "research/projects/2024_Zijin_finesst/index.html#scientifictechnicalmanagement",
    "href": "research/projects/2024_Zijin_finesst/index.html#scientifictechnicalmanagement",
    "title": "solar wind discontinuities",
    "section": "Scientific/Technical/Management",
    "text": "Scientific/Technical/Management\n\nContent\n\nDiscuss objectives and their significance.\nDiscuss perceived impact of the work.\nDiscuss relevance of the work to the program element. See V(a)\nExplain the technical approach and methodology.\nDiscuss potential sources of uncertainty\nPresent mitigation strategy or alternate approach given obstacles\nDiscuss roles of all team members so it’s clear what they are doing\nPresent a work plan, with milestones, management structure\nPresent a data sharing and/or archiving plan in the S/T/M section only if it is required by program element, see Section II.(c). Special\n\nSpecial Content\n\nProvide other special requirements of program element, e.g., special statements for participating scientists, team leads, etc.\n\n\n\nOverview\nJuno orbits\nParker Solar Probe orbits\n\n\nDiscontinuities observed by different spacecrafts\nJuno, Parker Solar Probe, Wind and Stereo.\n\n\nOccurrence rate of discontinuities\n\n\nModel validation\n\n\n\nSolar wind properties"
  },
  {
    "objectID": "research/projects/2024_Zijin_finesst/index.html#zijins-cv",
    "href": "research/projects/2024_Zijin_finesst/index.html#zijins-cv",
    "title": "Solar wind discontinuities",
    "section": "Zijin’s CV",
    "text": "Zijin’s CV"
  },
  {
    "objectID": "research/projects/2024_Zijin_finesst/index.html#antons-cv",
    "href": "research/projects/2024_Zijin_finesst/index.html#antons-cv",
    "title": "Solar wind discontinuities",
    "section": "Anton’s CV",
    "text": "Anton’s CV"
  },
  {
    "objectID": "research/projects/2024_Zijin_finesst/index.html#budget-narrative-budget-justification",
    "href": "research/projects/2024_Zijin_finesst/index.html#budget-narrative-budget-justification",
    "title": "Solar wind discontinuities",
    "section": "Budget Narrative (Budget Justification)",
    "text": "Budget Narrative (Budget Justification)\n\n\n\nGeneral\n\nPlease explain in words what is being purchased and why it is reasonable. See the Guidebook for Proposers\n\nRequired\n\nBudget Narrative: justify each proposed component of cost, including subcontracts/subawards, consultants, other direct costs (including travel), and facilities and equipment. Give the “basis of estimate;” quotes need not be provided, but the proposal should indicate that the cost was based upon a quote, prior experience, etc."
  },
  {
    "objectID": "research/projects/2024_Zijin_finesst/index.html#budget-details",
    "href": "research/projects/2024_Zijin_finesst/index.html#budget-details",
    "title": "Solar wind discontinuities",
    "section": "Budget Details",
    "text": "Budget Details"
  },
  {
    "objectID": "docs/research/index.html",
    "href": "docs/research/index.html",
    "title": "Research",
    "section": "",
    "text": "Relative role of EMIC waves, whistler-mode waves, and plasmasheet injections\n\n\n\npaper\n\n\n\n\n\n\n\n\n\nDec 27, 2024\n\n\nZijin Zhang\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\npaper\n\n\n\nWe conducted a search for narrowband radio signals over four observing sessions in 2020–2023 with the L-band receiver (1.15–1.73 GHz) of the 100 m diameter Green Bank Telescope…\n\n\n\n\n\nOct 1, 2023\n\n\nJean-Luc Margot, Megan Grace Li\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "docs/research/index.html#journal-articles",
    "href": "docs/research/index.html#journal-articles",
    "title": "Research",
    "section": "",
    "text": "Relative role of EMIC waves, whistler-mode waves, and plasmasheet injections\n\n\n\npaper\n\n\n\n\n\n\n\n\n\nDec 27, 2024\n\n\nZijin Zhang\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\npaper\n\n\n\nWe conducted a search for narrowband radio signals over four observing sessions in 2020–2023 with the L-band receiver (1.15–1.73 GHz) of the 100 m diameter Green Bank Telescope…\n\n\n\n\n\nOct 1, 2023\n\n\nJean-Luc Margot, Megan Grace Li\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "docs/research/index.html#projects",
    "href": "docs/research/index.html#projects",
    "title": "Research",
    "section": "Projects",
    "text": "Projects\n\n\n\n\n\n\n\n\n\n\nEnergetic ion scattering by solar wind discontinuities\n\n\n\n\n\n\nseeding\n\nsolar wind\n\n\n\nIn this studay, we consider observational-based model of ion dynamics and scattering in force-free rotational magnetic discontinuities. Focusing on quantification of the scattering effect, we demonstrate that background sheared magnetic field plays an important role in determining the efficiency of pitch angle scattering…\n\n\n\n\n\nZijin Zhang\n\n\n\n\n\n\n\n\n\n\n\n\nHybrid Simulations of Anisotropy in Solar Wind Discontinuities\n\n\n\n\n\n\n\n\n\n\n\nZijin Zhang, Anton V. Artemyev\n\n\n\n\n\n\n\n\n\n\n\n\nspace-analysis.py\n\n\nPython utils for data analysis in space physics\n\n\n\npackage\n\n\n\n\n\n\n\n\n\nFeb 9, 2024\n\n\nZijin Zhang\n\n\n\n\n\n\n\n\n\n\n\n\nEvolution of solar wind discontinuities over radial distance\n\n\n\n\n\n\nseeding\n\nsolar wind\n\n\n\nSolar wind discontinuities evolve in space with occurrence rate decreasing, thickness increasing and current density decreasing with distance from the Sun. And they are probably generated locally beyond 1 AU.\n\n\n\n\n\nFeb 9, 2024\n\n\nZijin Zhang\n\n\n\n\n\n\n\n\n\n\n\n\nDiscontinuityPy\n\n\nA python package for identifying and analyzing discontinuities for time series data.\n\n\n\npackage\n\n\n\n\n\n\n\n\n\nFeb 9, 2024\n\n\nZijin Zhang\n\n\n\n\n\n\n\n\n\n\n\n\nSolar wind discontinuities\n\n\nFINESST23 Proposal\n\n\n\nproposal\n\nsolar wind\n\n\n\n\n\n\n\n\n\nFeb 1, 2024\n\n\nZijin Zhang, Anton V. Artemyev\n\n\n\n\n\n\n\n\n\n\n\n\nThe kinetic simulation of the interaction between the Moon’s magnetic anomalies and the solar wind\n\n\n\n\n\n\nsolar wind\n\n\n\nWe investigate the interaction between the solar wind and lunar crustal magnetic anomalies, using particle-in-cell simulation.\n\n\n\n\n\nJul 1, 2022\n\n\nZijin Zhang, Xin Tao\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "docs/research/projects/2023_Zijin_solar-wind-discontinuities-evolution/index.html",
    "href": "docs/research/projects/2023_Zijin_solar-wind-discontinuities-evolution/index.html",
    "title": "Evolution of solar wind discontinuities over radial distance",
    "section": "",
    "text": "Web Pages\nGitHub repository"
  },
  {
    "objectID": "docs/research/projects/2023_Zijin_relativistic-electron-flux/index.html",
    "href": "docs/research/projects/2023_Zijin_relativistic-electron-flux/index.html",
    "title": "Relativistic electron flux decay and recovery",
    "section": "",
    "text": "ELFIN captured a significant ~4-hour episode of continuous EMIC-driven electron precipitation. This appears to be influenced by electron scattering caused by both whistler-mode and EMIC waves. Interestingly, despite this scattering, the predominant factor remains electron acceleration through whistler-mode waves, largely driven by substorm injections. The increase in electron fluxes during the storm, as recorded by ELFIN and ERG, aligns well with our analytical flux model. The first figure in the paper comprehensively presents all the observations we used, while the concluding figure distinctly shows the impact of electron acceleration on flux enhancement.\n\n\n\n(top) An overview of the mission orbits recorded on April 17, 2021, from 00:00 to 12:00 UTC. The orbits of the distinct missions are projected onto the MLT and \\(L\\)-shell plane, designated with different colors; star markers denote the orbit start, squares indicate their termination, and time annotations are provided near the periods of interest. ELFIN-B’s trajectory is displayed during three time intervals: 02:42-02:46, 04:14-04:18, and 05:47-05:51 UT. NOAA-19’s trajectory is plotted for 01:47-01:52 and 03:30-03:36 UT, while NOAA-15’s is displayed at 01:15-01:20 and 02:58-03:03 UT. The trajectories of GOES, MMS, and Arase span the entire 12-hour interval from 00:00 to 12:00 UT. (bottom) \\(Sym-H\\) and SME indices during this event."
  },
  {
    "objectID": "docs/research/projects/2024_Zijin_finesst/index.html",
    "href": "docs/research/projects/2024_Zijin_finesst/index.html",
    "title": "Solar wind discontinuities",
    "section": "",
    "text": "Future Investigators in NASA Earth and Space Science and Technology (FINESST) is a program element in Research Opportunities in Space and Earth Sciences (ROSES)."
  },
  {
    "objectID": "docs/research/projects/2023_Zijin_energetic-ion-scattering/index.html",
    "href": "docs/research/projects/2023_Zijin_energetic-ion-scattering/index.html",
    "title": "Energetic ion scattering by solar wind discontinuities",
    "section": "",
    "text": "Web Pages\nGitHub repository"
  },
  {
    "objectID": "docs/research/projects/2022_Zijin_solar-wind-LMA/index.html",
    "href": "docs/research/projects/2022_Zijin_solar-wind-LMA/index.html",
    "title": "The kinetic simulation of the interaction between the Moon’s magnetic anomalies and the solar wind",
    "section": "",
    "text": "The Moon, charactered by an absence of magnetosphere and atmosphere, sits directly exposed to the surrounding solar wind and/or magnetospheric plasma as the Moon revolved around the Earth. Therefore, the lunar space environment is mainly shaped by the interaction between the lunar surface and the impinging plasma. Previously, the Moon was thought as a passive absorber of the solar wind, forming a nearly complete void downstream called lunar wake. However, recent mission revealed a more complicated and diverse interaction between the Moon and the solar wind, such as the reflection and deflection of solar wind protons, formation of ”mini-magnetospheres” and collisionless shocks around lunar magnetic anomalies (LMAs). These new observation sparks a new interest to the lunar plasma environment research.\nIn the present thesis, we investigate the interaction between the solar wind and lunar crustal magnetic anomalies. We use particle-in-cell simulation to study a simplified but typical scenario of the interaction between a magnetic dipolar embedded in the lunar regolith and solar wind. We confirm that LMAs may indeed be strong enough to stand off the solar wind from directly striking the lunar surface under typical solar wind conditions and form a mini-magnetosphere structure. The analysis of the miniature magnetosphere and parameter influence offers insight into kinetic multi-scale physical processes in the planetary magnetic structures."
  },
  {
    "objectID": "docs/research/articles/2023_Zijin_relativistic-electron-flux/index.html",
    "href": "docs/research/articles/2023_Zijin_relativistic-electron-flux/index.html",
    "title": "Relativistic electron flux decay and recovery",
    "section": "",
    "text": "ELFIN captured a significant ~4-hour episode of continuous EMIC-driven electron precipitation. This appears to be influenced by electron scattering caused by both whistler-mode and EMIC waves. Interestingly, despite this scattering, the predominant factor remains electron acceleration through whistler-mode waves, largely driven by substorm injections. The increase in electron fluxes during the storm, as recorded by ELFIN and ERG, aligns well with our analytical flux model. The first figure in the paper comprehensively presents all the observations we used, while the concluding figure distinctly shows the impact of electron acceleration on flux enhancement.\n\n\n\n(top) An overview of the mission orbits recorded on April 17, 2021, from 00:00 to 12:00 UTC. The orbits of the distinct missions are projected onto the MLT and \\(L\\)-shell plane, designated with different colors; star markers denote the orbit start, squares indicate their termination, and time annotations are provided near the periods of interest. ELFIN-B’s trajectory is displayed during three time intervals: 02:42-02:46, 04:14-04:18, and 05:47-05:51 UT. NOAA-19’s trajectory is plotted for 01:47-01:52 and 03:30-03:36 UT, while NOAA-15’s is displayed at 01:15-01:20 and 02:58-03:03 UT. The trajectories of GOES, MMS, and Arase span the entire 12-hour interval from 00:00 to 12:00 UT. (bottom) \\(Sym-H\\) and SME indices during this event."
  },
  {
    "objectID": "docs/blog/index.html",
    "href": "docs/blog/index.html",
    "title": "Blog",
    "section": "",
    "text": "Relativistic electrons in the radiation belt and Current sheet in the solar wind\n\n\nFirst Oral Exam\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRelative role of EMIC waves, chorus waves, and electron injections on relativistic electron flux\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nExploring solar wind discontinuity properties in the inner and outer heliosphere\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLecture Notes\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nEfficient Nonthermal Particle Acceleration\n\n\nby the Kink Instability in Relativistic Jets\n\n\n\n#journal club\n\n\n\n\n\n\n\n\n\nApr 16, 2025\n\n\nE. P. Alves, J. Zrake, F. Fiuza\n\n\n\n\n\n\n\n\n\n\n\n\nThe role of drift orbit bifurcations in energization and loss\n\n\nof electrons in the outer radiation belt\n\n\n\n#journal club\n\n\ndynamical system\n\n\n\n\n\n\n\n\n\nJan 24, 2025\n\n\nA. Y. Ukhorskiy, M. I. Sitnov\n\n\n\n\n\n\n\n\n\n\n\n\nMagnetosheath jets at Jupiter and across the solar system\n\n\n\n\n\n\n#journal club\n\n\n\n\n\n\n\n\n\nOct 21, 2024\n\n\nYufei Zhou\n\n\n\n\n\n\n\n\n\n\n\n\nPhD\n\n\n\n\n\n\n\n\n\n\n\nSep 24, 2024\n\n\nZijin Zhang\n\n\n\n\n\n\n\n\n\n\n\n\nMESSENGER Observations of Extreme Loading and Unloading of Mercury’s Magnetic Tail\n\n\n\n\n\n\n#journal club\n\n\n\n\n\n\n\n\n\nApr 24, 2024\n\n\nJames A. Slavin\n\n\n\n\n\n\n\n\n\n\n\n\nEvolution of Solar and Stellar Dynamo Theory\n\n\nin ‘Solar and Stellar Dynamo: A New Era’\n\n\n\n#journal club\n\n\ndynamo theory\n\n\n\n\n\n\n\n\n\nJan 17, 2024\n\n\nCharbonneau Paul, Sokoloff Dmitry\n\n\n\n\n\n\n\n\n\n\n\n\nAGU23\n\n\nWide. Open. Science.\n\n\n\n#conference\n\n\n\n\n\n\n\n\n\nDec 11, 2023\n\n\nZijin Zhang\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#outline",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#outline",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Outline",
    "text": "Outline\n\nIntroduction to MHD dynamo theory\nPaper"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#references",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#references",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "References",
    "text": "References\n\n\nTobias, S. M. (2021). The turbulent dynamo. Journal of Fluid Mechanics, 912, P1. 10.1017/jfm.2020.1055\nRincon, François. 2019. “Dynamo Theories.” Journal of Plasma Physics. 10.1017/S0022377819000539.\nRincon, Francois. 2019. “Introduction to MHD Dynamos.” Presentation Link.\nRincon, François. 2017. “Turbulent MHD Dynamos in 2017: A Review of My Own Confusion.”\n\n\n\nJournal Club Presentation"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#what-is-dynamo-theory-about",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#what-is-dynamo-theory-about",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "What is dynamo theory about?",
    "text": "What is dynamo theory about?\n\nThe origin, amplification, saturation and sustainment, of magnetic ﬁelds in the universe\n\non the Earth, other planets and their satellites (“planetary magnetism”)\nin the Sun and other stars (“stellar magnetism”)\nin galaxies, clusters and the early universe (“cosmic magnetism”)\n\n\nIf you care about magnetic fields, you might care about dynamo theory."
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#takeaway-phenomenological-points",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#takeaway-phenomenological-points",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Takeaway phenomenological points",
    "text": "Takeaway phenomenological points\n\nMany astrophysical objects have global, ordered ﬁelds\n\nDifferential rotation, global symmetries and geometry are important\nCoherent structures and MHD instabilities may also be very important\nMotivation for the development of “large-scale” dynamo theories\n\nLots of “small-scale”, random ﬁelds also discovered from the 70s\n\nThese come hand in hand with global magnetism\nSimultaneous development of “small-scale dynamo” theory\n\nAstrophysical magnetism is in a nonlinear, saturated state\n\nLinear theory not the whole story (or using it requires non-trivial justiﬁcation)\nMultiple scale interactions expected to be important"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#tension-why-is-mean-field-electrodynamics-working",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#tension-why-is-mean-field-electrodynamics-working",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Tension: Why Is Mean-Field Electrodynamics Working?",
    "text": "Tension: Why Is Mean-Field Electrodynamics Working?\nSeparating the ﬂow and magnetic ﬁeld into large-scale, slowly varying “mean” component \\(〈U〉, 〈B〉\\) and small-scale rapidly varying “turbulent” components \\(\\boldsymbol{u}, \\boldsymbol{b}\\)\n\\[\n\\begin{gathered}\n\\boldsymbol{U}=\\langle\\mathbf{U}\\rangle + \\boldsymbol{u}, \\\\\n\\boldsymbol{B}=\\langle\\mathbf{B}\\rangle + \\boldsymbol{b} .\n\\end{gathered}\n\\]\nOccasionally interpreted as a decomposition into axisymmetric and non-axisymmetric field components in systems with a rotation axis.\n\\[\n\\frac{\\partial\\langle\\mathbf{B}\\rangle}{\\partial t}=\\nabla \\times(\\langle\\mathbf{U}\\rangle \\times\\langle\\mathbf{B}\\rangle+\\xi-\\eta \\nabla \\times\\langle\\mathbf{B}\\rangle)\n\\] where the mean electromotive force \\(\\xi\\) is given by the average of the small-scale flow-field cross-correlation: \\[\n\\xi=\\left\\langle\\mathbf{u} \\times \\mathbf{b}\\right\\rangle\n\\]"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#tension-the-troublesome-magnetic-helicity",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#tension-the-troublesome-magnetic-helicity",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Tension: The Troublesome Magnetic Helicity",
    "text": "Tension: The Troublesome Magnetic Helicity"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#tension-the-troublesome-solar-differential-rotation",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#tension-the-troublesome-solar-differential-rotation",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Tension: The Troublesome Solar Differential Rotation",
    "text": "Tension: The Troublesome Solar Differential Rotation"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#tensions-from-solar-to-stellar-dynamos",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#tensions-from-solar-to-stellar-dynamos",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Tension(s): From Solar to Stellar Dynamos",
    "text": "Tension(s): From Solar to Stellar Dynamos\nBabcock–Leighton mechanism\n\nThe net effect of BMRs is taking a formerly toroidal internal magnetic ﬁeld and converting a fraction of its associated ﬂux into a net surface dipole moment.\n\nThe larger sunspot pairs (‘‘bipolar magnetic regions’’, hereafter BMR) often emerge with a systematic tilt with respect to the E–W direction, in that on average, the leading sunspot (with respect to the direction of solar rotation) is located at a lower latitude than the trailing sunspot, the more so the higher the latitude of the emerging BMR (see, e.g., Stenﬂo and Kosovichev 2012; McClintock and Norton 2013). This pattern is known as ‘‘Joy’s law’’. The tilt of the magnetic axis of a BMR implies a non-zero projection along the N–S direction, which amounts to a dipole moment. The decay of BMRs and subsequent dispersal of their magnetic ﬂux by surface ﬂows can release a fraction of this dipole moment and contribute to the global dipole."
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "",
    "text": "Introduction to MHD dynamo theory\nPaper"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html#outline",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html#outline",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "",
    "text": "Introduction to MHD dynamo theory\nPaper"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html#references",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html#references",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "References",
    "text": "References\n\n\nTobias, S. M. (2021). The turbulent dynamo. Journal of Fluid Mechanics, 912, P1. 10.1017/jfm.2020.1055\nRincon, François. 2019. “Dynamo Theories.” Journal of Plasma Physics. 10.1017/S0022377819000539.\nRincon, Francois. 2019. “Introduction to MHD Dynamos.” Presentation Link.\nRincon, François. 2017. “Turbulent MHD Dynamos in 2017: A Review of My Own Confusion.”"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html#what-is-dynamo-theory-about",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html#what-is-dynamo-theory-about",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "What is dynamo theory about?",
    "text": "What is dynamo theory about?\n\nThe origin, amplification, saturation and sustainment, of magnetic ﬁelds in the universe\n\non the Earth, other planets and their satellites (“planetary magnetism”)\nin the Sun and other stars (“stellar magnetism”)\nin galaxies, clusters and the early universe (“cosmic magnetism”)\n\n\nIf you care about magnetic fields, you might care about dynamo theory."
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html#takeaway-phenomenological-points",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html#takeaway-phenomenological-points",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Takeaway phenomenological points",
    "text": "Takeaway phenomenological points\n\nMany astrophysical objects have global, ordered ﬁelds\n\nDifferential rotation, global symmetries and geometry are important\nCoherent structures and MHD instabilities may also be very important\nMotivation for the development of “large-scale” dynamo theories\n\nLots of “small-scale”, random ﬁelds also discovered from the 70s\n\nThese come hand in hand with global magnetism\nSimultaneous development of “small-scale dynamo” theory\n\nAstrophysical magnetism is in a nonlinear, saturated state\n\nLinear theory not the whole story (or using it requires non-trivial justiﬁcation)\nMultiple scale interactions expected to be important"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html#tension-why-is-mean-field-electrodynamics-working",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html#tension-why-is-mean-field-electrodynamics-working",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Tension: Why Is Mean-Field Electrodynamics Working?",
    "text": "Tension: Why Is Mean-Field Electrodynamics Working?\nSeparating the ﬂow and magnetic ﬁeld into large-scale, slowly varying “mean” component \\(〈U〉, 〈B〉\\) and small-scale rapidly varying “turbulent” components \\(\\boldsymbol{u}, \\boldsymbol{b}\\)\n\\[\n\\begin{gathered}\n\\boldsymbol{U}=\\langle\\mathbf{U}\\rangle + \\boldsymbol{u}, \\\\\n\\boldsymbol{B}=\\langle\\mathbf{B}\\rangle + \\boldsymbol{b} .\n\\end{gathered}\n\\]\nOccasionally interpreted as a decomposition into axisymmetric and non-axisymmetric field components in systems with a rotation axis.\n\\[\n\\frac{\\partial\\langle\\mathbf{B}\\rangle}{\\partial t}=\\nabla \\times(\\langle\\mathbf{U}\\rangle \\times\\langle\\mathbf{B}\\rangle+\\xi-\\eta \\nabla \\times\\langle\\mathbf{B}\\rangle)\n\\] where the mean electromotive force \\(\\xi\\) is given by the average of the small-scale flow-field cross-correlation: \\[\n\\xi=\\left\\langle\\mathbf{u} \\times \\mathbf{b}\\right\\rangle\n\\]"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html#tension-the-troublesome-magnetic-helicity",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html#tension-the-troublesome-magnetic-helicity",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Tension: The Troublesome Magnetic Helicity",
    "text": "Tension: The Troublesome Magnetic Helicity"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html#tension-the-troublesome-solar-differential-rotation",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html#tension-the-troublesome-solar-differential-rotation",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Tension: The Troublesome Solar Differential Rotation",
    "text": "Tension: The Troublesome Solar Differential Rotation"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html#tensions-from-solar-to-stellar-dynamos",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html#tensions-from-solar-to-stellar-dynamos",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Tension(s): From Solar to Stellar Dynamos",
    "text": "Tension(s): From Solar to Stellar Dynamos\n\nBabcock–Leighton mechanism\n\nThe net effect of BMRs is taking a formerly toroidal internal magnetic ﬁeld and converting a fraction of its associated ﬂux into a net surface dipole moment.\n\nThe larger sunspot pairs (‘‘bipolar magnetic regions’’, hereafter BMR) often emerge with a systematic tilt with respect to the E–W direction, in that on average, the leading sunspot (with respect to the direction of solar rotation) is located at a lower latitude than the trailing sunspot, the more so the higher the latitude of the emerging BMR (see, e.g., Stenﬂo and Kosovichev 2012; McClintock and Norton 2013). This pattern is known as ‘‘Joy’s law’’. The tilt of the magnetic axis of a BMR implies a non-zero projection along the N–S direction, which amounts to a dipole moment. The decay of BMRs and subsequent dispersal of their magnetic ﬂux by surface ﬂows can release a fraction of this dipole moment and contribute to the global dipole."
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#lenzs-law",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#lenzs-law",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Lenz’s Law",
    "text": "Lenz’s Law\nElectromagnetic induction suppresses rather enhances the seed magnetic ﬁeld."
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html#lenzs-law",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html#lenzs-law",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Lenz’s Law",
    "text": "Lenz’s Law\nElectromagnetic induction suppresses rather enhances the seed magnetic ﬁeld."
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#solar-magnetism",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#solar-magnetism",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Solar magnetism",
    "text": "Solar magnetism\n\n\n\n\n\nsolar magnetism\n\n\n\n\n\n\nplanetary magnetism\n\n\n\n\n\n\ncosmic magnetism"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#magnetic-ﬁelds-in-the-universe",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#magnetic-ﬁelds-in-the-universe",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Magnetic ﬁelds in the universe",
    "text": "Magnetic ﬁelds in the universe\n\n\n\n\n\nSolar magnetism (from 1G (global) to 1 kG (sunspots)\n\n\n\n\n\n\nPlanetary magnetism (0.1 G at Earth’s surface)\n\n\n\n\n\n\nCosmic magnetism (galactic magnetic ﬁeld ~ 10 μG)"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#mhd-equations",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#mhd-equations",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "MHD equations",
    "text": "MHD equations\nMHD induction equation\n\\[\\frac{\\partial \\mathbf{B}}{\\partial t}=\\nabla \\times(\\mathbf{u} \\times \\mathbf{B}-\\eta \\nabla \\times \\mathbf{B})\\]\nIncompressible, resistive, viscous MHD\n\\[\\frac{\\partial \\mathbf{u}}{\\partial t}+\\mathbf{u} \\cdot \\nabla \\mathbf{u}=-\\nabla P+\\mathbf{B} \\cdot \\nabla \\mathbf{B}+\\nu \\Delta \\mathbf{u}+\\mathbf{f}(\\mathbf{x}, t)\\]\nLenz’s Law\nElectromagnetic induction suppresses rather enhances the seed magnetic ﬁeld."
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#section",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#section",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "",
    "text": "Observations around solar activity minimum suggest that,the large-scale solar magnetic ﬁeld is axisymmetric about the rotation axis.\n\\[\n\\mathbf{B}(r, \\theta, t)=\\nabla \\times\\left(A(r, \\theta, t) \\hat{\\mathbf{e}}_\\phi\\right)+B(r, \\theta, t) \\hat{\\mathbf{e}}_\\phi .\n\\]\n\\[\n\\mathbf{u}(r, \\theta)=\\mathbf{u}_{\\mathrm{p}}(r, \\theta)+\\varpi \\Omega(r, \\theta) \\hat{\\mathbf{e}}_\\phi,\n\\]"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#section-1",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#section-1",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "",
    "text": "\\[\\begin{gathered}\\frac{\\partial A}{\\partial t}=\\underbrace{\\eta\\left(\\nabla^2-\\frac{1}{\\varpi^2}\\right) A}_{\\text {resistive decay }}-\\underbrace{\\frac{\\mathbf{u}_{\\mathrm{p}}}{\\varpi} \\cdot \\nabla(\\varpi A)}_{\\text {transport }}, \\\\ \\frac{\\partial B}{\\partial t}=\\underbrace{\\eta\\left(\\nabla^2-\\frac{1}{\\varpi^2}\\right) B+\\frac{1}{\\varpi} \\frac{\\partial(\\varpi B)}{\\partial r} \\frac{\\partial \\eta}{\\partial r}}_{\\text {resistive decay }}-\\underbrace{\\varpi \\mathbf{u}_{\\mathrm{p}} \\cdot \\nabla\\left(\\frac{B}{\\varpi}\\right)}_{\\text {transport }} \\\\ -\\underbrace{B \\nabla \\cdot \\mathbf{u}_{\\mathrm{p}}}_{\\text {compression }}+\\underbrace{\\varpi\\left(\\nabla \\times\\left(A \\hat{\\mathbf{e}}_\\phi\\right)\\right) \\cdot \\nabla \\Omega}_{\\text {shearing }} .\\end{gathered}\\]\nSimple spherically symmetric or planar 2D ﬂows can not support dynamo action.\nCowling’s theorem: an axisymmetric ﬂow cannot sustain an axisymmetric magnetic ﬁeld against resistive decay."
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html#magnetic-ﬁelds-in-the-universe",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html#magnetic-ﬁelds-in-the-universe",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Magnetic ﬁelds in the universe",
    "text": "Magnetic ﬁelds in the universe\n\n\n\n\n\nSolar magnetism (from 1G (global) to 1 kG (sunspots)\n\n\n\n\n\n\nPlanetary magnetism (0.1 G at Earth’s surface)\n\n\n\n\n\n\nCosmic magnetism (galactic magnetic ﬁeld ~ 10 μG)"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html#mhd-equations",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html#mhd-equations",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "MHD equations",
    "text": "MHD equations\nMHD induction equation\n\\[\\frac{\\partial \\mathbf{B}}{\\partial t}=\\nabla \\times(\\mathbf{u} \\times \\mathbf{B}-\\eta \\nabla \\times \\mathbf{B})\\]\nIncompressible, resistive, viscous MHD\n\\[\\frac{\\partial \\mathbf{u}}{\\partial t}+\\mathbf{u} \\cdot \\nabla \\mathbf{u}=-\\nabla P+\\mathbf{B} \\cdot \\nabla \\mathbf{B}+\\nu \\Delta \\mathbf{u}+\\mathbf{f}(\\mathbf{x}, t)\\]\n\nLenz’s Law\nElectromagnetic induction suppresses rather enhances the seed magnetic ﬁeld."
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html#section",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html#section",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "",
    "text": "Observations around solar activity minimum suggest that,the large-scale solar magnetic ﬁeld is axisymmetric about the rotation axis.\n\\[\n\\mathbf{B}(r, \\theta, t)=\\nabla \\times\\left(A(r, \\theta, t) \\hat{\\mathbf{e}}_\\phi\\right)+B(r, \\theta, t) \\hat{\\mathbf{e}}_\\phi .\n\\]\nthe (steady) large-scale flow field \\(\\mathbf{u}\\) is written as the sum of an axisymmetric azimuthal component (differential rotation), and an axisymmetric “poloidal” component \\(u_{\\mathrm{p}}\\)\n\\[\n\\mathbf{u}(r, \\theta)=\\mathbf{u}_{\\mathrm{p}}(r, \\theta)+\\varpi \\Omega(r, \\theta) \\hat{\\mathbf{e}}_\\phi,\n\\]"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html#section-1",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html#section-1",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "",
    "text": "\\[\\begin{gathered}\\frac{\\partial A}{\\partial t}=\\underbrace{\\eta\\left(\\nabla^2-\\frac{1}{\\varpi^2}\\right) A}_{\\text {resistive decay }}-\\underbrace{\\frac{\\mathbf{u}_{\\mathrm{p}}}{\\varpi} \\cdot \\nabla(\\varpi A)}_{\\text {transport }}, \\\\ \\frac{\\partial B}{\\partial t}=\\underbrace{\\eta\\left(\\nabla^2-\\frac{1}{\\varpi^2}\\right) B+\\frac{1}{\\varpi} \\frac{\\partial(\\varpi B)}{\\partial r} \\frac{\\partial \\eta}{\\partial r}}_{\\text {resistive decay }}-\\underbrace{\\varpi \\mathbf{u}_{\\mathrm{p}} \\cdot \\nabla\\left(\\frac{B}{\\varpi}\\right)}_{\\text {transport }} \\\\ -\\underbrace{B \\nabla \\cdot \\mathbf{u}_{\\mathrm{p}}}_{\\text {compression }}+\\underbrace{\\varpi\\left(\\nabla \\times\\left(A \\hat{\\mathbf{e}}_\\phi\\right)\\right) \\cdot \\nabla \\Omega}_{\\text {shearing }} .\\end{gathered}\\]\nSimple spherically symmetric or planar 2D ﬂows can not support dynamo action.\nCowling’s theorem: an axisymmetric ﬂow cannot sustain an axisymmetric magnetic ﬁeld against resistive decay."
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#anti-dynamo-theorem",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#anti-dynamo-theorem",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Anti-dynamo theorem",
    "text": "Anti-dynamo theorem\nObservations around solar activity minimum suggest that,the large-scale solar magnetic ﬁeld is axisymmetric about the rotation axis.\n\\[\n\\mathbf{B}(r, \\theta, t)=\\nabla \\times\\left(A(r, \\theta, t) \\hat{\\mathbf{e}}_\\phi\\right)+B(r, \\theta, t) \\hat{\\mathbf{e}}_\\phi .\n\\]\n\\[\n\\mathbf{u}(r, \\theta)=\\mathbf{u}_{\\mathrm{p}}(r, \\theta)+\\varpi \\Omega(r, \\theta) \\hat{\\mathbf{e}}_\\phi,\n\\]\nMHD induction equation\n\\[\\begin{gathered}\\frac{\\partial A}{\\partial t}=\\underbrace{\\eta\\left(\\nabla^2-\\frac{1}{\\varpi^2}\\right) A}_{\\text {resistive decay }}-\\underbrace{\\frac{\\mathbf{u}_{\\mathrm{p}}}{\\varpi} \\cdot \\nabla(\\varpi A)}_{\\text {transport }}, \\\\ \\frac{\\partial B}{\\partial t}=\\underbrace{\\eta\\left(\\nabla^2-\\frac{1}{\\varpi^2}\\right) B+\\frac{1}{\\varpi} \\frac{\\partial(\\varpi B)}{\\partial r} \\frac{\\partial \\eta}{\\partial r}}_{\\text {resistive decay }}-\\underbrace{\\varpi \\mathbf{u}_{\\mathrm{p}} \\cdot \\nabla\\left(\\frac{B}{\\varpi}\\right)}_{\\text {transport }} \\\\ -\\underbrace{B \\nabla \\cdot \\mathbf{u}_{\\mathrm{p}}}_{\\text {compression }}+\\underbrace{\\varpi\\left(\\nabla \\times\\left(A \\hat{\\mathbf{e}}_\\phi\\right)\\right) \\cdot \\nabla \\Omega}_{\\text {shearing }} .\\end{gathered}\\]"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#anti-dynamo-theorem-1",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#anti-dynamo-theorem-1",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Anti-dynamo theorem",
    "text": "Anti-dynamo theorem\nCowling’s theorem\nAn axisymmetric ﬂow cannot sustain an axisymmetric magnetic ﬁeld against resistive decay.\nZel’dovich’s theorem\nPlanar, two-dimensional motions cannot excite a dynamo.\nOthers\n\nA purely toroidal ﬂow cannot excite a dynamo\nA magnetic ﬁeld of the form \\(B(x, y, t)\\) alone cannot be a dynamo ﬁeld.\n\nA minimal geometric complexity is required for dynamos to work."
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#from-toroidal-to-poloidal",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#from-toroidal-to-poloidal",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "From toroidal to poloidal",
    "text": "From toroidal to poloidal\nWe have no choice but to look for some fundamentally non-axisymmetric process to provide an additional source term in MHD induction equation.\n\nTurbulence and mean-field electrodynamics\nThe Babcock–Leighton mechanism\nHydrodynamical and magnetohydrodynamical instabilities (from the rotational shear layer, tachocline)"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#mean-field-electrodynamics",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#mean-field-electrodynamics",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Mean-Field Electrodynamics",
    "text": "Mean-Field Electrodynamics\nClosure is achieved by expanding this turbulent electromotive force (emf) \\(\\boldsymbol{\\xi}\\) in terms of \\(\\langle\\mathbf{B}\\rangle\\) and its derivatives:\n\\[\n\\xi_i=a_{i j}\\left\\langle B_j\\right\\rangle+b_{i j k} \\frac{\\partial\\left\\langle B_j\\right\\rangle}{\\partial x_k}+\\cdots\n\\]\nThis is not a linearization procedure, in that we are not assuming that:\n\\[\\left|\\boldsymbol{u}\\right| /|\\langle\\boldsymbol{U}\\rangle| \\ll 1\\]\n\\[\\left|\\boldsymbol{b}\\right| /|\\langle\\boldsymbol{B}\\rangle| \\ll 1\\]"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#tension-why-is-mean-field-electrodynamics-working-1",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#tension-why-is-mean-field-electrodynamics-working-1",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Tension: Why Is Mean-Field Electrodynamics Working?",
    "text": "Tension: Why Is Mean-Field Electrodynamics Working?\nThe challenge is now to compute these tensorial quantities from known statistical properties of the turbulent ﬂow\nTractable physical regimes:\n\nThe energy density of the mean magnetic ﬁeld is larger than the energy density of the small-scale ﬁeld;\nThe magnetic Reynolds number is low;\nThe turbulent cyclonic eddies have a lifetime shorter than their characteristic turnover time."
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#tensions-from-solar-to-stellar-dynamos-1",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#tensions-from-solar-to-stellar-dynamos-1",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Tension(s): From Solar to Stellar Dynamos",
    "text": "Tension(s): From Solar to Stellar Dynamos\nHydrodynamical and magnetohydrodynamical instabilities\n\ntachocline\nThe tachocline is the rotational shear layer uncovered by helioseismology immediately beneath the Sun’s convective envelope, providing a smooth match between the latitudinal differential rotation of the envelope, and the rigidly rotating radiative core (see, e.g., Spiegel and Zahn 1992; Brown et al. 1989; Tomczyk et al. 1995; Gough and McIntyre 1998; Charbonneau et al. 1999, and references therein)."
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#tensions-from-solar-to-stellar-dynamos-2",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/dynamo.revealjs.html#tensions-from-solar-to-stellar-dynamos-2",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Tension(s): From Solar to Stellar Dynamos",
    "text": "Tension(s): From Solar to Stellar Dynamos\n\nWhich is the primary polarity reversal mechanism: α-effect, or Babcock–Leighton, . . . or something else?\nHow do differential rotation and meridional circulation vary with rotation rate, luminosity, and internal structure?\nHow do turbulent coefﬁcients (α-effect, turbulent pumping, turbulent diffusion) vary with rotation rate, luminosity, and internal structure?\nHow do sunspots and BMRs form and decay in stars of varying structure (in particularly, depth of convective envelope), rotation rate and luminosity?\n\nUnifying dynamo framework applicable to both the sun and solar type stars of varying spectral type, luminosity, and rotation rate."
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html#anti-dynamo-theorem",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html#anti-dynamo-theorem",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Anti-dynamo theorem",
    "text": "Anti-dynamo theorem\nObservations around solar activity minimum suggest that,the large-scale solar magnetic ﬁeld is axisymmetric about the rotation axis.\n\\[\n\\mathbf{B}(r, \\theta, t)=\\nabla \\times\\left(A(r, \\theta, t) \\hat{\\mathbf{e}}_\\phi\\right)+B(r, \\theta, t) \\hat{\\mathbf{e}}_\\phi .\n\\]\n\\[\n\\mathbf{u}(r, \\theta)=\\mathbf{u}_{\\mathrm{p}}(r, \\theta)+\\varpi \\Omega(r, \\theta) \\hat{\\mathbf{e}}_\\phi,\n\\]\nMHD induction equation\n\\[\\begin{gathered}\\frac{\\partial A}{\\partial t}=\\underbrace{\\eta\\left(\\nabla^2-\\frac{1}{\\varpi^2}\\right) A}_{\\text {resistive decay }}-\\underbrace{\\frac{\\mathbf{u}_{\\mathrm{p}}}{\\varpi} \\cdot \\nabla(\\varpi A)}_{\\text {transport }}, \\\\ \\frac{\\partial B}{\\partial t}=\\underbrace{\\eta\\left(\\nabla^2-\\frac{1}{\\varpi^2}\\right) B+\\frac{1}{\\varpi} \\frac{\\partial(\\varpi B)}{\\partial r} \\frac{\\partial \\eta}{\\partial r}}_{\\text {resistive decay }}-\\underbrace{\\varpi \\mathbf{u}_{\\mathrm{p}} \\cdot \\nabla\\left(\\frac{B}{\\varpi}\\right)}_{\\text {transport }} \\\\ -\\underbrace{B \\nabla \\cdot \\mathbf{u}_{\\mathrm{p}}}_{\\text {compression }}+\\underbrace{\\varpi\\left(\\nabla \\times\\left(A \\hat{\\mathbf{e}}_\\phi\\right)\\right) \\cdot \\nabla \\Omega}_{\\text {shearing }} .\\end{gathered}\\]"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html#anti-dynamo-theorem-1",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html#anti-dynamo-theorem-1",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Anti-dynamo theorem",
    "text": "Anti-dynamo theorem\n\nCowling’s theorem\nAn axisymmetric ﬂow cannot sustain an axisymmetric magnetic ﬁeld against resistive decay.\n\n\nZel’dovich’s theorem\nPlanar, two-dimensional motions cannot excite a dynamo.\n\n\nOthers\n\nA purely toroidal ﬂow cannot excite a dynamo\nA magnetic ﬁeld of the form \\(B(x, y, t)\\) alone cannot be a dynamo ﬁeld.\n\nA minimal geometric complexity is required for dynamos to work."
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html#from-toroidal-to-poloidal",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html#from-toroidal-to-poloidal",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "From toroidal to poloidal",
    "text": "From toroidal to poloidal\nWe have no choice but to look for some fundamentally non-axisymmetric process to provide an additional source term in MHD induction equation.\n\nTurbulence and mean-field electrodynamics\nThe Babcock–Leighton mechanism\nHydrodynamical and magnetohydrodynamical instabilities (from the rotational shear layer, tachocline)"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html#mean-field-electrodynamics",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html#mean-field-electrodynamics",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Mean-Field Electrodynamics",
    "text": "Mean-Field Electrodynamics\nClosure is achieved by expanding this turbulent electromotive force (emf) \\(\\boldsymbol{\\xi}\\) in terms of \\(\\langle\\mathbf{B}\\rangle\\) and its derivatives:\n\\[\n\\xi_i=a_{i j}\\left\\langle B_j\\right\\rangle+b_{i j k} \\frac{\\partial\\left\\langle B_j\\right\\rangle}{\\partial x_k}+\\cdots\n\\]\nThis is not a linearization procedure, in that we are not assuming that:\n\\[\\left|\\boldsymbol{u}\\right| /|\\langle\\boldsymbol{U}\\rangle| \\ll 1\\]\n\\[\\left|\\boldsymbol{b}\\right| /|\\langle\\boldsymbol{B}\\rangle| \\ll 1\\]"
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html#tension-why-is-mean-field-electrodynamics-working-1",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html#tension-why-is-mean-field-electrodynamics-working-1",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Tension: Why Is Mean-Field Electrodynamics Working?",
    "text": "Tension: Why Is Mean-Field Electrodynamics Working?\nThe challenge is now to compute these tensorial quantities from known statistical properties of the turbulent ﬂow\n\nTractable physical regimes:\n\nThe energy density of the mean magnetic ﬁeld is larger than the energy density of the small-scale ﬁeld;\nThe magnetic Reynolds number is low;\nThe turbulent cyclonic eddies have a lifetime shorter than their characteristic turnover time."
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html#tensions-from-solar-to-stellar-dynamos-1",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html#tensions-from-solar-to-stellar-dynamos-1",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Tension(s): From Solar to Stellar Dynamos",
    "text": "Tension(s): From Solar to Stellar Dynamos\n\nHydrodynamical and magnetohydrodynamical instabilities\n\n\n\ntachocline\n\n\n\nThe tachocline is the rotational shear layer uncovered by helioseismology immediately beneath the Sun’s convective envelope, providing a smooth match between the latitudinal differential rotation of the envelope, and the rigidly rotating radiative core (see, e.g., Spiegel and Zahn 1992; Brown et al. 1989; Tomczyk et al. 1995; Gough and McIntyre 1998; Charbonneau et al. 1999, and references therein)."
  },
  {
    "objectID": "docs/blog/journal_club/2024-01-17_dynamo/index.html#tensions-from-solar-to-stellar-dynamos-2",
    "href": "docs/blog/journal_club/2024-01-17_dynamo/index.html#tensions-from-solar-to-stellar-dynamos-2",
    "title": "Evolution of Solar and Stellar Dynamo Theory",
    "section": "Tension(s): From Solar to Stellar Dynamos",
    "text": "Tension(s): From Solar to Stellar Dynamos\n\nWhich is the primary polarity reversal mechanism: α-effect, or Babcock–Leighton, . . . or something else?\nHow do differential rotation and meridional circulation vary with rotation rate, luminosity, and internal structure?\nHow do turbulent coefﬁcients (α-effect, turbulent pumping, turbulent diffusion) vary with rotation rate, luminosity, and internal structure?\nHow do sunspots and BMRs form and decay in stars of varying structure (in particularly, depth of convective envelope), rotation rate and luminosity?\n\nUnifying dynamo framework applicable to both the sun and solar type stars of varying spectral type, luminosity, and rotation rate."
  },
  {
    "objectID": "docs/blog/2023_AGU/index.html",
    "href": "docs/blog/2023_AGU/index.html",
    "title": "AGU23",
    "section": "",
    "text": "Two posters are presented this year. First AGU meeting in person!\n\nSolar wind discontinuities spatial evolution and energetic ion scattering\nPoster PDF\nRelativistic electron flux decay and recovery: Relative role of EMIC waves, whistler-mode waves, and plasmasheet injections\nPoster PDF"
  },
  {
    "objectID": "docs/others/05_cv_Zijin.html",
    "href": "docs/others/05_cv_Zijin.html",
    "title": "Curriculum Vitae",
    "section": "",
    "text": "Zijin Zhang\nEarth, Planetary and Space Sciences, University of California, Los Angeles, CA 90095\nzijin@ucla.edu"
  },
  {
    "objectID": "docs/others/05_cv_Zijin.html#professional-preparation",
    "href": "docs/others/05_cv_Zijin.html#professional-preparation",
    "title": "Curriculum Vitae",
    "section": "Professional Preparation",
    "text": "Professional Preparation\nGraduate student in Planetary Science  University of California, Los Angeles  2022-present\nB.Sc. in Space Physics and B.Eng. in Computer Science  University of Science and Technology of China  2018-2022"
  },
  {
    "objectID": "docs/others/05_cv_Zijin.html#profile",
    "href": "docs/others/05_cv_Zijin.html#profile",
    "title": "Curriculum Vitae",
    "section": "Profile",
    "text": "Profile"
  },
  {
    "objectID": "docs/others/05_cv_Zijin.html#publications",
    "href": "docs/others/05_cv_Zijin.html#publications",
    "title": "Curriculum Vitae",
    "section": "Publications",
    "text": "Publications"
  },
  {
    "objectID": "docs/others/05_cv_Zijin.html#presentations",
    "href": "docs/others/05_cv_Zijin.html#presentations",
    "title": "Curriculum Vitae",
    "section": "Presentations",
    "text": "Presentations\n\nZijin Zhang, Anton Artemyev, Vassilis Angelopoulos, & Shi Chen. (2023, December 11). Solar wind discontinuities spatial evolution and energetic ion scattering. American Geophysical Union. https://doi.org/10.13140/RG.2.2.12905.67682\n\nhttps://beforerr.github.io/ids_spatial_evolution_juno/presentations/AGU23_poster.pdf\nhttp://dx.doi.org/10.13140/RG.2.2.12905.67682"
  },
  {
    "objectID": "docs/others/cv_Zijin.html",
    "href": "docs/others/cv_Zijin.html",
    "title": "Curriculum Vitae",
    "section": "",
    "text": "Education\n\nHeliophysics Summer School, NASA’s Living with a Star, UCAR/CPAESS, Boulder, Colorado, 2024\nGraduate student in Planetary Science, University of California, Los Angeles, 2022 - present\nB.Sc. in Space Physics, University of Science and Technology of China, 2018 - 2022\n\n\n\nResearch Interests\n\nSolar wind and wave‑particle interactions\nComputational plasma physics and application of data science in space science\nSolar physics, heliophysics and experimental space science\n\n\n\nPublications\n\n\nZhang, Z., Artemyev, A., Mourenas, D., Angelopoulos, V., Zhang, X.-J., Kasahara, S., Miyoshi, Y., Matsuoka, A., Kasahara, Y., Mitani, T., Yokota, S., Hori, T., Keika, K., Takashima, T., Teramoto, M., Matsuda, S., & Shinohara, I. (2024). Relativistic Electron Flux Decay and Recovery: Relative Roles of EMIC Waves, Chorus Waves, and Electron Injections. Journal of Geophysical Research: Space Physics, 129(12), e2024JA033174. DOI: 10.1029/2024JA033174\nMargot, J.-L., Li, M. G., Pinchuk, … Zhang, Z.. (2023). A search for technosignatures around 11680 stars with the green bank telescope at 1.15–1.73 GHz. Astronomical Journal, 166(5), 206. DOI: 10.3847/1538-3881/acfda4\nZhang, Z., & Tao, X. (2022). The kinetic simulation of the interaction between the Moon’s magnetic anomalies and the solar wind. Undergraduate Thesis [University of Science and Technology of China]. DOI: 10.13140/RG.2.2.15841.68968\n\n\n\nPresentations\n\nZhang, Z., Artemyev, A., Angelopoulos, V., & Velli, M. (2024, December). On the Alfvénicity of multifluid force-free current sheet. American Geophysical Union.\nZhang, Z., Artemyev, A., Angelopoulos, V., & Chen, S. (2023, December 14). Solar wind discontinuities spatial evolution and energetic ion scattering. American Geophysical Union. DOI: 10.13140/RG.2.2.12905.67682\nZhang, Z., Artemyev, A., Mourenas, D., Angelopoulos, V., & Zhang, X.-J. (2023, December 12). Relativistic electron flux decay and recovery: Relative roles of EMIC waves, whistler-mode waves, and plasmasheet injections. American Geophysical Union. DOI: 10.13140/RG.2.2.33038.33607\nZhang, Z., Artemyev, A., Mourenas, D., Angelopoulos, V., & Zhang, X.-J. (2023, June 22). Relativistic electron flux decay and recovery: Relative role of EMIC waves, whistler-mode waves, and plasmasheet injections. Geospace Environment Modeling. DOI: 10.13140/RG.2.2.33038.33607\n\n\n\nSoftware\n\nZhang, Z. (2025). discontinuitypy: A python package for identifying and analyzing discontinuities for time series (Version v0.4.0) [Computer software]. Zenodo. DOI: 10.5281/ZENODO.14868016\n\n\n\nResearch Experience\n\nGraduate Student Researcher, Experimental Space Physics Group, 2022-present\nStudy energetic ion scattering by solar wind discontinuities. 2022-present. Project website.\nUndergraduate Research Assistant, Artificial Intelligence of Things Lab, 2021-2022\nImplemented a distributed system to monitor edge devices and automate IT deployment and management"
  },
  {
    "objectID": "docs/others/cv_Zijin.html#professional-preparation",
    "href": "docs/others/cv_Zijin.html#professional-preparation",
    "title": "Curriculum Vitae",
    "section": "Professional Preparation",
    "text": "Professional Preparation\nGraduate student in Planetary Science  University of California, Los Angeles  2022-present\nB.Sc. in Space Physics and B.Eng. in Computer Science  University of Science and Technology of China  2018-2022"
  },
  {
    "objectID": "docs/others/cv_Zijin.html#profile",
    "href": "docs/others/cv_Zijin.html#profile",
    "title": "Curriculum Vitae",
    "section": "Profile",
    "text": "Profile"
  },
  {
    "objectID": "docs/others/cv_Zijin.html#publications",
    "href": "docs/others/cv_Zijin.html#publications",
    "title": "Curriculum Vitae",
    "section": "Publications",
    "text": "Publications\n\nZhang, Z., Artemyev, A., Mourenas, D., Angelopoulos, V., Zhang, X.-J., & Kasahara, S. (2024). Relativistic electron flux decay and recovery: Relative roles of EMIC waves, whistler-mode waves, and plasmasheet injections. ResearchGate (to be submitted to JGR: Space Physics). DOI: 10.13140/RG.2.2.25908.01920\nMargot, J.-L., Li, M. G., Pinchuk, … Zhang, Z.. (2023). A search for technosignatures around 11680 stars with the green bank telescope at 1.15–1.73 GHz. Astronomical Journal, 166(5), 206. DOI: 10.3847/1538-3881/acfda4\nZhang, Z., & Tao, X. (2022). The kinetic simulation of the interaction between the Moon’s magnetic anomalies and the solar wind [Undergraduate Thesis, University of Science and Technology of China]. DOI: 10.13140/RG.2.2.15841.68968"
  },
  {
    "objectID": "docs/others/cv_Zijin.html#presentations",
    "href": "docs/others/cv_Zijin.html#presentations",
    "title": "Curriculum Vitae",
    "section": "Presentations",
    "text": "Presentations\n\nZhang, Z., Artemyev, A., Angelopoulos, V., & Chen, S. (2023, December 14). Solar wind discontinuities spatial evolution and energetic ion scattering. American Geophysical Union. DOI: 10.13140/RG.2.2.12905.67682\nZhang, Z., Artemyev, A., Mourenas, D., Angelopoulos, V., & Zhang, X.-J. (2023, December 12). Relativistic electron flux decay and recovery: Relative roles of EMIC waves, whistler-mode waves, and plasmasheet injections. American Geophysical Union. DOI: 10.13140/RG.2.2.33038.33607\nZhang, Z., Artemyev, A., Mourenas, D., Angelopoulos, V., & Zhang, X.-J. (2023, June 22). Relativistic electron flux decay and recovery: Relative role of EMIC waves, whistler-mode waves, and plasmasheet injections. Geospace Environment Modeling. DOI: 10.13140/RG.2.2.33038.33607"
  },
  {
    "objectID": "docs/others/cv_Zijin.html#research-interests",
    "href": "docs/others/cv_Zijin.html#research-interests",
    "title": "Curriculum Vitae",
    "section": "Research Interests",
    "text": "Research Interests\n\nSolar wind and wave‑particle interactions\nComputational plasma physics and application of data science in space science\nSolar physics, heliophysics and experimental space science"
  },
  {
    "objectID": "docs/others/cv_Zijin.html#education",
    "href": "docs/others/cv_Zijin.html#education",
    "title": "Curriculum Vitae",
    "section": "Education",
    "text": "Education\n\nGraduate student in Planetary Science, University of California, Los Angeles, 2022-present\nB.Sc. in Space Physics and B.Eng. in Computer Science,University of Science and Technology of China, 2018-2022"
  },
  {
    "objectID": "docs/others/cv_Zijin.html#research-experience",
    "href": "docs/others/cv_Zijin.html#research-experience",
    "title": "Curriculum Vitae",
    "section": "Research Experience",
    "text": "Research Experience\n\nGraduate Student Researcher, Experimental Space Physics Group, 2022-present\nStudy energetic ion scattering by solar wind discontinuities. 2022-present. Project website.\nUndergraduate Research Assistant, Artificial Intelligence of Things Lab, 2021-2022\nImplemented a distributed system to monitor edge devices and automate IT deployment and management"
  },
  {
    "objectID": "docs/blog/2024_NASA_summer_school/index.html",
    "href": "docs/blog/2024_NASA_summer_school/index.html",
    "title": "Lecture Notes",
    "section": "",
    "text": "Symmetry\nConservations\nComoving frame vs Lab frame\nEvaluate interactions in the comoving frame\n\nRadiation and isotropy\n\n\n\n\n\n“Far out in the uncharted backwaters of the unfashionable end of the western spiral arm of the Galaxy lies a small unregarded yellow sun.” - Douglas Adams\nOn the importance of being Magnetic\n“… a sunspot is a vortex, in which electrified”\nSunspot rush towards the poles\nSheely 2013, Cornoal Cells to infer the magnetic field structure and chirallity of filament channels\nPlasma is different\n\nCollision, faster particle collide less and can be accelerated more easily\n\nInverse Robin Hood D.T. Runaway is possible\n\n\ncometary ion tail\nWarped heliospheric current sheet is limited in space and time (1Au and further)\nYou can treat everything as a fluid as long as you find a way to close the system with proper equations of state"
  },
  {
    "objectID": "docs/blog/journal_club/2024-04-23_mercury/index.html",
    "href": "docs/blog/journal_club/2024-04-23_mercury/index.html",
    "title": "MESSENGER Observations of Extreme Loading and Unloading of Mercury’s Magnetic Tail",
    "section": "",
    "text": "Messenger (Mercury Surface, Space Environment, Geochemistry, and Ranging)\n\nA NASA robotic space probe that orbited the planet Mercury between 2011 and 2015\nMagnetometer (MAG) and Energetic Particle and Plasma Spectrometer (EPPS)\n\n\nMercury\n\nThe smallest and innermost planet (\\(0.39 \\text{AU}\\)) in the Solar System\n\\(R_{\\text{Mercury}} = 2439.7 \\text{km} = 0.38 R_{\\text{Earth}}\\)\n\nDungey cycle\n\nCirculation of plasma, magnetic flux, and energy from the dayside X-line at the magnetopause\nto the nightside X-line in the crosstail current layer and,\nand later, back to the dayside magnetosphere\nRanges from ~1 month at Jupiter to ~1 week at Saturn and ~1 hour at Earth\n\n\n\nA cross-magnetosphere electric potential of ~30 kV or a mean dawn-to- dusk electric field of ~2 mV/m. This electric field implies a Dungey cycle time (i.e., time to drift in response to the dawn-to-dusk magnetospheric electric field from local noon to midnight in the polar cap, or from the northern boundary of the tail down to the cross-tail current sheet) at Mercury of ~2 min.\n\\[\n\\phi_c = R_{MP} × (v × B_N) \\approx 30 kV\n\\]\nThe relevant scaleis the convectiontime \\(T_c\\), defined a the time to cycle the magnetic flux in the tail \\(\\Phi_T\\) under the action of the electric potential \\(\\phi_c\\) across the magnetosphere: \\(T_c = \\Phi_T/\\phi_c\\)\n\n\n\n\n\n\n\nThe magnitude of the magnetic field in Mercury’s tail increased and then decreased by factors of ~2 to 3.5.\n\nNeglecting changes in tail diameter, magnetic energy density increased by factors of 10. (By comparison, Earth’s one is less than a factor of ~1.6)\nEvents 2 to 4 corresponded to higher \\(|B_Y/B_X|\\) than the intervening periods, indicating increased flaring of the magnetic tail.\n\n\nEstimating the magnetic flux\n\\[\n\\Phi = \\int_{\\text{tail}} B \\cdot dA = 0.5 \\pi B_{\\text{tail}}R_{\\text{tail}}^2\n\\]\n\nthe radius of the tail for event 3 may have reached 3.5 \\(R_M\\)\n\nthe solar wind conditions predicted from a magnetohydrodynamic model of the inner heliosphere driven by solar magnetic field observations\n\n\n\\[\n\\Phi = \\approx 9.5 \\text{MWb}\n\\]\n\n\n\nFig. 3 Magnetometer observations of tail-loading event 2 during MESSENGER’s third flyby.\n\n\nsix intervals of several seconds each when the total magnetic field weakened, indicating entry into a region with high plasma thermal pressure and low magnetic field pressure.\nThese minima in field magnitude coincide with either rapid northward-then-southward or just southward variations in BZ, followed by a slower recovery back to BZ ≈ 0\n\n\nNear-Mercury neutral line (NMNL)\n\nThe NMNL was observed near XMSO = –2.6 RM during MESSENGER’s second flyby (5), but it was closer to the planet, near XMSO ≈ –1.6 RM, for this flyby. The third flyby results therefore suggest that the NMNL develops much closer to the planet when the magnetic tail is heavily loaded with magnetic flux, such as during events 2 and 3.\n\n\n\n\nThe total magnetic flux emanating from Mercury’s surface can be calculated for a simple centered dipole:\n\\[\n\\Phi_M = 2 \\pi B_{\\text{eq}}R_{\\text{M}}^2 \\approx 9.5 \\text{MWb}\n\\]\n\\[\n\\Phi / \\Phi_M \\approx 1\n\\]\nBy comparision, Earth’s is only ~10 to 12%.\n\nMercury’s dayside magneto-sphere may be fully depleted by reconnection\nThe entire dayside surface would map to open magnetic field lines and be exposed to the shocked solar wind of the magnetosheath."
  },
  {
    "objectID": "docs/blog/journal_club/2024-04-23_mercury/index.html#quick-facts",
    "href": "docs/blog/journal_club/2024-04-23_mercury/index.html#quick-facts",
    "title": "MESSENGER Observations of Extreme Loading and Unloading of Mercury’s Magnetic Tail",
    "section": "",
    "text": "Messenger (Mercury Surface, Space Environment, Geochemistry, and Ranging)\n\nA NASA robotic space probe that orbited the planet Mercury between 2011 and 2015\nMagnetometer (MAG) and Energetic Particle and Plasma Spectrometer (EPPS)\n\n\nMercury\n\nThe smallest and innermost planet (\\(0.39 \\text{AU}\\)) in the Solar System\n\\(R_{\\text{Mercury}} = 2439.7 \\text{km} = 0.38 R_{\\text{Earth}}\\)\n\nDungey cycle\n\nCirculation of plasma, magnetic flux, and energy from the dayside X-line at the magnetopause\nto the nightside X-line in the crosstail current layer and,\nand later, back to the dayside magnetosphere\nRanges from ~1 month at Jupiter to ~1 week at Saturn and ~1 hour at Earth\n\n\n\nA cross-magnetosphere electric potential of ~30 kV or a mean dawn-to- dusk electric field of ~2 mV/m. This electric field implies a Dungey cycle time (i.e., time to drift in response to the dawn-to-dusk magnetospheric electric field from local noon to midnight in the polar cap, or from the northern boundary of the tail down to the cross-tail current sheet) at Mercury of ~2 min.\n\\[\n\\phi_c = R_{MP} × (v × B_N) \\approx 30 kV\n\\]\nThe relevant scaleis the convectiontime \\(T_c\\), defined a the time to cycle the magnetic flux in the tail \\(\\Phi_T\\) under the action of the electric potential \\(\\phi_c\\) across the magnetosphere: \\(T_c = \\Phi_T/\\phi_c\\)"
  },
  {
    "objectID": "docs/projects/trips/transactions_with_currencies.html",
    "href": "docs/projects/trips/transactions_with_currencies.html",
    "title": "Transactions with currencies",
    "section": "",
    "text": "Code\ndef convert_transactions_to_target_currency(transactions, exchange_rates, target_currency = 'CNY'):\n    \"\"\"\n    Converts a list of transactions in various currencies to a target currency based on provided exchange rates.\n\n    Parameters:\n    - transactions (list of tuples): A list where each tuple contains the amount and its currency as a string,\n      e.g., [(100, 'USD'), (-50, 'GBP')].\n    - exchange_rates (dict): A dictionary of exchange rates with currency pairs as keys and rates as values,\n      e.g., {('USD', 'CNY'): 9.14, ('GBP', 'CNY'): 7.23}.\n    - target_currency (str): The currency to which all amounts will be converted.\n\n    Returns:\n    - float: The total amount in the target currency after conversion.\n    \"\"\"\n    total_in_target_currency = 0.0\n    for amount, currency in transactions:\n        if currency == target_currency:\n            # If the transaction is already in the target currency, no conversion is needed.\n            converted_amount = amount\n        else:\n            # Convert the transaction to the target currency using the exchange rate.\n            key = (currency, target_currency)\n            if key in exchange_rates:\n                rate = exchange_rates[key]\n                converted_amount = amount * rate\n            else:\n                raise ValueError(f\"No exchange rate provided for {currency} to {target_currency}\")\n        total_in_target_currency += converted_amount\n    \n    print(total_in_target_currency, \"in\", target_currency)\n    \n    return total_in_target_currency\n\ndef convert_transactions_to_target_currencies(transactions, exchange_rates, target_currencies = ['CNY', 'USD']):\n    \"\"\"Converts a list of transactions in various currencies to multiple target currencies based on provided exchange rates.\n    \"\"\" \n    return [convert_transactions_to_target_currency(transactions, exchange_rates, target_currency) for target_currency in target_currencies]\nCode\nexchange_rates_example = {\n    (\"GBP\", \"CNY\"): 9.14,\n    (\"USD\", \"CNY\"): 7.23,\n    (\"CNY\", \"CNY\"): 1,\n    (\"GBP\", \"USD\"): 1.26,\n    \n}\ntarget_currency_example = \"CNY\"\ntarget_currency_example = \"USD\"",
    "crumbs": [
      "Projects",
      "Trips",
      "Transactions with currencies"
    ]
  },
  {
    "objectID": "docs/projects/trips/transactions_with_currencies.html#zijin---yezi",
    "href": "docs/projects/trips/transactions_with_currencies.html#zijin---yezi",
    "title": "Transactions with currencies",
    "section": "Zijin - Yezi",
    "text": "Zijin - Yezi\n\n\nCode\ntransactions_example = [(339.21, 'GBP'), (-251.38, 'USD')]\nresult_example = convert_transactions_to_target_currencies(transactions_example, exchange_rates_example)\n\n\n1282.9019999999998 in CNY\n176.02459999999996 in USD",
    "crumbs": [
      "Projects",
      "Trips",
      "Transactions with currencies"
    ]
  },
  {
    "objectID": "docs/projects/trips/transactions_with_currencies.html#zijin---hanlin",
    "href": "docs/projects/trips/transactions_with_currencies.html#zijin---hanlin",
    "title": "Transactions with currencies",
    "section": "Zijin - Hanlin",
    "text": "Zijin - Hanlin\n\n\nCode\ntransactions_example = [(72.33, 'GBP'), (-251.40, 'USD')]\nresult_example = convert_transactions_to_target_currencies(transactions_example, exchange_rates_example)\n\n\n-1156.5258 in CNY\n-160.26420000000002 in USD",
    "crumbs": [
      "Projects",
      "Trips",
      "Transactions with currencies"
    ]
  },
  {
    "objectID": "docs/projects/trips/transactions_with_currencies.html#zijin---hanzhang",
    "href": "docs/projects/trips/transactions_with_currencies.html#zijin---hanzhang",
    "title": "Transactions with currencies",
    "section": "Zijin - Hanzhang",
    "text": "Zijin - Hanzhang\n\n\nCode\ntransactions_example = [(-251.40, 'USD')]\nresult_example = convert_transactions_to_target_currencies(transactions_example, exchange_rates_example)\n\n\n-1817.622 in CNY\n-251.4 in USD",
    "crumbs": [
      "Projects",
      "Trips",
      "Transactions with currencies"
    ]
  },
  {
    "objectID": "docs/projects/trips/transactions_with_currencies.html#zijin---rosy",
    "href": "docs/projects/trips/transactions_with_currencies.html#zijin---rosy",
    "title": "Transactions with currencies",
    "section": "Zijin - Rosy",
    "text": "Zijin - Rosy\n\n\nCode\ntransactions_example = [(-177.89, 'USD')]\nresult_example = convert_transactions_to_target_currencies(transactions_example, exchange_rates_example)\n\n\n-1286.1447 in CNY\n-177.89 in USD",
    "crumbs": [
      "Projects",
      "Trips",
      "Transactions with currencies"
    ]
  },
  {
    "objectID": "docs/blog/phd/proposal_EMIC.html",
    "href": "docs/blog/phd/proposal_EMIC.html",
    "title": "Dynamics of EMIC Waves and Their Influence on Radiation Belt Electron Fluxes",
    "section": "",
    "text": "PhD Candidate: Zijin Zhang"
  },
  {
    "objectID": "docs/blog/phd/proposal_EMIC.html#abstract",
    "href": "docs/blog/phd/proposal_EMIC.html#abstract",
    "title": "Dynamics of EMIC Waves and Their Influence on Radiation Belt Electron Fluxes",
    "section": "Abstract",
    "text": "Abstract\nElectromagnetic Ion Cyclotron (EMIC) waves are fundamental plasma wave phenomena in Earth’s magnetosphere, influencing the dynamics of radiation belts through interactions with energetic electrons. These interactions often lead to significant modulation of electron fluxes, contributing to both electron acceleration and loss. This study aims to deepen the understanding of how EMIC waves, in concert with other wave modes such as whistler-mode chorus waves and phenomena like plasma sheet injections, impact the behavior of radiation belt electrons during various geomagnetic conditions. Leveraging extensive datasets from satellites such as the Van Allen Probes, ERG (Arase), MMS, and ELFIN, this study will conduct a comprehensive analysis of wave properties, and the resulting effects on electron fluxes. By integrating observational data with advanced simulation techniques, the project seeks to enhance current models of radiation belt dynamics, improving predictions of space weather effects."
  },
  {
    "objectID": "docs/blog/phd/proposal_EMIC.html#background-and-motivation",
    "href": "docs/blog/phd/proposal_EMIC.html#background-and-motivation",
    "title": "Dynamics of EMIC Waves and Their Influence on Radiation Belt Electron Fluxes",
    "section": "Background and Motivation",
    "text": "Background and Motivation\nThe dynamic environments of Earth’s radiation belts are shaped by a complex interplay of different types of waves and particle populations. Among these, Electromagnetic Ion Cyclotron (EMIC) waves play a pivotal role in the energy dynamics of radiation belt electrons. These waves, primarily generated through instabilities associated with the anisotropic temperature distribution of ions, have been the focus of significant research due to their ability to effectively resonate with high-energy electrons (Millan & Thorne, 2007; Jordanova et al., 2010).\nOrigin and Characteristics of EMIC Waves:\nEMIC waves arise predominantly during geomagnetic storms when rapid injections of energetic ions from the solar wind into the magnetosphere create temperature anisotropies (Cornwall et al., 1970; Anderson et al., 1996). These waves have been observed in different frequency bands corresponding to the ion species (H+, He+, O+) that drive them, each influencing different electron populations within the radiation belts. The interaction of these waves with electrons, particularly through resonant scattering, can lead to significant modifications in electron pitch angles and energies, contributing to both acceleration and loss processes.\nInteractions with Radiation Belt Electrons:\nThe resonance with radiation belt electrons typically results in increased pitch angle scattering, particularly for electrons at energies of hundreds of keV to several MeV. This scattering can fill the loss cone and lead to electron precipitation into the Earth’s atmosphere, effectively depleting the radiation belt populations (Thorne et al., 2005; Summers et al., 2007). Furthermore, recent studies have highlighted that under certain conditions, EMIC waves can also accelerate electrons to ultra-relativistic energies through mechanisms that are not yet fully understood and are a current area of active research (Miyoshi et al., 2013; Foster et al., 2014).\nRole of EMIC Waves in Space Weather:\nUnderstanding the interactions between EMIC waves and radiation belt electrons is crucial for predicting space weather effects, particularly since these interactions can lead to rapid changes in radiation belt configurations, posing risks to satellites and other space-based technologies (Baker et al., 2004; Horne et al., 2005). The 2003 Halloween storm provided a clear example of how enhanced EMIC wave activity correlated with significant radiation belt electron flux decreases, highlighting the importance of including these waves in predictive models (Turner et al., 2012).\nGaps in Current Understanding:\nDespite significant advances, there remain substantial gaps in our understanding of the conditions under which EMIC waves are most effective at causing electron losses and what roles other concurrent processes (e.g., whistler-mode chorus waves and plasma sheet injections) play in modifying these interactions. The proposed study aims to bridge these gaps by combining observational data analysis with theoretical modeling efforts.\nThis enriched background sets a solid foundation for investigating the interactions of EMIC waves with radiation belt electrons and underscores the importance of this research in advancing our understanding of magnetospheric physics and improving our ability to forecast space weather impacts effectively."
  },
  {
    "objectID": "docs/blog/phd/proposal_EMIC.html#proposed-data-and-detailed-analysis-approach",
    "href": "docs/blog/phd/proposal_EMIC.html#proposed-data-and-detailed-analysis-approach",
    "title": "Dynamics of EMIC Waves and Their Influence on Radiation Belt Electron Fluxes",
    "section": "Proposed Data and Detailed Analysis Approach",
    "text": "Proposed Data and Detailed Analysis Approach\nData Acquisition and Sources:\n\nELFIN CubeSat: Employ low-altitude measurements from the ELFIN CubeSat to quantify the effects of EMIC waves on electron precipitation. ELFIN’s unique orbital characteristics allow it to measure loss cone distributions and provide a direct measure of wave-driven electron losses, enhancing our understanding of wave-particle interaction dynamics in the radiation belts.\nVan Allen Probes: Utilize extensive datasets from the Van Allen Probes, which include electric and magnetic field measurements, plasma wave spectra, and particle detection (electron and ion fluxes) across different energy ranges. These data are essential for directly observing EMIC waves and assessing their interactions with radiation belt electrons during different geomagnetic conditions.\nERG (Arase) Satellite: Draw upon high-resolution data from the ERG satellite, which offers crucial insights into the inner magnetosphere’s dynamics. ERG’s suite of instruments provides critical measurements of electron density, electric fields, and magnetic fields that help identify the conditions conducive to EMIC wave generation and propagation.\nMagnetospheric Multiscale (MMS) Mission: Analyze high-resolution data from the MMS mission, which is key for understanding the microphysics of wave-particle interactions, especially during short-duration events and smaller spatial scales that are not resolved by other satellites.\n\nAnalytical Methods:\n\nWave-Particle Interaction Analysis: Use phase space density calculations and quasi-linear theory to analyze how EMIC waves scatter radiation belt electrons into the loss cone, leading to precipitation. This method helps in quantifying the diffusion coefficients which are critical for understanding the rate and extent of electron flux changes.\nEvent Selection and Case Studies: Identify specific events during which intense EMIC wave activity coincides with significant changes in electron fluxes. These events will be used as case studies to analyze the interaction mechanisms in detail, employing cross-spectral analysis to examine the coherence between EMIC waves and electron flux oscillations.\n\nSimulation and Modeling:\n\nDiffusion Model Enhancement: Integrate the latest empirical models of EMIC wave properties into existing radiation belt simulation frameworks. This will involve updating the wave spectral characteristics and amplitudes based on observed data, thus refining the models used to predict electron dynamics under various space weather conditions.\nNumerical Simulations: Conduct particle-in-cell and test particle simulations to model the interactions of electrons with EMIC waves, validating the theoretical predictions with observational data. This approach provides a dynamic simulation environment where theoretical assumptions can be rigorously tested against real-world data.\nModel Validation and Iterative Refinement: Employ a systematic approach to compare simulated results with satellite observations. This iterative process of validation and refinement is essential to improve the reliability and accuracy of predictive models, ensuring they are robust under a wide range of space weather scenarios.\n\nResearch Questions Addressed:\n\nMechanism Elucidation: How exactly do EMIC waves influence electron pitch angles and energies, and under what specific conditions do these interactions lead to net electron losses or gains?\nModeling Improvements: Can the integration of enhanced EMIC wave models into simulation frameworks improve the accuracy of forecasts regarding electron dynamics in the radiation belts?\nPredictive Capabilities: How effectively can the refined models predict changes in electron fluxes during geomagnetic storms, and what improvements are necessary to achieve better predictive reliability?\n\nBy addressing these questions through a detailed analytical and simulation-based approach, the proposed research aims to significantly advance our understanding of EMIC waves’ role in radiation belt dynamics."
  },
  {
    "objectID": "docs/blog/phd/proposal_EMIC.html#expected-contributions",
    "href": "docs/blog/phd/proposal_EMIC.html#expected-contributions",
    "title": "Dynamics of EMIC Waves and Their Influence on Radiation Belt Electron Fluxes",
    "section": "Expected Contributions",
    "text": "Expected Contributions\nThis research project is poised to make contributions to our understanding of magnetospheric dynamics, particularly in relation to how EMIC waves influence radiation belt electrons. The integration of empirical data from multiple satellite sources with advanced simulation techniques aims to create a robust analytical framework capable of deciphering the complex interactions within Earth’s magnetosphere. Specific expected contributions include:\n\nEmpirical Analysis of Wave-Particle Interactions: By leveraging data from the Van Allen Probes, ERG, MMS, and ELFIN, this study will provide comprehensive empirical insights into how EMIC waves interact with radiation belt electrons. This will include detailed case studies where EMIC wave activity is correlated with significant changes in electron fluxes, enhancing our empirical understanding of these critical interactions.\nAdvanced Theoretical Modeling: The development and enhancement of diffusion models that incorporate refined EMIC wave characteristics will offer new theoretical insights into the mechanisms driving electron dynamics in the radiation belts. This will facilitate a better understanding of the conditions under which EMIC waves lead to electron acceleration or loss, filling a significant gap in the current scientific literature.\nImproved Predictive Capabilities for Space Weather: By refining simulation models to better predict the impacts of EMIC waves on radiation belt dynamics, this research will enhance our ability to forecast space weather effects, thereby contributing to more effective mitigation strategies for protecting satellites and other space-based technologies from adverse effects.\nPublications and Dissemination: The findings from this study are expected to be disseminated through several peer-reviewed scientific papers, presentations at major international conferences, and integrations into global space weather modeling tools, reaching both academic audiences and space weather practitioners."
  },
  {
    "objectID": "docs/blog/phd/proposal_EMIC.html#discussion-and-future-work",
    "href": "docs/blog/phd/proposal_EMIC.html#discussion-and-future-work",
    "title": "Dynamics of EMIC Waves and Their Influence on Radiation Belt Electron Fluxes",
    "section": "Discussion and Future Work",
    "text": "Discussion and Future Work\nThe findings from this research will deepen our understanding of magnetospheric physics, particularly the role of EMIC waves in electron dynamics. However, several questions are likely to emerge from this study, guiding future research efforts:\n\nWave Source Regions and Propagation: Further investigations may be required to identify the specific source regions of EMIC waves and their propagation characteristics through the magnetosphere. Understanding these aspects could enhance predictions of when and where EMIC waves will impact electron populations.\nInteractions with Other Wave Modes: While this project focuses on EMIC waves, the magnetosphere contains multiple interacting wave modes. Future work could explore the interactions between EMIC waves and other wave types, such as ULF and VLF waves, to provide a more holistic view of the dynamics governing radiation belt electron fluxes.\nTechnological Applications: The development of real-time monitoring tools based on the findings from this research could be explored. These tools would use satellite data to provide immediate assessments of EMIC wave activity and its potential impacts, offering valuable information for satellite operators and space weather forecasters."
  },
  {
    "objectID": "docs/blog/phd/proposal_EMIC.html#summary",
    "href": "docs/blog/phd/proposal_EMIC.html#summary",
    "title": "Dynamics of EMIC Waves and Their Influence on Radiation Belt Electron Fluxes",
    "section": "Summary",
    "text": "Summary\nThe proposed research is designed to tackle some of the most pressing questions in space physics regarding the impact of EMIC waves on radiation belt dynamics. Through a combination of detailed empirical analysis and advanced theoretical modeling, this project aims to provide significant insights and tools for predicting space weather, thereby contributing to our ability to safeguard and optimize the operation of space-based technologies."
  },
  {
    "objectID": "docs/blog/phd/index.html",
    "href": "docs/blog/phd/index.html",
    "title": "PhD",
    "section": "",
    "text": "Geophysics & Space Physics | UCLA Graduate Programs\n\n\nDepartmental Written and Oral Preliminary Examination: This examination must be taken no later than the spring quarter of the second year. It is scheduled by the faculty adviser in consultation with the student and other members of the examining committee. The examining committee consists of the faculty adviser and at least two additional EPSS faculty members. In extraordinary circumstances, a delay or change in committee membership may be granted by petition to the graduate adviser or department chair.\n\n\nThe student prepares two written research proposals on two dissimilar projects approved by the faculty adviser. The proposals must be concise, with a guideline of 4 pages and a maximum of 5 pages, and must be submitted to the examining committee at least 10 days before the examination. One of the proposals should cover a possible dissertation topic. The proposals are presented briefly to the examining committee orally, and the committee examines their originality and scientific merit, as well as the student’s fundamental knowledge in the program area.\n\n\nFirst Exam"
  },
  {
    "objectID": "docs/blog/journal_club/2024-04-23_mercury/messenger.revealjs.html#quick-facts",
    "href": "docs/blog/journal_club/2024-04-23_mercury/messenger.revealjs.html#quick-facts",
    "title": "MESSENGER Observations of Extreme Loading and Unloading of Mercury’s Magnetic Tail",
    "section": "Quick facts",
    "text": "Quick facts\nMessenger (Mercury Surface, Space Environment, Geochemistry, and Ranging)\n\nA NASA robotic space probe that orbited the planet Mercury between 2011 and 2015\nMagnetometer (MAG) and Energetic Particle and Plasma Spectrometer (EPPS)\n\n\nMercury\n\nThe smallest and innermost planet (\\(0.39 \\text{AU}\\)) in the Solar System\n\\(R_{\\text{Mercury}} = 2439.7 \\text{km} = 0.38 R_{\\text{Earth}}\\)\n\nDungey cycle\n\nCirculation of plasma, magnetic flux, and energy from the dayside X-line at the magnetopause\nto the nightside X-line in the crosstail current layer and,\nand later, back to the dayside magnetosphere\nRanges from ~1 month at Jupiter to ~1 week at Saturn and ~1 hour at Earth\n\nMercury’s magnetosphere under southward IMF conditions\nA cross-magnetosphere electric potential of ~30 kV or a mean dawn-to- dusk electric field of ~2 mV/m. This electric field implies a Dungey cycle time (i.e., time to drift in response to the dawn-to-dusk magnetospheric electric field from local noon to midnight in the polar cap, or from the northern boundary of the tail down to the cross-tail current sheet) at Mercury of ~2 min.\n\\[\n\\phi_c = R_{MP} × (v × B_N) \\approx 30 kV\n\\]\nThe relevant scaleis the convectiontime \\(T_c\\), defined a the time to cycle the magnetic flux in the tail \\(\\Phi_T\\) under the action of the electric potential \\(\\phi_c\\) across the magnetosphere: \\(T_c = \\Phi_T/\\phi_c\\)"
  },
  {
    "objectID": "docs/blog/journal_club/2024-04-23_mercury/index.html#tail-loading-event-2",
    "href": "docs/blog/journal_club/2024-04-23_mercury/index.html#tail-loading-event-2",
    "title": "MESSENGER Observations of Extreme Loading and Unloading of Mercury’s Magnetic Tail",
    "section": "",
    "text": "Fig. 3 Magnetometer observations of tail-loading event 2 during MESSENGER’s third flyby.\n\n\nsix intervals of several seconds each when the total magnetic field weakened, indicating entry into a region with high plasma thermal pressure and low magnetic field pressure.\nThese minima in field magnitude coincide with either rapid northward-then-southward or just southward variations in BZ, followed by a slower recovery back to BZ ≈ 0\n\n\nNear-Mercury neutral line (NMNL)\n\nThe NMNL was observed near XMSO = –2.6 RM during MESSENGER’s second flyby (5), but it was closer to the planet, near XMSO ≈ –1.6 RM, for this flyby. The third flyby results therefore suggest that the NMNL develops much closer to the planet when the magnetic tail is heavily loaded with magnetic flux, such as during events 2 and 3."
  },
  {
    "objectID": "docs/blog/journal_club/2024-04-23_mercury/index.html#overview-of-magnetospheric-measurements",
    "href": "docs/blog/journal_club/2024-04-23_mercury/index.html#overview-of-magnetospheric-measurements",
    "title": "MESSENGER Observations of Extreme Loading and Unloading of Mercury’s Magnetic Tail",
    "section": "",
    "text": "The magnitude of the magnetic field in Mercury’s tail increased and then decreased by factors of ~2 to 3.5.\n\nNeglecting changes in tail diameter, magnetic energy density increased by factors of 10. (By comparison, Earth’s one is less than a factor of ~1.6)\nEvents 2 to 4 corresponded to higher \\(|B_Y/B_X|\\) than the intervening periods, indicating increased flaring of the magnetic tail.\n\n\nEstimating the magnetic flux\n\\[\n\\Phi = \\int_{\\text{tail}} B \\cdot dA = 0.5 \\pi B_{\\text{tail}}R_{\\text{tail}}^2\n\\]\n\nthe radius of the tail for event 3 may have reached 3.5 \\(R_M\\)\n\nthe solar wind conditions predicted from a magnetohydrodynamic model of the inner heliosphere driven by solar magnetic field observations\n\n\n\\[\n\\Phi = \\approx 9.5 \\text{MWb}\n\\]"
  },
  {
    "objectID": "docs/blog/journal_club/2024-04-23_mercury/index.html#schematic-view",
    "href": "docs/blog/journal_club/2024-04-23_mercury/index.html#schematic-view",
    "title": "MESSENGER Observations of Extreme Loading and Unloading of Mercury’s Magnetic Tail",
    "section": "",
    "text": "The total magnetic flux emanating from Mercury’s surface can be calculated for a simple centered dipole:\n\\[\n\\Phi_M = 2 \\pi B_{\\text{eq}}R_{\\text{M}}^2 \\approx 9.5 \\text{MWb}\n\\]\n\\[\n\\Phi / \\Phi_M \\approx 1\n\\]\nBy comparision, Earth’s is only ~10 to 12%.\n\nMercury’s dayside magneto-sphere may be fully depleted by reconnection\nThe entire dayside surface would map to open magnetic field lines and be exposed to the shocked solar wind of the magnetosheath."
  },
  {
    "objectID": "docs/blog/journal_club/2024-04-23_mercury/messenger.revealjs.html#overview-of-magnetospheric-measurements",
    "href": "docs/blog/journal_club/2024-04-23_mercury/messenger.revealjs.html#overview-of-magnetospheric-measurements",
    "title": "MESSENGER Observations of Extreme Loading and Unloading of Mercury’s Magnetic Tail",
    "section": "Overview of magnetospheric measurements",
    "text": "Overview of magnetospheric measurements\n\n\nThe magnitude of the magnetic field in Mercury’s tail increased and then decreased by factors of ~2 to 3.5.\n\nNeglecting changes in tail diameter, magnetic energy density increased by factors of 10. (By comparison, Earth’s one is less than a factor of ~1.6)\nEvents 2 to 4 corresponded to higher \\(|B_Y/B_X|\\) than the intervening periods, indicating increased flaring of the magnetic tail."
  },
  {
    "objectID": "docs/blog/journal_club/2024-04-23_mercury/messenger.revealjs.html#tail-loading-event-2",
    "href": "docs/blog/journal_club/2024-04-23_mercury/messenger.revealjs.html#tail-loading-event-2",
    "title": "MESSENGER Observations of Extreme Loading and Unloading of Mercury’s Magnetic Tail",
    "section": "Tail-loading event 2",
    "text": "Tail-loading event 2\nFig. 3 Magnetometer observations of tail-loading event 2 during MESSENGER’s third flyby.\n\nEstimating the magnetic flux\n\\[\n\\Phi = \\int_{\\text{tail}} B \\cdot dA = 0.5 \\pi B_{\\text{tail}}R_{\\text{tail}}^2\n\\]\n\nthe radius of the tail for event 3 may have reached 3.5 \\(R_M\\)\n\nthe solar wind conditions predicted from a magnetohydrodynamic model of the inner heliosphere driven by solar magnetic field observations\n\n\n\\[\n\\Phi = \\approx 9.5 \\text{MWb}\n\\]"
  },
  {
    "objectID": "docs/blog/journal_club/2024-04-23_mercury/messenger.revealjs.html#schematic-view",
    "href": "docs/blog/journal_club/2024-04-23_mercury/messenger.revealjs.html#schematic-view",
    "title": "MESSENGER Observations of Extreme Loading and Unloading of Mercury’s Magnetic Tail",
    "section": "Schematic view",
    "text": "Schematic view\nThe total magnetic flux emanating from Mercury’s surface can be calculated for a simple centered dipole:\n\\[\n\\Phi_M = 2 \\pi B_{\\text{eq}}R_{\\text{M}}^2 \\approx 9.5 \\text{MWb}\n\\]\n\\[\n\\Phi / \\Phi_M \\approx 1\n\\]\nBy comparision, Earth’s is only ~10 to 12% (14).\n\nMercury’s dayside magneto-sphere may be fully depleted by reconnection\nThe entire dayside surface would map to open magnetic field lines and be exposed to the shocked solar wind of the magnetosheath.\n\n\n\n\n\nJournal Club Presentation"
  },
  {
    "objectID": "docs/blog/phd/2024_pre/proposal_EMIC.html",
    "href": "docs/blog/phd/2024_pre/proposal_EMIC.html",
    "title": "Relative role of EMIC waves, chorus waves, and electron injections on relativistic electron flux",
    "section": "",
    "text": "PhD Candidate: Zijin Zhang"
  },
  {
    "objectID": "docs/blog/phd/2024_pre/proposal_EMIC.html#abstract",
    "href": "docs/blog/phd/2024_pre/proposal_EMIC.html#abstract",
    "title": "Dynamics of EMIC Waves and Their Influence on Radiation Belt Electron Fluxes",
    "section": "Abstract",
    "text": "Abstract\nElectromagnetic Ion Cyclotron (EMIC) waves and whistler waves are fundamental plasma wave phenomena in Earth’s magnetosphere, influencing the dynamics of radiation belts through interactions with energetic electrons. These interactions often lead to significant modulation of electron fluxes, with chorus waves accelerating electrons to relativistic energies (Miyoshi et al. 2003; Sorathia et al. 2018) and EMIC & whistler waves causing electron losses through pitch angle scattering (Summers and Thorne 2003; Summers, Ni, and Meredith 2007b). This study aims to deepen the understanding of how these waves, in concert with other phenomena like plasma sheet injections, impact the behavior of radiation belt electrons. Leveraging extensive datasets from satellites such as the Van Allen Probes, ERG (Arase), MMS, and ELFIN, this study will conduct a comprehensive analysis of wave properties, and the resulting effects on electron fluxes. By integrating observational data with advanced simulation techniques, the project seeks to enhance current models of radiation belt dynamics, improving predictions of space weather effects."
  },
  {
    "objectID": "docs/blog/phd/2024_pre/proposal_EMIC.html#background-and-motivation",
    "href": "docs/blog/phd/2024_pre/proposal_EMIC.html#background-and-motivation",
    "title": "Dynamics of EMIC Waves and Their Influence on Radiation Belt Electron Fluxes",
    "section": "Background and Motivation",
    "text": "Background and Motivation\nInteractions of Waves with Radiation Belt Electrons:\nRelativistic electron fluxes in Earth’s inner magnetosphere are greatly affected by electron scattering to the atmosphere via resonant interactions with whistler-mode and electromagnetic ion cyclotron (EMIC) waves (Millan and Thorne 2007; Summers, Ni, and Meredith 2007a). Near the loss-cone, electron scattering rates for EMIC waves at such energies are much larger than for whistler-mode waves (Glauert and Horne 2005). Thus, EMIC wave-driven electron precipitation is considered a key contributor to relativistic electron losses at energies exceeding the minimum energy for cyclotron resonance with such waves, \\(E_{\\min}\\sim 0.5-1\\) MeV (Summers and Thorne 2003; Summers, Ni, and Meredith 2007b). Numerical simulations of the outer radiation belt dynamics (Ma et al. 2015) and data-model comparisons (Angelopoulos et al. 2023) have demonstrated that EMIC waves can scatter relativistic electrons efficiently and deplete their fluxes quickly in the outer radiation belt.\nFor energies below ultra-relativistic energies (below several MeV) and for typical plasma characteristics, EMIC wave-driven electron scattering mostly affects low pitch-angle electrons (equatorial \\(\\alpha_{eq}&lt;30^\\circ\\), see Kersten et al. 2014). Therefore, additional high pitch-angle electron scattering by whistler-mode waves is required to assist EMIC waves in the precipitation of the main, near-equatorial, (trapped) electron population (Mourenas et al. 2016). A combination of electron scattering by whistler-mode and EMIC waves at the same \\(L\\)-shell (even if at different longitudes) can result in a very effective electron flux depletion (Mourenas et al. 2016; Drozdov et al. 2022). Verification of this electron loss mechanism requires a combination of satellites near the equator (to measure the waves and equatorial pitch-angle electron fluxes) and at low-altitude (to measure precipitating electron fluxes).\nOrigin and Characteristics of Waves:\n\nEMIC waves are often generated by anisotropic ion populations from plasma sheet injections . These injections also create anisotropic “seed” electrons , the free energy source for whistler-mode chorus waves . Such chorus waves can effectively accelerate the same seed electrons to relativistic energies \\cite&lt;e.g.,&gt;{Miyoshi03,Thorne13:nature,Li14:storm,Mourenas14:fluxes,Allison&Shprits20}. Therefore, there is a competition between electron acceleration by whistler-mode waves \\cite&lt;supported by direct adiabatic heating during injections, see, e.g.&gt;{Sorathia18} and electron precipitation by EMIC and chorus waves, and this competition should ultimately shape the energy spectrum of radiation belt electrons after a series of plasma sheet injections. Several recent publications indicate that the electron energy spectrum may have an upper limit corresponding to a balance between electron injections and precipitation loss, controlled by whistler-mode waves . The existence of such an upper limit has been predicted by Kennel and Petschek (1966), and reevaluated for relativistic electrons by Summers, Tang, and Thorne (2009) and Summers and Shi (2014). Several of its main assumptions have been verified using ELFIN data . The Kennel-Petschek upper limit is based on the idea that injected electrons generate whistler-mode waves (with exponentially higher wave power for electron fluxes above the flux limit) that ultimately scatter these same injected electrons into the atmosphere. The competition between linearly increasing anisotropic electron fluxes and exponentially faster electron losses into the atmosphere due to exponentially increasing wave growth, leads to a stationary solution in the diffusion (Fokker-Planck) equation describing electron flux dynamics. Inclusion of EMIC wave-driven loss into this balance reduces the upper limit of the electron flux at high energy .\nRole of EMIC Waves in Space Weather:\nUnderstanding the interactions between EMIC waves and radiation belt electrons is crucial for predicting space weather effects, particularly since these interactions can lead to rapid changes in radiation belt configurations, posing risks to satellites and other space-based technologies (Baker et al., 2004; Horne et al., 2005). The 2003 Halloween storm provided a clear example of how enhanced EMIC wave activity correlated with significant radiation belt electron flux decreases, highlighting the importance of including these waves in predictive models (Turner et al., 2012).\nGaps in Current Understanding:\nDespite significant advances, there remain substantial gaps in our understanding of the conditions under which EMIC waves are most effective at causing electron losses and what roles other concurrent processes (e.g., whistler-mode chorus waves and plasma sheet injections) play in modifying these interactions. The proposed study aims to bridge these gaps by combining observational data analysis with theoretical modeling efforts.\nThis enriched background sets a solid foundation for investigating the interactions of EMIC waves with radiation belt electrons and underscores the importance of this research in advancing our understanding of magnetospheric physics and improving our ability to forecast space weather impacts effectively."
  },
  {
    "objectID": "docs/blog/phd/2024_pre/proposal_EMIC.html#proposed-data-and-detailed-analysis-approach",
    "href": "docs/blog/phd/2024_pre/proposal_EMIC.html#proposed-data-and-detailed-analysis-approach",
    "title": "Dynamics of EMIC Waves and Their Influence on Radiation Belt Electron Fluxes",
    "section": "Proposed Data and Detailed Analysis Approach",
    "text": "Proposed Data and Detailed Analysis Approach\nData Acquisition and Sources:\n\nELFIN CubeSat: Employ low-altitude measurements from the ELFIN CubeSat to quantify the effects of EMIC waves on electron precipitation. ELFIN’s unique orbital characteristics allow it to measure loss cone distributions and provide a direct measure of wave-driven electron losses, enhancing our understanding of wave-particle interaction dynamics in the radiation belts.\nVan Allen Probes: Utilize extensive datasets from the Van Allen Probes, which include electric and magnetic field measurements, plasma wave spectra, and particle detection (electron and ion fluxes) across different energy ranges. These data are essential for directly observing EMIC waves and assessing their interactions with radiation belt electrons during different geomagnetic conditions.\nERG (Arase) Satellite: Draw upon high-resolution data from the ERG satellite, which offers crucial insights into the inner magnetosphere’s dynamics. ERG’s suite of instruments provides critical measurements of electron density, electric fields, and magnetic fields that help identify the conditions conducive to EMIC wave generation and propagation.\nMagnetospheric Multiscale (MMS) Mission: Analyze high-resolution data from the MMS mission, which is key for understanding the microphysics of wave-particle interactions, especially during short-duration events and smaller spatial scales that are not resolved by other satellites.\n\n\n\n\n(top) An overview of the mission orbits recorded on April 17, 2021, from 00:00 to 12:00 UTC. The orbits of the various missions are projected onto the MLT and \\(L\\)-shell plane, using Tsyganenko 2001 model. (bottom) Sym-H and SME indices during this event.\n\n\nAnalytical Methods:\n\nWave-Particle Interaction Analysis: Use phase space density calculations and quasi-linear theory to analyze how EMIC waves scatter radiation belt electrons into the loss cone, leading to precipitation. This method helps in quantifying the diffusion coefficients which are critical for understanding the rate and extent of electron flux changes.\nEvent Selection and Case Studies: Identify specific events during which intense EMIC wave activity coincides with significant changes in electron fluxes. These events will be used as case studies to analyze the interaction mechanisms in detail, employing cross-spectral analysis to examine the coherence between EMIC waves and electron flux oscillations.\n\nSimulation and Modeling:\n\nDiffusion Model Enhancement: Integrate the latest empirical models of EMIC wave properties into existing radiation belt simulation frameworks. This will involve updating the wave spectral characteristics and amplitudes based on observed data, thus refining the models used to predict electron dynamics under various space weather conditions.\nNumerical Simulations: Conduct particle-in-cell and test particle simulations to model the interactions of electrons with EMIC waves, validating the theoretical predictions with observational data. This approach provides a dynamic simulation environment where theoretical assumptions can be rigorously tested against real-world data.\nModel Validation and Iterative Refinement: Employ a systematic approach to compare simulated results with satellite observations. This iterative process of validation and refinement is essential to improve the reliability and accuracy of predictive models, ensuring they are robust under a wide range of space weather scenarios.\n\nResearch Questions Addressed:\n\nMechanism Elucidation: How exactly do EMIC waves influence electron pitch angles and energies, and under what specific conditions do these interactions lead to net electron losses or gains?\nModeling Improvements: Can the integration of enhanced EMIC wave models into simulation frameworks improve the accuracy of forecasts regarding electron dynamics in the radiation belts?\nPredictive Capabilities: How effectively can the refined models predict changes in electron fluxes during geomagnetic storms, and what improvements are necessary to achieve better predictive reliability?\n\nBy addressing these questions through a detailed analytical and simulation-based approach, the proposed research aims to significantly advance our understanding of EMIC waves’ role in radiation belt dynamics."
  },
  {
    "objectID": "docs/blog/phd/2024_pre/proposal_EMIC.html#expected-contributions",
    "href": "docs/blog/phd/2024_pre/proposal_EMIC.html#expected-contributions",
    "title": "Relative role of EMIC waves, chorus waves, and electron injections on relativistic electron flux",
    "section": "Expected Contributions",
    "text": "Expected Contributions\nThis project aims to quantify the impact of EMIC waves on the electron energy spectrum, previously thought to be shaped mainly by plasma injections and whistler-mode waves. Using data from satellite missions like ELFIN, Van Allen Probes, and ERG (Arase), we will examine how EMIC waves alter electron fluxes during storms, particularly alongside whistler-mode waves. By analyzing case studies and applying diffusion coefficients, we aim to assess how EMIC waves influence electron pitch angles and precipitation. Ultimately, this study seeks to compare the effects of EMIC and whistler-mode waves to determine when EMIC waves dominate electron loss processes."
  },
  {
    "objectID": "docs/blog/phd/2024_pre/proposal_EMIC.html#discussion-and-future-work",
    "href": "docs/blog/phd/2024_pre/proposal_EMIC.html#discussion-and-future-work",
    "title": "Dynamics of EMIC Waves and Their Influence on Radiation Belt Electron Fluxes",
    "section": "Discussion and Future Work",
    "text": "Discussion and Future Work\nThe findings from this research will deepen our understanding of magnetospheric physics, particularly the role of EMIC waves in electron dynamics. However, several questions are likely to emerge from this study, guiding future research efforts:\n\nWave Source Regions and Propagation: Further investigations may be required to identify the specific source regions of EMIC waves and their propagation characteristics through the magnetosphere. Understanding these aspects could enhance predictions of when and where EMIC waves will impact electron populations.\nInteractions with Other Wave Modes: While this project focuses on EMIC waves, the magnetosphere contains multiple interacting wave modes. Future work could explore the interactions between EMIC waves and other wave types, such as ULF and VLF waves, to provide a more holistic view of the dynamics governing radiation belt electron fluxes.\nTechnological Applications: The development of real-time monitoring tools based on the findings from this research could be explored. These tools would use satellite data to provide immediate assessments of EMIC wave activity and its potential impacts, offering valuable information for satellite operators and space weather forecasters."
  },
  {
    "objectID": "docs/blog/phd/2024_pre/proposal_EMIC.html#summary",
    "href": "docs/blog/phd/2024_pre/proposal_EMIC.html#summary",
    "title": "Dynamics of EMIC Waves and Their Influence on Radiation Belt Electron Fluxes",
    "section": "Summary",
    "text": "Summary\nThe proposed research is designed to tackle some of the most pressing questions in space physics regarding the impact of EMIC waves on radiation belt dynamics. Through a combination of detailed empirical analysis and advanced theoretical modeling, this project aims to provide significant insights and tools for predicting space weather, thereby contributing to our ability to safeguard and optimize the operation of space-based technologies."
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw02.html",
    "href": "docs/courses/epss263/homework/epss263_hw02.html",
    "title": "Homework 02",
    "section": "",
    "text": "Show the conservation of charge density \\(\\rho_c\\) (Eq. I.50), by integrating the Boltzmann equation.\n\nThe Boltzmann equation is given by\n\\[\n\\frac{\\partial f}{\\partial t} + \\mathbf{v} \\cdot \\nabla f + \\frac{q}{m} \\left( \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} \\right) \\cdot \\nabla_v f = \\left( \\frac{\\partial f}{\\partial t} \\right)_c\n\\]\nTake the zeroth charge-velocity moment of the Boltzmann equation, i.e., multiply by \\(e v^0 = e\\) and integrate over velocity space. The first term on the left-hand side becomes\n\\[\n\\int d^3v \\, e \\frac{\\partial f}{\\partial t} = \\frac{\\partial}{\\partial t} \\int d^3v \\, e f = \\frac{\\partial}{\\partial t} \\rho_c\n\\]\nThe second term on the left-hand side becomes\n\\[\n\\int d^3v \\, e \\mathbf{v} \\cdot \\nabla f = \\nabla \\cdot \\int d^3v \\, e \\mathbf{v} f = \\nabla \\cdot \\mathbf{j}_c\n\\]\nThe third term on the left-hand side becomes\n\\[\n\\int d^3v \\, e \\frac{q}{m} \\left( \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} \\right) \\cdot \\nabla_v f = \\frac{q}{m} \\int d^3v \\, e \\left( \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} \\right) \\cdot \\nabla_v f\n= \\frac{e q}{m} \\int d^3v \\nabla_v \\cdot [\\left( \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} \\right) f] - \\frac{e q}{m} \\int d^3v \\nabla_v \\cdot \\left( \\mathbf{v} \\times \\mathbf{B} \\right) f\n\\]\nThe first term on the right-hand side becomes a surface integral over the velocity space, which vanishes because the distribution function \\(f\\) goes to zero at infinity. The second term on the right-hand side is zero because \\(\\mathbf{v} \\times \\mathbf{B}\\) is always perpendicular to \\(\\mathbf{v}\\), so the dot product is zero. Therefore, the third term on the left-hand side is zero.\nThe right-hand side of the Boltzmann equation is zero because the collision operator conserves charge density. Therefore, the zeroth charge-velocity moment of the Boltzmann equation is\n\\[\n\\frac{\\partial}{\\partial t} \\rho_c + \\nabla \\cdot \\mathbf{j}_c = 0\n\\]",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 02"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/index.html",
    "href": "docs/courses/epss263/homework/index.html",
    "title": "Homework",
    "section": "",
    "text": "Homework 02\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nHomework 03\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nHomework 04\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nHomework 05\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nHomework 06\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNo matching items",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw02.html#collision-time-scale",
    "href": "docs/courses/epss263/homework/epss263_hw02.html#collision-time-scale",
    "title": "Homework 02",
    "section": "Collision time scale",
    "text": "Collision time scale\n\n\nShow that the collision time scale \\(\\tau\\) is indeed large enough, such that R1 is indeed large for the plasma region envisioned in the book. To compute \\(\\tau =1/\\nu_{ei}\\), obtain the numerical value of the collision frequency for that region by using tabulated values of the Coulomb logarithm \\(\\lambda\\) in the NRL formulary (here, p. 34, item (b)) and the equation for \\(\\nu_{ei}=\\nu_e \\text{~} \\nu_i\\) for the weak collision rate case (strong field case, here, p. 36).\n\n\nThe Lorentz collision frequency is given by\n\\[\n\\nu = n \\sigma v \\ln \\Lambda\n\\]\nwhere \\(n\\) is the particle number density, \\(\\sigma\\) is the collisional cross-section, \\(v\\) is the mean thermal velocity between particle species, and \\(\\ln \\Lambda\\) is the Coulomb logarithm accounting for small angle collisions.\nUsing typical parameters for space science, we can calculate the collision time scale \\(\\tau = 1/\\nu_{ei} = 3 \\cdot 10^4 \\text{s}\\), which is indeed large enough.\n\n\nCode\nimport plasmapy.formulary as plf\nimport astropy.units as u\n\nn = 1e7 * u.m**-3\nT = 1e5 * u.K\nv_drift = 100 * u.km / u.s\n\n\ndef tau(n, T, V):\n    # assuming temperature and denisty is the same for both species\n    n_ion = n_e = n\n    T_ion = T_e = T\n    \n    Coulomb_log = plf.Coulomb_logarithm(T, n_e, (\"e-\", \"p+\")) * u.dimensionless_unscaled\n    \n    electron_ion_collisions = plf.MaxwellianCollisionFrequencies(\n        \"e-\",\n        \"p+\",\n        v_drift = V,\n        n_a=n_e,\n        T_a=T_e,\n        n_b=n_ion,\n        T_b=T_ion,\n        Coulomb_log=Coulomb_log,\n    )\n\n    nu_ei = electron_ion_collisions.Maxwellian_avg_ei_collision_freq\n    return (1  / nu_ei).to(u.s)\n\ntau(n=n, T=T, V=v_drift)\n\n\n\\(34654.032 \\; \\mathrm{s}\\)",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 02"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw02.html#dimensionless-ratios",
    "href": "docs/courses/epss263/homework/epss263_hw02.html#dimensionless-ratios",
    "title": "Homework 02",
    "section": "Dimensionless ratios",
    "text": "Dimensionless ratios\n\n\nObtain the ratios R1-R4 for typical parameters in another plasma region, the near-Earth magnetotail plasma sheet (but outside the reconnection electron diffusion region). Is the Hall term significant now? Derive the ratio of the electron inertia to the Hall term (ratio R4/R3) by scaling analysis – under what conditions is it significant in this environment?\n\n\nGiven the following parameters\n\\[\n\\begin{aligned}\n& R_1 \\equiv \\frac{V B}{n J}=\\frac{V B}{\\frac{m_e}{e^2 n \\tau}} \\frac{B}{\\mu_0 L}=n V L \\tau \\frac{\\mu_0 e^2}{m_e} \\\\\n& R_2 \\equiv \\frac{V B}{\\frac{1}{n e} \\frac{P_e}{L}}=\\frac{V B}{\\frac{k}{n e} \\frac{n T}{L}}=\\frac{e}{k} \\frac{V B L}{T} \\\\\n& R_3 \\equiv \\frac{V B}{\\frac{1}{\\text { en }} \\frac{B^2}{\\mu_0 L}}=\\frac{V L n}{B} \\mathrm{e} \\mu_0 \\\\\n& R_4 \\equiv \\frac{V B}{\\frac{m_e}{e^2 n} \\frac{J}{T}}=L^2 n \\frac{\\mu_o e^2}{m_e} \\\\\n&\n\\end{aligned}\n\\]\nUsing the parameters from (Borovsky et al. 2020), and assuming the spatial scale of the magnetotail plasma sheet is about earth radius, i.e., \\(L \\sim 10^7 m\\), we have the ratios calculated as shown below Table 1. The Hall term is now become comparable to the “v cross B” term with \\(R_3 \\sim 10\\). This term will be more significant when the spatial scale is smaller (for example, near the reconnection region).\nThe ratio of the electron inertia to the Hall term is given by\n\\[\nR_4/R_3 = \\frac{L * B}{V} * \\frac{e}{m_e}\n\\]\nSince \\(R_4\\) is proportional to \\(L^2\\), and \\(R_3\\) is proportional to \\(L\\), the ratio \\(R_4/R_3\\) is proportional to \\(L\\). Therefore, the electron inertia term is more significant when the spatial scale is smaller. It is also more significant when the magnetic field is weaker, or the velocity is larger.\n\n\nCode\nfrom astropy.constants.si import mu0, e, m_e, k_B\nimport astropy.units as u\nfrom astropy.table import QTable\nimport pandas as pd\n\ndef R1(\n    n: float, #: number density\n    V: float, #: velocity\n    L: float, #: length\n    τ: float, #: collision time\n):\n    \"\"\"\n    Ratio of the \"v cross B\" term over the ohmic resistive term\n    \"\"\"\n    const = mu0 * e**2 / m_e\n    return (n * V * L * τ * const).to(u.dimensionless_unscaled)\n\ndef R2(\n    V: float, #: velocity\n    B: float, #: magnetic field\n    L: float, #: length\n    T: float #: temperature\n):\n    \"\"\"\n    Ratio of the \"v cross B\" term over the ampipolar electric field term\n    \"\"\"\n    const = e / k_B\n    return (V * B * L / T * const).to(u.dimensionless_unscaled)\n\ndef R3(\n    V: float, #: velocity\n    B: float, #: magnetic field\n    n: float, #: number density\n    L: float #: length\n):\n    \"\"\"\n    Ratio of the \"v cross B\" term over the Hall term\n    \"\"\"\n    const = e * mu0\n    return (V * L * n / B * const).to(u.dimensionless_unscaled)\n\ndef R4(\n    L: float, #: length\n    n: float, #: number density\n):\n    \"\"\"\n    Ratio of the \"v cross B\" term over the electron inertia term\n    \"\"\"\n    const = mu0 * e**2 / m_e\n    return (L**2 * n * const).to(u.dimensionless_unscaled)\n\ndef R4overR3(\n    V: float, #: velocity\n    B: float, #: magnetic field\n    n: float, #: number density\n    L: float #: length\n):\n    \"\"\"\n    Ratio of the electron inertia term to the Hall term\n    \"\"\"\n    return R4(L=L, n=n) / R3(V=V, B=B, n=n, L=L)\n\n\nimport plasmapy.formulary as plf\n# using the parameters from [@borovskyOutstandingQuestionsMagnetospheric2020]\n\nsolar_wind = dict(\n    name = \"solar wind\",\n    n = 1e7 * u.m**-3,\n    V = 1e5 * u.m / u.s,\n    L = 1e6 * u.m,\n    T = 1e5 * u.K,\n    B = 1e-8 * u.T\n)\n\nmagnetotail = dict(\n    name = \"ion plasma sheet\",\n    n = 5e5 * u.m**-3,\n    V = 1e5 * u.m / u.s,\n    L = 1e7 * u.m,\n    T = (1e3 * u.eV).to(u.K, equivalencies=u.temperature_energy()),\n    B = 1e-8 * u.T\n)\n\nfor d in [solar_wind, magnetotail]:\n    d[\"τ\"] = tau(n=d[\"n\"], T=d[\"T\"], V=d[\"V\"])\n    d[\"R1\"] = R1(n=d[\"n\"], V=d[\"V\"], L=d[\"L\"], τ=d[\"τ\"])\n    d[\"R2\"] = R2(V=d[\"V\"], B=d[\"B\"], L=d[\"L\"], T=d[\"T\"])\n    d[\"R3\"] = R3(V=d[\"V\"], B=d[\"B\"], n=d[\"n\"], L=d[\"L\"])\n    d[\"R4\"] = R4(L=d[\"L\"], n=d[\"n\"])\n\ndf = QTable([solar_wind, magnetotail])\n\nfor col in df.colnames[1:]:\n    df[col].info.format = \".1E\"\ndf\n\n\n\n\nCode\nfrom great_tables import GT\nGT(df.to_pandas()).fmt_scientific(\n    columns = df.colnames[1:], decimals=1\n).cols_label(\n    n = \"Number Density (m^-3)\",\n    V = \"Velocity (m/s)\",\n    L = \"Length (m)\",\n    T = \"Temperature (K)\",\n    τ = \"Collision Time (s)\",\n    B = \"Magnetic Field (T)\"\n).tab_spanner(\n    label=\"Plasma Parameters\",\n    columns=[\"n\", \"V\", \"L\", \"T\", \"B\", \"τ\"]\n)\n\n\n\n\nTable 1: Ratios of the terms in Ohm’s law\n\n\n\n\n\n\n\n\n\n\nname\nPlasma Parameters\nR1\nR2\nR3\nR4\n\n\nNumber Density (m^-3)\nVelocity (m/s)\nLength (m)\nTemperature (K)\nMagnetic Field (T)\nCollision Time (s)\n\n\n\n\nsolar wind\n1.0 × 107\n1.0 × 105\n1.0 × 106\n1.0 × 105\n1.0 × 10−8\n3.5 × 104\n1.2 × 109\n1.2 × 102\n2.0 × 101\n3.5 × 105\n\n\nion plasma sheet\n5.0 × 105\n1.0 × 105\n1.0 × 107\n1.2 × 107\n1.0 × 10−8\n6.7 × 108\n1.2 × 1013\n1.0 × 101\n1.0 × 101\n1.8 × 106",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 02"
    ]
  },
  {
    "objectID": "docs/blog/phd/2024_pre/proposal_EMIC.html#analytical-methods",
    "href": "docs/blog/phd/2024_pre/proposal_EMIC.html#analytical-methods",
    "title": "Dynamics of EMIC Waves and Their Influence on Radiation Belt Electron Fluxes",
    "section": "Analytical Methods",
    "text": "Analytical Methods\n\nWave-Particle Interaction Analysis: Use phase space density calculations and quasi-linear theory to analyze how EMIC waves scatter radiation belt electrons into the loss cone, leading to precipitation. This method helps in quantifying the diffusion coefficients which are critical for understanding the rate and extent of electron flux changes.\nEvent Selection and Case Studies: Identify specific events during which intense EMIC wave activity coincides with significant changes in electron fluxes. These events will be used as case studies to analyze the interaction mechanisms in detail, employing cross-spectral analysis to examine the coherence between EMIC waves and electron flux oscillations."
  },
  {
    "objectID": "docs/blog/phd/2024_pre/proposal_EMIC.html#simulation-and-modeling",
    "href": "docs/blog/phd/2024_pre/proposal_EMIC.html#simulation-and-modeling",
    "title": "Dynamics of EMIC Waves and Their Influence on Radiation Belt Electron Fluxes",
    "section": "Simulation and Modeling",
    "text": "Simulation and Modeling\n\nDiffusion Model Enhancement: Integrate the latest empirical models of EMIC wave properties into existing radiation belt simulation frameworks. This will involve updating the wave spectral characteristics and amplitudes based on observed data, thus refining the models used to predict electron dynamics under various space weather conditions.\n\n\n\nModel Validation and Iterative Refinement: Employ a systematic approach to compare simulated results with satellite observations. This iterative process of validation and refinement is essential to improve the reliability and accuracy of predictive models, ensuring they are robust under a wide range of space weather scenarios."
  },
  {
    "objectID": "docs/blog/phd/2024_pre/proposal_EMIC.html#research-questions-addressed",
    "href": "docs/blog/phd/2024_pre/proposal_EMIC.html#research-questions-addressed",
    "title": "Dynamics of EMIC Waves and Their Influence on Radiation Belt Electron Fluxes",
    "section": "Research Questions Addressed",
    "text": "Research Questions Addressed\n\nMechanism Elucidation: How exactly do these waves together influence electron pitch angles and energies, and under what specific conditions do these interactions lead to net electron losses or gains?\nModeling Improvements: Can the integration of enhanced EMIC wave models into simulation frameworks improve the accuracy of forecasts regarding electron dynamics in the radiation belts?\n\n\nBy addressing these questions through a detailed analytical and simulation-based approach, the proposed research aims to significantly advance our understanding of EMIC waves’ role in radiation belt dynamics."
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw04.html",
    "href": "docs/courses/epss263/homework/epss263_hw04.html",
    "title": "Homework 04",
    "section": "",
    "text": "Derive analytically the group velocities for the Intermediate, Fast, and Slow wave.\n\nThe dispersion relation of fast and slow magnetosonic waves is\n\\[\n\\omega^2=\\frac{k^2}{2}\\left[c_m^2 \\pm \\sqrt{c_m^4-4 c_s^2 c_a^2 k_z^2 / k^2}\\right] = \\frac{k^2}{2}\\left[c_m^2 \\pm c_n^2\\right]\n\\tag{1}\\]\nwhere “+” corresponds to fast mode and “-” corresponds to slow mode. And we have defined\n\\[\nc_n^2=\\sqrt{c_m^4-4 c_s^2 c_a^2 \\cos ^2 \\theta}\n\\]\nThus the phase velocities of the two modes are\n\\[\nV_{p,(f,s)}=\\frac{1}{\\sqrt{2}}\\left[c_m^2 \\pm c_n^2\\right]^{1 / 2} \\hat{e}_k\n\\]\nTaking derivatives with respect to \\(k_x\\) and \\(k_z\\) for Equation 1, we have\n\\[\n\\begin{aligned}\n2 ω ∂_{k_x} ω = k_x (c_m^2 ± c_n^2) ± 1/2 k^2 ∂_{k_x} c_n^2\n\\\\\n2 ω ∂_{k_z} ω = k_z (c_m^2 ± c_n^2) ± 1/2 k^2 ∂_{k_z} c_n^2\n\\end{aligned}\n\\]\nBecause \\(k^2 = k_x^2 + k_z^2\\), we have\n\\[\n\\begin{aligned}\n∂_{k_x} c_n^2 &= \\frac{4 c_a^2 c_s^2 k_z^2 k_x}{k^4 \\sqrt{c_m^4 - 4 c_s^2 c_a^2 k_z^2 / k^2}}\n\\\\\n∂_{k_z} c_n^2 &= - \\frac{4 c_a^2 c_s^2 k_z k_x^2}{k^3 c_n^2} = - \\frac{4 c_a^2 c_s^2 \\sin θ \\cos θ^2}{c_n^2}\n\\end{aligned}\n\\]\n\\[\n\\begin{aligned}\nω ∂_{k_x} ω\n&= \\frac{k_x}{2} (c_m^2 ± c_n^2) ± 1/4 k^2 ∂_{k_x} c_n^2 \\\\\n&= \\frac{k_x}{2} (c_m^2 ± c_n^2) ± 1/4 \\frac{4 c_a^2 c_s^2 k_z^2 k_x}{k^2 \\sqrt{c_m^4 - 4 c_s^2 c_a^2 k_z^2 / k^2}} \\\\\n&= k \\sin θ V_p^2 ± \\frac{c_a^2 c_s^2 \\cos^2 θ \\sin θ k }{c_n^2}\n\\\\\nω ∂_{k_z} ω\n&= \\frac{k_z}{2} (c_m^2 ± c_n^2) ± 1/4 k^2 ∂_{k_z} c_n^2 \\\\\n&=  k \\cos θ V_p^2 \\mp \\frac{c_a^2 c_s^2 \\sin θ^2 \\cos θ k}{c_n^2}\n\\end{aligned}\n\\]\nSo\n\\[\n\\begin{aligned}\nV_{g,x} = ∂_{k_x} ω = V_p \\sin θ (1 ± \\frac{c_a^2 c_s^2 \\cos^2 θ}{V_{p}^2 c_n^2})\n\\\\\nV_{g,z} = ∂_{k_z} ω = V_p \\cos θ (1 ∓ \\frac{c_a^2 c_s^2 \\sin^2 θ}{V_{p}^2 c_n^2})\n\\end{aligned}\n\\]",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 04"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw04.html#phase-velocity-and-the-group-velocity-polar-plots",
    "href": "docs/courses/epss263/homework/epss263_hw04.html#phase-velocity-and-the-group-velocity-polar-plots",
    "title": "Homework 04",
    "section": "Phase velocity and the group velocity polar plots",
    "text": "Phase velocity and the group velocity polar plots\n\nPlot the phase velocity and the group velocity polar plots for \\(C_S= 0.25 C_A\\) and \\(C_S= 4 C_A\\).\n\nHere we plot velocity type (group or phase) for different wave types (fast, slow, intermediate) for different ratios of \\(C_S/C_A\\).\n\n\n\nVelocity comparison of different wave types for different ratios of \\(C_S/C_A\\) and velocity types\n\n\n\n\n\nVelocity comparison of group and phase velocities for different wave types abd ratios\n\n\n\n\n\nVelocity change over ratio for different wave types and velocity types.\n\n\n\"\"\"\nCalculates the phase velocities and group velocities for fast and slow waves.\n\"\"\"\nfunction calc_VpVg_fastandslow(cs, ca, θ)\n    cm = sqrt(cs^2 + ca^2) #: magnetosonic speed\n    cm2 = cs^2 + ca^2\n    cn2 = @. sqrt(cm^4 - 4 * cs^2 * ca^2 * cos(θ)^2)\n\n    Vpi = @. ca * abs(cos(θ))\n    Vps = sqrt.(0.5 * (cm2 .- cn2))\n    Vpf = sqrt.(0.5 * (cm2 .+ cn2))\n\n    Vpi_para = @. Vpi * cos(θ)\n    Vpi_perp = @. Vpi * sin(θ)\n\n    Vps_para = @. Vps * cos(θ)\n    Vps_perp = @. Vps * sin(θ)\n\n    Vpf_para = @. Vpf * cos(θ)\n    Vpf_perp = @. Vpf * sin(θ)\n\n    Vgs_perp = @. Vps * sin(θ) * (1 - cs^2 * ca^2 / Vps^2 / cn2 * cos(θ)^2)\n    Vgs_para = @. Vps * cos(θ) * (1 + cs^2 * ca^2 / Vps^2 / cn2 * sin(θ)^2)\n\n    Vgf_perp = @. Vpf * sin(θ) * (1 + cs^2 * ca^2 / Vpf^2 / cn2 * cos(θ)^2)\n    Vgf_para = @. Vpf * cos(θ) * (1 - cs^2 * ca^2 / Vpf^2 / cn2 * sin(θ)^2)\n\n    intermediate_wave_p = (\n        wave = \"Intermediate Waves\",\n        type=  \"phase velocity\",\n        v_parp = Vpi_para,\n        v_perp = Vpi_perp\n    )\n\n    intermediate_wave_g = (\n        wave = \"Intermediate Waves\",\n        type=  \"group velocity\",\n        v_parp = ca,\n        v_perp = 0\n    )\n\n    fast_wave_p = (\n        wave = \"Fast Waves\",\n        type=  \"phase velocity\",\n        v_parp = Vpf_para,\n        v_perp = Vpf_perp\n    )\n\n    fast_wave_g = (\n        wave = \"Fast Waves\",\n        type=  \"group velocity\",\n        v_parp = Vgf_para,\n        v_perp = Vgf_perp\n    )\n\n    slow_wave_p = (\n        wave = \"Slow Waves\",\n        type=  \"phase velocity\",\n        v_parp = Vps_para,\n        v_perp = Vps_perp\n    )\n\n    slow_wave_g = (\n        wave = \"Slow Waves\",\n        type=  \"group velocity\",\n        v_parp = Vgs_para,\n        v_perp = Vgs_perp\n    )\n\n    return (\n        fast_wave_g, fast_wave_p,\n        slow_wave_g, slow_wave_p,\n        intermediate_wave_p, intermediate_wave_g\n    )\nend",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 04"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw04.code.html",
    "href": "docs/courses/epss263/homework/epss263_hw04.code.html",
    "title": "Homework 04",
    "section": "",
    "text": "Plot the phase velocity and the group velocity polar plots for \\(C_S= 0.25 C_A\\) and \\(C_S= 4 C_A\\).\n\n\n\nCode\ninclude(\"main.jl\")\nusing AlgebraOfGraphics\nusing CairoMakie\nusing beforerr\n\n\n\n\nCode\ndfs = [0.8, 1, 1.25] .|&gt; VpVg_fastandslow_df\ndf = vcat(dfs...);\n\n\n\n\nCode\naxis = (width = 225, height = 225)\n\nbase_map = data(df) * mapping(\n    :v_parp =&gt; L\"V_{\\parallel}\",\n    :v_perp =&gt; L\"V_{\\perp}\",\n) * visual(Scatter, markersize = 3);\n\n\n\n\nCode\nplt=  base_map * mapping(color=:wave, marker=:wave, row=:cs=&gt;nonnumeric, col=:type)\ndraw(plt,axis=axis)\neasy_save(\"mhd_waves_1\")\n\n\n┌ Info: Saved /Users/zijin/projects/beforerr/docs/courses/epss263/homework/figures/mhd_waves_1.png\n└ @ beforerr /Users/zijin/.julia/dev/beforerr.jl/src/utils/makie.jl:34\n\n\n\n\n\n\n\nCode\nplt = base_map * mapping(col=:wave,row=:cs=&gt;nonnumeric,color=:type)\nfg = draw(plt, axis=axis)\nsave(\"mhd_waves_2.png\", fg)\nfg\n\n\n\n\n\n\n\nCode\nplt = base_map * mapping(color=:wave, marker=:type, markersize=:type, col=:cs=&gt;nonnumeric)\nfg = draw(plt, axis=axis)\nsave(\"mhd_waves_4.png\", fg)\nfg\n\n\n\n\n\n\n\nCode\nplt = base_map * mapping(row=:wave,color=:cs=&gt;nonnumeric,col=:type)\nfg = draw(plt, axis=axis)\nsave(\"mhd_waves_3.png\", fg)\nfg",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 04"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw04.code.html#phase-velocity-and-the-group-velocity-polar-plots",
    "href": "docs/courses/epss263/homework/epss263_hw04.code.html#phase-velocity-and-the-group-velocity-polar-plots",
    "title": "Homework 04",
    "section": "",
    "text": "Plot the phase velocity and the group velocity polar plots for \\(C_S= 0.25 C_A\\) and \\(C_S= 4 C_A\\).\n\n\n\nCode\ninclude(\"main.jl\")\nusing AlgebraOfGraphics\nusing CairoMakie\nusing beforerr\n\n\n\n\nCode\ndfs = [0.8, 1, 1.25] .|&gt; VpVg_fastandslow_df\ndf = vcat(dfs...);\n\n\n\n\nCode\naxis = (width = 225, height = 225)\n\nbase_map = data(df) * mapping(\n    :v_parp =&gt; L\"V_{\\parallel}\",\n    :v_perp =&gt; L\"V_{\\perp}\",\n) * visual(Scatter, markersize = 3);\n\n\n\n\nCode\nplt=  base_map * mapping(color=:wave, marker=:wave, row=:cs=&gt;nonnumeric, col=:type)\ndraw(plt,axis=axis)\neasy_save(\"mhd_waves_1\")\n\n\n┌ Info: Saved /Users/zijin/projects/beforerr/docs/courses/epss263/homework/figures/mhd_waves_1.png\n└ @ beforerr /Users/zijin/.julia/dev/beforerr.jl/src/utils/makie.jl:34\n\n\n\n\n\n\n\nCode\nplt = base_map * mapping(col=:wave,row=:cs=&gt;nonnumeric,color=:type)\nfg = draw(plt, axis=axis)\nsave(\"mhd_waves_2.png\", fg)\nfg\n\n\n\n\n\n\n\nCode\nplt = base_map * mapping(color=:wave, marker=:type, markersize=:type, col=:cs=&gt;nonnumeric)\nfg = draw(plt, axis=axis)\nsave(\"mhd_waves_4.png\", fg)\nfg\n\n\n\n\n\n\n\nCode\nplt = base_map * mapping(row=:wave,color=:cs=&gt;nonnumeric,col=:type)\nfg = draw(plt, axis=axis)\nsave(\"mhd_waves_3.png\", fg)\nfg",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 04"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw04.py.html",
    "href": "docs/courses/epss263/homework/epss263_hw04.py.html",
    "title": "",
    "section": "",
    "text": "CoursesEPSS M263HomeworkEpss263 Hw04.py CodeShow All CodeHide All Code\n\n\n\n\n\n\nCode\nfrom numpy import cos, sin, sqrt\n\n\n\n\nCode\ndef calc_VpVg_fastandslow(cs, ca, theta):\n    \"\"\"Calculates the phase velocities and group velocities for fast and slow waves.\n    \"\"\"\n    cos_angle = cos(theta)\n    sin_angle = sin(theta)\n\n    cm = sqrt(cs**2 + ca**2)\n\n    cn4 = cm**4 - 4 * cs**2 * ca**2 * cos_angle**2\n    cn2 = sqrt(cn4)\n\n    tmp2 = cm**2 - cn2\n\n    Cp_slow = sqrt(0.5 * (tmp2))\n    Cp_fast = sqrt(0.5 * (cm**2 + cn2))\n\n    Cg_slow_perp = (\n        sin_angle * Cp_slow * (1 - cs**2 * ca**2 / Cp_slow**2 / cn2 * cos_angle**2)\n    )\n    Cg_slow_para = (\n        cos_angle * Cp_slow * (1 + cs**2 * ca**2 / Cp_slow**2 / cn2 * sin_angle**2)\n    )\n\n    Cg_fast_perp = (\n        sin_angle * Cp_fast * (1 + cs**2 * ca**2 / Cp_fast**2 / cn2 * cos_angle**2)\n    )\n    Cg_fast_para = (\n        cos_angle * Cp_fast * (1 - cs**2 * ca**2 / Cp_fast**2 / cn2 * sin_angle**2)\n    )\n\n    return {\n        \"Vps\": Cp_slow,\n        \"Vpf\": Cp_fast,\n        \"Vgs_perp\": Cg_slow_perp,\n        \"Vgs_para\": Cg_slow_para,\n        \"Vgf_perp\": Cg_fast_perp,\n        \"Vgf_para\": Cg_fast_para,\n    }\n\n\n\n\nCode\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ncs = 0.8\nca = 1.0\ncm = np.sqrt(cs**2 + ca**2)\n\nangle_kb = np.arange(1,360,1) * np.pi/180\n   \nresult = calc_VpVg_fastandslow(cs,ca,angle_kb)\nCp_slow = result['Vps']\nCp_fast = result['Vpf']\nCg_slow_perp = result['Vgs_perp']\nCg_slow_para = result['Vgs_para']\nCg_fast_perp = result['Vgf_perp']\nCg_fast_para = result['Vgf_para']\n\n\n/var/folders/tg/rfd0nr_970s3mv1fspgvkkxm0000gn/T/ipykernel_22523/3788757295.py:18: RuntimeWarning: divide by zero encountered in divide\n  sin_angle * Cp_slow * (1 - cs**2 * ca**2 / Cp_slow**2 / cn2 * cos_angle**2)\n/var/folders/tg/rfd0nr_970s3mv1fspgvkkxm0000gn/T/ipykernel_22523/3788757295.py:18: RuntimeWarning: invalid value encountered in multiply\n  sin_angle * Cp_slow * (1 - cs**2 * ca**2 / Cp_slow**2 / cn2 * cos_angle**2)\n/var/folders/tg/rfd0nr_970s3mv1fspgvkkxm0000gn/T/ipykernel_22523/3788757295.py:21: RuntimeWarning: divide by zero encountered in divide\n  cos_angle * Cp_slow * (1 + cs**2 * ca**2 / Cp_slow**2 / cn2 * sin_angle**2)\n/var/folders/tg/rfd0nr_970s3mv1fspgvkkxm0000gn/T/ipykernel_22523/3788757295.py:21: RuntimeWarning: invalid value encountered in multiply\n  cos_angle * Cp_slow * (1 + cs**2 * ca**2 / Cp_slow**2 / cn2 * sin_angle**2)\n\n\n\n\nCode\nfrom matplotlib import pyplot as plt\n# add a figure of equal x and y aspect ratio\nfig, ax = plt.subplots(figsize=(6,6))\n\n# plot phase speed of fast/slow \nax.plot(Cp_fast * np.cos(angle_kb), Cp_fast * np.sin(angle_kb), \n    ls='--',color='red',lw=0.75,label=r'$V_{p,f}$')\nax.plot(Cp_slow * np.cos(angle_kb), Cp_slow * np.sin(angle_kb), \n    ls=':',color='red',lw=0.75,label=r'$V_{p,s}$')\n\n# plot group velocity of fast/slow wind\nax.scatter(Cg_slow_para, Cg_slow_perp, marker='.', s=0.5,color='green',label=r'$V_{g,s}$')\nax.scatter(Cg_fast_para, Cg_fast_perp, marker='.', s=0.5,color='green',label=r'$V_{g,f}$')\n\nax.set_xlabel(r'$V_{\\parallel}$')\nax.set_ylabel(r'$V_{\\perp}$')\n\n\nText(0, 0.5, '$V_{\\\\perp}$')\n\n\n\n\n\n\n\n\n\n\n\nCode\nimport os\nos.makedirs('./group_velocity_angle', exist_ok=True)\n\n\n\n\nCode\ndef func_for_maximum_Vgsperp_costheta(h,cs = 0.5, ca = 1.0):\n    cs2 = cs*cs\n    ca2 = ca*ca \n    cm2 = cs2 + ca2 \n    cm4 = cm2 * cm2 \n    cn4 = cm4 - 4*cs2*ca2*h\n    if cn4&lt;0:\n        cn4 = 0\n    \n    cn2 = sqrt(cn4)\n    vp2 = 0.5 * (cm2 - cn2)\n\n    r = cs2 * ca2 / vp2 / cn2 \n\n    return r * (1-h) * (1-r*h) - (1-r*h) - 2 * (1-h)\\\n        *(r - h * r*r * ( 2 -  cm2 / cn2))\n\n\n\n\nCode\ntheta_max_Vgsperp\n\n\n0.2619881172665487\n\n\n\n\nCode\n# find the kB angle corresponding to maximum Vgsperp\nsol = root_scalar(func_for_maximum_Vgsperp_costheta, args=(cs,ca), bracket = [1e-3,1-1e-3], method='brentq')\n\nif sol.converged:\n    h = sol.root  # h = cos^2 theta\n    theta_max_Vgsperp = np.arccos(np.sqrt(h))\n\nfig = plt.figure(figsize=[8,8])\nsub = fig.add_subplot(111,aspect='equal')\n\n# plot phase speed of fast/slow \nsub.plot(Cp_fast * np.cos(angle_kb), Cp_fast * np.sin(angle_kb), \n    ls='--',color='red',lw=0.75,label=r'$V_{p,f}$')\nsub.plot(Cp_slow * np.cos(angle_kb), Cp_slow * np.sin(angle_kb), \n    ls=':',color='red',lw=0.75,label=r'$V_{p,s}$')\n\n# plot group velocity of fast/slow wind\nsub.scatter(Cg_slow_para, Cg_slow_perp, marker='.', s=0.5,color='green',label=r'$V_{g,s}$')\nsub.scatter(Cg_fast_para, Cg_fast_perp, marker='.', s=0.5,color='green',label=r'$V_{g,f}$')\n\n# draw a straight line connected to the instantaneous Cg\n# sub.plot([0,Cg_fast_para[i]],[0,Cg_fast_perp[i]],color='C1',ls=':')\n# sub.plot([0,Cg_slow_para[i]],[0,Cg_slow_perp[i]],color='C1',ls='--')\n\n# direction of k corresponding to the maximum value of Vgsperp\nsub.plot([0, np.cos(theta_max_Vgsperp)], [0, np.sin(theta_max_Vgsperp)], \n    color='red', ls='--')\n\nsub.legend(ncol=2)\n\nsub.set_title(r'$θ = {}^\\circ$'.format(int(theta_max_Vgsperp * 180 / np.pi)))\nsub.set_xlabel(r'$V_{\\parallel}$')\nsub.set_ylabel(r'$V_{\\perp}$')\n\nfig;\n\n\n\n\n\n\n\n\n\n\n\nCode\n# find the kB angle corresponding to maximum Vgsperp\nsol = root_scalar(func_for_maximum_Vgsperp_costheta, args=(cs,ca), bracket = [1e-3,1-1e-3], method='brentq')\nif sol.converged:\n    h = sol.root  # h = cos^2 theta\n    theta_max_Vgsperp = np.arccos(np.sqrt(h))\n\nfor i in range(len((angle_kb[0:2]))):\n    theta = angle_kb[i]\n\n    fig = plt.figure(figsize=[8,8])\n    sub = fig.add_subplot(111,aspect='equal')\n\n    # plot phase speed of fast/slow \n    sub.plot(Cp_fast * np.cos(angle_kb), Cp_fast * np.sin(angle_kb), \n        ls='--',color='red',lw=0.75,label=r'$V_{p,f}$')\n    sub.plot(Cp_slow * np.cos(angle_kb), Cp_slow * np.sin(angle_kb), \n        ls=':',color='red',lw=0.75,label=r'$V_{p,s}$')\n\n    # plot group velocity of fast/slow wind\n    sub.scatter(Cg_slow_para, Cg_slow_perp, marker='.', s=0.5,color='green',label=r'$V_{g,s}$')\n    sub.scatter(Cg_fast_para, Cg_fast_perp, marker='.', s=0.5,color='green',label=r'$V_{g,f}$')\n\n    sub.plot([0, k_radius * np.cos(theta)], [0, k_radius * np.sin(theta)], \n        ls='--', lw=0.5, color = 'k', label=r'$k$')\n\n\n    # draw a straight line connected to the instantaneous Cg\n    sub.plot([0,Cg_fast_para[i]],[0,Cg_fast_perp[i]],color='C1',ls=':')\n    sub.plot([0,Cg_slow_para[i]],[0,Cg_slow_perp[i]],color='C1',ls='--')\n\n    # # direction of k corresponding to the maximum value of Vgsperp\n    # sub.plot([0,k_radius * np.cos(theta_max_Vgsperp)], [0, k_radius * np.sin(theta_max_Vgsperp)], \n    #     color='red', ls='--')\n\n    sub.legend(ncol=2)\n\n    sub.set_title(r'angle&lt;k,B&gt; = {:03d}'.format(int(angle_kb[i] * 180 / np.pi)))\n    sub.set_xlabel(r'$V_{\\parallel}$')\n    sub.set_ylabel(r'$V_{\\perp}$')\n\n\n    sub.set_xlim([-1.2*cm,1.2*cm])\n    sub.set_ylim([-1.2*cm,1.2*cm])\n\n    # fig.savefig('./group_velocity_angle/anglekb_{:03d}.png'.\n    #     format(int(angle_kb[i] * 180 / np.pi)),dpi=300)\n    # plt.close(fig)",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Epss263 Hw04.py"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw04.html#dgroup-velocities-for-the-intermediate-fast-and-slow-wave",
    "href": "docs/courses/epss263/homework/epss263_hw04.html#dgroup-velocities-for-the-intermediate-fast-and-slow-wave",
    "title": "Homework 04",
    "section": "",
    "text": "Derive analytically the group velocities for the Intermediate, Fast, and Slow wave.\n\nThe dispersion relation of fast and slow magnetosonic waves is\n\\[\n\\omega^2=\\frac{k^2}{2}\\left[c_m^2 \\pm \\sqrt{c_m^4-4 c_s^2 c_a^2 k_z^2 / k^2}\\right] = \\frac{k^2}{2}\\left[c_m^2 \\pm c_n^2\\right]\n\\tag{1}\\]\nwhere “+” corresponds to fast mode and “-” corresponds to slow mode. And we have defined\n\\[\nc_n^2=\\sqrt{c_m^4-4 c_s^2 c_a^2 \\cos ^2 \\theta}\n\\]\nThus the phase velocities of the two modes are\n\\[\n\\boldsymbol{V}_{\\boldsymbol{p},(\\boldsymbol{f}, \\boldsymbol{s})}=\\frac{1}{\\sqrt{2}}\\left[c_m^2 \\pm c_n^2\\right]^{1 / 2} \\hat{e}_k\n\\]\nTaking derivatives with respect to \\(k_x\\) for Equation 1, we have\n\\[\nω \\partial_z ∂_z =\n\\]\nThe group velocity is a little bit complicated, but after taking derivatives of \\(\\omega\\) with respect to \\(k_x\\) and \\(k_z\\) respectively, we get \\[\n\\begin{aligned}\n& V_{g,(f, s), x}=V_{p,(f, s)} \\sin \\theta\\left[1 \\pm \\frac{c_s^2 c_a^2}{V_{p(f, s)}^2 c_n^2} \\cos ^2 \\theta\\right] \\\\\n& V_{g,(f, s), z}=V_{p,(f, s)} \\cos \\theta\\left[1 \\mp \\frac{c_s^2 c_a^2}{V_{p(f, s)}^2 c_n^2} \\sin ^2 \\theta\\right]\n\\end{aligned}\n\\]",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 04"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw04.julia.html",
    "href": "docs/courses/epss263/homework/epss263_hw04.julia.html",
    "title": "Homework 04",
    "section": "",
    "text": "Plot the phase velocity and the group velocity polar plots for \\(C_S= 0.25 C_A\\) and \\(C_S= 4 C_A\\).\n\n\n\nCode\nimport Pkg;\nPkg.add(\"Optim\");\n\n\n   Resolving package versions...\n  No Changes to `~/.julia/environments/v1.10/Project.toml`\n  No Changes to `~/.julia/environments/v1.10/Manifest.toml`\n\n\n\n\nCode\ninclude(\"main.jl\")\nusing AlgebraOfGraphics\nusing CairoMakie\nusing beforerr\n\n\n\n\nCode\ndfs = [0.25, 1, 4] .|&gt; VpVg_fastandslow_df\ndf = vcat(dfs...);\n\n\n\n\nCode\naxis = (width=225, height=225)\n\nbase_map = data(df) * mapping(\n    :v_parp =&gt; L\"V_{\\parallel}\",\n    :v_perp =&gt; L\"V_{\\perp}\",\n) * visual(Scatter, markersize=3);\n\n\n\n\nCode\nsubset(df, :type =&gt; .==(\"group velocity\"))\n\n\nArgumentError: ArgumentError: function passed to `subset`/`subset!` returned value of type `Bool` while it must return an `AbstractVector` when subsetting a data frame to ensure common mistakes in code are caught. Please report an issue if you find this restriction inconvenient.\nArgumentError: function passed to `subset`/`subset!` returned value of type `Bool` while it must return an `AbstractVector` when subsetting a data frame to ensure common mistakes in code are caught. Please report an issue if you find this restriction inconvenient.\n\n\n\nStacktrace:\n\n  [1] (::DataFrames.var\"#611#612\"{Base.Fix2{typeof(==), String}})(x::Vector{String})\n\n    @ DataFrames ~/.julia/packages/DataFrames/58MUJ/src/abstractdataframe/subset.jl:68\n\n  [2] _transformation_helper(df::DataFrame, col_idx::Int64, ::Base.RefValue{Any})\n\n    @ DataFrames ~/.julia/packages/DataFrames/58MUJ/src/abstractdataframe/selection.jl:562\n\n  [3] select_transform!(::Base.RefValue{Any}, df::DataFrame, newdf::DataFrame, transformed_cols::Set{Symbol}, copycols::Bool, allow_resizing_newdf::Base.RefValue{Bool}, column_to_copy::BitVector)\n\n    @ DataFrames ~/.julia/packages/DataFrames/58MUJ/src/abstractdataframe/selection.jl:805\n\n  [4] _manipulate(df::DataFrame, normalized_cs::Vector{Any}, copycols::Bool, keeprows::Bool)\n\n    @ DataFrames ~/.julia/packages/DataFrames/58MUJ/src/abstractdataframe/selection.jl:1778\n\n  [5] manipulate(df::DataFrame, cs::Any; copycols::Bool, keeprows::Bool, renamecols::Bool)\n\n    @ DataFrames ~/.julia/packages/DataFrames/58MUJ/src/abstractdataframe/selection.jl:1698\n\n  [6] select(df::DataFrame, args::Any; copycols::Bool, renamecols::Bool, threads::Bool)\n\n    @ DataFrames ~/.julia/packages/DataFrames/58MUJ/src/abstractdataframe/selection.jl:1298\n\n  [7] _get_subset_conditions(df::DataFrame, ::Base.RefValue{Any}, skipmissing::Bool, threads::Bool)\n\n    @ DataFrames ~/.julia/packages/DataFrames/58MUJ/src/abstractdataframe/subset.jl:113\n\n  [8] subset(df::DataFrame, args::Any; skipmissing::Bool, view::Bool, threads::Bool)\n\n    @ DataFrames ~/.julia/packages/DataFrames/58MUJ/src/abstractdataframe/subset.jl:284\n\n  [9] subset(df::DataFrame, args::Any)\n\n    @ DataFrames ~/.julia/packages/DataFrames/58MUJ/src/abstractdataframe/subset.jl:278\n\n [10] top-level scope\n\n    @ ~/projects/beforerr/docs/courses/epss263/homework/epss263_hw04.julia.ipynb:1\n\n\n\n\nCode\nplt = base_map * mapping(color=:wave, marker=:wave, row=:cs =&gt; nonnumeric, col=:type)\ndraw(plt, axis=axis)\neasy_save(\"mhd_waves_1\")\n\n\n┌ Info: Saved /Users/zijin/projects/beforerr/docs/courses/epss263/homework/figures/mhd_waves_1.png\n└ @ beforerr /Users/zijin/.julia/dev/beforerr.jl/src/utils/makie.jl:34\n\n\n\n\n\n\n\nCode\nplt = base_map * mapping(col=:wave, row=:cs =&gt; nonnumeric, color=:type)\nfg = draw(plt, axis=axis)\neasy_save(\"mhd_waves_2\")\n\n\n┌ Info: Saved /Users/zijin/projects/beforerr/docs/courses/epss263/homework/figures/mhd_waves_2.png\n└ @ beforerr /Users/zijin/.julia/dev/beforerr.jl/src/utils/makie.jl:34\n\n\n\n\n\n\n\nCode\nplt = base_map * mapping(color=:wave, marker=:type, markersize=:type, col=:cs =&gt; nonnumeric)\nfg = draw(plt, axis=axis)\neasy_save(\"mhd_waves_4\")\n\n\n┌ Info: Saved /Users/zijin/projects/beforerr/docs/courses/epss263/homework/figures/mhd_waves_4.png\n└ @ beforerr /Users/zijin/.julia/dev/beforerr.jl/src/utils/makie.jl:34\n\n\n\n\n\n\n\nCode\nplt = base_map * mapping(row=:wave, color=:cs =&gt; nonnumeric, col=:type)\nfg = draw(plt, axis=axis)\neasy_save(\"mhd_waves_3\")\n\n\n┌ Info: Saved /Users/zijin/projects/beforerr/docs/courses/epss263/homework/figures/mhd_waves_3.png\n└ @ beforerr /Users/zijin/.julia/dev/beforerr.jl/src/utils/makie.jl:34\n\n\n\n\n\n\n\nCode\nfunction plot_maximum_vgs_angle(cs)\n    df = VpVg_fastandslow_df(cs)\n\n    θmax = maximum_vgs_angle(cs, ca)\n    @show θmax\n    Vgs_para, Vgs_perp = vgs(θmax, cs, ca)\n\n    subset!(df, :type =&gt; ByRow(==(\"group velocity\")))\n\n    base_map = data(df) * mapping(\n        :v_parp =&gt; L\"V_{\\parallel}\",\n        :v_perp =&gt; L\"V_{\\perp}\",\n    ) * visual(Scatter, markersize=3);\n\n    plt = base_map * mapping(color=:wave, col=:cs =&gt; nonnumeric)\n    fig = draw(plt, axis=axis)\n    lines!(\n        [0, Vgs_para], [0, Vgs_perp],\n        color=:black,\n        linestyle=:dash,\n    )\n    return fig\nend\n\n\nplot_maximum_vgs_angle (generic function with 1 method)\n\n\n\n\nCode\nplot_maximum_vgs_angle(0.8)\n\n\nθmax = 0.2619881212506986\n\n\n\n\n\n\n\nCode\nplot_maximum_vgs_angle(1.2)\n\n\nθmax = 0.23537868316399047",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 04"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw04.julia.html#phase-velocity-and-the-group-velocity-polar-plots",
    "href": "docs/courses/epss263/homework/epss263_hw04.julia.html#phase-velocity-and-the-group-velocity-polar-plots",
    "title": "Homework 04",
    "section": "",
    "text": "Plot the phase velocity and the group velocity polar plots for \\(C_S= 0.25 C_A\\) and \\(C_S= 4 C_A\\).\n\n\n\nCode\nimport Pkg;\nPkg.add(\"Optim\");\n\n\n   Resolving package versions...\n  No Changes to `~/.julia/environments/v1.10/Project.toml`\n  No Changes to `~/.julia/environments/v1.10/Manifest.toml`\n\n\n\n\nCode\ninclude(\"main.jl\")\nusing AlgebraOfGraphics\nusing CairoMakie\nusing beforerr\n\n\n\n\nCode\ndfs = [0.25, 1, 4] .|&gt; VpVg_fastandslow_df\ndf = vcat(dfs...);\n\n\n\n\nCode\naxis = (width=225, height=225)\n\nbase_map = data(df) * mapping(\n    :v_parp =&gt; L\"V_{\\parallel}\",\n    :v_perp =&gt; L\"V_{\\perp}\",\n) * visual(Scatter, markersize=3);\n\n\n\n\nCode\nsubset(df, :type =&gt; .==(\"group velocity\"))\n\n\nArgumentError: ArgumentError: function passed to `subset`/`subset!` returned value of type `Bool` while it must return an `AbstractVector` when subsetting a data frame to ensure common mistakes in code are caught. Please report an issue if you find this restriction inconvenient.\nArgumentError: function passed to `subset`/`subset!` returned value of type `Bool` while it must return an `AbstractVector` when subsetting a data frame to ensure common mistakes in code are caught. Please report an issue if you find this restriction inconvenient.\n\n\n\nStacktrace:\n\n  [1] (::DataFrames.var\"#611#612\"{Base.Fix2{typeof(==), String}})(x::Vector{String})\n\n    @ DataFrames ~/.julia/packages/DataFrames/58MUJ/src/abstractdataframe/subset.jl:68\n\n  [2] _transformation_helper(df::DataFrame, col_idx::Int64, ::Base.RefValue{Any})\n\n    @ DataFrames ~/.julia/packages/DataFrames/58MUJ/src/abstractdataframe/selection.jl:562\n\n  [3] select_transform!(::Base.RefValue{Any}, df::DataFrame, newdf::DataFrame, transformed_cols::Set{Symbol}, copycols::Bool, allow_resizing_newdf::Base.RefValue{Bool}, column_to_copy::BitVector)\n\n    @ DataFrames ~/.julia/packages/DataFrames/58MUJ/src/abstractdataframe/selection.jl:805\n\n  [4] _manipulate(df::DataFrame, normalized_cs::Vector{Any}, copycols::Bool, keeprows::Bool)\n\n    @ DataFrames ~/.julia/packages/DataFrames/58MUJ/src/abstractdataframe/selection.jl:1778\n\n  [5] manipulate(df::DataFrame, cs::Any; copycols::Bool, keeprows::Bool, renamecols::Bool)\n\n    @ DataFrames ~/.julia/packages/DataFrames/58MUJ/src/abstractdataframe/selection.jl:1698\n\n  [6] select(df::DataFrame, args::Any; copycols::Bool, renamecols::Bool, threads::Bool)\n\n    @ DataFrames ~/.julia/packages/DataFrames/58MUJ/src/abstractdataframe/selection.jl:1298\n\n  [7] _get_subset_conditions(df::DataFrame, ::Base.RefValue{Any}, skipmissing::Bool, threads::Bool)\n\n    @ DataFrames ~/.julia/packages/DataFrames/58MUJ/src/abstractdataframe/subset.jl:113\n\n  [8] subset(df::DataFrame, args::Any; skipmissing::Bool, view::Bool, threads::Bool)\n\n    @ DataFrames ~/.julia/packages/DataFrames/58MUJ/src/abstractdataframe/subset.jl:284\n\n  [9] subset(df::DataFrame, args::Any)\n\n    @ DataFrames ~/.julia/packages/DataFrames/58MUJ/src/abstractdataframe/subset.jl:278\n\n [10] top-level scope\n\n    @ ~/projects/beforerr/docs/courses/epss263/homework/epss263_hw04.julia.ipynb:1\n\n\n\n\nCode\nplt = base_map * mapping(color=:wave, marker=:wave, row=:cs =&gt; nonnumeric, col=:type)\ndraw(plt, axis=axis)\neasy_save(\"mhd_waves_1\")\n\n\n┌ Info: Saved /Users/zijin/projects/beforerr/docs/courses/epss263/homework/figures/mhd_waves_1.png\n└ @ beforerr /Users/zijin/.julia/dev/beforerr.jl/src/utils/makie.jl:34\n\n\n\n\n\n\n\nCode\nplt = base_map * mapping(col=:wave, row=:cs =&gt; nonnumeric, color=:type)\nfg = draw(plt, axis=axis)\neasy_save(\"mhd_waves_2\")\n\n\n┌ Info: Saved /Users/zijin/projects/beforerr/docs/courses/epss263/homework/figures/mhd_waves_2.png\n└ @ beforerr /Users/zijin/.julia/dev/beforerr.jl/src/utils/makie.jl:34\n\n\n\n\n\n\n\nCode\nplt = base_map * mapping(color=:wave, marker=:type, markersize=:type, col=:cs =&gt; nonnumeric)\nfg = draw(plt, axis=axis)\neasy_save(\"mhd_waves_4\")\n\n\n┌ Info: Saved /Users/zijin/projects/beforerr/docs/courses/epss263/homework/figures/mhd_waves_4.png\n└ @ beforerr /Users/zijin/.julia/dev/beforerr.jl/src/utils/makie.jl:34\n\n\n\n\n\n\n\nCode\nplt = base_map * mapping(row=:wave, color=:cs =&gt; nonnumeric, col=:type)\nfg = draw(plt, axis=axis)\neasy_save(\"mhd_waves_3\")\n\n\n┌ Info: Saved /Users/zijin/projects/beforerr/docs/courses/epss263/homework/figures/mhd_waves_3.png\n└ @ beforerr /Users/zijin/.julia/dev/beforerr.jl/src/utils/makie.jl:34\n\n\n\n\n\n\n\nCode\nfunction plot_maximum_vgs_angle(cs)\n    df = VpVg_fastandslow_df(cs)\n\n    θmax = maximum_vgs_angle(cs, ca)\n    @show θmax\n    Vgs_para, Vgs_perp = vgs(θmax, cs, ca)\n\n    subset!(df, :type =&gt; ByRow(==(\"group velocity\")))\n\n    base_map = data(df) * mapping(\n        :v_parp =&gt; L\"V_{\\parallel}\",\n        :v_perp =&gt; L\"V_{\\perp}\",\n    ) * visual(Scatter, markersize=3);\n\n    plt = base_map * mapping(color=:wave, col=:cs =&gt; nonnumeric)\n    fig = draw(plt, axis=axis)\n    lines!(\n        [0, Vgs_para], [0, Vgs_perp],\n        color=:black,\n        linestyle=:dash,\n    )\n    return fig\nend\n\n\nplot_maximum_vgs_angle (generic function with 1 method)\n\n\n\n\nCode\nplot_maximum_vgs_angle(0.8)\n\n\nθmax = 0.2619881212506986\n\n\n\n\n\n\n\nCode\nplot_maximum_vgs_angle(1.2)\n\n\nθmax = 0.23537868316399047",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 04"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw04.html#group-velocities-for-the-intermediate-fast-and-slow-wave",
    "href": "docs/courses/epss263/homework/epss263_hw04.html#group-velocities-for-the-intermediate-fast-and-slow-wave",
    "title": "Homework 04",
    "section": "",
    "text": "Derive analytically the group velocities for the Intermediate, Fast, and Slow wave.\n\nThe dispersion relation of fast and slow magnetosonic waves is\n\\[\n\\omega^2=\\frac{k^2}{2}\\left[c_m^2 \\pm \\sqrt{c_m^4-4 c_s^2 c_a^2 k_z^2 / k^2}\\right] = \\frac{k^2}{2}\\left[c_m^2 \\pm c_n^2\\right]\n\\tag{1}\\]\nwhere “+” corresponds to fast mode and “-” corresponds to slow mode. And we have defined\n\\[\nc_n^2=\\sqrt{c_m^4-4 c_s^2 c_a^2 \\cos ^2 \\theta}\n\\]\nThus the phase velocities of the two modes are\n\\[\nV_{p,(f,s)}=\\frac{1}{\\sqrt{2}}\\left[c_m^2 \\pm c_n^2\\right]^{1 / 2} \\hat{e}_k\n\\]\nTaking derivatives with respect to \\(k_x\\) and \\(k_z\\) for Equation 1, we have\n\\[\n\\begin{aligned}\n2 ω ∂_{k_x} ω = k_x (c_m^2 ± c_n^2) ± 1/2 k^2 ∂_{k_x} c_n^2\n\\\\\n2 ω ∂_{k_z} ω = k_z (c_m^2 ± c_n^2) ± 1/2 k^2 ∂_{k_z} c_n^2\n\\end{aligned}\n\\]\nBecause \\(k^2 = k_x^2 + k_z^2\\), we have\n\\[\n\\begin{aligned}\n∂_{k_x} c_n^2 &= \\frac{4 c_a^2 c_s^2 k_z^2 k_x}{k^4 \\sqrt{c_m^4 - 4 c_s^2 c_a^2 k_z^2 / k^2}}\n\\\\\n∂_{k_z} c_n^2 &= - \\frac{4 c_a^2 c_s^2 k_z k_x^2}{k^3 c_n^2} = - \\frac{4 c_a^2 c_s^2 \\sin θ \\cos θ^2}{c_n^2}\n\\end{aligned}\n\\]\n\\[\n\\begin{aligned}\nω ∂_{k_x} ω\n&= \\frac{k_x}{2} (c_m^2 ± c_n^2) ± 1/4 k^2 ∂_{k_x} c_n^2 \\\\\n&= \\frac{k_x}{2} (c_m^2 ± c_n^2) ± 1/4 \\frac{4 c_a^2 c_s^2 k_z^2 k_x}{k^2 \\sqrt{c_m^4 - 4 c_s^2 c_a^2 k_z^2 / k^2}} \\\\\n&= k \\sin θ V_p^2 ± \\frac{c_a^2 c_s^2 \\cos^2 θ \\sin θ k }{c_n^2}\n\\\\\nω ∂_{k_z} ω\n&= \\frac{k_z}{2} (c_m^2 ± c_n^2) ± 1/4 k^2 ∂_{k_z} c_n^2 \\\\\n&=  k \\cos θ V_p^2 \\mp \\frac{c_a^2 c_s^2 \\sin θ^2 \\cos θ k}{c_n^2}\n\\end{aligned}\n\\]\nSo\n\\[\n\\begin{aligned}\nV_{g,x} = ∂_{k_x} ω = V_p \\sin θ (1 ± \\frac{c_a^2 c_s^2 \\cos^2 θ}{V_{p}^2 c_n^2})\n\\\\\nV_{g,z} = ∂_{k_z} ω = V_p \\cos θ (1 ∓ \\frac{c_a^2 c_s^2 \\sin^2 θ}{V_{p}^2 c_n^2})\n\\end{aligned}\n\\]",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 04"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw04.html#maximum-excursion-of-the-group-velocity",
    "href": "docs/courses/epss263/homework/epss263_hw04.html#maximum-excursion-of-the-group-velocity",
    "title": "Homework 04",
    "section": "Maximum excursion of the group velocity",
    "text": "Maximum excursion of the group velocity\n\"\"\"\nCalculates the group velocities for slow waves.\n\"\"\"\nfunction vgs(θ, cs, ca)\n    cm = sqrt(cs^2 + ca^2) #: magnetosonic speed\n    cm2 = cs^2 + ca^2\n    cn2 = sqrt(cm^4 - 4 * cs^2 * ca^2 * cos(θ)^2)\n\n    Vps = sqrt(0.5 * (cm2 - cn2))\n    Vgs_para = Vps * cos(θ) * (1 + cs^2 * ca^2 / Vps^2 / cn2 * sin(θ)^2)\n    Vgs_perp = Vps * sin(θ) * (1 - cs^2 * ca^2 / Vps^2 / cn2 * cos(θ)^2)\n    return Vgs_para, Vgs_perp\nend\n\n\"\"\"\nCalculates the group velocities propagation angle for slow waves.\n\"\"\"\nfunction vgs_angle(θ, cs, ca)\n    Vgs_para, Vgs_perp = vgs(θ, cs, ca)\n    return atan(Vgs_perp, Vgs_para)\nend\n\n\nfunction maximum_vgs_angle(cs, ca)\n    f(θ) = -abs(vgs_angle(θ, cs, ca))\n    res = optimize(f, 0, π/2)\n    return res.minimizer \nend\nfunction plot_maximum_vgs_angle(cs)\n    df = VpVg_fastandslow_df(cs)\n\n    θmax = maximum_vgs_angle(cs, ca)\n    @show θmax\n    Vgs_para, Vgs_perp = vgs(θmax, cs, ca)\n\n    subset!(df, :type =&gt; ByRow(==(\"group velocity\")))\n\n    base_map = data(df) * mapping(\n        :v_parp =&gt; L\"V_{\\parallel}\",\n        :v_perp =&gt; L\"V_{\\perp}\",\n    ) * visual(Scatter, markersize=3);\n\n    plt = base_map * mapping(color=:wave, col=:cs =&gt; nonnumeric)\n    fig = draw(plt, axis=axis)\n    lines!(\n        [0, Vgs_para], [0, Vgs_perp],\n        color=:black,\n        linestyle=:dash,\n    )\n    return fig\nend\nFor \\(C_S = 0.8 C_A\\), the maximum excursion of the group velocity is at \\(\\theta = 0.262\\), the group velocity is propagating at an angle of \\(\\phi = - 0.228\\).\n\nFor \\(C_S = 1.25 C_A\\), the maximum excursion of the group velocity is at \\(\\theta = 0.262\\), the group velocity is propagating at an angle of \\(\\phi = - 0.228\\).\n\nSimilary for \\(C_S = 0.25 C_A\\) and \\(C_S = 4 C_A\\), we have \\(\\theta = 0.500, \\phi = - 0.020\\).",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 04"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw04.html#comparison-of-the-group-velocity",
    "href": "docs/courses/epss263/homework/epss263_hw04.html#comparison-of-the-group-velocity",
    "title": "Homework 04",
    "section": "Comparison of the group velocity",
    "text": "Comparison of the group velocity\n\nUse the 2D solver to demonstrate that the F, S, and I waves propagate with the predicted group velocity. To do this, plot the F and S waves from a thermal pressure bomb at a given time t for which the disturbances (F and S) have propagated a distance Vg,F/S * t, and overplot the analytical group velocity-times-t diagram for that choice of CS/CA. They should lie on top of each other. Do the same for the I (Alfvén) waves generated by a magnetic pressure bomb with component in the out-of-plane direction (it will result in an Alfvén wave pulse).\n\nThe group velocity for the fast and slow waves are overplotted with scattered points with blue and orange colors respectively. Generally, the analytical group velocity is consistent with the numerical group velocity. We do not have the intermediate wave for the thermal pressure bomb but we have the intermediate wave for the magnetic pressure bomb as shown in the \\(B_z\\) plot.\n\nThermal pressure bomb for fast and slow waves\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMagnetic pressure bomb for intermediate waves",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 04"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw05.html",
    "href": "docs/courses/epss263/homework/epss263_hw05.html",
    "title": "Homework 05",
    "section": "",
    "text": "Compute the parallel current from a bipolar Alfvén wavepacket. In the simulation lecture it was shown that a unipolar pulse (magnetic bomb, Bz unipolar gaussian) creates a field aligned current. The direction of that current was computed from curlB (left panel in the 2D result) and (in simulation coordinates) from \\(J_x=[±1/(μ_0 C_a)] dE_y/dy\\) (right panel in the 2D result).\n\n\n\nMultiply the RHS image by the sign corresponding to the propagation direction, we get the LHS image.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTo create a bipolar pulse in dBz and let it evolve on both sides. The init input is as follows:\ncase(6)\n    !2D gaussian perturbation in Bz modulated by a odd function of x\n    do iz = izmin,izmax\n        do iy = iymin,iymax\n            do ix = ixmin,ixmax\n                uu(ix,iy,iz,7) = uu(ix,iy,iz,7) + db0 * (xgrid(ix) - 0.5*Lx) * &\n                exp( -( (xgrid(ix)-0.5*Lx)/(0.01*Lx) )**2 - ((ygrid(iy)-0.5*Ly)/(0.01*Ly))**2)\n            enddo\n        enddo\n    enddo\nThe basic idea is to change the amplitude modulation part from a constant to a odd function like (xgrid(ix) - 0.5*Lx) (sin would also work).\nThe figures below show the current density in the x direction for the bipolar Alfvén wavepacket.\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe notebooks to reproduce the results are available here with initial input here.",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 05"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw05.html#alfven-current",
    "href": "docs/courses/epss263/homework/epss263_hw05.html#alfven-current",
    "title": "Homework 05",
    "section": "",
    "text": "Compute the parallel current from a bipolar Alfvén wavepacket. In the simulation lecture it was shown that a unipolar pulse (magnetic bomb, Bz unipolar gaussian) creates a field aligned current. The direction of that current was computed from curlB (left panel in the 2D result) and (in simulation coordinates) from \\(J_x=[±1/(μ_0 C_a)] dE_y/dy\\) (right panel in the 2D result).\n\n\n\nMultiply the RHS image by the sign corresponding to the propagation direction, we get the LHS image.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTo create a bipolar pulse in dBz and let it evolve on both sides. The init input is as follows:\ncase(6)\n    !2D gaussian perturbation in Bz modulated by a odd function of x\n    do iz = izmin,izmax\n        do iy = iymin,iymax\n            do ix = ixmin,ixmax\n                uu(ix,iy,iz,7) = uu(ix,iy,iz,7) + db0 * (xgrid(ix) - 0.5*Lx) * &\n                exp( -( (xgrid(ix)-0.5*Lx)/(0.01*Lx) )**2 - ((ygrid(iy)-0.5*Ly)/(0.01*Ly))**2)\n            enddo\n        enddo\n    enddo\nThe basic idea is to change the amplitude modulation part from a constant to a odd function like (xgrid(ix) - 0.5*Lx) (sin would also work).\nThe figures below show the current density in the x direction for the bipolar Alfvén wavepacket.\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe notebooks to reproduce the results are available here with initial input here.",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 05"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw05.html#hydrodynamic-shock",
    "href": "docs/courses/epss263/homework/epss263_hw05.html#hydrodynamic-shock",
    "title": "Homework 05",
    "section": "Hydrodynamic shock",
    "text": "Hydrodynamic shock\n\nShow that the entropy across a hydrodynamic shock increases: (i) First, prove equation III.80 in Siscoe (you can use the jumps in p and \\(ρ\\) previously derived). (ii) Next, take the derivative of the entropy ratio as function of Mach number and show it is positive. Thus explain that starting from M1=1 and moving upwards all M1 values have positive entropy ratios. (iii) Plot the entropy ratio as function of M1 for a range of adiabatic indices. (iv) Under what conditions does the entropy not increase? [Ans. \\(γ=1\\)] When might such conditions occur in space plasmas and why? [Ans. parallel shocks]\n\nGiven the jump conditions of pressure and density:\n\\[\n\\rho _2\\to \\frac{(γ +1)}{γ +\\frac{2}{M_1^2}-1} \\rho _1\n\\]\n\\[\np_2\\to \\frac{\\left(2 γ  M_1^2-(γ -1)\\right)}{γ +1} p_1\n\\]\nAnd as the entropy is defined as \\(\\alpha_i\\text{:=} p_i / \\rho _i^{γ}\\)\nassums = { Subscript[ρ, 1] &gt; 0, γ &gt; 0, Subscript[M, 1] &gt; 0};\nratio = Simplify[α[2]/α[1] /. rules, assums]\ngives us\n\\[\nα[2]/α[1] = (γ +1)^{-γ -1} \\left(γ +\\frac{2}{M_1^2}-1\\right)^{γ } \\left(-γ +2 γ  M_1^2+1\\right) = \\left(\\frac{1}{γ+1}\\right)^{γ+1}\\left[2 γ M_1^2-(γ-1)\\right]\\left(γ-1+\\frac{2}{M_1^2}\\right)^γ\n\\]\nTaking the derivative of the entropy ratio with respect to \\(M_1\\):\ndRatio = D[ratio, M1];\ndRatio = Simplify[dRatio, assums];\ndRatio /. formatRules\ngives us\n\\[\n\\frac{d}{d M_1} \\left(\\frac{α_2}{α_1}\\right) =\n4 (γ -1) γ  (γ +1)^{-γ -1} \\left(M_1^2-1\\right)^2 M_1^{-2 γ -1} \\left((γ -1) M_1^2+2\\right)^{γ -1}\n\\]\nThe derivative is positive for all \\(M_1&gt;0\\) values as long as \\(γ&gt;1\\). And when \\(M_1=1\\), the ratio is equal to 1.\nThe plot of the entropy ratio as a function of \\(M_1\\) for a range of adiabatic indices is shown below.\nγs = {1, 4/3, 5/3, 2};\nLogLogPlot[\n Evaluate[ratio /. γ -&gt; γs], {M1, 1, 100}, \n PlotLegends -&gt; γs\n ]\n\nAnd we can see that when \\(γ=1\\), the entropy ratio is constant and equal to 1. As \\(p = α_1 ρ^γ = n k T\\), this corresponds to the case where the temperature is constant across the shock. Isothermal behavior is due to fast, field-aligned escaping electrons and this is more likely to occur in parallel shocks.\nThe mathematica notebook for this question and the following question is available here.",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 05"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw05.html#perpendicular-shock",
    "href": "docs/courses/epss263/homework/epss263_hw05.html#perpendicular-shock",
    "title": "Homework 05",
    "section": "Perpendicular Shock",
    "text": "Perpendicular Shock\n\n\nShow Eq. III.90 following Siscoe notes. Follow same procedure as in III.73 to factor the known solution and derive the quadratic coefficients. Write (X-1)(X^2 + A_1 X + A_0)=0 where X = (U2/U1) and solve for A0 and A1 given the coefficients of the cubic. For extra testing of cubic, make sure that X=1 is indeed a valid solution. As another test of your cubic equation (you can do that always during the derivation): Set \\(A_1 → ∞\\) and validate it becomes a quadratic that is identical to III.71 (with M1 defined same as S1).\n\n\nThe continuity relations for the perpendicular shock can be written as\n\\[\n\\begin{aligned}\n& [[\\rho U]]=0 \\\\\n& \\left[\\left[\\rho U^2+p+\\frac{B^2}{2 \\mu_0}\\right]\\right]=0 \\\\\n& {\\left[\\left[\\left(\\frac{1}{2} \\rho U^2+\\frac{\\gamma}{\\gamma-1} \\rho+\\frac{B^2}{\\mu_0}\\right) U\\right]\\right]=0} \\\\\n& {[[U B]]=0}\n\\end{aligned}\n\\]\nNormalizing the magnetic pressure by the ram pressure and the thermal pressure by the ram pressure\n\\[\nB_1^2\\to \\frac{\\rho _1 U_1^2}{A^2}\n\\]\n\\[\np_1\\to \\frac{\\rho _1 U_1^2}{\\gamma  S^2}\n\\]\nAnd Elimitating \\(B_2\\), \\(\\rho_2\\) and \\(p_2\\) from the equations\nmassEq := \\[Rho]1 U1 == \\[Rho]2 U2\nmomEq := \\[Rho]1 U1^2 + p1 + B1^2/2 == \\[Rho]2 U2^2 + p2 + B2^2/2\nenergyEq := (1/2 \\[Rho]1 U1^2 + f p1 + B1^2) U1 == (1/2 \\[Rho]2 U2^2 +\n      f p2 + B2^2) U2\nFaradayEq := B1 U1 == B2 U2\neqs = {massEq, momEq, energyEq, FaradayEq};\n\nSimplify[\n Eliminate[eqs, {B2, \\[Rho]2, p2}] /. rules, {Subscript[U, 1] &gt; 0, \n  Subscript[\\[Rho], 1] &gt; 0}]\nWe get the following equation\n\\[\n\\frac{(r-1) \\left(A^2 r \\left(S^2 (-\\gamma +\\gamma  r+r+1)-2\\right)+S^2 (\\gamma +\\gamma  (-r)-2)\\right)}{A (\\gamma -1) S}=0\n\\]\nwhere \\(r = U_2/U_1\\).\nClearly, \\(r=1\\) is a solution. We can collect the rest equation to get the quadratic equation in \\(r\\)\nCollect[S^2 (-2 + \\[Gamma] - r \\[Gamma]) + A^2 r (-2 + S^2 (1 + r - \\[Gamma] + r \\[Gamma])) == 0, r]\nwe get\n\\[\nr^2 \\left(A^2 \\gamma  S^2+A^2 S^2\\right)+r \\left(-A^2 \\gamma  S^2+A^2 S^2-2 A^2-\\gamma  S^2\\right)+\\gamma  S^2-2 S^2=0\n\\]\nThis is exactly the same as Eq. III.90 in Siscoe notes.\n\n\nSolve the quadratic to find the two solutions for U2. Show that one is non-physical, and identify the remaining, physical one.\n\n\nassums = {A &gt; 0 , S &gt; 0, \\[Gamma] &gt; 1};\nSolve[eqR, {r}, Reals, Assumptions -&gt; assums] // Simplify\nSolve the quadratic equation, we get\n\\[\n\\left\\{\\left\\{r\\to \\frac{A^2 \\left((\\gamma -1) S^2+2\\right)-\\sqrt{A^4 \\left((\\gamma -1) S^2+2\\right)^2+A^2 \\left(\\left(-2 \\gamma ^2+2 \\gamma +8\\right) S^4+4 \\gamma  S^2\\right)+\\gamma ^2 S^4}+\\gamma  S^2}{2 A^2 (\\gamma +1) S^2}\\right\\},\\left\\{r\\to \\frac{A^2 \\left((\\gamma -1) S^2+2\\right)+\\sqrt{A^4 \\left((\\gamma -1) S^2+2\\right)^2+A^2 \\left(\\left(-2 \\gamma ^2+2 \\gamma +8\\right) S^4+4 \\gamma  S^2\\right)+\\gamma ^2 S^4}+\\gamma  S^2}{2 A^2 (\\gamma +1) S^2}\\right\\}\\right\\}\n\\]\nThe first solution is non-physical as it is negative. The physical solution is\n\\[\nr_1\\text{:=}\\frac{A^2 \\left((\\gamma -1) S^2+2\\right)+\\sqrt{A^4 \\left((\\gamma -1) S^2+2\\right)^2+A^2 \\left(\\left(-2 \\gamma ^2+2 \\gamma +8\\right) S^4+4 \\gamma  S^2\\right)+\\gamma ^2 S^4}+\\gamma  S^2}{2 A^2 (\\gamma +1) S^2}\n\\]\nIn the limit of \\(A\\to\\infty\\)\nSubscript[r, 1] := \n 1/(2 A^2 S^2 (1 + \\[Gamma])) (A^2 (2 + S^2 (-1 + \\[Gamma])) + \n    S^2 \\[Gamma] + \\[Sqrt](A^4 (2 + S^2 (-1 + \\[Gamma]))^2 + \n       S^4 \\[Gamma]^2 + \n       A^2 (4 S^2 \\[Gamma] + S^4 (8 + 2 \\[Gamma] - 2 \\[Gamma]^2))))\nSimplify[Limit[Subscript[r, 1], {A -&gt; \\[Infinity]}], assums]\nwe can see that the solution becomes\n\\[\n\\frac{(\\gamma -1) S^2+2}{(\\gamma +1) S^2}\n\\]\nwhich is the same as Eq. III.71 in Siscoe notes for hydrodynamic shocks.\n\n\nPlot the solution as function of A1 and M1 (color, contour or surface plot OK). Show that the limits for \\(A_1→∞\\) and \\(M_1→∞\\) are as expected.\n\n\nIn the limit of \\(A_1→∞\\) and \\(M_1→∞\\), the solution approaches \\(\\frac{\\gamma -1}{\\gamma +1}\\). For \\(γ=5/3\\), the solution approaches 0.25, which is expected. The contour plot of the solution is shown below.\nBlock[{\\[Gamma] = 5/3, p1, p2},\n p1 = ContourPlot[r1, {A, 0, 100}, {S, 0, 100}, \n   PlotLegends -&gt; Automatic];\n p2 = ContourPlot[r1, {A, 0, 10}, {S, 0, 10}, \n   PlotLegends -&gt; Automatic];\n Export[\"figures/shock_U2.svg\", p1];\n Export[\"figures/shock_U2_zoom.svg\", p2];\n {p1, p2}\n ]\n\n\n\n\n\n\n\n\n\nContour plot with A and S less than 100\n\n\n\n\n\n\n\nZoom in plot for A and S less than 10",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 05"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw06.html",
    "href": "docs/courses/epss263/homework/epss263_hw06.html",
    "title": "Homework 06",
    "section": "",
    "text": "Using equation IV.2 in Siscoe (the 3 components of the Euler equation, expressed in terms of \\(δV\\)) we derived the dispersion relation for double-adiabatic MHD. We derived the F,S wave dispersion relation in the notes (Lecture 15a; same as Siscoe IV.7). The Intermediate mode was derived earlier in the class as well, separately (Siscoe IV4). We did not solve the quadratic using the determinant.\n\nExpress the 3 wave solutions in terms of \\(ω^2\\) (there is no need to simplify the R.H.S).\n\n\n\n\nThe velocity perturbation is given by the following expression:\n\\[\n\\begin{aligned}\n\\omega^2 \\delta \\vec{V} & =\\left[C_{\\perp}^2 k_x(\\vec{k} \\cdot \\delta \\vec{V})-C_{11}^2 k_x^2 \\delta V_x\\right] \\hat{x} \\\\\n& +\\left[C_{ \\pm}^2 k_x k_z \\delta V_x+3 C_{11}^2 k_z^2 \\delta V_z\\right] \\hat{z} \\\\\n& +\\xi_0 C_A^2\\left[k^2 \\delta V_x \\hat{x}+k_z^2 \\delta V_y \\hat{y}\\right]\n\\end{aligned}\n\\]\nThe three wave solutions are given by the following expressions:\nIntermediate mode:\n\\[\n\\omega_i^2=\\xi_0 C_A^2 k_z^2\n\\]\neqI := \\[Omega]^2 - \\[Xi]0 Ca^2 kz^2 == 0\nFast and slow waves:\n\\[\n\\left(\\omega_{f, s}^2-3 C_∥^2 k_z^2\\right)\\left[\\omega_{f, s}^2-(2 C_⟂^2+C_∥^2) k_x^2-\\xi_0 C_A^2 k_z^2\\right]-C_⟂^4 k_x^2 k_z^2=0\n\\]\neqFS := (\\[Omega]^2 - \n      3 Cparp^2 kz^2) (\\[Omega]^2 - (2 Cperp^2 + \n         Cparp^2) kx^2 - \\[Xi]0  Ca^2 kz^2) - Cperp^4 kx^2 kz^2 == 0\nWhich gives:\n\\[\n\\omega ^4 + \\omega ^2 \\left(-\\xi _0 C_A^2 k_z^2 - k_x^2 \\left(C_\\parallel^2 + 2 C_\\perp^2\\right)-3 C_\\parallel^2 k_z^2\\right)+3 \\xi _0 C_A^2 C_\\parallel^2 k_z^4+3 C_\\parallel^2 k_x^2 k_z^2 \\left(C_\\parallel^2+2 C_\\perp^2\\right)-C_\\perp^4 k_x^2 k_z^2=0\n\\]\nin the form of a quadratic equation:\n\\[\n(\\omega^2)^2 + A \\omega^2 + B = 0\n\\]\nwhere:\n\\[\n\\begin{aligned}\nA &= -\\xi_0 C_A^2 k_z^2 - k_x^2 \\left(C_\\parallel^2+2 C_\\perp^2\\right)-3 C_\\parallel^2 k_z^2\n\\\\\nB &= 3 \\xi_0 C_A^2 C_\\parallel^2 k_z^4+3 C_\\parallel^2 k_x^2 k_z^2 \\left(C_\\parallel^2+2 C_\\perp^2\\right)-C_\\perp^4 k_x^2 k_z^2\n\\end{aligned}\n\\]\nSo the solutions in terms of \\(\\omega^2\\) are:\n\\[\n\\omega^2 = \\frac{-A \\pm \\sqrt{A^2 - 4 B}}{2}\n\\]\n\n\n\n\n\nPlot them in a polar diagram (Friedriechs diagram) and check that they agree with the polar diagrams shown in Notes 14a (last page). Use p|| = p⊥, for the unperturbed doubleadiabatic plasma, and β=0.5, 0.8, 1.0, and 2.0, as shown in the class notes.\n\n\nSubstitute the above values of \\(A\\) and \\(B\\) with \\(k_x = k \\cos(\\theta)\\) and \\(k_z = k \\sin(\\theta)\\):\nrules = {kz -&gt; k Cos[\\[Theta]], kx -&gt; k Sin[\\[Theta]], Ca -&gt; 1, \n   k -&gt; 1};\ncases = {Cperp -&gt; Cparp, \\[Xi]0 -&gt; 1};\nrules = Join[rules, cases];\n\nCollect[eqFS //. rules /. notationRules, \\[Omega]]\nIn this case, the dispersion relation could be simplified to:\n\\[\n\\omega ^4 + \\omega ^2 \\left(-3 C_{\\text{parp}}^2 \\sin ^2(\\theta )-3 C_{\\text{parp}}^2 \\cos ^2(\\theta )-\\cos ^2(\\theta )\\right)+3 C_{\\text{parp}}^2 \\cos ^4(\\theta )+8 C_{\\text{parp}}^4 \\sin ^2(\\theta ) \\cos ^2(\\theta )=0\n\\]\nsolsI = Solve[eqI, \\[Omega]];\nsolsAll = Solve[eqFS, \\[Omega]];\nsolsFS = {solsAll[[2]], solsAll[[4]]};\nsols = Join[solsI, solsFS];\nvp = Simplify[\\[Omega]/k /. sols //. rules, k &gt; 0];\nps = Table[\n Block[{Cparp = Cparpi},\n  PolarPlot[Evaluate@vp, {\\[Theta], 0, 2 \\[Pi]}]\n  ],\n {Cparpi, {Sqrt[0.5/2], Sqrt[0.8/2], Sqrt[1/2], Sqrt[2/2]}}\n ]\n\nSetDirectory@NotebookDirectory[];\nExport[\"figures/polar_diagram.svg\", GraphicsRow[ps]]\n\n\n\n\nPolar diagram\n\n\n\n\n\n\n\n\nWhy do you think the dispersion curves for the anisotropic MHD compressional modes are so different from the isotropic MHD ones, even when p|| = p⊥?\n\n\nBasically this is because the scalar adiabatic relation is replaced by two separate adiabatic relations for aniostropic MHD. This two separate adiabatic relations have different coefficients for the parallel and perpendicular directions. And this leads to different dispersion relations for the compressional modes even when \\(p_{\\parallel} = p_{\\perp}\\).",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 06"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw06.html#problem-1",
    "href": "docs/courses/epss263/homework/epss263_hw06.html#problem-1",
    "title": "Homework 06",
    "section": "",
    "text": "Using equation IV.2 in Siscoe (the 3 components of the Euler equation, expressed in terms of \\(δV\\)) we derived the dispersion relation for double-adiabatic MHD. We derived the F,S wave dispersion relation in the notes (Lecture 15a; same as Siscoe IV.7). The Intermediate mode was derived earlier in the class as well, separately (Siscoe IV4). We did not solve the quadratic using the determinant.\n\nExpress the 3 wave solutions in terms of \\(ω^2\\) (there is no need to simplify the R.H.S).\n\n\n\n\nThe velocity perturbation is given by the following expression:\n\\[\n\\begin{aligned}\n\\omega^2 \\delta \\vec{V} & =\\left[C_{\\perp}^2 k_x(\\vec{k} \\cdot \\delta \\vec{V})-C_{11}^2 k_x^2 \\delta V_x\\right] \\hat{x} \\\\\n& +\\left[C_{ \\pm}^2 k_x k_z \\delta V_x+3 C_{11}^2 k_z^2 \\delta V_z\\right] \\hat{z} \\\\\n& +\\xi_0 C_A^2\\left[k^2 \\delta V_x \\hat{x}+k_z^2 \\delta V_y \\hat{y}\\right]\n\\end{aligned}\n\\]\nThe three wave solutions are given by the following expressions:\nIntermediate mode:\n\\[\n\\omega_i^2=\\xi_0 C_A^2 k_z^2\n\\]\neqI := \\[Omega]^2 - \\[Xi]0 Ca^2 kz^2 == 0\nFast and slow waves:\n\\[\n\\left(\\omega_{f, s}^2-3 C_∥^2 k_z^2\\right)\\left[\\omega_{f, s}^2-(2 C_⟂^2+C_∥^2) k_x^2-\\xi_0 C_A^2 k_z^2\\right]-C_⟂^4 k_x^2 k_z^2=0\n\\]\neqFS := (\\[Omega]^2 - \n      3 Cparp^2 kz^2) (\\[Omega]^2 - (2 Cperp^2 + \n         Cparp^2) kx^2 - \\[Xi]0  Ca^2 kz^2) - Cperp^4 kx^2 kz^2 == 0\nWhich gives:\n\\[\n\\omega ^4 + \\omega ^2 \\left(-\\xi _0 C_A^2 k_z^2 - k_x^2 \\left(C_\\parallel^2 + 2 C_\\perp^2\\right)-3 C_\\parallel^2 k_z^2\\right)+3 \\xi _0 C_A^2 C_\\parallel^2 k_z^4+3 C_\\parallel^2 k_x^2 k_z^2 \\left(C_\\parallel^2+2 C_\\perp^2\\right)-C_\\perp^4 k_x^2 k_z^2=0\n\\]\nin the form of a quadratic equation:\n\\[\n(\\omega^2)^2 + A \\omega^2 + B = 0\n\\]\nwhere:\n\\[\n\\begin{aligned}\nA &= -\\xi_0 C_A^2 k_z^2 - k_x^2 \\left(C_\\parallel^2+2 C_\\perp^2\\right)-3 C_\\parallel^2 k_z^2\n\\\\\nB &= 3 \\xi_0 C_A^2 C_\\parallel^2 k_z^4+3 C_\\parallel^2 k_x^2 k_z^2 \\left(C_\\parallel^2+2 C_\\perp^2\\right)-C_\\perp^4 k_x^2 k_z^2\n\\end{aligned}\n\\]\nSo the solutions in terms of \\(\\omega^2\\) are:\n\\[\n\\omega^2 = \\frac{-A \\pm \\sqrt{A^2 - 4 B}}{2}\n\\]\n\n\n\n\n\nPlot them in a polar diagram (Friedriechs diagram) and check that they agree with the polar diagrams shown in Notes 14a (last page). Use p|| = p⊥, for the unperturbed doubleadiabatic plasma, and β=0.5, 0.8, 1.0, and 2.0, as shown in the class notes.\n\n\nSubstitute the above values of \\(A\\) and \\(B\\) with \\(k_x = k \\cos(\\theta)\\) and \\(k_z = k \\sin(\\theta)\\):\nrules = {kz -&gt; k Cos[\\[Theta]], kx -&gt; k Sin[\\[Theta]], Ca -&gt; 1, \n   k -&gt; 1};\ncases = {Cperp -&gt; Cparp, \\[Xi]0 -&gt; 1};\nrules = Join[rules, cases];\n\nCollect[eqFS //. rules /. notationRules, \\[Omega]]\nIn this case, the dispersion relation could be simplified to:\n\\[\n\\omega ^4 + \\omega ^2 \\left(-3 C_{\\text{parp}}^2 \\sin ^2(\\theta )-3 C_{\\text{parp}}^2 \\cos ^2(\\theta )-\\cos ^2(\\theta )\\right)+3 C_{\\text{parp}}^2 \\cos ^4(\\theta )+8 C_{\\text{parp}}^4 \\sin ^2(\\theta ) \\cos ^2(\\theta )=0\n\\]\nsolsI = Solve[eqI, \\[Omega]];\nsolsAll = Solve[eqFS, \\[Omega]];\nsolsFS = {solsAll[[2]], solsAll[[4]]};\nsols = Join[solsI, solsFS];\nvp = Simplify[\\[Omega]/k /. sols //. rules, k &gt; 0];\nps = Table[\n Block[{Cparp = Cparpi},\n  PolarPlot[Evaluate@vp, {\\[Theta], 0, 2 \\[Pi]}]\n  ],\n {Cparpi, {Sqrt[0.5/2], Sqrt[0.8/2], Sqrt[1/2], Sqrt[2/2]}}\n ]\n\nSetDirectory@NotebookDirectory[];\nExport[\"figures/polar_diagram.svg\", GraphicsRow[ps]]\n\n\n\n\nPolar diagram\n\n\n\n\n\n\n\n\nWhy do you think the dispersion curves for the anisotropic MHD compressional modes are so different from the isotropic MHD ones, even when p|| = p⊥?\n\n\nBasically this is because the scalar adiabatic relation is replaced by two separate adiabatic relations for aniostropic MHD. This two separate adiabatic relations have different coefficients for the parallel and perpendicular directions. And this leads to different dispersion relations for the compressional modes even when \\(p_{\\parallel} = p_{\\perp}\\).",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 06"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw06.html#problem-2",
    "href": "docs/courses/epss263/homework/epss263_hw06.html#problem-2",
    "title": "Homework 06",
    "section": "Problem 2",
    "text": "Problem 2\n\nThe current of a moving Alfvén wave pulse closes in the pulse itself. You can see why in Siscoe equation III.44 (class notes Lecture 10a, Page 10) expressing \\(δJ\\) for an MHD wave: the Alfvén (I) mode has a parallel and a perpendicular current, \\(div(J_I)=- i k J_I =0\\). Use the MHD simulation to determine and plot Jy (the perpendicular current) either from (curlB)y or from dEy/dx (in simulation coordinates). Then also plot \\(div(J_I)=∂J_x/∂x+∂J_y/∂y\\) and show it is exactly zero. [In the ideal MHD and Hall MHD equations we ignore the displacement current and the space charge, so div(JI). [FYI: These corrections can become important when the electron inertial response or ion thermal motion become significant, causing an E|| in Ohm’s law, where (-VxB)||=(JxB)||=0\n\nThe current density in the x and y directions are plotted below:\n\n\n\n\n\n\n\n\n\nJx\n\n\n\n\n\n\n\nJy\n\n\n\n\n\nThe divergence of the current density is plotted below:\n\n\n\ndivJ\n\n\nWe can see that the divergence of the current density is exactly zero, which means that the current of a moving Alfvén wave pulse closes in the pulse itself.",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 06"
    ]
  },
  {
    "objectID": "docs/courses/epss263/homework/epss263_hw06.html#problem-3",
    "href": "docs/courses/epss263/homework/epss263_hw06.html#problem-3",
    "title": "Homework 06",
    "section": "Problem 3",
    "text": "Problem 3\n\nChen Shi modified his MHD code to accept a moving source of the dBz pulse (source moves in +y). The code is called “moving_source_code.zip” in the lecture notes. Run it and compute the parallel current Jx around this wing at time t=4.0. You will find the current moves towards the source in the upper-right part of the wing and away from the source in the upper-left. This is an apparent current (appearing to connect to the source): each Jx pulse is moving along the field, but contiguous pulses make it appear that the current continues all the way to the source.\n\n\n\n\nJx\n\n\n\n\n\nJy\n\n\nWe can see that current moves towards the source in the upper-right part of the wing with positive \\(J_y\\) and away from the source in the upper-left with negative \\(J_y\\). The current in y direction has the most intensity in the edge of the wing, which let the current close itself.",
    "crumbs": [
      "Courses",
      "EPSS M263",
      "Homework",
      "Homework 06"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps2.html",
    "href": "docs/courses/astr145/homework/ps2.html",
    "title": "Problem Set 2",
    "section": "",
    "text": "Code\nimport numpy as np\nfrom astropy.constants import c, G, M_sun, m_p\nimport astropy.units as u\n\ndef bondi_gamma_factor(gamma):\n    \"\"\"\n    Calculate the factor involving gamma in the Bondi accretion rate.\n    \"\"\"\n    factor = (2 / (5 - 3 * gamma)) ** ((5 - 3 * gamma) / (2 * (gamma - 1)))\n    return factor\n\ndef bondi_accretion_rate(M_star, rho_inf, c_inf, gamma=1.4):\n    \"\"\"\n    Calculate the Bondi accretion rate.\n    \n    Parameters:\n    - M_star: Mass of the star in grams\n    - rho_inf: Density of ISM in g/cm^3\n    - c_inf: Sound speed in ISM in cm/s\n    - gamma: Adiabatic index (default is 1.4 for ISM)\n    \n    Returns:\n    - accretion rate in g/s\n    \"\"\"\n    # First part of the equation\n    factor1 = np.pi * (G**2) * (M_star**2) * rho_inf / (c_inf**3)\n    \n    # Second part: The factor involving gamma\n    factor2 = bondi_gamma_factor(gamma)\n    \n    print(f\"Factor 1: {factor1}\")\n    print(f\"Factor 2: {factor2}\")\n    \n    # Bondi accretion rate in grams per second\n    accretion_rate = factor1 * factor2\n    \n    return accretion_rate\n\ndef time_to_double_mass(M_star, rho_inf, c_inf, gamma=1.4):\n    \"\"\"\n    Estimate the time for a star to double its mass via accretion.\n    \n    Parameters:\n    - M_star: Initial mass of the star in grams\n    - rho_inf: Density of ISM in g/cm^3\n    - c_inf: Sound speed in ISM in cm/s\n    - gamma: Adiabatic index (default is 1.4 for ISM)\n    \n    Returns:\n    - Time to double the mass in seconds\n    \"\"\"\n    accretion_rate = bondi_accretion_rate(M_star, rho_inf, c_inf, gamma)\n    print(f\"Bondi accretion rate: {accretion_rate.to(u.M_sun/u.yr)}\")\n    \n    # Time to double the mass (in seconds)\n    time_double = M_star / accretion_rate\n    \n    return time_double\nCode\n# Example: Solar mass star in typical ISM conditions\nM_star = M_sun  # Solar mass in grams\nrho_inf = 1e-24 * u.g / u.cm**3 # ISM density\nc_inf = 10 * u.km / u.s # Sound speed\n\n# Calculate time to double mass\ntime_double = time_to_double_mass(M_star, rho_inf, c_inf).to(u.yr)\n\n# Print result\nprint(f\"Time to double the mass of a solar-mass star: {time_double:.2e}\")\n\n\nFactor 1: 55331588792011.84 m6 g / (s cm3 km3)\nFactor 2: 2.5000000000000004\nBondi accretion rate: 2.1953875961320245e-15 solMass / yr\nTime to double the mass of a solar-mass star: 4.56e+14 yr",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 2"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps2.html#the-eddington-luminosity",
    "href": "docs/courses/astr145/homework/ps2.html#the-eddington-luminosity",
    "title": "Problem Set 2",
    "section": "1 The Eddington Luminosity",
    "text": "1 The Eddington Luminosity\n\n\nCode\nprint(G, c, m_p, M_sun)\n\n\n  Name   = Gravitational constant\n  Value  = 6.6743e-11\n  Uncertainty  = 1.5e-15\n  Unit  = m3 / (kg s2)\n  Reference = CODATA 2018   Name   = Speed of light in vacuum\n  Value  = 299792458.0\n  Uncertainty  = 0.0\n  Unit  = m / s\n  Reference = CODATA 2018   Name   = Proton mass\n  Value  = 1.67262192369e-27\n  Uncertainty  = 5.1e-37\n  Unit  = kg\n  Reference = CODATA 2018   Name   = Solar mass\n  Value  = 1.988409870698051e+30\n  Uncertainty  = 4.468805426856864e+25\n  Unit  = kg\n  Reference = IAU 2015 Resolution B 3 + CODATA 2018",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 2"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps2.html#bondi-accretion-onto-black-holes",
    "href": "docs/courses/astr145/homework/ps2.html#bondi-accretion-onto-black-holes",
    "title": "Problem Set 2",
    "section": "2 Bondi Accretion onto Black Holes?",
    "text": "2 Bondi Accretion onto Black Holes?\n\n\nCode\nM_bh = 1e6 * M_sun  # SMBH mass\nrho_inf = 1.67e-24 * u.g / u.cm**3 # galactic medium density\nc_inf = 200 * u.km / u.s # sound speed\ngamma = 4/3  # adiabatic index\n\n\n\n2.1 Estimate the sonic radius\n\n\nCode\n# import package related to the current problem\nfrom astr145 import schwarzschild_radius\n\ndef sonic_radius(M_bh, c_inf, gamma):\n    factor = (5 - 3 * gamma) / 4\n    r_s = G * M_bh / (c_inf**2) * factor\n    return r_s\n\n# Calculate the sonic radius\nr_s = sonic_radius(M_bh, c_inf, gamma).to(u.km)\naccretion_rate = bondi_accretion_rate(M_bh, rho_inf, c_inf, gamma).to(u.M_sun/u.yr)\nR_sch = schwarzschild_radius(M_bh).to(u.km)\n# Output the results\nprint(f\"Sonic radius: {r_s:.2e}\")\nprint(f\"Schwarzschild radius: {R_sch:.2e}\")\nprint(f\"Sonic radius in Schwarzschild units: {r_s/R_sch:.2e}\")\nprint(f\"Bondi accretion rate: {accretion_rate:.2e}\")\n\n\nFactor 1: 1.1550469160332473e+22 m6 g / (s cm3 km3)\nFactor 2: 2.828427124746191\nSonic radius: 8.29e+11 km\nSchwarzschild radius: 2.95e+06 km\nSonic radius in Schwarzschild units: 2.81e+05\nBondi accretion rate: 5.18e-07 solMass / yr\n\n\n\n\nCode\nepsilon = 0.1  # Efficiency factor\n# Function to calculate Eddington luminosity\ndef eddington_luminosity(M):\n    L_edd = 4 * np.pi * G * M_bh * c\n    return L_edd\n\ndef eddington_luminosity(M_bh):\n    L_edd = 1.25e38 * (M_bh / M_sun) * u.erg / u.s  # Eddington luminosity in erg/s\n    return L_edd\n\n# Function to calculate Eddington accretion rate\ndef eddington_accretion_rate(M_bh, epsilon=epsilon):\n    L_edd = eddington_luminosity(M_bh)\n    Mdot_edd = L_edd / (epsilon * c**2)  # Eddington accretion rate\n    return Mdot_edd.to(u.M_sun/u.yr)\n\n\n\n\nCode\n# Example: For a SMBH with 1e6 solar masses\nM_bh = 1e6 * M_sun\n# Calculate the Eddington accretion rate\nedd_accretion_rate = eddington_accretion_rate(M_bh)\n\n# Output the result\nprint(f\"Eddington accretion rate: {edd_accretion_rate:.2e}\")\nprint(f\"Bondi accretion rate in Eddington units: {accretion_rate/edd_accretion_rate:.2e}\")\n\n\nEddington accretion rate: 2.21e-02 solMass / yr\nBondi accretion rate in Eddington units: 2.35e-05\n\n\n\n\nCode\nσT = 6.65e-25 * u.cm**2  # Thomson cross-section\n\nf1 = 4  * m_p * c_inf**3 / (epsilon * c  * σT * M_sun * G * rho_inf)\nf1 = f1.to(u.dimensionless_unscaled)\nf2 = bondi_gamma_factor(gamma) **(-1)\nprint(f\"Factor: {f1 * f2}\")\n\n\nFactor: 42828445976.572334",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 2"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps2.html#rotating-black-holes",
    "href": "docs/courses/astr145/homework/ps2.html#rotating-black-holes",
    "title": "Problem Set 2",
    "section": "3 Rotating Black Holes",
    "text": "3 Rotating Black Holes\n\nStationary black holes have a point singularity while rotating black holes possess a ring-shaped singularity. This distinction leads to the intriguing concept of naked singularities that could theoretically be observed. The concept of naked singularities presents a paradox in physics since they lack an event horizon, allowing for potential observation, although none have been detected so far.",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 2"
    ]
  },
  {
    "objectID": "docs/blog/2024_NASA_summer_school/capstone.html",
    "href": "docs/blog/2024_NASA_summer_school/capstone.html",
    "title": "beforerr",
    "section": "",
    "text": "\\[\n\\frac{T_{t,m}}{T_{t,e}} = (\\frac{E_m}{E_e})^{1/4} (\\frac{M_m}{M_e})^{-1/6}\n\\]\nwith \\(T_{t,e}=34 K\\) and \\(T_{CO_2}(gas|p=0.1atm) &gt; 180 K\\)\nFor \\(M_m = M_e\\) and \\(T_{t,m} = 180 K\\) we get \\(E_{crit} \\geq 780 E_⊕\\)\nAssuming \\(E\\propto M\\), then \\(M_{crit} \\geq 5 × 10^8 M_⊕\\)\n\\(E_{crit} = 5×10^{30} \\text{erg/s} \\gg  E_⊕=4×10^{20} \\text{erg/s}\\)"
  },
  {
    "objectID": "docs/blog/journal_club/2024-10-16_jets/index.html",
    "href": "docs/blog/journal_club/2024-10-16_jets/index.html",
    "title": "Magnetosheath jets at Jupiter and across the solar system",
    "section": "",
    "text": "Reported anti-sunward and sunward jets in the Jovian magnetosheath."
  },
  {
    "objectID": "docs/blog/journal_club/2024-10-16_jets/index.html#introduction---what-are-magnetosheath-jets",
    "href": "docs/blog/journal_club/2024-10-16_jets/index.html#introduction---what-are-magnetosheath-jets",
    "title": "Magnetosheath jets at Jupiter and across the solar system",
    "section": "Introduction - What are magnetosheath jets?",
    "text": "Introduction - What are magnetosheath jets?\nLarge amplitude, yet spatially localized, transient increases in dynamic pressure, known as “magnetosheath jets” or “plasmoids”.\n\nPlaschke et al. (2018)"
  },
  {
    "objectID": "docs/blog/journal_club/2024-10-16_jets/index.html#why-jupyter",
    "href": "docs/blog/journal_club/2024-10-16_jets/index.html#why-jupyter",
    "title": "Magnetosheath jets at Jupiter and across the solar system",
    "section": "Why Jupyter?",
    "text": "Why Jupyter?\nMost jets are observed in quasi-parallel shocked magnetosheath (presence of foreshock):\n\nFormation mechanism: shock rippling (97%), shock reformation, and shock interaction with rotational discontinuities\n\nQuasiperpendicular shocks are less favorable\n\nFormation mechanism: shock interaction with discontinuities; mirror modes…\nMagnetic flux tubes that are embedded in the Qper magnetosheath but are connected to the Qpar section of the bow-shock (Kajdič et al. 2021)\n\nSubsolar bow shocks of outer planets are more frequently quasi-perpendicular (due to the Parker spiral)\nParametric variation of jets"
  },
  {
    "objectID": "docs/blog/journal_club/2024-10-16_jets/index.html#results",
    "href": "docs/blog/journal_club/2024-10-16_jets/index.html#results",
    "title": "Magnetosheath jets at Jupiter and across the solar system",
    "section": "Results",
    "text": "Results\nJupiter-Sun-Orbital (JSO) Cartesian and spherical coordinates. In this coordinate system, the x-axis points from Jupiter to the Sun, the z-axis is aligned with vJO × x^ (where vJO denotes the orbital velocity of Jupiter)\nVoyager 2 observation\n\nSignificant variations, indicating quasi-parallel magnetosheath conditions.\nMagnetic field standard deviation and high energy ion flux are good local indicators to distinguish between quasi-parallel and quasi-perpendicular magnetosheath.\nAfter the third jet, quasi-perpendicular magnetosheath [θ = 90∘, φ = 245∘]"
  },
  {
    "objectID": "docs/blog/journal_club/2024-10-16_jets/index.html#sunward-jet",
    "href": "docs/blog/journal_club/2024-10-16_jets/index.html#sunward-jet",
    "title": "Magnetosheath jets at Jupiter and across the solar system",
    "section": "Sunward jet",
    "text": "Sunward jet\n\n\nmagnetopause crossings (expansion phase of the magnetosphere)\n\nbreathing of the magnetopause is expected to occur on a time scale of hour for Jupiter.\n\n(density-depleted) hot flow anomaly (a flow reversal in their core HFA)"
  },
  {
    "objectID": "docs/blog/journal_club/2024-10-16_jets/index.html#anti-sunward-jets",
    "href": "docs/blog/journal_club/2024-10-16_jets/index.html#anti-sunward-jets",
    "title": "Magnetosheath jets at Jupiter and across the solar system",
    "section": "Anti-sunward jets",
    "text": "Anti-sunward jets\nReminiscent of the cores of HFA convected downstream\nThe two density peaks contributing to the dynamic pressure corresponded to the plasma pileups on the leading and trailing edges of the HFA.\nThe increased velocity in the jets may be attributed to the curved shock formed during shock–discontinuity interaction, since curved shocks are less capable of decelerating flows and thus could produce relatively high speed flows than other shocks.\nFast mode nature (not mirror modes, which exhibit durations ranging from 20 to 120 seconds and sizes equivalent approximately ~ 0.15RJ)"
  },
  {
    "objectID": "docs/blog/journal_club/2024-10-16_jets/index.html#comparing-magnetosheath-jets-across-planets",
    "href": "docs/blog/journal_club/2024-10-16_jets/index.html#comparing-magnetosheath-jets-across-planets",
    "title": "Magnetosheath jets at Jupiter and across the solar system",
    "section": "Comparing magnetosheath jets across planets",
    "text": "Comparing magnetosheath jets across planets\nten minutes and can even approach an hour.\nMuch longer than the durations observed for jets at Earth (up to ~ 3 min)"
  },
  {
    "objectID": "docs/blog/journal_club/2024-10-16_jets/index.html#discussion",
    "href": "docs/blog/journal_club/2024-10-16_jets/index.html#discussion",
    "title": "Magnetosheath jets at Jupiter and across the solar system",
    "section": "Discussion",
    "text": "Discussion\nThey have reported anti-sunward and sunward jets in the Jovian magnetosheath.\nThese jets were associated with magnetic field discontinuities.\nThe highly intermittent and discontinuous magnetic fields in solar wind allow jets to be formed downstream of these planetery bow shocks.\nMore powerful jets than at Earth are expected in outer planets.\nGiven the high Mach number for Jovian and Kronian bow shock and the decreasing beta with solar centric distance beyond the Martian orbit. And yheoretical calculations suggest that the strength of jets (ratio of jet to upstream dynamic pressure) grow with Mach number and decrease with plasma beta (ratio of thermal to magnetic pressure)."
  },
  {
    "objectID": "docs/blog/phd/2024_pre/proposal_SWD.html",
    "href": "docs/blog/phd/2024_pre/proposal_SWD.html",
    "title": "Exploring solar wind discontinuity properties in the inner and outer heliosphere",
    "section": "",
    "text": "PhD Candidate: Zijin Zhang"
  },
  {
    "objectID": "docs/blog/phd/2024_pre/proposal_SWD.html#abstract",
    "href": "docs/blog/phd/2024_pre/proposal_SWD.html#abstract",
    "title": "Exploring solar wind discontinuity properties in the inner and outer heliosphere",
    "section": "Abstract",
    "text": "Abstract\nSolar wind discontinuities, characterized by abrupt changes in the magnetic field, play a crucial role in heliospheric dynamics, including solar wind turbulence, and particle heating and acceleration. Understanding these discontinuities is essential for elucidating the fundamental processes that govern the solar wind’s evolution and its interaction with planetary environments. This proposal aims to conduct a detailed study of these discontinuities, leveraging data from contemporary space missions like Parker Solar Probe (PSP) and Juno to examine their characteristics (occurrence rates, thickness, current density, and Alfvénicity, etc.) from the Sun to beyond 1 AU. By analyzing the evolution of these features, this study seeks to answer questions about how the discontinuities change with radial distance from the Sun and the physical mechanisms behind their formation and evolution. Detailed observational information about their configuration and evolution will provide a solid foundation for investigations of the role of discontinuities in solar wind heating, energetic particles\nacceleration and propagation."
  },
  {
    "objectID": "docs/blog/phd/2024_pre/proposal_SWD.html#introduction-and-background",
    "href": "docs/blog/phd/2024_pre/proposal_SWD.html#introduction-and-background",
    "title": "Exploring solar wind discontinuity properties in the inner and outer heliosphere",
    "section": "Introduction and Background",
    "text": "Introduction and Background\nSolar wind magnetic discontinuities, characterized by rapid variations in interplanetary magnetic fields, are pivotal in understanding key phenomena in heliophysics. These discontinuities, manifesting as localized transient rotations or jumps in the magnetic field, is one of the first discoveries in solar wind investigations (Colburn and Sonett 1966). Theoretical models suggest that the formation and destruction of discontinuities are closely related to the nonlinear dynamics of Alfvén waves. These nonlinear processes can create significant isolated disturbances to the otherwise adiabatic evolution of the solar wind flow.\nThese discontinuities change the local direction of the interplanetary magnetic field (deviating from the average Parker spiral) and contribute significantly to the magnetic fluctuation spectrum (Borovsky 2010). They harbor kinetic-scale structures with intense currents, which act as a source of free energy for plasma waves and instabilities, leading to energy dissipation(Dmitruk, Matthaeus, and Seenu 2004; macbrideTurbulentCascadeAU2008?; Osman et al. 2012; Tessein et al. 2013). Their formation, evolution, and destruction are believed to be closely related to solar wind heating and acceleration via magnetic reconnection (Dmitruk, Matthaeus, and Seenu 2004) or nonlinear wave-wave and wave-particle interaction (Medvedev et al. 1997). Moreover, discontinuities are coherent structures in turbulent solar wind and have a nontrivial influence (distinct from random fluctuations) on energetic particles whose gyroradius is comparable to the thickness of the discontinuity (Malara, Perri, and Zimbardo 2021). Recent investigatation of the nonfluid (kinetic) properties of solar wind discontinuities (Artemyev et al. 2019) reveals that electron density and temperature vary significantly across these discontinuities, underlining the importance of kinetic effects in discontinuity structure.\nUnderstanding the dynamics of solar wind discontinuities is essential for elucidating the fundamental processes that govern the solar wind’s evolution as it travels through the heliosphere. As such, this study aims to address the key question:\n“How do discontinuities evolve over radial distances from the Sun and what are the physical mechanisms behind their formation and evolution?”\nBy leveraging data from missions such as PSP and Juno, this research will generate a comprehensive dataset of discontinuity configurations and investigate their spatial and temporal evolution. These statistics will aid in modeling processes like ion scattering by coherent structures and elucidate their roles in solar wind heating and particle acceleration.\n\nPrevious Studies and Context\nSpacecraft investigations of the space plasma environment have revealed that the solar wind magnetic field follows the Parker model of the heliospheric current sheet only on average. Localized transient currents, that can be significantly more intense than the model currents, are carried by various discontinuities observed as strong variations in magnetic field components (Colburn and Sonett 1966; Burlaga 1968; Turner and Siscoe 1971). Most often such variations are manifested as magnetic fieild rotations within the plane of two most fluctuating components.\n\nFurther advancements were made with data from the Helios-1, Helios-2, Ulysses and Voyager missions, which explored discontinuities in three-dimensional space, revealing their prevalence and importance throughout the heliosphere (Mariani, Bavassano, and Villante 1983; Tsurutani et al. 1997). As illustrated in Figure 1, these discontinuities are observed at a multitude of radial distances from the Sun. These findings underscored the need to understand the origin of discontinuities, which are thought to arise from dynamic processes on the Sun, including solar flares and coronal mass ejections, as well as through in-situ processes like local magnetic turbulence, magnetic reconnection and nonlinear wave interactions within the solar wind.\n\n\n\n\n\n\nFigure 1: Distribution of occurrence rate of solar wind discontinuities (Söding et al. 2001).\n\n\n\n\n\nThe Role of Alfven wave and kinetic effects in the discontinuities\nUlysses measurements of the high-latitude solar wind at \\(1-5\\) AU showed that the majority of discontinuities resided within the stream-stream interaction regions and/or within Alfvén wave trains (Tsurutani et al. 1995; Tsurutani and Ho 1999). The nonlinear evolution of Alfvén waves (wave steepening) can be the main cause of such discontinuities. The background plasma/magnetic field inhomogeneities and various dissipative processes are key to Alfvén wave nonlinear evolution . In hybrid simulations and analytical models , this steepening was shown to cause formation of discontinuities in configurations resembling the near-Earth observations. There are models predicting discontinuity formation and destruction due to dissipative processes (e.g., Alfvén wave steepening, magnetic reconnection) in the solar wind. However, the efficiency of these processes in realistic expanding solar wind was not yet tested against observations.\nMore recently, utilizing high-resolution plasma measurements from ARTEMIS and MMS missions, Artemyev et al. (2019) showed that discontinuities have kinetic characteristics for both tangential and rotational discontinuities: fluxes of electrons of different energies vary differently across these discontinuities. This discoveries revealed the importance of ion and electron kinetics to discontinuity structure.\n\n\nCurrent Gaps in Understanding\nPrevious observations of solar wind discontinuities in the outer heliosphere were rarely in conjunction with measurements closer to the Sun. Thus it is presently unclear whether the observed changes in their frequency and properties are due to variations in the solar plasma state resulting from solar variability, such as the solar magnetic activity cycle, or whether these changes are a natural outcome of the discontinuities’ propagation and interaction with the ambient solar wind.\nRegular and long-lasting Juno (2011-2016) and PSP (2019-now) observations together with almost permanent near-Earth solar wind monitoring provide a unique opportunity to examine the discontinuity characteristics at two radial distances simultaneously in the context of both the inner and in the outer heliosphere over an large radial distance range (\\(\\sim 0.1\\) AU - \\(\\sim 5\\) AU). We will determine the discontinuity occurrence rates and properties for various radial distances and compare these results with the prediction of the adiabatic expansion model, to understand if discontinuity formation or destruction dominate the statistics of discontinuities far away from the solar wind acceleration region.\nThis research seeks to address these gaps by leveraging recent advancements in observational capabilities and numerical modeling to provide a comprehensive examination of solar wind discontinuities."
  },
  {
    "objectID": "docs/blog/phd/2024_pre/proposal_SWD.html#methodology",
    "href": "docs/blog/phd/2024_pre/proposal_SWD.html#methodology",
    "title": "Exploring solar wind discontinuity properties in the inner and outer heliosphere",
    "section": "Methodology",
    "text": "Methodology\nData Collection and Model:\nParker Solar Probe and Juno provide high-resolution magnetic field and plasma data from the inner heliosphere to beyond 1 AU. The PSP’s close passes to the Sun offer unique insights into the nascent solar wind, while Juno’s trajectory up to Jupiter allows for studying the evolution of solar wind structures as they propagate outward.\nThe solar wind plasma state, as evidenced by the sunspot number (referenced in Figure 2), plays a crucial role in understanding the dynamics of discontinuities. During the initial phase of the JUNO mission, the sunspot number reached its peak, indicating a period of heightened solar activity. However, by the end of the mission’s cruise phase, there was a significant decline in solar activity. This variation underscores the importance of calibrating the discontinuity properties in relation to solar activity levels to account for temporal fluctuations.\nFurther analysis of Figure 2 highlights the significance of the heliographic longitudinal difference between the Juno mission and Earth as well as the STEREO-A mission. Specifically, when there is a substantial longitudinal difference between Juno and Earth, the difference between Juno and STEREO-A tends to be minimal, and vice versa. This longitudinal discrepancy between Earth and STEREO-A ensures comprehensive coverage of the plasma en route to Juno.\n\n\n\n\n\n\nFigure 2: Overview. a, Juno orbit during its cruise phase (2011-2016). b, Difference of heliographic longitude of Juno and 1-AU missions. c, monthly and smoothed sunspot number. d-g, Near-Earth (OMNI) and STEREO-A solar wind plasma density and speed.\n\n\n\nDatasets from missions such as STEREO, ARTEMIS, and WIND will complement observations from PSP and Juno, offering a broader contextual perspective on heliospheric conditions and enabling a multi-point analysis of discontinuity properties (Velli et al. 2020). The table below summarizes the time resolution of magnetic field and plasma data for PSP, Juno, Wind, ARTEMIS, and STEREO. However, since Juno does not provide direct plasma measurements, we will estimate the spatial scale (thickness) of discontinuities using solar wind speed derived from solar wind propagation models. Specifically, we will employ the Two-Dimensional Outer Heliosphere Solar Wind Modeling (MSWIM2D) (Keebler et al. 2022) to determine the ion bulk velocity (\\(v\\)) and plasma density (\\(n\\)) at Juno’s location. This model, which utilizes the BATSRUS MHD solver, simulates the propagation of solar wind from 1 to 75 astronomical units (AU) in the ecliptic plane, effectively covering the region pertinent to our study. The MSWIM2D model provides output data with an hourly time resolution as shown in Figure 6. The comparison of magnetic field magnitudes from MSWIM2D with those measured by Juno, after averaging to the same time resolution, reveals a strong correlation, confirming the model’s reliability.\n\n\n\nMission\nδt(B)\nδt(plasma)\n\n\n\n\nParker Solar Probe\n~200 Hz\n0.25-1 Hz\n\n\nJuno\n1 Hz\n1 hour\n\n\nARTEMIS\n5 Hz\n0.25 Hz\n\n\nWIND\n11 Hz\n1 Hz\n\n\nSTEREO\n8 Hz\n1 min\n\n\n\nDiscontinuity Identification and Analysis:\nThis first step in understanding the evolution of solar wind discontinuities involves identifying and characterizing these structures. We will adopt Liu’s method (Liu et al. 2022) for this purpose, as it demonstrates better compatibility with discontinuities exhibiting minor field changes and is more robust to the situation encountered in the outer heliosphere.\nSubsequently, for each identified discontinuity, we calculate the distance matrix of the time series sequence (the distance between each pair of magnetic field vectors) to ascertain its leading and trailing edges.\nAfter that, we will utilize the minimum or maximum variance analysis (MVA) analysis (Bengt U. Ö. Sonnerup and Scheible 1998; B. U. Ö. Sonnerup and Cahill Jr. 1967) to determine the main (most varying) magnetic field component, \\(B_l\\), and medium variation component, \\(B_m\\).\nThe magnetic field component along the maximum variance direction is then fitted by a step-like functions to extract the parameters (we used logistic function here \\(B(t; A, \\mu, \\sigma, {\\mathrm{form=logistic}}) = A \\left[1 - \\frac{1}{1 + e^{\\alpha}} \\right]\\), where \\(\\alpha = (t - \\mu)/{\\sigma}\\)).\nWhile previous studies (Vasko et al. 2021, 2022), typically using data from a single spacecraft, often calculate current intensity by taking the derivative of the time series, our study must account for the varying time resolutions of different spacecraft. To address this, we fit the data to achieve a more precise representation of the peak current density, \\(J_m = - \\frac{1}{\\mu_0 V_n} \\frac{d B_m}{d t}\\), thereby minimizing the impact of time resolution discrepancies.\nExamples of solar wind discontinuities detected by various spacecraft are illustrated in Figure 3.\n\n\n\n\n\n\nFigure 3: Discontinuities detected by PSP, Juno, STEREO and near-Earth ARTEMIS satellite: red, blue, and black lines are \\(B_l\\), \\(B_m\\), and \\(|{\\mathbf B}|\\).\n\n\n\n\nProposed Approach:\nTwo promising approaches are proposed for studying the evolution of solar wind discontinuities:\n1. Conjunction Events Analysis: This approach involves studying instances where spacecraft are either simultaneously aligned along the same spiral field line, thus measuring solar wind emanating from the same solar surface region, or positioned to measure the same solar wind plasma (Velli et al. 2020). The latter alignment is determined by the difference in radial distance, \\(\\delta R\\), corresponding to the solar wind travel time, \\(\\tau = \\delta R / V_{sw}\\).\nAn example demonstrating this approach is presented in Figure 4, showcasing similar trends in magnetic field magnitude, plasma density, velocity, and temperature observed by the Parker Solar Probe (PSP) and the Advanced Composition Explorer (ACE) during an alignment period in April 2019. Validation is further supported by utilizing the statistical plasma expansion model (Perrone et al. 2019), where the plasma properties measured by PSP and projected to the ACE location exhibit good agreement with actual ACE measurements, as depicted in Figure 7. This confirms the validity of the alignment approach for studying solar wind discontinuities.\n2. Comparative Analysis: This approach leverages extensive data collected over the years to compare solar wind discontinuities observed by different spacecraft at various radial distances. Due to the Sun’s rapid rotation, solar wind plasma emitted from a single region on the solar surface sweeps across the entire heliosphere within a solar rotation period of 27 days. By utilizing solar wind measurements at 1 AU from STEREO, ARTEMIS, and WIND, and comparing these with data from Juno and PSP, it is possible to distinguish between the effects of temporal variations in solar wind and those due to spatial variations (associated with radial distance from the Sun) in the occurrence rate and characteristics of discontinuities. An example of such a comparison for the occurrence rate is depicted in Figure 5, where the number of discontinuities measured per day by different spacecraft missions is plotted.\n\n\n\n\n\n\nFigure 4: Measurement by PSP and ACE spacecrafts from 2019-04-06 to 2019-04-10. From top to bottom: (a) Magnetic field magnitude measured (b) Plasma density, (c) Plasma velocity, (d) Plasma temperature.\n\n\n\nIn the proposed study, we will expand this comparison to include the properties of discontinuities, such as thickness, strength (current density), and orientation.\nThis extension will enable us to grasp how these features evolve with radial distance from the Sun and how they relate to the local plasma properties. Examining these properties is crucial for understanding the generation of discontinuities.\nBorovsky (2008) argued that solar wind discontinuities act as static boundaries between flux tubes originating at the solar surface and they are convected passively from the source regions. However, Greco et al. (2009), by examining the waiting time distribution of magnetic ﬁeld increments, discovered a good agreement between between MHD simulations and observations. This finding suggests that discontinuities stem from intermittent MHD turbulence, indicating local generation.\nIf turbulence theory holds true, discontinuities properties should align with local plasma parameters; conversely, if propagation theory is accurate, discontinuities properties should be consistent with solar wind expansion model. Studying these properties will provide insights into the physical mechanisms governing discontinuity formation and spatial evolution as solar wind propagates through the heliosphere.\n\n\n\n\n\n\nFigure 5: The number of discontinuities measured by Juno per day coincides with the discontinuity number measured by STEREO, WIND, and ARTEMIS, when Juno is around \\(1\\) AU. This number (occurrence rate) decreases with distance (with time after \\(\\sim 2013\\)), as Juno moves from \\(1\\) AU to \\(5\\) AU. We will use the similar comparison for discontinuity characteristics and occurrence rate derived for PSP and Juno."
  },
  {
    "objectID": "docs/blog/phd/2024_pre/proposal_SWD.html#summary",
    "href": "docs/blog/phd/2024_pre/proposal_SWD.html#summary",
    "title": "Exploring solar wind discontinuity properties in the inner and outer heliosphere",
    "section": "Summary",
    "text": "Summary\nThis research project adopts a comprehensive approach to unravel the complex characteristics of solar wind discontinuities, seeking to shed light on their fundamental characteristics. By utilizing big data from multiple spacecraft missions throughout the heliosphere, we aim to examine the temporal variations in these properties driven by solar activity, as well as the spatial variations influenced by radial distance from the Sun. Our goal is to infer the intricate processes governing the evolution of magnetic discontinuities, a key component of magnetic field turbulence and a crucial interface for charged particle acceleration."
  },
  {
    "objectID": "docs/blog/phd/2024_pre/proposal_SWD.html#figures",
    "href": "docs/blog/phd/2024_pre/proposal_SWD.html#figures",
    "title": "Exploring solar wind discontinuity properties in the inner and outer heliosphere",
    "section": "Figures",
    "text": "Figures\n\n\n\n\n\n\nFigure 6: a, Magnetic field magnitude from MSWIM2D and Juno. b-c, Plasma speed and density from MSWIM2D model. d, Juno radial distance from the Sun.\n\n\n\n\n\n\n\n\n\nFigure 7: Plasma properties (plasma beta versus plasma speed normalized by Alfven speed) measured by PSP projected to the ACE location using the statistical plasma expansion model. Top panel shows the data from the candidate alignment period (2019-04-06 to 2019-04-07) and the bottom panel shows the data after the alignment period."
  },
  {
    "objectID": "docs/blog/phd/2024_pre/proposal_EMIC.html#analysis-approach",
    "href": "docs/blog/phd/2024_pre/proposal_EMIC.html#analysis-approach",
    "title": "Relative role of EMIC waves, chorus waves, and electron injections on relativistic electron flux",
    "section": "Analysis Approach",
    "text": "Analysis Approach\nFirst, we will identify specific events during which intense EMIC wave activity coincides with significant changes in electron fluxes. These events will be used as case studies to analyze the interaction mechanisms in detail, employing cross-spectral analysis to examine the coherence between EMIC waves and electron flux oscillations.\n\n\n\n\n\n\nFigure 2: Two ELFIN CubeSats observations of EMIC wave-driven electron precipitation, where the precipitating flux reaches the trapped flux in high-energy channels, over an interval exceeding three hours, from 02:42 to 05:53 UT. The locations are projected to the equatorial L-Shell and MLT, using the Tsyganenko89 magnetic field model. Panels (a), (b), and (d) show data from ELFIN-B, while panel (c) features observations from ELFIN-A.\n\n\n\nFigure 2 (adapted from Fig 5 of Angelopoulos et al. (2023)) shows a clear example of the EMIC wave-driven electron precipitation observed by ELFIN CubeSats. We observe a high precipitating-to-trapped flux ratio \\(j_{prec}/j_{trap}\\) during four ELFIN orbits.\nWithin \\(L \\in [5,6]\\) there is a peak of precipitating-to-trapped flux ratio above \\(300\\) keV. This peak moves from \\(L \\sim 6\\) around 02:45 UT to \\(L \\sim 5\\) at 05:15 UT. Only EMIC wave-driven precipitation may have a low-energy cut-off of scattering fluxes around \\(\\sim 500\\) keV, which is a typical minimum resonance energy for EMIC waves (see the identification of other EMIC wave-driven precipitation events with similar precipitating-to-trapped ratios in An et al. 2022; Angelopoulos et al. 2023). Note that the efficient precipitation (large \\(j_{prec}/j_{trap}\\)) observed at \\(L&gt;6.5\\) is likely due to a combination of whistler-mode wave-driven precipitation (Shi et al. 2022) and precipitation due to the curvature scattering (Wilkins et al. 2023), while precipitation of \\(&lt;300\\) keV electrons at \\(L&lt;5\\) is driven by whistler-mode wave scattering (see similar examples of quasi-periodical precipitation on the dusk flank in Artemyev et al. 2021).\nTherefore, Figure 2 demonstrates that during at least three hours, ELFIN observed continuous EMIC wave-driven losses of relativistic electrons. As \\(j_{prec}/j_{trap}\\) for \\(\\sim\\) 0.3–1 MeV electrons reaches one, the strong diffusion regime, one may expect a significant depletion of equatorial electron flux in this energy range, at least at low pitch-angles.\nTo further confirm the role of EMIC waves in driving electron precipitation, we will utilize phase space density calculations and quasi-linear theory to analyze how EMIC waves scatter radiation belt electrons into the loss cone, leading to precipitation. By quantifying the diffusion coefficients, we can better understand the rate and extent of changes in electron flux.\nIn the limit of near-equilibrium of the electron distribution near the loss-cone (Kennel and Petschek 1966) the average precipitating electron flux measured within the loss-cone by ELFIN CubeSats at low altitude, \\(j_{prec}\\), can be expressed as a function of the trapped flux measured at an equatorial pitch-angle \\(5\\)% above the loss-cone angle \\(\\alpha_{LC}\\), denoted \\(j_{trap}\\) (Mourenas et al. 2023). In the ELFIN data products, \\(j_{prec}\\) is averaged over the loss cone weighted by solid angle, giving \\(j_{prec}/j_{trap}\\approx 1.3/(z_0+z_0^2/200)\\) with \\(z_0=2\\alpha_{LC}/(\\tau_B D_{\\alpha\\alpha})^{1/2}\\) and \\(\\tau_B\\) the electron bounce period, valid for \\(j_{prec}/j_{trap}\\in[0.001,0.85]\\).\nAccordingly, \\(D_{\\alpha\\alpha}\\) at \\(\\alpha_0=\\alpha_{LC}\\) can be inferred from the measured ratio \\(j_{prec}/j_{trap}\\) at ELFIN, giving \\(D_{\\alpha\\alpha} \\approx \\frac{{\\alpha_{LC}^2}}{{2500\\, \\tau_B }} \\left(\\sqrt{1+ \\frac{{ j_{trap} }}{{ 38.5\\, j_{prec} }} } -1 \\right)^{-2}\\).\nThe diffusion rates \\(D_{\\alpha\\alpha}\\) inferred, using the above Equation, from time-averaged ELFIN measurements of precipitating and trapped electron fluxes are displayed in Figure 3 for different electron energies and different \\(L\\). In the noon-dusk sector of the plasmaspheric plume, despite the theoretical impossibility of cyclotron resonance between 0.5-2 MeV electrons and typical EMIC wave frequencies, observed electron precipitation at these energies continues, particularly for low-energy electrons via scattering with high-frequency, low-amplitude H-band EMIC waves.\nThese results suggest the presence of duskside EMIC wave bursts with peak amplitudes \\(B_w\\approx 0.5\\) nT and a low-amplitude component at frequencies above those of peak-amplitude.\nThis estimate of electron lifetime by EMIC waves is based on analytical quasi-linear diffusion theory with realistic wave and plasma parameters, which allows us to simplify the dispersion relation and the diffusion coefficients. However, in general, quasi-linear diffusion by EMIC waves alone cannot lead to strong and fast dropouts of 2–6 MeV electrons up to high pitch angles, as there is no cyclotron resonance between these electrons and EMIC waves above the maximum resonance pitch angle \\(\\alpha_{0,\\max}\\). This prevents the majority of the electron population from being scattered toward the loss cone, except if the bottleneck in the bounce-averaged pitch angle diffusion rate \\(D_{\\alpha\\alpha}(\\text{EMIC})\\) at high \\(\\alpha_0\\) can be filled by other kinds of waves. Therefore, in the proposed study, we will extend the quasi-linear diffusion analysis to chorus waves and further investigate the combined effects of EMIC and chorus waves on radiation belt electrons. By utilizing the observed wave properties with the aid of theoretical predictions, we aim to elucidate the underlying mechanisms that drive electron dynamics during storm-time events."
  },
  {
    "objectID": "docs/blog/phd/2024_pre/index.html",
    "href": "docs/blog/phd/2024_pre/index.html",
    "title": "beforerr",
    "section": "",
    "text": "EMIC Proposal\nSolar wind discontinuity Proposal"
  },
  {
    "objectID": "docs/blog/2024_NASA_summer_school/index.html#the-physics-of-heliophysics---tom-bogdan",
    "href": "docs/blog/2024_NASA_summer_school/index.html#the-physics-of-heliophysics---tom-bogdan",
    "title": "Lecture Notes",
    "section": "",
    "text": "Symmetry\nConservations\nComoving frame vs Lab frame\nEvaluate interactions in the comoving frame\n\nRadiation and isotropy"
  },
  {
    "objectID": "docs/blog/2024_NASA_summer_school/index.html#the-physics-of-heliophysics---marco-velli",
    "href": "docs/blog/2024_NASA_summer_school/index.html#the-physics-of-heliophysics---marco-velli",
    "title": "Lecture Notes",
    "section": "",
    "text": "“Far out in the uncharted backwaters of the unfashionable end of the western spiral arm of the Galaxy lies a small unregarded yellow sun.” - Douglas Adams\nOn the importance of being Magnetic\n“… a sunspot is a vortex, in which electrified”\nSunspot rush towards the poles\nSheely 2013, Cornoal Cells to infer the magnetic field structure and chirallity of filament channels\nPlasma is different\n\nCollision, faster particle collide less and can be accelerated more easily\n\nInverse Robin Hood D.T. Runaway is possible\n\n\ncometary ion tail\nWarped heliospheric current sheet is limited in space and time (1Au and further)\nYou can treat everything as a fluid as long as you find a way to close the system with proper equations of state"
  },
  {
    "objectID": "docs/courses/astr145/homework/ps1.html",
    "href": "docs/courses/astr145/homework/ps1.html",
    "title": "Problem Set 1",
    "section": "",
    "text": "Code\nfrom math import pi\nfrom astropy.constants import G, c, M_sun, g0\nimport astropy.units as u\n\ndef schwarzschild_radius(M):\n    \"\"\"Schwarzschild radius\"\"\"\n    return (2 * G * M) / (c ** 2)",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 1"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps1.html#high-energy-photons",
    "href": "docs/courses/astr145/homework/ps1.html#high-energy-photons",
    "title": "Problem Set 1",
    "section": "1 High-Energy Photons",
    "text": "1 High-Energy Photons\n\nConsider a quasar with an X-ray luminosity of \\(L_X = 10^{43} erg s^{−1}\\) that is situated 10 Gpc from Earth. If the typical photon has an energy of 1 keV, what is the flux of photons from this source observed at Earth, in units of photons \\(cm^{−2} s^{−1}\\)? The Chandra telescope has a collecting area of \\(0.04 m^2\\). How long must Chandra observe this source in order to collect 10 photons? Express your answer in hours.\n\nNow consider a blazar with \\(Lγ = 10^{45} erg s^{−1}\\) that is situated 0.5 Gpc from Earth. If the typical photon has an energy of 10 GeV, what is the flux of photons from this source observed at Earth, in units of photons \\(cm^{−2} s^{−1}\\)? The Fermi telescope has a collecting area of ∼ 8000 cm2. How long must Fermi observe this source in order to collect 10 photons?\n\n\nThe code for the calculations is as follows:\n\n\nCode\ndef energy_flux(L, d):\n    \"\"\"Energy flux\"\"\"\n    return L / (4 * pi * d ** 2)\n\ndef photon_flux(F, E):\n    \"\"\"Photon flux\"\"\"\n    f_p = F / E.to(u.erg)\n    return f_p.to(1 / u.cm ** 2 / u.s)\n\n# Part (a): Quasar\nL_X = 1e43 * u.erg / u.s  # X-ray luminosity of the quasar\nd = 10 * u.Gpc  # Distance from Earth in Gpc\nE = 1 * u.keV  # Photon energy in keV\nA = 0.04 * u.m ** 2  # Collecting area of the Chandra telescope\n\nF_energy = energy_flux(L_X, d)\nF_photon = photon_flux(F_energy, E)\nrate = F_photon * A\nt = 10 / rate\nprint(f\"Part (a):\")\nprint(f\"Photon Flux: {F_photon:.2e}\")\nprint(f\"Time to Collect 10 Photons: {t.to(u.hour):.2f}\\n\")\n\n# Part (b): Blazar\nL_gamma = 1e45 * u.erg / u.s  # Gamma-ray luminosity of the blazar\nd = 0.5 * u.Gpc  # Distance from Earth in Gpc\nE = 10 * u.GeV  # Photon energy in GeV\nA = 8000 * u.cm ** 2  # Collecting area of the Fermi telescope\n\nF_energy = energy_flux(L_gamma, d)\nF_photon = photon_flux(F_energy, E)\nrate = F_photon * A\nt = 10 / rate\nprint(f\"Part (b):\")\nprint(f\"Photon Flux: {F_photon:.2e}\")\nprint(f\"Time to Collect 10 Photons: {t.to(u.hour):.2f}\")\n\n\nPart (a):\nPhoton Flux: 5.22e-07 1 / (s cm2)\nTime to Collect 10 Photons: 13.31 h\n\nPart (b):\nPhoton Flux: 2.09e-09 1 / (s cm2)\nTime to Collect 10 Photons: 166.41 h\n\n\n\n\n1.1 Quasar\nEnergy Flux (\\(F_{\\text{energy}}\\)) is given by:\n\\[\nF_{\\text{energy}} = \\frac{L_X}{4\\pi d^2} = \\frac{10^{43} \\, \\text{erg/s}}{4\\pi (10 Gpc)^2} \\approx 8.37 \\times 10^{-16} \\, \\text{erg/cm}^2\\text{/s}\n\\]\nConvert Photon Energy to Ergs:\n\\[\n1 \\, \\text{keV} = 1.602 \\times 10^{-9} \\, \\text{erg}\n\\]\nPhoton Flux (\\(F_{\\text{photon}}\\)) is given by:\n\\[\nF_{\\text{photon}} = \\frac{F_{\\text{energy}}}{E} \\approx 5.22 \\times 10^{-7} \\, \\text{photons/cm}^2\\text{/s}\n\\]\nRate of Photons Collected:\n\\[\nR = F_{\\text{photon}} \\times A\n\\]\nTime to Collect 10 Photons\n\\[\nt = \\frac{N}{R} = \\frac{10 \\, \\text{photons}}{R} \\approx 13.3 \\, \\text{hours}\n\\]\n\n\n\n1.2 Blazar\n\\[\nF_{\\text{photon}} = \\frac{F_{\\text{energy}}}{E}\n\\]\nPlugging in the values:\n\\[\nF_{\\text{photon}} = \\frac{F_{\\text{energy}}}{E} \\approx 2.089 \\times 10^{-9} \\, \\text{photons/cm}^2\\text{/s}\n\\]\n\\[\nt = \\frac{N}{R} \\approx 166 \\, \\text{hours}\n\\]",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 1"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps1.html#gravitational-frequency-shift",
    "href": "docs/courses/astr145/homework/ps1.html#gravitational-frequency-shift",
    "title": "Problem Set 1",
    "section": "2 Gravitational Frequency Shift",
    "text": "2 Gravitational Frequency Shift\nSuppose you are standing in your “laboratory,” a steel box of height l. The laboratory is sitting on the Earth, so you and everything in it feel a downward gravitational acceleration of magnitude \\(g = 10 m s^{−2}\\) (don’t use the numerical value in this problem, just call it g).\n\nIf you drop a ball from rest at the top of the box, it hits the bottom after a time \\(t\\), where \\(g t^2/2 = l\\). Show that its kinetic energy at the bottom of the box is \\(E_b = m l g\\).\nYour friend is in a similar laboratory in space, far enough away from the Earth that its gravity is negligible. She has attached a laser to the ceiling of her laboratory, pointing down towards a light detector on the floor. The laser emits photons that have frequency νt. The detector at the bottom can measure the frequency (and hence the color) of photons that it receives. If the laboratory were floating freely in space, then the frequency of the photons received at the bottom would be νb = νt. How long does it take photons to go from the top of the box to the bottom? (Give an equation for the time tb in terms of l and c.)\n\nNow suppose that your friend’s laboratory is not floating freely but is being towed by a rocket that is accelerating upwards (in the frame of your friend) with acceleration a = 10 m s−2. By the time the light reaches the bottom, therefore, the box is moving upwards with a speed vbox = at. What is the frequency νb of photons measured by a detector bolted to the floor at the bottom of the box? (Give a formula expressing \\(ν_b\\) in terms of νt, a, l, and c.) Are the photons at the bottom bluer or redder than those emitted at the top? Hint: You can assume that the travel time is the same as in (b) so long as \\(v_{box}&lt;&lt;c\\).\n\nRemember that the energy of a photon with frequency ν is E = hν. Show that the photons received at the bottom of the box have greater energy than those emitted at the top of the box by an amount ≈ Et × (al/c2).\n\nYou install an identical laser and light detector in your laboratory on the earth. The laser again emits photons with frequency νt. Apply the equivalence principle discussed in class to answer the following questions: (i) Are the photons received at the bottom bluer, redder, or the same color as those emitted at the top? (ii) Do photons gain energy, lose energy, or keep the same energy as they fall through the box? (iii) What is the amount of energy that a photon gains or loses as it falls through the box? (If the energy doesn’t change, answer zero.) Explain (briefly) the reasoning behind your answers.\nCompare your answers to part (e) and part (a). What does this comparison suggest?\n\n\n\n2.1 Kinetic Energy\n\\[\nl = \\frac{1}{2}gt^2\n\\implies\nt = \\sqrt{\\frac{2l}{g}}\n\\]\n\\[\nv = gt = g \\sqrt{\\frac{2l}{g}} = \\sqrt{2gl}\n\\]\n\\[\n\\implies\nE_b = \\frac{1}{2}mv^2 = \\frac{1}{2}m(2gl) = m g l\n\\]\n\n\n\n2.2 Traverse Time\n\\[\nt_b = \\frac{l}{c}\n\\]\n\n\n\n2.3 Frequency Shift\n\\[\n\\nu_b = \\nu_t \\left(1 + \\frac{v_{\\text{box}}}{c}\\right)\n\\]\nAssume that the travel time is the same\n\\[\nv_{\\text{box}} = at = a \\left(\\frac{l}{c}\\right)\n\\]\n\\[\n\\implies\n\\nu_b = \\nu_t \\left(1 + \\frac{a l}{c^2}\\right)\n\\]\nThe photons received at the bottom are bluer than those emitted at the top.\n\n\n\n2.4 Energy Difference\n\\[\nE_b = h\\nu_b = h\\nu_t \\left(1 + \\frac{a l}{c^2}\\right) = E_t \\left(1 + \\frac{a l}{c^2}\\right)\n\\]\n\\[\n\\implies\n\\Delta E = E_b - E_t = E_t \\left(\\frac{a l}{c^2}\\right)\n\\]\n\n\n\n2.5 Equivalence Principle\nAccording to the equivalence principle, being in a gravitational field is equivalent to being in an accelerated frame. Thus, photons climbing down a gravitational well gain energy, appearing bluer at the bottom.\n\\[\n\\Delta E \\approx E_t \\left(\\frac{g l}{c^2}\\right)\n\\]\n\n\n\n2.6 Comparison Between Parts (a) and (e)\nkinetic energy gained by the ball is \\(E_b = mgl\\)\nphotons gain energy \\(\\Delta E \\approx E_t \\left(\\frac{g l}{c^2}\\right)\\)\nImplications: The energy gained by both the ball and the photons is proportional to \\(g l\\), suggests that gravitational effects are universally applicable. Also consider if the energy gained is equivalent for both the ball and the photons \\(E_b = \\Delta E\\), this implies that \\(m = E_t/c^2\\), similar to the mass-energy equivalence.",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 1"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps1.html#black-hole-masses",
    "href": "docs/courses/astr145/homework/ps1.html#black-hole-masses",
    "title": "Problem Set 1",
    "section": "3 Black Hole Masses",
    "text": "3 Black Hole Masses\nThe gravitational effects of a spherical object with mass M and radius R, are identical to those of a point mass with the same mass M for any radius r &gt; R. Therefore, although all the mass of a black hole is concentrated at the singularity, it is sometimes useful to calculate an “effective” density by spreading its mass uniformly within the Schwarzschild radius.\n\nEstimate the effective density of a stellar-mass black hole with \\(M = 10 M_\\odot\\). Can you find anything on Earth with comparable density to this black hole?\nEstimate the effective average density of a supermassive black hole with \\(M =  10^8 M_\\odot\\) solar masses. Can you find anything on Earth with comparable density to this black hole?\nBased on these densities, do you think it is easier to propose alternative theories to stellar mass or supermassive black holes?\n\n\nThe code for the calculations is as follows:\n\n\nCode\ndef volume(r):\n    \"\"\"Volume of a sphere with radius r\"\"\"\n    return (4/3) * pi * r ** 3\n\ndef density(M, r):\n    \"\"\"Effective density of a black hole\"\"\"\n    return M / volume(r)\n\ndef bh_density(M):\n    \"\"\"Effective density of a black hole\"\"\"\n    R_s = schwarzschild_radius(M)\n    return density(M, R_s).to(u.g / u.cm ** 3)\n\n\n# Part (a): Stellar-mass black hole\nM_stellar = 10  * M_sun # Stellar-mass black hole: 10 solar masses\nprint(f\"Effective Density of a Stellar-Mass Black Hole ({M_stellar} M_sun):\")\nprint(f\"Approximate Density: {bh_density(M_stellar):.2e}\\n\")\n\n# Part (b): Supermassive black hole\nM_supermassive = 1e8 * M_sun  # Supermassive black hole: 10^8 solar masses\nprint(f\"Effective Density of a Supermassive Black Hole ({M_supermassive:.0e} M_sun):\")\nprint(f\"Approximate Density: {bh_density(M_supermassive):.2e}\\n\")\n\n\nEffective Density of a Stellar-Mass Black Hole (1.988409870698051e+31 kg M_sun):\nApproximate Density: 1.84e+14 g / cm3\n\nEffective Density of a Supermassive Black Hole (2e+38 kg M_sun):\nApproximate Density: 1.84e+00 g / cm3\n\n\n\n\n3.1 Effective Density of a Stellar-Mass Black Hole\nSchwarzschild Radius (\\(R_s\\)) is given by:\n\\[\nR_s = \\frac{2GM}{c^2}\n\\]\nSo the effective density (\\(\\rho\\)) is:\n\\[\n\\rho = \\frac{M}{\\frac{4}{3} \\pi R_s^3} = \\frac{M}{\\frac{4}{3} \\pi \\left(\\frac{2GM}{c^2}\\right)^3} = \\frac{3c^6}{32\\pi G^3 M^2}\n\\]\nSubstituting the given values:\n\\[\n\\rho \\approx 1.84 \\times 10^{14} \\, \\text{g/cm}^3\n\\]\nGiven the average density of Earth is \\(\\approx 5.5 \\, \\text{g/cm}^3\\), no known materials on Earth have densities comparable to \\(10^{14} \\, \\text{g/cm}^3\\). The effective density of a stellar-mass black hole is astronomically higher than any terrestrial substance.\n\n\n\n3.2 Effective Density of a Supermassive Black Hole\nAfter substituting:\n\\[\n\\rho \\approx 1.84  \\text{g/cm}^3\n\\]\nWith average density of water:** \\(1 \\, \\text{g/cm}^3\\), the effective density of a supermassive black hole is comparable with the density of water on Earth.\n\n\n\n3.3 Implications\nBased on the Calculated Densities:\n\nStellar-Mass Black Holes (\\(\\sim 10^{14} \\, \\text{g/cm}^3\\)):\n\nExtremely High Density: Far exceeds any known material’s density.\nImplications: The lack of comparable densities in any known matter strengthens the case for black holes as the simplest explanation.\n\nSupermassive Black Holes (\\(\\sim 1\\, \\text{g/cm}^3\\)):\n\nLow Effective Density: Comparable to or lower than common materials on Earth.\nImplications: It is easier to propose alternative theories for supermassive black holes due to their low effective densities, which are not as extreme as those of stellar-mass black holes. Alternative explanations (e.g., dark matter concentrations, exotic objects) might be more plausible or easier to conceive.",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 1"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps1.html#spaghetti-fication",
    "href": "docs/courses/astr145/homework/ps1.html#spaghetti-fication",
    "title": "Problem Set 1",
    "section": "4 Spaghetti-fication",
    "text": "4 Spaghetti-fication\nConsider an astronaut with height h = 180 cm approaching a black hole.\n\nShow that the tidal force experienced by the astronaut can be expressed as\n\n\\[\nF_\\text{tidal} = \\frac{2 G M m h}{r^3}\n\\]\nwhere M is the mass of the black hole, m is the mass of the astronaut, and r is the distance between them. Here the tidal force is just the difference between the gravitational force evaluated at the astronaut’s toes and at their head’s – the astronaut would feel this as a pulling across their body. Note that we have assumed \\(h&lt;&lt;r\\) here.\n\nIf the astronaut is approaching a stellar-mass black hole with \\(M = 10 M_\\odot\\), how strong would the acceleration due to this tidal force be when they get to the Schwarzschild adius of the black hole?\nA human body can sustain a maximum acceleration of 9g, where \\(g = 980 cm  s^{−2}\\) is the gravitational acceleration on Earth’s surface. How close, in units of the Schwarzschild radius, could the astronaut get to the black hole without being spaghettified (i.e., stretched into a long, thin strand)?\nNow consider a supermassive black hole with \\(M = 10^6 M_\\odot\\) instead. What is the acceleration due to tidal forces at its Schwarzschild radius? How close, again in units of the Schwarzschild radius, could the astronaut get to this black hole?\n\n\nThe code for the calculations is as follows:\n\n\nCode\nh = 180.0 * u.cm             # Height of astronaut in cm\ng_max = 9 * g0   # Maximum sustainable acceleration\n\ndef tidal_acceleration(M, h, r):\n    \"\"\"tidal acceleration\"\"\"\n    return (2 * G * M * h) / (r ** 3)\n\ndef closest_approach(M, h, a_max):\n    return (2 * G * M * h / a_max) ** (1/3)\n\ndef r_schwarzchild(r, R_s):\n    return (r / R_s).to(u.dimensionless_unscaled)\n\n# Part (b): Tidal acceleration at Schwarzschild radius for a stellar-mass black hole\ndef part_b(M_mass_solar):\n    M = M_mass_solar * M_sun\n    R_s = schwarzschild_radius(M)\n    a_tidal = tidal_acceleration(M, h, R_s)\n    return a_tidal\n\n# Part (c): Closest approach without spaghettification for a stellar-mass black hole\ndef part_c(M_mass_solar):\n    M = M_mass_solar * M_sun\n    R_s = schwarzschild_radius(M)\n    r = closest_approach(M, h, g_max)\n    return r_schwarzchild(r, R_s)\n\n# Part (d): Tidal acceleration and closest approach for a supermassive black hole\ndef part_d(M_mass_solar):\n    M = M_mass_solar * M_sun\n    R_s = schwarzschild_radius(M)\n    a_tidal = tidal_acceleration(M, h, R_s)\n    r = closest_approach(M, h, g_max)\n    return a_tidal, r_schwarzchild(r, R_s)  # (Tidal acceleration, Closest approach in R_s)\n\n# Part (b)\nM_star = 10  # Stellar-mass black hole: 10 solar masses\na_tidal_b = part_b(M_star)\nprint(f\"Part (b):\")\nprint(f\"Acceleration due to tidal forces at Schwarzschild radius for {M_star} M_sun black hole:\")\nprint(f\"a_tidal ≈ {a_tidal_b:.2e}\\n\")\n\n# Part (c)\nclosest_r_b = part_c(M_star)\nprint(f\"Part (c):\")\nprint(f\"Closest approach without spaghettification for {M_star} M_sun black hole:\")\nprint(f\"r ≈ {closest_r_b:.2f} Schwarzschild radii\\n\")\n\n# Part (d)\nM_super = 1e6  # Supermassive black hole: 10^6 solar masses\na_tidal_d, closest_r_d = part_d(M_super)\nprint(f\"Part (d):\")\nprint(f\"Tidal acceleration at Schwarzschild radius for {M_super:.0e} M_sun black hole:\")\nprint(f\"a_tidal ≈ {a_tidal_d:.2e}\")\nprint(f\"Closest approach without spaghettification:\")\nprint(f\"r ≈ {closest_r_d:.2e} Schwarzschild radii\")\n\n\nPart (b):\nAcceleration due to tidal forces at Schwarzschild radius for 10 M_sun black hole:\na_tidal ≈ 1.85e+10 cm / s2\n\nPart (c):\nClosest approach without spaghettification for 10 M_sun black hole:\nr ≈ 128.09 Schwarzschild radii\n\nPart (d):\nTidal acceleration at Schwarzschild radius for 1e+06 M_sun black hole:\na_tidal ≈ 1.85e+00 cm / s2\nClosest approach without spaghettification:\nr ≈ 5.95e-02 Schwarzschild radii\n\n\n\n4.1 Tidal Force\nUsing the approximation \\(h \\ll r\\)\n\\[\nF_{\\text{head}} = \\frac{G M m}{\\left(r - \\frac{h}{2}\\right)^2} \\approx \\frac{G M m}{r^2} \\left(1 + \\frac{h}{r}\\right)\n\\]\n\\[\nF_{\\text{toe}} = \\frac{G M m}{\\left(r + \\frac{h}{2}\\right)^2} \\approx \\frac{G M m}{r^2} \\left(1 - \\frac{h}{r}\\right)\n\\]\nSi the tidal force is:\n\\[\nF_{\\text{tidal}} = F_{\\text{head}} - F_{\\text{toe}} \\approx \\frac{2 G M m h}{r^3}\n\\]\n\n\n\n4.2 Acceleration of Tidal Forces\n\\[\na_{\\text{tidal}} = \\frac{F_{\\text{tidal}}}{m} = \\frac{2 G M h}{R_s^3} = \\frac{2 G M h}{(2 G M / c^2)^3} = \\frac{c^6 h}{4 G^2 M^2}\n\\]\nSubstituting the given values:\n\\[\na_{\\text{tidal}} = 1.86 \\times 10^{10} cm/s²\n\\]\n\n\n\n4.3 Closest Approach Without Spaghettification\nSet \\(a_{\\text{tidal}} = a_{\\text{max}}= 9g\\) :\n\\[\n\\frac{2 G M h}{r^3} = a_{\\text{max}} \\implies r = \\left( \\frac{2 G M h}{a_{\\text{max}}} \\right)^{1/3}\n\\]\nGiven \\(2 G M = R_s c^2\\) :\n\\[\n\\implies r = R_s \\left( \\frac{h c^2}{a_{\\text{max}} R_s^2} \\right)^{1/3}\n\\]\n\\[\n\\frac{r}{R_s} = \\frac{3.78 \\times 10^8}{2.95 \\times 10^6} \\approx 128\n\\]\n\n\n4.4 Supermassive Black Hole\n\\[\na_{\\text{tidal}} \\approx 1.85 cm/s²\n\\]\n\\[\n\\frac{r}{R_s} \\approx 6 \\times 10^{-2}\n\\]",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 1"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps1.html#visualizing-black-holes",
    "href": "docs/courses/astr145/homework/ps1.html#visualizing-black-holes",
    "title": "Problem Set 1",
    "section": "5 Visualizing Black Holes",
    "text": "5 Visualizing Black Holes\n\nWatch this six-minute video demonstrating what you would see if you traveled near a black hole https://youtu.be/JDNZBT_GeqU. Write a short reaction (a paragraph or so) to this video – you could comment on something you learned or particularly enjoyed or pose a question it raised to you, for example.\n\n\nGravitational lensing, where light from surrounding stars bends around the black hole, creating a warped view is so coool. Especially when near the event horizon and orbiting the black hole, the visual distortions are so fascinating. Also it is kind of interesting that why the closest stable orbit is 3 times the Schwarzschild radius.",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 1"
    ]
  },
  {
    "objectID": "docs/projects/index.html",
    "href": "docs/projects/index.html",
    "title": "Projects",
    "section": "",
    "text": "Space data analysis toolbox in Julia\n\n\n\npackage\n\nJulia\n\n\n\n\n\n\n\n\n\nApr 16, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nA Julia package for representing charged particles\n\n\n\npackage\n\nJulia\n\n\n\n\n\n\n\n\n\nFeb 3, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nGenerate multiple method definitions allowing arbitrary argument order based on types\n\n\n\npackage\n\nJulia\n\n\n\n\n\n\n\n\n\nFeb 1, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nA simple Julia wrapper around Speasy to deal with main Space Physics WebServices\n\n\n\npackage\n\nJulia\n\n\n\n\n\n\n\n\n\nFeb 1, 2025\n\n\n\n\n\nNo matching items",
    "crumbs": [
      "Projects"
    ]
  },
  {
    "objectID": "docs/projects/index.html#coding",
    "href": "docs/projects/index.html#coding",
    "title": "Projects",
    "section": "",
    "text": "Space data analysis toolbox in Julia\n\n\n\npackage\n\nJulia\n\n\n\n\n\n\n\n\n\nApr 16, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nA Julia package for representing charged particles\n\n\n\npackage\n\nJulia\n\n\n\n\n\n\n\n\n\nFeb 3, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nGenerate multiple method definitions allowing arbitrary argument order based on types\n\n\n\npackage\n\nJulia\n\n\n\n\n\n\n\n\n\nFeb 1, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nA simple Julia wrapper around Speasy to deal with main Space Physics WebServices\n\n\n\npackage\n\nJulia\n\n\n\n\n\n\n\n\n\nFeb 1, 2025\n\n\n\n\n\nNo matching items",
    "crumbs": [
      "Projects"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps6.html",
    "href": "docs/courses/astr145/homework/ps6.html",
    "title": "Problem Set 6",
    "section": "",
    "text": "Show that the time for an electron to lose half its energy is\n\n\n\nCode\nusing DrWatson\nusing Unitful: Mass, Length\ninclude(srcdir(\"astr145/main.jl\"))\n\n\nescape_velocity (generic function with 1 method)\n\n\n\n\nCode\nusing Unitful: c, q, me, μ0, ϵ0\n\nB_con = sqrt(4π / μ0)\nq_factor = 1 / sqrt(4π * ϵ0)\n\nt_half(B, γ0; m=me) = (3 * m^3 * c^5) / (2 * (q_factor * q)^4 * (B * B_con)^2 * γ0) |&gt; upreferred\nt_half(10u\"μGauss\", 1e6)\n\n\n5.158665568940776e12 s",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 6"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps6.html#synchrotron-cooling",
    "href": "docs/courses/astr145/homework/ps6.html#synchrotron-cooling",
    "title": "Problem Set 6",
    "section": "",
    "text": "Show that the time for an electron to lose half its energy is\n\n\n\nCode\nusing DrWatson\nusing Unitful: Mass, Length\ninclude(srcdir(\"astr145/main.jl\"))\n\n\nescape_velocity (generic function with 1 method)\n\n\n\n\nCode\nusing Unitful: c, q, me, μ0, ϵ0\n\nB_con = sqrt(4π / μ0)\nq_factor = 1 / sqrt(4π * ϵ0)\n\nt_half(B, γ0; m=me) = (3 * m^3 * c^5) / (2 * (q_factor * q)^4 * (B * B_con)^2 * γ0) |&gt; upreferred\nt_half(10u\"μGauss\", 1e6)\n\n\n5.158665568940776e12 s",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 6"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps6.html#compact-objects",
    "href": "docs/courses/astr145/homework/ps6.html#compact-objects",
    "title": "Problem Set 6",
    "section": "2 Compact Objects",
    "text": "2 Compact Objects\n\nWhite dwarfs, neutron stars, and stellar-mass black holes are all compact objects formed at the final stages of stellar evolution. Here, you will compare some of their fundamental properties. Assume typical white dwarfs have M ≈ M_sun and a radius comparable to Earth. For neutron stars, assume M ≈ 2 M_sun and a radius of 10 km.\n\n\n2.1 Escape Velocities\n\nEstimate the escape velocity at the surfaces of white dwarfs and neutron stars, and compare them to that of a black hole.\n\n\n\nCode\nusing UnitfulAstro: Msun, Rearth\n\nM_white_dwarf = 1u\"Msun\"\nM_neutron_star = 2u\"Msun\"\nM_black_hole = 10u\"Msun\"\n\nR_white_dwarf = Rearth\nR_neutron_star = 10u\"km\"\n\nv_es_white_dwarf = let M = M_white_dwarf, R = R_white_dwarf\n    @show v_es(M, R)\nend\n\nv_es_neutron_star = let M = M_neutron_star, R = R_neutron_star\n    @show v_es(M, R)\nend\n\nv_es_black_hole = let M = M_black_hole\n    R = Rsch(M)\n    @show v_es(M, R)\nend\n\nprintln(\"White dwarf to black hole: \", v_es_white_dwarf / v_es_black_hole)\nprintln(\"Neutron star to black hole: \", v_es_neutron_star / v_es_black_hole)\n\n\nv_es(M, R) = 6.450971939285288e6 m s⁻¹\nv_es(M, R) = 2.3040177082652816e8 m s⁻¹\nv_es(M, R) = 2.99792458e8 m s⁻¹\nWhite dwarf to black hole: 0.021518126180763653\nNeutron star to black hole: 0.7685375821780285\n\n\nNeutron stars have the comparable escape velocity to black holes, while white dwarfs have a much lower escape velocity (1% of the black hole’s).\n\n\n2.2 Gravitational Acceleration\n\nEstimate the gravitational acceleration at the surface of a white dwarf and neutron star, and compare them with that at the Schwarzschild radius of a black hole with M ≈ 10 M . Would humans be able to survive this gravity?\n\n\n\nCode\ng(M, R) = G * M / R^2 |&gt; upreferred\n\ng0 = 9.8u\"m/s^2\"\n\ng_white_dwarf = let M = 1u\"Msun\", R = Rearth\n    @show g(M, R)\nend\n\ng_neutron_star = let M = 2u\"Msun\", R = 10u\"km\"\n    @show g(M, R)\nend\n\ng_black_hole = let M = 10u\"Msun\"\n    R = Rsch(M)\n    @show g(M, R)\nend\n\nNoUnits(minimum([g_white_dwarf, g_neutron_star, g_black_hole]) / g0)\n\n\ng(M, R) = 3.262338232502328e6 m s⁻²\ng(M, R) = 2.6542488e12 m s⁻²\ng(M, R) = 1.5216374427790059e12 m s⁻²\n\n\n332891.6563777886\n\n\nHumans would not be able to survive the gravity of white dwarfs or neutron stars or black holes.\n\n\n2.3 Gravitational Redshift\n\nRecall that near a massive object, light experiences a gravitational redshift:\n\n\n\nCode\nz(M, R) = sqrt(1 - 2 * G * M / (R * c^2))\n\n@show z(M_white_dwarf, R_white_dwarf)\n@show z(M_neutron_star, R_neutron_star)\n@show z(M_black_hole, R_ISCO(M_black_hole))\n\n\nz(M_white_dwarf, R_white_dwarf) = 0.999768458317059\nz(M_neutron_star, R_neutron_star) = 0.6398046457942846\nz(M_black_hole, R_ISCO(M_black_hole)) = 0.816496580927726\n\n\n0.816496580927726",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 6"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps6.html#ultra-high-energy-cosmic-rays",
    "href": "docs/courses/astr145/homework/ps6.html#ultra-high-energy-cosmic-rays",
    "title": "Problem Set 6",
    "section": "3 Ultra-High Energy Cosmic Rays",
    "text": "3 Ultra-High Energy Cosmic Rays\n\nRead this article about ultra-high energy cosmic rays: https://physicsworld.com/a/the-riddle-of-ultrahigh-energy-cosmic-rays/ Write a short reaction (a paragraph or so) to this video – you could comment on something you learned or particularly enjoyed or pose a question it raised to you, for example.\n\nI was particularly intrigued by the challenges in identifying the sources of UHECRs due to their deflection by magnetic fields, which obscures their paths. This raises a compelling question: how can we develop methods or technologies to trace these particles back to their origins, thereby unveiling the astrophysical processes responsible for such extreme energies?",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 6"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps5.html",
    "href": "docs/courses/astr145/homework/ps5.html",
    "title": "Problem Set 5",
    "section": "",
    "text": "Some models for high-energy radiation from compact objects involve gas free-falling onto the surface of the object at a velocity near the object’s escape speed. This speed is very supersonic relative to the star, so the gas must pass through a shock (called either an “accretion” or “standoff” shock) before it settles on the surface. Assuming that this is a strong shock, estimate the post-shock temperatures for a white dwarf (with M? = 1 M and R? = 109 cm) and a neutron star (with M? = 1 M and R? = 106 cm). You can assume γ = 5/3, μ = mp, and that the standoff shock is just above the surface of the star. (For the pedantic among you: you can use the expressions in this problem set, even though this shock is actually spherical rather than planar.)\n\nusing DrWatson\nusing Unitful: Mass, Length\ninclude(srcdir(\"astr145/main.jl\"))\nfunction postshock_temperature(u1; μ=mp, γ=5 / 3)\n    2 * (γ - 1) / (γ + 1)^2 * μ * u1^2 |&gt; upreferred\nend\n\nfunction postshock_temperature(M::Mass, R::Length)\n    v_esc = escape_velocity(M, R)\n    kT = postshock_temperature(v_esc)\n    T = uconvert(u\"K\", kT / Unitful.k)\n    @show v_esc kT T\nend\n\npostshock_temperature(1u\"Msun\", 1e9u\"cm\")\npostshock_temperature(1u\"Msun\", 1e6u\"cm\")",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 5"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps5.html#the-shock-jump-conditions",
    "href": "docs/courses/astr145/homework/ps5.html#the-shock-jump-conditions",
    "title": "Problem Set 5",
    "section": "",
    "text": "Some models for high-energy radiation from compact objects involve gas free-falling onto the surface of the object at a velocity near the object’s escape speed. This speed is very supersonic relative to the star, so the gas must pass through a shock (called either an “accretion” or “standoff” shock) before it settles on the surface. Assuming that this is a strong shock, estimate the post-shock temperatures for a white dwarf (with M? = 1 M and R? = 109 cm) and a neutron star (with M? = 1 M and R? = 106 cm). You can assume γ = 5/3, μ = mp, and that the standoff shock is just above the surface of the star. (For the pedantic among you: you can use the expressions in this problem set, even though this shock is actually spherical rather than planar.)\n\nusing DrWatson\nusing Unitful: Mass, Length\ninclude(srcdir(\"astr145/main.jl\"))\nfunction postshock_temperature(u1; μ=mp, γ=5 / 3)\n    2 * (γ - 1) / (γ + 1)^2 * μ * u1^2 |&gt; upreferred\nend\n\nfunction postshock_temperature(M::Mass, R::Length)\n    v_esc = escape_velocity(M, R)\n    kT = postshock_temperature(v_esc)\n    T = uconvert(u\"K\", kT / Unitful.k)\n    @show v_esc kT T\nend\n\npostshock_temperature(1u\"Msun\", 1e9u\"cm\")\npostshock_temperature(1u\"Msun\", 1e6u\"cm\")",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 5"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps3.html",
    "href": "docs/courses/astr145/homework/ps3.html",
    "title": "Problem Set 3",
    "section": "",
    "text": "Code\nusing DrWatson\ninclude(srcdir(\"astr145/main.jl\"))\n\n\nRsch (generic function with 1 method)\n\n\n\n\nCode\nusing Unitful, UnitfulAstro\nusing Unitful: mp, G, c, σ\nusing UnitfulAstro: Msun, Rsun, AU\n\nb = 2.8977729e-3u\"m*K\"\n# Wien displacement law\nλ_max(T) =  b / T |&gt; upreferred\nT(M, R) = (G * M * L_edd(M) / (8π * σ * R^3 * c^2))^(1/4) |&gt; upreferred\nR_in_nonrot(M) = 6 * G * M / c^2 \nR_in_rot(M) = G * M / c^2\n\nlet M = 1e8u\"Msun\"\n    t = T(M, R_in_nonrot(M))\n    λmax = λ_max(t) |&gt; upreferred\n    @show t\n    @show λmax\n    @show uconvert(u\"nm\", λmax)\nend\n\nlet M = 30u\"Msun\"\n    t = T(M, R_in_rot(M))\n    λmax = λ_max(t)\n    @show t\n    @show λmax\n    @show uconvert(u\"nm\", λmax)\nend;\n\n\nt = 117052.63248779604 K\nλmax = 2.475615318008438e-8 m\nuconvert(u\"nm\", λmax) = 24.75615318008438 nm\nt = 1.9174070039396945e7 K\nλmax = 1.5112977547520943e-10 m\nuconvert(u\"nm\", λmax) = 0.15112977547520942 nm",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 3"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps3.html#accretion-onto-black-holes",
    "href": "docs/courses/astr145/homework/ps3.html#accretion-onto-black-holes",
    "title": "Problem Set 3",
    "section": "",
    "text": "Code\nusing DrWatson\ninclude(srcdir(\"astr145/main.jl\"))\n\n\nRsch (generic function with 1 method)\n\n\n\n\nCode\nusing Unitful, UnitfulAstro\nusing Unitful: mp, G, c, σ\nusing UnitfulAstro: Msun, Rsun, AU\n\nb = 2.8977729e-3u\"m*K\"\n# Wien displacement law\nλ_max(T) =  b / T |&gt; upreferred\nT(M, R) = (G * M * L_edd(M) / (8π * σ * R^3 * c^2))^(1/4) |&gt; upreferred\nR_in_nonrot(M) = 6 * G * M / c^2 \nR_in_rot(M) = G * M / c^2\n\nlet M = 1e8u\"Msun\"\n    t = T(M, R_in_nonrot(M))\n    λmax = λ_max(t) |&gt; upreferred\n    @show t\n    @show λmax\n    @show uconvert(u\"nm\", λmax)\nend\n\nlet M = 30u\"Msun\"\n    t = T(M, R_in_rot(M))\n    λmax = λ_max(t)\n    @show t\n    @show λmax\n    @show uconvert(u\"nm\", λmax)\nend;\n\n\nt = 117052.63248779604 K\nλmax = 2.475615318008438e-8 m\nuconvert(u\"nm\", λmax) = 24.75615318008438 nm\nt = 1.9174070039396945e7 K\nλmax = 1.5112977547520943e-10 m\nuconvert(u\"nm\", λmax) = 0.15112977547520942 nm",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 3"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps3.html#stellar-tidal-disruption",
    "href": "docs/courses/astr145/homework/ps3.html#stellar-tidal-disruption",
    "title": "Problem Set 3",
    "section": "2 Stellar Tidal Disruption",
    "text": "2 Stellar Tidal Disruption\n\n\nCode\nd = (4.1e6)^(1/3) * Rsun\n@show d\n@show d/AU |&gt; NoUnits\n@show Rsch(4.1e6u\"Msun\");\n\n\nd = 160.0520663883155 R⊙\nd / AU |&gt; NoUnits = 0.744316894788203\nRsch(4.1e6 * u\"Msun\") = 1.2108325312011024e10 m",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 3"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps3.html#black-holes-through-time",
    "href": "docs/courses/astr145/homework/ps3.html#black-holes-through-time",
    "title": "Problem Set 3",
    "section": "3 Black Holes Through Time",
    "text": "3 Black Holes Through Time\n\nIn the nearby Universe, black holes seem to be ubiquitous in galaxies: to a reasonable approximation, every galaxy has a central supermassive black hole with a mass about one four-thousandth of its stellar mass. Assuming all these black holes grew through disk accretion, compare (quantitatively though approximately!) the total energy of radiation they have generated to the total energy generated by stars. You will need to make some assumptions along the way; please be clear about them!\n\nAssume:\n\nAccretion Efficiency \\(\\eta\\) is about 10% .\nStellar Fusion Efficiency \\(\\eta_f\\) is about 0.7% .\n\n\\[\nE_{\\text{BH}} = \\eta \\times M_{\\text{BH}} \\times c^2 = \\eta \\times \\left( \\frac{M_*}{4000} \\right) \\times c^2\n\\]\nEnergy generated by stars through nuclear fusion:\n\\[\nE_* = \\eta_f \\times M_* \\times c^2\n\\]\nSo\n\\[\n\\frac{E_{\\text{BH}}}{E_*} = \\frac{\\eta \\left( \\frac{M_*}{4000} \\right)  c^2}{\\eta_f M_* c^2} = \\frac{\\eta}{4000 \\eta_f} \\approx 0.0036\n\\]",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 3"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps3.html#the-magnetorotational-instability",
    "href": "docs/courses/astr145/homework/ps3.html#the-magnetorotational-instability",
    "title": "Problem Set 3",
    "section": "4 The Magnetorotational Instability",
    "text": "4 The Magnetorotational Instability\nAccretion disks typically exhibit differential rotation. So as the disk rotates, fluid elements become more azimuthally separated. Magnetic tension oppose such separation, however, such force acts to decrease the angular momentum of the inner fluid element and increase that of the outer element. Because angular momentum is an increasing function of radius in Keplerian disks, this transfer of angular momentum causes the fluid elements to separate further radially, leading to instability. This continuously growing stretching and twisting of magnetic field lines generate MHD turbulence. The turbulent motions effectively act as a efficient “viscous” force, facilitating the transfer of angular momentum.",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 3"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps2.html",
    "href": "docs/courses/epss261/homework/ps2.html",
    "title": "Problem Set 2",
    "section": "",
    "text": "Warning\n\n\n\nFunctions in this report are experimental, not tested, and may change without notice.",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "Homework",
      "Problem Set 2"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps2.html#introduction",
    "href": "docs/courses/epss261/homework/ps2.html#introduction",
    "title": "Problem Set 2",
    "section": "1 Introduction",
    "text": "1 Introduction\nIn this report, I will demonstrate the application of Julia in space data analysis. Due to its highly flexible type system, multiple dispatch feature, and seamless interoperability between Python and C packages, Julia enables the implementation of SPEDAS complex functionalities in a concise and generalizable manner, often requiring only a few lines of code.\nMore specifically, we utilize\n\nDimensionalData : which provides an abstract array with named dimensions, facilitating more intuitive indexing and generalized manipulation.\nUnitful : which enables seamless unit conversion and supports dimensional analysis\n\nSince Julia features an abstract type system, most packages can be used directly and composed seamlessly without unintended side effects. This contrasts with Python, where inheritance and subtyping are commonly used, making it more challenging to share functionality across different classes.\ndegap and rectify_datetime are used to clean up the data and rectify the time series (make timestamps uniform).\nfunction degap(da::DimArray; dim=Ti)\n    dims = otherdims(da, dim)\n    rows = filter(x -&gt; !any(isnan, x), eachslice(da; dims))\n    if !isempty(rows)\n        cat(rows...; dims)\n    else\n        similar(da, (0, size(da, 2)))\n    end\nend\n\nfunction degap(ts::TimeArray)\n    ts[all.(!isnan, eachrow(values(ts)))]\nend\n\nfunction rectify_datetime(da; tol=2, kwargs...)\n    times = dims(da, Ti)\n    t0 = times[1]\n    dtime = Quantity.(times.val .- t0)\n    new_times = TimeseriesTools.rectify(Ti(dtime); tol)[1]\n    set(da, Ti =&gt; new_times .+ t0)\nend\ntplot could be decomposed into multiple steps and lead to better readability and flexibility.\n\"\"\"\nLay out multiple time series on the same figure across different panels (rows)\n\"\"\"\nfunction tplot(f, tas::AbstractVector; add_legend=true, link_xaxes=true, kwargs...)\n    aps = map(enumerate(tas)) do (i, ta)\n        ap = tplot(f[i, 1], ta; kwargs...)\n        # Hide redundant x labels\n        link_xaxes && i != length(tas) && hidexdecorations!(ap.axis, grid=false)\n        ap\n    end\n    axs = map(ap -&gt; ap.axis, aps)\n    link_xaxes && linkxaxes!(axs...)\n    add_legend && axislegend.(axs)\n    FigureAxes(f, axs)\nend\n\n\"\"\"\nSetup the axis on a position and plot multiple time series on it\n\"\"\"\nfunction tplot(gp::GridPosition, tas::AbstractVector; kwargs...)\n    ax = Axis(gp, ylabel=ylabel(ta))\n    plots = map(tas) do ta\n        tplot!(ax, ta; kwargs...)\n    end\n    ax, plots\nend\n\n\"\"\"\nPlot a multivariate time series on a position in a figure\n\"\"\"\nfunction tplot(gp::GridPosition, ta::AbstractDimArray; labeldim=nothing, kwargs...)\n    args, attributes = _series(ta, kwargs, labeldim)\n    series(gp, args...; attributes...)\nend\n\n\n\n\n\n\nNote\n\n\n\nSome functions in this report have been collected into multiple Julia packages Speasy.jl and SpaceTools.jl, please refer to the package for more information.",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "Homework",
      "Problem Set 2"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps2.html#energy-input-and-energy-dissipation",
    "href": "docs/courses/epss261/homework/ps2.html#energy-input-and-energy-dissipation",
    "title": "Problem Set 2",
    "section": "2 Energy input and energy dissipation",
    "text": "2 Energy input and energy dissipation\n\nCompute the total energy input and total energy dissipation in the magnetosphere during a storm, the one which occurred on 17 March, 2015. This was the largest storm of the previous solar cycle. The total energy input rate is: \\(ε[W]= (4π/μ_0)V B^2 \\sin^4(θ/2) I_0^2\\), also widely known as the Akasofu “epsilon” parameter1,2,3,4,5,6, with \\(θ = acos(B_{z,GSM}/B_{yz,GSM})\\), \\(I_0 =7RE\\). Its cumulative integral is: \\(U_{in}= ∫εdt\\) [in PetaJoules]. The magnetospheric energy dissipation rate in the ionosphere and ring current (in J/s or W) is: \\(W_{md}=[4 10^{13}(∂(-Dst*)/∂t + (-Dst*)/τ_R)+300 AE]\\) and its integral is given by: \\(U_{md}=∫ W_{md} dt\\) [in PJ], where: \\(τ_R=1\\) hr is the ring-current decay rate of O+ through charge exchange in the beginning of the storm, and \\(τ_R=6\\) hr late in the storm recovery when H+ is the dominant species, and Dst* is the corrected Dst to account for SW pressure variations6. Compute these quantities by following the crib sheet. Scale factors are included. Translate as needed (in Python) and complete (below lines: “; CONSTRUCT…”) the crib sheet EPSS_Hwk02.1_crib.pro. Produce the plot below. In your answer, explain each panel in the plot.\n\n\n2.1 Define and load data sets\nWe write a simple Julia wrapper around the Speasy, a Python package to deal with main Space Physics WebServices using API instead of downloading files. This allows easier integration between Python and Julia.\nabstract type AbstractDataSet end\n\n@kwdef struct DataSet &lt;: AbstractDataSet\n    name::String\n    parameters::Vector{String}\nend\n\nspeasy() = @pyconst(pyimport(\"speasy\"))\n\nstruct SpeasyVariable\n    py::Py\nend\n\nfunction get_data(args...)\n    res = @pyconst(pyimport(\"speasy\").get_data)(args...)\n    return apply_recursively(res, SpeasyVariable, is_pylist)\nend\n\n\nCode\nfunction load_dataset(dataset, args...; name=dataset.name, products=dataset.parameters, provider=\"cda\")\n    map(products) do p\n        replace_fillval_by_nan!(get_data(\"$provider/$name/$p\", args...))\n    end\nend\n\n\nload_dataset (generic function with 1 method)\n\n\n\n\nCode\nOMNI_HRO_PARAMS = [\n    \"Vx\", \"Vy\", \"Vz\", \"flow_speed\",\n    \"BX_GSE\", \"BY_GSM\", \"BZ_GSM\", \"E\",\n    \"AE_INDEX\", \"SYM_H\", \"Pressure\"\n]\n\n\"\"\"\nHigh resolution (1-min), multi-source, near-Earth solar wind magnetic field and plasma data as shifted to Earth's bow shock nose, plus several 1-min geomagnetic activity indices.\n\nReferences:[DOI](https://doi.org/10.48322/45bb-8792)\n\"\"\"\nOMNI_HRO_1MIN = DataSet(\"OMNI_HRO_1MIN\", OMNI_HRO_PARAMS)\n\n\"\"\"\nVersion 2 of OMNI_HRO_1MIN dataset\n\n- [DOI](https://doi.org/10.48322/mj0k-fq60)\n\"\"\"\nOMNI_HRO2_1MIN = DataSet(\"OMNI_HRO2_1MIN\", OMNI_HRO_PARAMS)\n\nOMNI2_H0_MRG1HR = DataSet(\n    \"OMNI2_H0_MRG1HR\",\n    [\"KP1800\", \"DST1800\", \"AE1800\"]\n)\n\ntimespan = [\"2015-03-15\", \"2015-03-22\"] # 7 days\nomni_hro_ds = load_dataset(OMNI_HRO_1MIN, timespan) |&gt; TimeArray\nOMNI2_H0_MRG1HR_ds = load_dataset(OMNI2_H0_MRG1HR, timespan) |&gt; TimeArray\n\n\nCan't get OMNI2_H0_MRG1HR/KP1800 without web service, switching to web service\nCan't get OMNI2_H0_MRG1HR/DST1800 without web service, switching to web service\nCan't get OMNI2_H0_MRG1HR/AE1800 without web service, switching to web service\n\n\n168×3 TimeSeries.TimeArray{Float64, 2, Dates.DateTime, Matrix{Float64}} 2015-03-15T00:30:00 to 2015-03-21T23:30:00\n┌─────────────────────┬────────┬─────────┬────────┐\n│                     │ KP1800 │ DST1800 │ AE1800 │\n├─────────────────────┼────────┼─────────┼────────┤\n│ 2015-03-15T00:30:00 │   20.0 │   -11.0 │  159.0 │\n│ 2015-03-15T01:30:00 │   20.0 │   -11.0 │  147.0 │\n│ 2015-03-15T02:30:00 │   20.0 │   -11.0 │  159.0 │\n│ 2015-03-15T03:30:00 │   20.0 │   -12.0 │  170.0 │\n│ 2015-03-15T04:30:00 │   20.0 │   -11.0 │  232.0 │\n│ 2015-03-15T05:30:00 │   20.0 │   -11.0 │  235.0 │\n│ 2015-03-15T06:30:00 │   27.0 │    -9.0 │  317.0 │\n│ 2015-03-15T07:30:00 │   27.0 │    -9.0 │  446.0 │\n│          ⋮          │   ⋮    │    ⋮    │   ⋮    │\n│ 2015-03-21T17:30:00 │   17.0 │   -44.0 │  105.0 │\n│ 2015-03-21T18:30:00 │   17.0 │   -44.0 │   84.0 │\n│ 2015-03-21T19:30:00 │   17.0 │   -44.0 │   72.0 │\n│ 2015-03-21T20:30:00 │   17.0 │   -47.0 │   68.0 │\n│ 2015-03-21T21:30:00 │   13.0 │   -40.0 │   94.0 │\n│ 2015-03-21T22:30:00 │   13.0 │   -43.0 │   55.0 │\n│ 2015-03-21T23:30:00 │   13.0 │   -41.0 │   47.0 │\n└─────────────────────┴────────┴─────────┴────────┘\n                                   153 rows omitted\n\n\n\n\n2.2 Akasofu parameter\n\n\nCode\nfunction Akasofu_epsilon(B, V)\n    _, By, Bz = B\n    I0 = 7 * Re\n    Bt = norm([By, Bz])\n    θ = acos(Bz / Bt)\n    return (4π / μ0) * V * Bt^2 * sin(θ / 2)^4 * I0^2 |&gt; u\"GW\"\nend\n\nB_ts = omni_hro_ds[:BX_GSE, :BY_GSM, :BZ_GSM] .* u\"nT\"\nV_ts = omni_hro_ds[:flow_speed] .* u\"km/s\"\n\nAkasofu_epsilon_meta = Dict(\n    \"label\" =&gt; \"Akasofu Epsilon\"\n)\nAkasofu_epsilon_ts = TimeArray(\n    timestamp(omni_hro_ds),\n    Akasofu_epsilon.(eachrow(values(B_ts)), values(V_ts)),\n    [:ε],\n    Akasofu_epsilon_meta\n)\n\n\n10080×1 TimeSeries.TimeArray{Unitful.Quantity{Float64, 𝐋² 𝐌 𝐓⁻³, Unitful.FreeUnits{(GW,), 𝐋² 𝐌 𝐓⁻³, nothing}}, 1, Dates.DateTime, Vector{Unitful.Quantity{Float64, 𝐋² 𝐌 𝐓⁻³, Unitful.FreeUnits{(GW,), 𝐋² 𝐌 𝐓⁻³, nothing}}}} 2015-03-15T00:00:00 to 2015-03-21T23:59:00\n┌─────────────────────┬───────────────┐\n│                     │ ε             │\n├─────────────────────┼───────────────┤\n│ 2015-03-15T00:00:00 │     53.202 GW │\n│ 2015-03-15T00:01:00 │    59.3266 GW │\n│ 2015-03-15T00:02:00 │    62.2223 GW │\n│ 2015-03-15T00:03:00 │    66.7341 GW │\n│ 2015-03-15T00:04:00 │    66.7664 GW │\n│ 2015-03-15T00:05:00 │     64.882 GW │\n│ 2015-03-15T00:06:00 │    67.7737 GW │\n│ 2015-03-15T00:07:00 │    66.3617 GW │\n│          ⋮          │       ⋮       │\n│ 2015-03-21T23:53:00 │        NaN GW │\n│ 2015-03-21T23:54:00 │        NaN GW │\n│ 2015-03-21T23:55:00 │        NaN GW │\n│ 2015-03-21T23:56:00 │ 0.00733769 GW │\n│ 2015-03-21T23:57:00 │  0.0025041 GW │\n│ 2015-03-21T23:58:00 │  0.0070985 GW │\n│ 2015-03-21T23:59:00 │ 0.00196921 GW │\n└─────────────────────┴───────────────┘\n                     10065 rows omitted\n\n\n\n\n2.3 Dst correction\nSiscoe etal 1968, JGR found deltaDst = constant*(sqrt(P_after)-sqrt(P_before)) for after/before sudden impulse.\nWe use this here to correct Dst for SW dynamic pressure, relative to prestorm value (Dst=0, Pdyn=2nPa).\n\n\nCode\nfunction correct_Dst(dst, P_after, P_before)\n    Siscoe_constant = 13.5u\"nT/sqrt(nPa)\"\n    @. (dst - Siscoe_constant * (sqrt(P_after * u\"nPa\") - sqrt(P_before * u\"nPa\")))\nend\n\nomni_hro_symh = omni_hro_ds[:SYM_H] .* u\"nT\"\nomni_Dst_corrected = correct_Dst(omni_hro_symh, omni_hro_ds[:Pressure], 2)\n\n\n10080×1 TimeSeries.TimeArray{Unitful.Quantity{Float64, 𝐌 𝐈⁻¹ 𝐓⁻², Unitful.FreeUnits{(nT,), 𝐌 𝐈⁻¹ 𝐓⁻², nothing}}, 1, Dates.DateTime, Vector{Unitful.Quantity{Float64, 𝐌 𝐈⁻¹ 𝐓⁻², Unitful.FreeUnits{(nT,), 𝐌 𝐈⁻¹ 𝐓⁻², nothing}}}} 2015-03-15T00:00:00 to 2015-03-21T23:59:00\n┌─────────────────────┬────────────────┐\n│                     │ SYM_H_Pressure │\n├─────────────────────┼────────────────┤\n│ 2015-03-15T00:00:00 │    -3.42358 nT │\n│ 2015-03-15T00:01:00 │    -5.36862 nT │\n│ 2015-03-15T00:02:00 │    -3.73869 nT │\n│ 2015-03-15T00:03:00 │     -3.9673 nT │\n│ 2015-03-15T00:04:00 │    -3.53824 nT │\n│ 2015-03-15T00:05:00 │    -3.13192 nT │\n│ 2015-03-15T00:06:00 │    -2.88453 nT │\n│ 2015-03-15T00:07:00 │    -2.84302 nT │\n│          ⋮          │       ⋮        │\n│ 2015-03-21T23:53:00 │         NaN nT │\n│ 2015-03-21T23:54:00 │         NaN nT │\n│ 2015-03-21T23:55:00 │         NaN nT │\n│ 2015-03-21T23:56:00 │    -23.2479 nT │\n│ 2015-03-21T23:57:00 │    -23.2479 nT │\n│ 2015-03-21T23:58:00 │    -22.5591 nT │\n│ 2015-03-21T23:59:00 │    -22.5591 nT │\n└─────────────────────┴────────────────┘\n                      10065 rows omitted\n\n\n\n\nCode\ntplot([omni_hro_symh, omni_Dst_corrected])\n\n\n\n\n\n\n\n2.4 Electric field\n\n\nCode\nomni_mVBz = @. -V_ts * B_ts.BZ_GSM |&gt; u\"mV/m\"\n\n\n10080×1 TimeSeries.TimeArray{Unitful.Quantity{Float64, 𝐋 𝐌 𝐈⁻¹ 𝐓⁻³, Unitful.FreeUnits{(m⁻¹, mV), 𝐋 𝐌 𝐈⁻¹ 𝐓⁻³, nothing}}, 1, Dates.DateTime, Vector{Unitful.Quantity{Float64, 𝐋 𝐌 𝐈⁻¹ 𝐓⁻³, Unitful.FreeUnits{(m⁻¹, mV), 𝐋 𝐌 𝐈⁻¹ 𝐓⁻³, nothing}}}} 2015-03-15T00:00:00 to 2015-03-21T23:59:00\n┌─────────────────────┬───────────────────┐\n│                     │ flow_speed_BZ_GSM │\n├─────────────────────┼───────────────────┤\n│ 2015-03-15T00:00:00 │   0.342721 mV m⁻¹ │\n│ 2015-03-15T00:01:00 │    0.65641 mV m⁻¹ │\n│ 2015-03-15T00:02:00 │   0.711816 mV m⁻¹ │\n│ 2015-03-15T00:03:00 │    0.72822 mV m⁻¹ │\n│ 2015-03-15T00:04:00 │    0.74763 mV m⁻¹ │\n│ 2015-03-15T00:05:00 │   0.718425 mV m⁻¹ │\n│ 2015-03-15T00:06:00 │   0.750825 mV m⁻¹ │\n│ 2015-03-15T00:07:00 │     0.7488 mV m⁻¹ │\n│          ⋮          │         ⋮         │\n│ 2015-03-21T23:53:00 │        NaN mV m⁻¹ │\n│ 2015-03-21T23:54:00 │        NaN mV m⁻¹ │\n│ 2015-03-21T23:55:00 │        NaN mV m⁻¹ │\n│ 2015-03-21T23:56:00 │   -6.13815 mV m⁻¹ │\n│ 2015-03-21T23:57:00 │   -6.17108 mV m⁻¹ │\n│ 2015-03-21T23:58:00 │   -6.22842 mV m⁻¹ │\n│ 2015-03-21T23:59:00 │   -6.19553 mV m⁻¹ │\n└─────────────────────┴───────────────────┘\n                         10065 rows omitted",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "Homework",
      "Problem Set 2"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps2.html#cumulative-energy-input-and-dissipation",
    "href": "docs/courses/epss261/homework/ps2.html#cumulative-energy-input-and-dissipation",
    "title": "Problem Set 2",
    "section": "3 Cumulative energy input and dissipation",
    "text": "3 Cumulative energy input and dissipation\n\n\nCode\nfunction integrate(ts)\n    ts = degap(ts)\n    ε = values(ts)\n    times = timestamp(ts)\n    dts = Quantity.(diff(times))\n    ∫ε_dt = cumsum(ε[1:end-1] .* dts) .|&gt; u\"PJ\"\n    Uin_meta = Dict(\n        \"label\" =&gt; \"Cumulative energy input\"\n    )\n    TimeArray(times[2:end], ∫ε_dt, [:Uin], Uin_meta)\nend\n\ntau_r(t, t0; τr_i=1u\"hr\", τr_f=6u\"hr\") = τr_i * (t &lt; t0) + τr_f * (t &gt;= t0)\n\nfunction compute_Wmd(dDst_dt, Dst, AE, time, time2transition)\n    # Time-varying tau_r (assume split between initial and late storm)\n    τ_r = tau_r(time, time2transition)\n    factor = u\"erg/s\" / u\"nT\"\n    Wmd_dDstodt = -4e20 * dDst_dt * factor * 1u\"s\"\n    Wmd_dstotau = -4e20 * Dst / τ_r * factor * 1u\"s\"\n    Wmd_AE = 3e15 * AE * factor\n    Wmd_all = Wmd_dDstodt + Wmd_dstotau + Wmd_AE\n    # return (; Wmd_dDstodt, Wmd_dstotau, Wmd_AE, Wmd_all)\n    return Wmd_all\nend\n\nitem(ts) = values(ts)[1]\n\nomni_AE = omni_hro_ds.AE_INDEX .* u\"nT\"\n\nWmd_all_ts = let Dst = omni_Dst_corrected, AE = omni_AE, time2transition = Date(\"2015-03-19\")\n    times = timestamp(Dst)\n    dts = Quantity.(diff(times))\n    dDst_dt = diff(Dst) ./ dts\n    time = times[10]\n    # ([dDst_dt[times], Dst[times], AE[times]])\n    Wmd_all = map(times[2:end]) do time\n        compute_Wmd(item.([dDst_dt[time], Dst[time], AE[time]])..., time, time2transition)\n    end\n    TimeArray(times[2:end], Wmd_all, [:Wmd], Dict(\"label\" =&gt; \"Cumulative energy dissipation\"))\nend\n\nUin = integrate(Akasofu_epsilon_ts)\nUout = integrate(Wmd_all_ts)\nrename!(Uout, :Uout)\n\n\n6338×1 TimeSeries.TimeArray{Unitful.Quantity{Float64, 𝐋² 𝐌 𝐓⁻², Unitful.FreeUnits{(PJ,), 𝐋² 𝐌 𝐓⁻², nothing}}, 1, Dates.DateTime, Vector{Unitful.Quantity{Float64, 𝐋² 𝐌 𝐓⁻², Unitful.FreeUnits{(PJ,), 𝐋² 𝐌 𝐓⁻², nothing}}}} 2015-03-15T00:02:00 to 2015-03-21T23:59:00\n┌─────────────────────┬──────────────┐\n│                     │ Uout         │\n├─────────────────────┼──────────────┤\n│ 2015-03-15T00:02:00 │ 0.0863126 PJ │\n│ 2015-03-15T00:03:00 │  0.028522 PJ │\n│ 2015-03-15T00:04:00 │ 0.0449733 PJ │\n│ 2015-03-15T00:05:00 │ 0.0346158 PJ │\n│ 2015-03-15T00:06:00 │  0.024771 PJ │\n│ 2015-03-15T00:07:00 │ 0.0211541 PJ │\n│ 2015-03-15T00:08:00 │ 0.0256013 PJ │\n│ 2015-03-15T00:09:00 │ 0.0127587 PJ │\n│          ⋮          │      ⋮       │\n│ 2015-03-21T23:48:00 │   267.107 PJ │\n│ 2015-03-21T23:49:00 │    267.11 PJ │\n│ 2015-03-21T23:50:00 │   267.073 PJ │\n│ 2015-03-21T23:51:00 │    267.09 PJ │\n│ 2015-03-21T23:57:00 │   267.109 PJ │\n│ 2015-03-21T23:58:00 │   267.112 PJ │\n│ 2015-03-21T23:59:00 │   267.088 PJ │\n└─────────────────────┴──────────────┘\n                     6323 rows omitted\n\n\n\n3.1 Plot\n\n\nCode\nfig = Figure(; size=(1200, 1200))\ntvars2plot = [\n    [Uin, Uout],\n    Akasofu_epsilon_ts,\n    [omni_hro_symh, OMNI2_H0_MRG1HR_ds.DST1800 .* u\"nT\", omni_Dst_corrected],\n    [omni_AE, OMNI2_H0_MRG1HR_ds.AE1800 .* u\"nT\"],\n    [omni_mVBz, omni_hro_ds.E .* u\"mV/m\"],\n    [omni_hro_ds.Pressure .* u\"nPa\"]\n]\nf, axs = tplot(fig, tvars2plot)\naxs[3].ylabel = \"DST\"\naxs[4].ylabel = \"AE\"\naxs[5].ylabel = \"Electric field\"\naxs[6].ylabel = \"Pressure\"\naxislegend.(axs)\nf",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "Homework",
      "Problem Set 2"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps2.html#field-line-resonances",
    "href": "docs/courses/epss261/homework/ps2.html#field-line-resonances",
    "title": "Problem Set 2",
    "section": "4 Field line resonances",
    "text": "4 Field line resonances\n\nObtain magnetic field data from THEMIS-A for a field line resonances observed on 2008-Sep-05 10 – 20 UT. These have periods of 10-30 mHz and can be seen in Figure 1 of Sarris et al., 2010 (Sarris et al. 2010). It would be sufficient to use spin-period (FGS) data.\n\n\n\nShow the band-bass filtered data between fmin=1/180s and fmax=1/15s (low-pass using block average function tsmooth2 with window 61 points, subtract it from the original data to get the high-pass, then do tsmooth2 on that with 5 points). Plot the data.\n\n\n\n\nCode\ntha_l2_fgm_ds = DataSet(\"THA_L2_FGM\", [\"tha_fgs_gse\"])\ntspan = [\"2008-09-05T10:00:00\", \"2008-09-05T22:00:00\"]\ntha_fgs_gse = load_dataset(tha_l2_fgm_ds, tspan) |&gt; TS\n\ntha_fgs_gse.metadata[\"long_name\"] = \"THA FGS GSE\"\ntha_fgs_gse.metadata[\"units\"] = \"nT\"\n\n\n\"nT\"\n\n\nThe smooth (tsmooth2 in IDL) function is implemented as follows. By using mapslices, the function efficiently applies the operation along the desired dimension. This approach is very general and can be used for multiple dimensions.\nfunction smooth(da::AbstractDimArray, span::Integer; dims=Ti, suffix=\"_smoothed\", kwargs...)\n    new_da = mapslices(da; dims) do slice\n        mean.(RollingWindowArrays.rolling(slice, span; kwargs...))\n    end\n    rebuild(new_da; name=Symbol(da.name, suffix))\nend\n\n\nCode\nfunction amap(f, a::AbstractDimArray, b::AbstractDimArray)\n    shared_selectors = DimSelectors(b)\n    data = f(a[shared_selectors], b[shared_selectors])\nend\n\n\namap (generic function with 1 method)\n\n\n\n\nCode\nda = tha_fgs_gse\nda_smoothed = smooth(da, 61)\nda_filtered = amap(-, da, da_smoothed)\nda_filtered = rebuild(da_filtered; name=:tha_fgs_gse_filtered)\nda_filtered_smoothed = smooth(da_filtered, 5)\n\nfigure = (; size=(1000, 600))\ntplot([da, da_smoothed, da_filtered_smoothed]; figure)\n\n\n\n\n\n\n4.1 Dynamic power spectrum\n\n\nDo a dynamic power spectrum of the unfiltered data.\n\n\nIn this section, we implement two approaches to represent the time-frequency domain of time series data. The first approach utilizes a window function, while the second employs a wavelet transform. The functions pspectrum are dispatched based on the second argument, leveraging Julia’s multiple dispatch mechanism.\n\nReference: Matlab, PySPEDAS : pytplot.tplot_math.dpwrspc\n\n\n\nCode\nusing SignalAnalysis\nusing DimensionalData: Where\n\nfunction pspectrum(x::AbstractDimArray, spec::Spectrogram)\n    fs = SpaceTools.samplingrate(x)\n    y = tfd(x, spec; fs)\n    t0 = dims(x, Ti)[1]\n    times = Ti(y.time .* 1u\"s\" .+ t0)\n    freqs = 𝑓(y.freq * 1u\"Hz\")\n    y_da = DimArray(y.power', (times, freqs))\nend\n\n\npspectrum (generic function with 1 method)\n\n\n\n\nCode\nusing ContinuousWavelets\n\n\"\"\"\n    pspectrum(x, wt; kwargs...)\n\nReturns the power spectrum of `x` in the time-frequency domains\n\"\"\"\nfunction pspectrum(x::AbstractDimArray, wt::CWT)\n    fs = SpaceTools.samplingrate(x)\n    res = cwt(x, wt)\n    power = abs.(res) .^ 2\n    n = length(dims(x, Ti))\n    times = dims(x, Ti)\n    freqs = 𝑓(getMeanFreq(computeWavelets(n, wt)[1], fs) * 1u\"Hz\")\n    DimArray(power, (times, freqs))\nend\n\n\nMain.Notebook.pspectrum\n\n\n\n\nCode\nconst DD = DimensionalData\n\n\"\"\"\n    plot_tfr(data; kwargs...)\n\nDisplays time frequency representation using Makie.\n\"\"\"\nfunction plot_tfr(da::DimArray; colorscale=log10, crange=:auto, figure_kwargs...)\n    cmid = median(da)\n    cmax = cmid * 10\n    cmin = cmid / 10\n\n    fig, ax, hm = heatmap(da; colorscale, colorrange=(cmin, cmax))\n    Colorbar(fig[:, end+1], hm)\n\n    # rasterize the heatmap to reduce file size\n    if *(size(da)...) &gt; 32^2\n        hm.rasterize = true\n    end\n\n    fig\nend\n\n\nMain.Notebook.plot_tfr\n\n\nApplying hamming window and plotting the power spectrum\n\n\nCode\nda = TS(tha_fgs_gse[:, 3])\nda = rectify_datetime(da)\n\nspec1 = Spectrogram(nfft=512, noverlap=64, window=hamming)\nres1 = pspectrum(da, spec1)\nplot_tfr(res1)\n\n\n\n\n\nApplying Morlet wavelet and plotting the power spectrum\n\n\nCode\nwl2 = wavelet(Morlet(π), β=2)\nres2 = pspectrum(da, wl2)\nplot_tfr(res2)\n\n\n┌ Warning: the lowest frequency wavelet has more than 1% its max at zero, so it may not be analytic. Think carefully\n│   lowAprxAnalyt = 0.076815\n└ @ ContinuousWavelets ~/.julia/packages/ContinuousWavelets/eb0df/src/sanityChecks.jl:7\n┌ Warning: the lowest frequency wavelet has more than 1% its max at zero, so it may not be analytic. Think carefully\n│   lowAprxAnalyt = 0.076815\n└ @ ContinuousWavelets ~/.julia/packages/ContinuousWavelets/eb0df/src/sanityChecks.jl:7\n\n\n\n\n\nField line resonances are more visible using window function although with lower resolution. Zoom in on the low frequencies\n\n\nCode\nres1_s = res1[𝑓=Where(&lt;=(0.05u\"Hz\"))]\nplot_tfr(res1_s)\n\n\n\n\n\n\n\n4.2 Field aligned coordinate system\n\n\nTransform to the field aligned coordinate system, with “Other dimension” being radially inward (minus R). This will give you 3 components: Radially inward, Azimuthal Westward, and Field aligned. Plot and confirm that the compressional component is small.\n\n\nTo confirm that the compressional component of the magnetic field is small, we need to analyze the fluctuations in the magnetic field and determine whether the component along the background field direction is significantly weaker than the perpendicular components.\nfac_matrix_make and rotate could be easily implemented in few lines. Note that we implement only the array version (corresponding to one timestamp), and the matrix version could be freely got using Julia broadcast operators which also align with dimensions.\nfunction fac_matrix_make(\n    vec::AbstractVector;\n    xref=[1.0, 0.0, 0.0]\n)\n    z0 = normalize(vec)\n    y0 = normalize(cross(z0, xref))\n    x0 = cross(y0, z0)\n    return vcat(x0', y0', z0')\nend\n\nfunction rotate(da, mat)\n    da = da[DimSelectors(mats)]\n    da_rot = mats .* eachrow(da.data)\n    TS(dims(da, Ti), dims(da, 2), hcat(da_rot...)')\nend\n\n\nCode\nda = tha_fgs_gse\n# smooth the data\nmat_da = smooth(da, 601)\n# make the rotation matrix from the smoothed data\nmats = fac_matrix_make.(eachslice(mat_da, dims=Ti))\n# rotate original data\nda_fac = rotate(da, mats)\ntplot([da, da_fac])\n\n\n\n\n\n\n\n4.3 Poloidal vs. toroidal\n\n\nMake dynamic power spectra of the radial and azimuthal components. Which of the two components dominates? This determines if the FLR is poloidal or toroidal. (You may use wavelet transform instead of FFT to construct the dynamic power spectrum, if you prefer and can easily do so as in IDL SPEDAS). Report on your plots with explanations. Show all your code in addition to your plots, with comments included for clarification.\n\n\n\n\nCode\nda_x = da_fac[:, 1]\nda_x = rectify_datetime(da_x)\n\nres_x = pspectrum(da_x, spec1)\nplot_tfr(res_x)\n\n\n\n\n\n\n\nCode\nda_y = da_fac[:, 2]\nda_y = rectify_datetime(da_y)\n\nres_y = pspectrum(da_y, spec1)\nplot_tfr(res_y)\n\n\n\n\n\nWe can see that the power spectrum of the y (azimuthal) component is much higher than the power spectrum of the x (radial) component. This indicates that the FLR is likely to be toroidal.",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "Homework",
      "Problem Set 2"
    ]
  },
  {
    "objectID": "docs/projects/coding/2025_SpaceTools.jl/index.html",
    "href": "docs/projects/coding/2025_SpaceTools.jl/index.html",
    "title": "SPEDAS.jl",
    "section": "",
    "text": "Think of SPEDAS in Julia.",
    "crumbs": [
      "Projects",
      "Coding",
      "SPEDAS.jl"
    ]
  },
  {
    "objectID": "docs/projects/coding/2025_SpaceTools.jl/index.html#installation",
    "href": "docs/projects/coding/2025_SpaceTools.jl/index.html#installation",
    "title": "SPEDAS.jl",
    "section": "Installation",
    "text": "Installation\n\n\nCode\nusing Pkg\nPkg.add([\"Speasy\", \"SPEDAS\", \"DimensionalData\", \"Dates\", \"Unitful\", \"LinearAlgebra\", \"CairoMakie\"])\nPkg.add(url=\"https://github.com/Beforerr/Beforerr.jl\")\n\n\n\n   Resolving package versions...\n  No Changes to `~/projects/beforerr/docs/projects/coding/2025_SpaceTools.jl/Project.toml`\n  No Changes to `~/projects/beforerr/docs/projects/coding/2025_SpaceTools.jl/Manifest.toml`\n    Updating git-repo `https://github.com/Beforerr/Beforerr.jl`\n   Resolving package versions...\n    Updating `~/projects/beforerr/docs/projects/coding/2025_SpaceTools.jl/Project.toml`\n  [49aed396] + Beforerr v0.1.1 `https://github.com/Beforerr/Beforerr.jl#main`\n    Updating `~/projects/beforerr/docs/projects/coding/2025_SpaceTools.jl/Manifest.toml`\n  [cbdf2221] + AlgebraOfGraphics v0.10.3\n  [49aed396] + Beforerr v0.1.1 `https://github.com/Beforerr/Beforerr.jl#main`\n  [8be319e6] + Chain v0.6.0\n  [a93c6f00] + DataFrames v1.7.0\n  [1313f7d8] + DataFramesMeta v0.15.4\n  [85a47980] + Dictionaries v0.4.5\n  [38e38edf] + GLM v1.9.0\n  [313cdc1a] + Indexing v1.1.1\n  [4345ca2d] + Loess v0.6.4\n  [7eb4fadd] + Match v2.4.0\n  [c020b1a1] + NaturalSort v1.0.0\n  [2dfb63ee] + PooledArrays v1.4.3\n  [91c51154] + SentinelArrays v1.4.8\n  [1277b4bf] + ShiftedArrays v2.0.0\n  [3eaba693] + StatsModels v0.7.4\n  [9ce81f87] + TableMetadataTools v0.1.0\nPrecompiling project...\n   1537.4 ms  ✓ StatsModels\n   1516.3 ms  ✓ GLM\n  18307.0 ms  ✓ AlgebraOfGraphics\n   5639.8 ms  ✓ AlgebraOfGraphics → AlgebraOfGraphicsUnitfulExt\n   5612.6 ms  ✓ DimensionalData → DimensionalDataAlgebraOfGraphicsExt\n   6132.7 ms  ✓ Beforerr\n    387.7 ms  ✓ Beforerr → LatexExt\n  7 dependencies successfully precompiled in 34 seconds. 438 already precompiled.",
    "crumbs": [
      "Projects",
      "Coding",
      "SPEDAS.jl"
    ]
  },
  {
    "objectID": "docs/projects/coding/2025_SpaceTools.jl/index.html#spectrogram",
    "href": "docs/projects/coding/2025_SpaceTools.jl/index.html#spectrogram",
    "title": "SPEDAS.jl",
    "section": "Spectrogram",
    "text": "Spectrogram\nhttps://cdaweb.gsfc.nasa.gov/misc/NotesM.html#MMS1_FPI_FAST_L2_DES-DIST\n\n\nCode\nts0 = \"2019-01-02T15\" |&gt; DateTime\nts1 = \"2019-01-02T22\" |&gt; DateTime\n\ntvars = [\n    \"cda/MMS1_FGM_SRVY_L2/mms1_fgm_b_gse_srvy_l2_clean\",\n    \"cda/MMS1_FPI_FAST_L2_DES-MOMS/mms1_des_energyspectr_omni_fast\",\n]\ntplot(tvars, ts0, ts1; add_title=true)\n\n\n\nCan't get MMS1_FGM_SRVY_L2/mms1_fgm_b_gse_srvy_l2_clean without web service, switching to web service\nCan't get MMS1_FGM_SRVY_L2/mms1_fgm_b_gse_srvy_l2_clean without web service, switching to web service\n[ Info: Resampling 403194×4 DimArray{Unitful.Quantity{Float32, 𝐌 𝐈⁻¹ 𝐓⁻², Unitful.FreeUnits{(nT,), 𝐌 𝐈⁻¹ 𝐓⁻², nothing}}, 2} mms1_fgm_b_gse_srvy_l2_clean along dimension 1 from 403194 to 6070 points",
    "crumbs": [
      "Projects",
      "Coding",
      "SPEDAS.jl"
    ]
  },
  {
    "objectID": "docs/projects/coding/2025_SpaceTools.jl/index.html#overlay-plots",
    "href": "docs/projects/coding/2025_SpaceTools.jl/index.html#overlay-plots",
    "title": "SPEDAS.jl",
    "section": "Overlay plots",
    "text": "Overlay plots\n\n\nCode\nSDS = SPEDAS.DataSet\nts0 = DateTime(\"2021-01-17\")\nts1 = DateTime(\"2021-01-18\")\n\ndensity_tvar = SDS(\n    \"Density\",\n    [\n        \"cda/PSP_SWP_SPI_SF00_L3_MOM/DENS\",\n        \"cda/PSP_FLD_L3_RFS_LFR_QTN/N_elec\",\n        \"cda/PSP_FLD_L3_SQTN_RFS_V1V2/electron_density\"\n    ]\n)\n\ntvars = [density_tvar]\n\ntplot(tvars, ts0, ts1; add_title=true)\n\n\n\n[ Info: Resampling 24704×1 DimArray{Unitful.Quantity{Float32, 𝐋⁻³, Unitful.FreeUnits{(cm⁻³,), 𝐋⁻³, nothing}}, 2} DENS along dimension 1 from 24704 to 6070 points\n[ Info: Resampling 24272×1 DimArray{Unitful.Quantity{Float32, 𝐋⁻³, Unitful.FreeUnits{(cm⁻³,), 𝐋⁻³, nothing}}, 2} N_elec along dimension 1 from 24272 to 6070 points\n[ Info: Resampling 24282×1 DimArray{Unitful.Quantity{Float32, 𝐋⁻³, Unitful.FreeUnits{(cm⁻³,), 𝐋⁻³, nothing}}, 2} electron_density along dimension 1 from 24282 to 6070 points",
    "crumbs": [
      "Projects",
      "Coding",
      "SPEDAS.jl"
    ]
  },
  {
    "objectID": "docs/projects/coding/2025_SpaceTools.jl/index.html#complex-requests-and-flexible-layout",
    "href": "docs/projects/coding/2025_SpaceTools.jl/index.html#complex-requests-and-flexible-layout",
    "title": "SPEDAS.jl",
    "section": "Complex requests and flexible layout",
    "text": "Complex requests and flexible layout\n\n\nCode\ndata = let intervals = [\"2019-01-02T15\", \"2019-01-02T16\"]\n    products = [\n        spz.inventories.tree.cda.MMS.MMS1.FGM.MMS1_FGM_SRVY_L2.mms1_fgm_b_gse_srvy_l2_clean,\n        spz.inventories.tree.cda.MMS.MMS1.SCM.MMS1_SCM_SRVY_L2_SCSRVY.mms1_scm_acb_gse_scsrvy_srvy_l2,\n        spz.inventories.tree.cda.MMS.MMS1.DES.MMS1_FPI_FAST_L2_DES_MOMS.mms1_des_bulkv_gse_fast,\n        spz.inventories.tree.cda.MMS.MMS1.DES.MMS1_FPI_FAST_L2_DES_MOMS.mms1_des_temppara_fast,\n        spz.inventories.tree.cda.MMS.MMS1.DES.MMS1_FPI_FAST_L2_DES_MOMS.mms1_des_tempperp_fast,\n        spz.inventories.tree.cda.MMS.MMS1.DES.MMS1_FPI_FAST_L2_DES_MOMS.mms1_des_energyspectr_omni_fast,\n        spz.inventories.tree.cda.MMS.MMS1.DIS.MMS1_FPI_FAST_L2_DIS_MOMS.mms1_dis_energyspectr_omni_fast\n    ]\n    get_data(products, intervals)\nend\n\nlet figure = (; size=(1200, 1200)), add_title = true\n    f = Figure(; figure...)\n    tplot(f[1, 1], data[1:3]; add_title)\n    tplot(f[1, 2], [data[4:5], data[6:7]...]; add_title)\n    f\nend\n\n\nCan't get MMS1_FGM_SRVY_L2/mms1_fgm_b_gse_srvy_l2_clean without web service, switching to web service",
    "crumbs": [
      "Projects",
      "Coding",
      "SPEDAS.jl"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps1.html",
    "href": "docs/courses/epss261/homework/ps1.html",
    "title": "Problem Set 1",
    "section": "",
    "text": "Obtain and plot the AE [1min resolution] and Dst [1hr resolution] indices directly from their official site, WDC-C in Kyoto, and Kp [3hr resolution] index from its official site, GFZ Potsdam, the entire month of March 2015.\nDownload ASCII and plot using your own tools which are not SPEDAS. Note it’s easier to download in IAGA-2002 format for AE and Dst and to use the ftp directory download for kp.\n\n\n\n\n[a] In a short paragraph explain: What is AE index, and Dst index, and how are they derived? How did you download and plot? Show some lines of the ascii data.\n\nThe AE index (Auroral Electrojet index) and Dst index (Disturbance Storm-Time index) are geomagnetic indices used to measure different aspects of Earth’s magnetic activity. The AE index quantifies the intensity of auroral electrojets, currents flowing in the auroral regions, and is derived from horizontal magnetic field variations measured by magnetometers distributed around the auroral zone. It provides insight into substorm activity and is calculated using the difference between maximum and minimum horizontal components recorded at these stations. The Dst index, on the other hand, measures the intensity of the ring current, a system of charged particles trapped in Earth’s magnetosphere. It is derived from the average horizontal magnetic field variations observed by low-latitude magnetometers. The Dst index is commonly used to assess geomagnetic storms, with negative values indicating stronger disturbances.\nWe use julia to download and plot the AE and Dst indices directly from their official site, WDC-C in Kyoto.\n\nhttps://wdc.kugi.kyoto-u.ac.jp/aeasy/index.html\nhttps://wdc.kugi.kyoto-u.ac.jp/dstae/index.html / http://wdc.kugi.kyoto-u.ac.jp/dst_final/201503\n\nFirst we register and download the data dependencies using the DataDeps package.\n\n\nCode\nusing CairoMakie\nusing DataDeps\nusing CSV, DelimitedFiles\nusing TimeSeries\nusing DataFrames\nusing Dates\n\nregister(DataDep(\"AE Index\",\n    \"\"\"\n    Dataset: AE Index\n    Website: https://wdc.kugi.kyoto-u.ac.jp/aeasy/index.html\n    \"\"\",\n    \"https://wdc.kugi.kyoto-u.ac.jp///aeasy///wwwtmp/WWW_aeasy04087001.dat\"\n))\n\nregister(DataDep(\"Dst Index\",\n    \"\"\"\n    Dataset: Dst Index\n    Website: https://wdc.kugi.kyoto-u.ac.jp/dstae/index.html\n    \"\"\",\n    \"https://wdc.kugi.kyoto-u.ac.jp///dstae///wwwtmp/WWW_dstae04096902.dat\"\n))\n\n# Step 1: Download data\nprintln(\"Downloading AE index data...\")\nae_file = readdir(datadep\"AE Index\", join=true)[1]\n\nprintln(\"Downloading Dst index data...\")\ndst_file = readdir(datadep\"Dst Index\", join=true)[1]\n\n\n┌ Warning: Over-writing registration of the datadep\n│   name = \"AE Index\"\n└ @ DataDeps ~/.julia/packages/DataDeps/Y2lje/src/registration.jl:15\n┌ Warning: Over-writing registration of the datadep\n│   name = \"Dst Index\"\n└ @ DataDeps ~/.julia/packages/DataDeps/Y2lje/src/registration.jl:15\nDownloading AE index data...\nDownloading Dst index data...\n\n\n\"/Users/zijin/.julia/scratchspaces/124859b0-ceae-595e-8997-d05f6a7a8dfe/datadeps/Dst Index/WWW_dstae04096902.dat\"\n\n\nThe data is downloaded as text files in IAGA-2002 format. Sample data looks like this:\nDATE       TIME         DOY     AE        AU        AL        AO     |\n2015-03-01 00:00:00.000 060       245.00    122.00   -123.00     -1.00\n2015-03-01 00:01:00.000 060       253.00    125.00   -128.00     -2.00\n2015-03-01 00:02:00.000 060       235.00    122.00   -113.00      5.00\n2015-03-01 00:03:00.000 060       225.00    120.00   -105.00      8.00\nDATE       TIME         DOY     DST                                  |\n2015-03-01 00:00:00.000 060       -34.00\n2015-03-01 01:00:00.000 060       -44.00\n2015-03-01 02:00:00.000 060       -30.00\n2015-03-01 03:00:00.000 060       -31.00\nWe then parse the data into TimeSeries using DelimitedFiles and TimeSeries.\n\n\nCode\nstart_time = \"2015-03-01T00:00:00\"\nend_time = \"2015-03-31T23:59:59\"\n\n# Step 2: Parse AE data\nfunction load_ae_data(filename)\n    meta = Dict(\n        \"unit\" =&gt; \"nT\",\n        \"label\" =&gt; \"AE Index\"\n    )\n\n    # Skip the header lines (first 14 lines)\n    data, header = readdlm(filename, skipstart=14, header=true)\n\n    # Convert date and time columns to DateTime\n    datetime = DateTime.(data[:, 1] .* \"T\" .* data[:, 2])\n\n    TimeArray(datetime, data[:, 4:7], header[4:7], meta)\nend\n\nfunction load_dst_data(filename)\n    meta = Dict(\n        \"unit\" =&gt; \"nT\",\n        \"label\" =&gt; \"Dst Index\"\n    )\n\n    # Skip the header lines (first 17 lines)\n    data, header = readdlm(filename, skipstart=17, header=true)\n\n    # Convert date and time columns to DateTime\n    datetime = DateTime.(data[:, 1] .* \"T\" .* data[:, 2])\n\n    TimeArray(datetime, data[:, 4:4], header[4:4], meta)\nend\n\nprintln(\"Parsing AE data...\")\nae_data = load_ae_data(ae_file)\n\nprintln(\"Parsing Dst data...\")\ndst_data = load_dst_data(dst_file)\n\n\nParsing AE data...\nParsing Dst data...\n\n\n744×1 TimeSeries.TimeArray{Any, 2, Dates.DateTime, Matrix{Any}} 2015-03-01T00:00:00 to 2015-03-31T23:00:00\n┌─────────────────────┬───────┐\n│                     │ DST   │\n├─────────────────────┼───────┤\n│ 2015-03-01T00:00:00 │ -34.0 │\n│ 2015-03-01T01:00:00 │ -44.0 │\n│ 2015-03-01T02:00:00 │ -30.0 │\n│ 2015-03-01T03:00:00 │ -31.0 │\n│ 2015-03-01T04:00:00 │ -28.0 │\n│ 2015-03-01T05:00:00 │ -42.0 │\n│ 2015-03-01T06:00:00 │ -55.0 │\n│ 2015-03-01T07:00:00 │ -53.0 │\n│          ⋮          │   ⋮   │\n│ 2015-03-31T17:00:00 │   2.0 │\n│ 2015-03-31T18:00:00 │  -7.0 │\n│ 2015-03-31T19:00:00 │  -9.0 │\n│ 2015-03-31T20:00:00 │ -10.0 │\n│ 2015-03-31T21:00:00 │ -12.0 │\n│ 2015-03-31T22:00:00 │ -12.0 │\n│ 2015-03-31T23:00:00 │ -12.0 │\n└─────────────────────┴───────┘\n               729 rows omitted\n\n\nPlot the data using CairoMakie.\n\n\nCode\nMakie.convert_arguments(P::Type{&lt;:Lines}, ta::TimeArray) = convert_arguments(P, timestamp(ta), values(ta))\n\nylabel(ta::TimeArray) = meta(ta)[\"label\"] * (isnothing(meta(ta)[\"unit\"]) || meta(ta)[\"unit\"] == \"\" ? \"\" : \" (\" * meta(ta)[\"unit\"] * \")\")\n\nfunction tplot(tas; linkxaxes=true, figure=(;), kwargs...)\n    f = Figure(; figure...)\n    axs = []\n    for (i, ta) in enumerate(tas)\n        ax = Axis(f[i, 1]; ylabel=ylabel(ta))\n\n        for p in propertynames(ta)\n            lines!(ax, getproperty(ta, p); label=p)\n        end\n\n        # Hide redundant x labels\n        linkxaxes && i != length(tas) && hidexdecorations!(ax, grid=false)\n        push!(axs, ax)\n    end\n    linkxaxes && linkxaxes!(axs...)\n    f\nend\n\nf = tplot([ae_data.AE, dst_data])\n\n\n\n\n\n\n\n\n\n\n\n\n\nIn a second paragraph do the same as above but for Kp. What is Kp index? And how is it derived?\n\nThe Kp index is a global geomagnetic activity index that quantifies disturbances in Earth’s magnetic field caused by solar activity. Kp is calculated from the K values or the geomagnetic recordings of 13 mid-latitude geomagnetic observatories.\nWe use a web service client to load the data (https://kp.gfz-potsdam.de/en/data) from json format into the TimeArray.\n\n\nCode\nusing JSON3\n\n\"\"\"\nDownload 'Kp', 'ap', 'Ap', 'Cp', 'C9', 'Hp30', 'Hp60', 'ap30', 'ap60', 'SN', 'Fobs' or 'Fadj' index data from kp.gfz-potsdam.de\n\n# Notes\n- 'start_time' and 'end_time': date format 'YYYY-MM-DDThh:mm:ss'\n\"\"\"\nfunction load_Kp_data(start_time, end_time, index=:Kp)\n    url = \"https://kp.gfz-potsdam.de/app/json/?start=$(start_time)Z&end=$(end_time)Z&index=$(index)\"\n    data = JSON3.read(download(url))\n    datetime = DateTime.(data[:datetime], \"yyyy-mm-ddTHH:MM:SSZ\")\n    TimeArray(datetime, Float64.(data[index]), [index], Dict(\"unit\" =&gt; \"\", \"label\" =&gt; string(index)))\nend\n\nkp_data = load_Kp_data(start_time, end_time)\n\n\n248×1 TimeSeries.TimeArray{Float64, 1, Dates.DateTime, Vector{Float64}} 2015-03-01T00:00:00 to 2015-03-31T21:00:00\n┌─────────────────────┬───────┐\n│                     │ Kp    │\n├─────────────────────┼───────┤\n│ 2015-03-01T00:00:00 │   5.0 │\n│ 2015-03-01T03:00:00 │   5.0 │\n│ 2015-03-01T06:00:00 │ 5.333 │\n│ 2015-03-01T09:00:00 │ 3.667 │\n│ 2015-03-01T12:00:00 │   2.0 │\n│ 2015-03-01T15:00:00 │ 1.333 │\n│ 2015-03-01T18:00:00 │ 2.333 │\n│ 2015-03-01T21:00:00 │ 2.667 │\n│          ⋮          │   ⋮   │\n│ 2015-03-31T03:00:00 │ 0.667 │\n│ 2015-03-31T06:00:00 │ 2.333 │\n│ 2015-03-31T09:00:00 │ 2.333 │\n│ 2015-03-31T12:00:00 │   3.0 │\n│ 2015-03-31T15:00:00 │   3.0 │\n│ 2015-03-31T18:00:00 │ 2.667 │\n│ 2015-03-31T21:00:00 │   2.0 │\n└─────────────────────┴───────┘\n               233 rows omitted\n\n\n\n\n\n\n[c] Plot all 3 indices in a single plot with common time, UT in usual units [2015-03-01 00:00]. If you cannot plot in this format, simply plot in decimal day or decimal hour.\n\n\n\nCode\nf = tplot([ae_data.AE, dst_data, kp_data])",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "Homework",
      "Problem Set 1"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps1.html#ae-dst-kp",
    "href": "docs/courses/epss261/homework/ps1.html#ae-dst-kp",
    "title": "Problem Set 1",
    "section": "",
    "text": "Obtain and plot the AE [1min resolution] and Dst [1hr resolution] indices directly from their official site, WDC-C in Kyoto, and Kp [3hr resolution] index from its official site, GFZ Potsdam, the entire month of March 2015.\nDownload ASCII and plot using your own tools which are not SPEDAS. Note it’s easier to download in IAGA-2002 format for AE and Dst and to use the ftp directory download for kp.\n\n\n\n\n[a] In a short paragraph explain: What is AE index, and Dst index, and how are they derived? How did you download and plot? Show some lines of the ascii data.\n\nThe AE index (Auroral Electrojet index) and Dst index (Disturbance Storm-Time index) are geomagnetic indices used to measure different aspects of Earth’s magnetic activity. The AE index quantifies the intensity of auroral electrojets, currents flowing in the auroral regions, and is derived from horizontal magnetic field variations measured by magnetometers distributed around the auroral zone. It provides insight into substorm activity and is calculated using the difference between maximum and minimum horizontal components recorded at these stations. The Dst index, on the other hand, measures the intensity of the ring current, a system of charged particles trapped in Earth’s magnetosphere. It is derived from the average horizontal magnetic field variations observed by low-latitude magnetometers. The Dst index is commonly used to assess geomagnetic storms, with negative values indicating stronger disturbances.\nWe use julia to download and plot the AE and Dst indices directly from their official site, WDC-C in Kyoto.\n\nhttps://wdc.kugi.kyoto-u.ac.jp/aeasy/index.html\nhttps://wdc.kugi.kyoto-u.ac.jp/dstae/index.html / http://wdc.kugi.kyoto-u.ac.jp/dst_final/201503\n\nFirst we register and download the data dependencies using the DataDeps package.\n\n\nCode\nusing CairoMakie\nusing DataDeps\nusing CSV, DelimitedFiles\nusing TimeSeries\nusing DataFrames\nusing Dates\n\nregister(DataDep(\"AE Index\",\n    \"\"\"\n    Dataset: AE Index\n    Website: https://wdc.kugi.kyoto-u.ac.jp/aeasy/index.html\n    \"\"\",\n    \"https://wdc.kugi.kyoto-u.ac.jp///aeasy///wwwtmp/WWW_aeasy04087001.dat\"\n))\n\nregister(DataDep(\"Dst Index\",\n    \"\"\"\n    Dataset: Dst Index\n    Website: https://wdc.kugi.kyoto-u.ac.jp/dstae/index.html\n    \"\"\",\n    \"https://wdc.kugi.kyoto-u.ac.jp///dstae///wwwtmp/WWW_dstae04096902.dat\"\n))\n\n# Step 1: Download data\nprintln(\"Downloading AE index data...\")\nae_file = readdir(datadep\"AE Index\", join=true)[1]\n\nprintln(\"Downloading Dst index data...\")\ndst_file = readdir(datadep\"Dst Index\", join=true)[1]\n\n\n┌ Warning: Over-writing registration of the datadep\n│   name = \"AE Index\"\n└ @ DataDeps ~/.julia/packages/DataDeps/Y2lje/src/registration.jl:15\n┌ Warning: Over-writing registration of the datadep\n│   name = \"Dst Index\"\n└ @ DataDeps ~/.julia/packages/DataDeps/Y2lje/src/registration.jl:15\nDownloading AE index data...\nDownloading Dst index data...\n\n\n\"/Users/zijin/.julia/scratchspaces/124859b0-ceae-595e-8997-d05f6a7a8dfe/datadeps/Dst Index/WWW_dstae04096902.dat\"\n\n\nThe data is downloaded as text files in IAGA-2002 format. Sample data looks like this:\nDATE       TIME         DOY     AE        AU        AL        AO     |\n2015-03-01 00:00:00.000 060       245.00    122.00   -123.00     -1.00\n2015-03-01 00:01:00.000 060       253.00    125.00   -128.00     -2.00\n2015-03-01 00:02:00.000 060       235.00    122.00   -113.00      5.00\n2015-03-01 00:03:00.000 060       225.00    120.00   -105.00      8.00\nDATE       TIME         DOY     DST                                  |\n2015-03-01 00:00:00.000 060       -34.00\n2015-03-01 01:00:00.000 060       -44.00\n2015-03-01 02:00:00.000 060       -30.00\n2015-03-01 03:00:00.000 060       -31.00\nWe then parse the data into TimeSeries using DelimitedFiles and TimeSeries.\n\n\nCode\nstart_time = \"2015-03-01T00:00:00\"\nend_time = \"2015-03-31T23:59:59\"\n\n# Step 2: Parse AE data\nfunction load_ae_data(filename)\n    meta = Dict(\n        \"unit\" =&gt; \"nT\",\n        \"label\" =&gt; \"AE Index\"\n    )\n\n    # Skip the header lines (first 14 lines)\n    data, header = readdlm(filename, skipstart=14, header=true)\n\n    # Convert date and time columns to DateTime\n    datetime = DateTime.(data[:, 1] .* \"T\" .* data[:, 2])\n\n    TimeArray(datetime, data[:, 4:7], header[4:7], meta)\nend\n\nfunction load_dst_data(filename)\n    meta = Dict(\n        \"unit\" =&gt; \"nT\",\n        \"label\" =&gt; \"Dst Index\"\n    )\n\n    # Skip the header lines (first 17 lines)\n    data, header = readdlm(filename, skipstart=17, header=true)\n\n    # Convert date and time columns to DateTime\n    datetime = DateTime.(data[:, 1] .* \"T\" .* data[:, 2])\n\n    TimeArray(datetime, data[:, 4:4], header[4:4], meta)\nend\n\nprintln(\"Parsing AE data...\")\nae_data = load_ae_data(ae_file)\n\nprintln(\"Parsing Dst data...\")\ndst_data = load_dst_data(dst_file)\n\n\nParsing AE data...\nParsing Dst data...\n\n\n744×1 TimeSeries.TimeArray{Any, 2, Dates.DateTime, Matrix{Any}} 2015-03-01T00:00:00 to 2015-03-31T23:00:00\n┌─────────────────────┬───────┐\n│                     │ DST   │\n├─────────────────────┼───────┤\n│ 2015-03-01T00:00:00 │ -34.0 │\n│ 2015-03-01T01:00:00 │ -44.0 │\n│ 2015-03-01T02:00:00 │ -30.0 │\n│ 2015-03-01T03:00:00 │ -31.0 │\n│ 2015-03-01T04:00:00 │ -28.0 │\n│ 2015-03-01T05:00:00 │ -42.0 │\n│ 2015-03-01T06:00:00 │ -55.0 │\n│ 2015-03-01T07:00:00 │ -53.0 │\n│          ⋮          │   ⋮   │\n│ 2015-03-31T17:00:00 │   2.0 │\n│ 2015-03-31T18:00:00 │  -7.0 │\n│ 2015-03-31T19:00:00 │  -9.0 │\n│ 2015-03-31T20:00:00 │ -10.0 │\n│ 2015-03-31T21:00:00 │ -12.0 │\n│ 2015-03-31T22:00:00 │ -12.0 │\n│ 2015-03-31T23:00:00 │ -12.0 │\n└─────────────────────┴───────┘\n               729 rows omitted\n\n\nPlot the data using CairoMakie.\n\n\nCode\nMakie.convert_arguments(P::Type{&lt;:Lines}, ta::TimeArray) = convert_arguments(P, timestamp(ta), values(ta))\n\nylabel(ta::TimeArray) = meta(ta)[\"label\"] * (isnothing(meta(ta)[\"unit\"]) || meta(ta)[\"unit\"] == \"\" ? \"\" : \" (\" * meta(ta)[\"unit\"] * \")\")\n\nfunction tplot(tas; linkxaxes=true, figure=(;), kwargs...)\n    f = Figure(; figure...)\n    axs = []\n    for (i, ta) in enumerate(tas)\n        ax = Axis(f[i, 1]; ylabel=ylabel(ta))\n\n        for p in propertynames(ta)\n            lines!(ax, getproperty(ta, p); label=p)\n        end\n\n        # Hide redundant x labels\n        linkxaxes && i != length(tas) && hidexdecorations!(ax, grid=false)\n        push!(axs, ax)\n    end\n    linkxaxes && linkxaxes!(axs...)\n    f\nend\n\nf = tplot([ae_data.AE, dst_data])\n\n\n\n\n\n\n\n\n\n\n\n\n\nIn a second paragraph do the same as above but for Kp. What is Kp index? And how is it derived?\n\nThe Kp index is a global geomagnetic activity index that quantifies disturbances in Earth’s magnetic field caused by solar activity. Kp is calculated from the K values or the geomagnetic recordings of 13 mid-latitude geomagnetic observatories.\nWe use a web service client to load the data (https://kp.gfz-potsdam.de/en/data) from json format into the TimeArray.\n\n\nCode\nusing JSON3\n\n\"\"\"\nDownload 'Kp', 'ap', 'Ap', 'Cp', 'C9', 'Hp30', 'Hp60', 'ap30', 'ap60', 'SN', 'Fobs' or 'Fadj' index data from kp.gfz-potsdam.de\n\n# Notes\n- 'start_time' and 'end_time': date format 'YYYY-MM-DDThh:mm:ss'\n\"\"\"\nfunction load_Kp_data(start_time, end_time, index=:Kp)\n    url = \"https://kp.gfz-potsdam.de/app/json/?start=$(start_time)Z&end=$(end_time)Z&index=$(index)\"\n    data = JSON3.read(download(url))\n    datetime = DateTime.(data[:datetime], \"yyyy-mm-ddTHH:MM:SSZ\")\n    TimeArray(datetime, Float64.(data[index]), [index], Dict(\"unit\" =&gt; \"\", \"label\" =&gt; string(index)))\nend\n\nkp_data = load_Kp_data(start_time, end_time)\n\n\n248×1 TimeSeries.TimeArray{Float64, 1, Dates.DateTime, Vector{Float64}} 2015-03-01T00:00:00 to 2015-03-31T21:00:00\n┌─────────────────────┬───────┐\n│                     │ Kp    │\n├─────────────────────┼───────┤\n│ 2015-03-01T00:00:00 │   5.0 │\n│ 2015-03-01T03:00:00 │   5.0 │\n│ 2015-03-01T06:00:00 │ 5.333 │\n│ 2015-03-01T09:00:00 │ 3.667 │\n│ 2015-03-01T12:00:00 │   2.0 │\n│ 2015-03-01T15:00:00 │ 1.333 │\n│ 2015-03-01T18:00:00 │ 2.333 │\n│ 2015-03-01T21:00:00 │ 2.667 │\n│          ⋮          │   ⋮   │\n│ 2015-03-31T03:00:00 │ 0.667 │\n│ 2015-03-31T06:00:00 │ 2.333 │\n│ 2015-03-31T09:00:00 │ 2.333 │\n│ 2015-03-31T12:00:00 │   3.0 │\n│ 2015-03-31T15:00:00 │   3.0 │\n│ 2015-03-31T18:00:00 │ 2.667 │\n│ 2015-03-31T21:00:00 │   2.0 │\n└─────────────────────┴───────┘\n               233 rows omitted\n\n\n\n\n\n\n[c] Plot all 3 indices in a single plot with common time, UT in usual units [2015-03-01 00:00]. If you cannot plot in this format, simply plot in decimal day or decimal hour.\n\n\n\nCode\nf = tplot([ae_data.AE, dst_data, kp_data])",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "Homework",
      "Problem Set 1"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps1.html#galileo-magnetometer-pds",
    "href": "docs/courses/epss261/homework/ps1.html#galileo-magnetometer-pds",
    "title": "Problem Set 1",
    "section": "2 Galileo Magnetometer PDS",
    "text": "2 Galileo Magnetometer PDS\n\nObtain and plot the Galileo magnetometer flyby #8 data of Ganymede from the Planetary Data System (PDS). This is the NASA data repository of Planetary missions, the counterpart of SPDF (Space Physics Data Facility) used for Heliophysics missions. Note that planetary magnetospheric quantities are stored in both. UCLA is the central “node” for PDS with Prof. Walker the PI of that program. Use your own tools such as Excel (but not SPEDAS) to do this (you are welcome to use SPLASH if on Windows (download it from PDS)).\n\n\n2.1 Coordinate system\n\nIn a short paragraph explain: What is the coordinate system and how did you download and plot?\n\nDataset about Galileo (https://pds-ppi.igpp.ucla.edu/mission/Galileo) flyby of Ganymede is available in the Planetary Data System (PDS) https://pds-ppi.igpp.ucla.edu/collection/urn:nasa:pds:galileo-mag-jup-calibrated:data-highres-ganymede (Kivelson 2024). Galileo calibrated MAG high-resolution magnetic field and trajectory data from the Ganymede 8 orbit Ganymede flyby cover 1997-05-07T15:36:00 to 1997-05-07T16:22:00.\nThe dataset contains data in the following coordinate systems:\n\nGanymede Phi-Omega (GPHIO) coordinates https://pds-ppi.igpp.ucla.edu/item/urn:nasa:pds:galileo-mag-jup-calibrated:data-highres-ganymede:orb08_gan_gphio::1.0 (Kivelson 2022).\nGanymede-centered ‘planetocentric’ right-handed (GSPRH) coordinates https://pds-ppi.igpp.ucla.edu/item/urn:nasa:pds:galileo-mag-jup-calibrated:data-highres-ganymede:orb08_gan_gsprh::1.0\nDespun Spacecraft (IRC) coordinates https://pds-ppi.igpp.ucla.edu/item/urn:nasa:pds:galileo-mag-jup-calibrated:data-highres-ganymede:orb08_gan_irc::1.0\nSystem III [1965] (SYS3) coordinates https://pds-ppi.igpp.ucla.edu/item/urn:nasa:pds:galileo-mag-jup-calibrated:data-highres-ganymede:orb08_gan_sys3::1.0\n\nThe data is downloaded as CSV format, read and plot using Julia.\n\n\nCode\nregister(DataDep(\"ORB08_GAN_GPHIO\",\n    \"\"\"\n    Dataset: ORB08_GAN_GPHIO\n    Website: https://pds-ppi.igpp.ucla.edu/mission/Galileo\n    \"\"\",\n    \"https://pds-ppi.igpp.ucla.edu/ditdos/write?id=urn:nasa:pds:galileo-mag-jup-calibrated:data-highres-ganymede:orb08_gan_gphio::1.0&f=csv\"\n))\n\nGAN_file = readdir(datadep\"ORB08_GAN_GPHIO\", join=true)[1]\n\ndata = CSV.File(GAN_file) |&gt; DataFrame\n\n\n┌ Warning: Over-writing registration of the datadep\n│   name = \"ORB08_GAN_GPHIO\"\n└ @ DataDeps ~/.julia/packages/DataDeps/Y2lje/src/registration.jl:15\n\n\n8187×8 DataFrame8162 rows omitted\n\n\n\nRow\nSPACECRAFT EVENT TIME\nBX\nBY\nBZ\nB-FIELD MAGNITUDE\nX\nY\nZ\n\n\n\nDateTime\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\nFloat64\n\n\n\n\n1\n1997-05-07T15:36:55.133\n-8.36\n-25.04\n-85.24\n89.23\n-1.57456\n-3.67635\n0.6489\n\n\n2\n1997-05-07T15:36:55.467\n-8.38\n-25.16\n-85.22\n89.25\n-1.57452\n-3.67527\n0.64893\n\n\n3\n1997-05-07T15:36:55.800\n-8.41\n-25.09\n-85.24\n89.25\n-1.57448\n-3.6742\n0.64897\n\n\n4\n1997-05-07T15:36:56.133\n-8.44\n-25.08\n-85.27\n89.28\n-1.57445\n-3.67313\n0.649\n\n\n5\n1997-05-07T15:36:56.467\n-8.5\n-25.16\n-85.19\n89.23\n-1.57441\n-3.67206\n0.64904\n\n\n6\n1997-05-07T15:36:56.800\n-8.47\n-25.18\n-85.18\n89.23\n-1.57437\n-3.67098\n0.64907\n\n\n7\n1997-05-07T15:36:57.133\n-8.6\n-25.2\n-85.18\n89.25\n-1.57434\n-3.66991\n0.64911\n\n\n8\n1997-05-07T15:36:57.467\n-8.47\n-25.04\n-85.12\n89.13\n-1.5743\n-3.66884\n0.64914\n\n\n9\n1997-05-07T15:36:57.800\n-8.44\n-25.04\n-85.17\n89.17\n-1.57426\n-3.66777\n0.64918\n\n\n10\n1997-05-07T15:36:58.133\n-8.41\n-25.3\n-85.06\n89.14\n-1.57423\n-3.66669\n0.64921\n\n\n11\n1997-05-07T15:36:58.467\n-8.39\n-25.27\n-85.0\n89.08\n-1.57419\n-3.66562\n0.64925\n\n\n12\n1997-05-07T15:36:58.800\n-8.37\n-25.01\n-85.09\n89.09\n-1.57415\n-3.66455\n0.64928\n\n\n13\n1997-05-07T15:36:59.133\n-8.37\n-24.98\n-85.12\n89.11\n-1.57411\n-3.66348\n0.64932\n\n\n⋮\n⋮\n⋮\n⋮\n⋮\n⋮\n⋮\n⋮\n⋮\n\n\n8176\n1997-05-07T16:22:20.132\n-10.75\n17.76\n-86.47\n88.93\n-1.00607\n5.14564\n0.79636\n\n\n8177\n1997-05-07T16:22:20.465\n-10.86\n17.67\n-86.62\n89.06\n-1.00598\n5.1467\n0.79637\n\n\n8178\n1997-05-07T16:22:20.799\n-10.95\n17.63\n-86.69\n89.14\n-1.00589\n5.14777\n0.79637\n\n\n8179\n1997-05-07T16:22:21.132\n-10.91\n17.59\n-86.88\n89.32\n-1.00579\n5.14884\n0.79638\n\n\n8180\n1997-05-07T16:22:21.465\n-10.86\n17.93\n-86.6\n89.1\n-1.0057\n5.1499\n0.79638\n\n\n8181\n1997-05-07T16:22:21.799\n-10.97\n17.63\n-86.44\n88.9\n-1.00561\n5.15097\n0.79639\n\n\n8182\n1997-05-07T16:22:22.132\n-11.01\n17.53\n-86.46\n88.9\n-1.00551\n5.15204\n0.79639\n\n\n8183\n1997-05-07T16:22:22.465\n-10.98\n17.45\n-86.38\n88.81\n-1.00542\n5.1531\n0.7964\n\n\n8184\n1997-05-07T16:22:22.799\n-11.05\n17.35\n-86.41\n88.82\n-1.00533\n5.15417\n0.7964\n\n\n8185\n1997-05-07T16:22:23.132\n-11.07\n17.39\n-86.42\n88.84\n-1.00523\n5.15524\n0.79641\n\n\n8186\n1997-05-07T16:22:23.465\n-11.17\n17.37\n-86.27\n88.71\n-1.00514\n5.1563\n0.79641\n\n\n8187\n1997-05-07T16:22:23.465\n-11.17\n17.37\n-86.27\n88.71\n-1.00514\n5.1563\n0.79641\n\n\n\n\n\n\n\n\n2.2 Plot\n\nPlot XYZ components and magnitude of the field in four panels. Use a 5th panel in the same plot to show all four traces with different colors, say: Blue, Green, Red, Black for X,Y,Z,T.\n\n\n\nCode\n# Create the plot with multiple panels\nfig = Figure(; size=(600, 600))\n\ntime = data.\"SPACECRAFT EVENT TIME\"\n\n# Panel for BX\nax1 = Axis(fig[1, 1], title=\"BX Component\", xlabel=\"Time\", ylabel=\"BX (nT)\")\nlines!(ax1, time, data[!, \"BX\"], color=:blue)\n\n# Panel for BY\nax2 = Axis(fig[2, 1], title=\"BY Component\", xlabel=\"Time\", ylabel=\"BY (nT)\")\nlines!(ax2, time, data[!, \"BY\"], color=:green)\n\n# Panel for BZ\nax3 = Axis(fig[3, 1], title=\"BZ Component\", xlabel=\"Time\", ylabel=\"BZ (nT)\")\nlines!(ax3, time, data[!, \"BZ\"], color=:red)\n\n# Panel for B-FIELD MAGNITUDE\nax4 = Axis(fig[4, 1], title=\"B-Field Magnitude\", xlabel=\"Time\", ylabel=\"Magnitude (nT)\")\nlines!(ax4, time, data[!, \"B-FIELD MAGNITUDE\"], color=:black)\n\n# Panel for all traces\nax5 = Axis(fig[5, 1], title=\"All Components\", xlabel=\"Time\", ylabel=\"B (nT)\")\nlines!(ax5, time, data[!, \"BX\"], color=:blue, label=\"BX\")\nlines!(ax5, time, data[!, \"BY\"], color=:green, label=\"BY\")\nlines!(ax5, time, data[!, \"BZ\"], color=:red, label=\"BZ\")\nlines!(ax5, time, data[!, \"B-FIELD MAGNITUDE\"], color=:black, label=\"Magnitude\")\n\nfor ax in [ax1, ax2, ax3, ax4]\n    hidexdecorations!(ax, grid=false)\nend\n\nlinkxaxes!(ax1, ax2, ax3, ax4, ax5)\naxislegend(ax5)\n\nfig",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "Homework",
      "Problem Set 1"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps1.html#voyager-2-heliospheric-termination-shock",
    "href": "docs/courses/epss261/homework/ps1.html#voyager-2-heliospheric-termination-shock",
    "title": "Problem Set 1",
    "section": "3 Voyager 2 Heliospheric termination shock",
    "text": "3 Voyager 2 Heliospheric termination shock\n\nVoyager 2 crossed the Heliospheric termination shock and entered the heliosheath in Aug. 2007.\n\n\n3.1 Plot and analysis\n\n[a] Plot the shock crossing in CDAWeb using their own plotting resources. In particular plot the total and RTN components of the magnetic field, flow speed, proton density N, and temperature T. In a short paragraph explain: what is the RTN system and how did you create the plot? In a second paragraph explain if the changes in the above parameters are consistent with shock crossings.\n\nThe RTN (Radial-Tangential-Normal) coordinate system is a heliocentric coordinate system used to describe the position in relation to the Sun fixed at a spacecraft (or the planet): The R axis is directed radially away from the Sun, the T axis is the cross product of the solar rotation axis and the R axis, and the N axis is the cross product of R and T.\n\nWe utilize the combined COHOWeb dataset (VOYAGER2_COHO1HR_MERGED_MAG_PLASMA, https://cdaweb.gsfc.nasa.gov/misc/NotesV.html#VOYAGER2_COHO1HR_MERGED_MAG_PLASMA) (Ness et al. 2023). The plot was generated using “CDAWeb Data Explorer” by selecting the “Plot Data” option and choosing the appropriate data variable. We select time range from 2007/08/01 00:00:00.000 to 2007/09/30 00:00:00.000.\nAround the end of August 31, we observe a significant decrease in bulk flow velocity accompanied by increases in proton density and temperature, corresponding to the shock crossing. Additionally, the magnetic field exhibits a slight increase. These changes are consistent with shock crossings, as shocks typically cause reductions in downstream flow velocity and simultaneous enhancements in plasma density, temperature, and magnetic field strength.\n\n[b] What is the change in pressure, including dynamic pressure, across the shock (assume the crossing is along the shock normal)? To do this also ignore the electron thermal pressure (just use ion thermal pressure) and plot the quantity: N*V^2 + Pt, where Pt is the sum of magnetic and thermal pressures. Do this using your own tools (not SPEDAS) after downloading the data from SPDF.\n\n\n\nCode\nusing Unitful\nusing Unitful: μ0, k, mp\n\nregister(DataDep(\"VOYAGER2_COHO1HR_MERGED_MAG_PLASMA\",\n    \"\"\"\n    Dataset: VOYAGER2_COHO1HR_MERGED_MAG_PLASMA\n    Website: https://cdaweb.gsfc.nasa.gov/misc/NotesV.html#VOYAGER2_COHO1HR_MERGED_MAG_PLASMA\n    \"\"\",\n    \"https://cdaweb.gsfc.nasa.gov/tmp/cweb_B6vad1PhkF/VOYAGER2_COHO1HR_MERGED_MAG_PLASMA_1663093.csv\"\n))\n\n# Read the CSV file\nVIM_file = readdir(datadep\"VOYAGER2_COHO1HR_MERGED_MAG_PLASMA\", join=true)[1]\ndata = CSV.File(VIM_file; comment=\"#\") |&gt; DataFrame\n\nallowmissing!(data)\ndata[!, \"time\"] = DateTime.(data.\"EPOCH_yyyy-mm-ddThh:mm:ss.sssZ\", \"yyyy-mm-ddTHH:MM:SS.sssZ\")\nfor c ∈ eachcol(data)\n    replace!(c, -1.0e31 =&gt; missing)\nend\ndropmissing!(data)\n\nN = data[!, \"SW_PROTON_DENS_n/cc\"] * u\"cm^-3\"\nV = data[!, \"BULK_FLOW_SPEED_km/s\"] * u\"km/s\"\nB = data[!, \"FIELD_MAGNITUDE_AVG._nT\"] * u\"nT\"\nT = data[!, \"RADIAL_PROTON_TEMP_deg_k\"] * u\"K\"\n\n# Calculate the pressure\npB = B .^ 2 / μ0 / 2 ./ 1u\"nPa\" .|&gt; NoUnits\npT = k * N .* T ./ u\"nPa\" .|&gt; NoUnits\npRam = mp * N .* V .^ 2 ./ u\"nPa\" .|&gt; NoUnits\npressure = pRam .+ pB .+ pT\nbeta = pT ./ pB\ntime = data.\"time\"\n\n# Plot the data\nfig = Figure()\nax = Axis(fig[1, 1], title=\"Pressure Across Shock\", xlabel=\"Time\", ylabel=\"Pressure (nPa)\")\nlines!(time, pRam, color=:blue, label=\"Ram Pressure\")\nlines!(time, pB, color=:green, label=\"Magnetic Pressure\")\nlines!(time, pT, color=:red, label=\"Thermal Pressure\")\nlines!(time, pressure, color=:black, label=\"Total Pressure\")\naxislegend(ax)\n\nax2 = Axis(fig[2, 1], xlabel=\"Time\", ylabel=\"Beta\")\nlines!(time, beta)\n\nhidexdecorations!(ax, grid=false)\nfig\n\n\n┌ Warning: Over-writing registration of the datadep\n│   name = \"VOYAGER2_COHO1HR_MERGED_MAG_PLASMA\"\n└ @ DataDeps ~/.julia/packages/DataDeps/Y2lje/src/registration.jl:15",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "Homework",
      "Problem Set 1"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps4.html",
    "href": "docs/courses/astr145/homework/ps4.html",
    "title": "Problem Set 4",
    "section": "",
    "text": "There are two main categories of CL AGNs:\n\nChanging-Obscuration AGNs: variations in the line-of-sight column density, often due to clouds or outflows obscuring the central engine, lead to observable spectral changes.\nChanging-State AGNs: the continuum emission and broad emission lines appear or disappear, typically triggered by significant changes in the accretion rate of the supermassive black hole.\n\nSeveral open questions are listed in (ramosalmeidaNuclearObscurationActive2017?). One of the most intriguing question about CS-AGN is their typical timescales and their frequency of occurrence. New telescopes and surveys will help us answer it.",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 4"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps4.html#changing-look-agns",
    "href": "docs/courses/astr145/homework/ps4.html#changing-look-agns",
    "title": "Problem Set 4",
    "section": "",
    "text": "There are two main categories of CL AGNs:\n\nChanging-Obscuration AGNs: variations in the line-of-sight column density, often due to clouds or outflows obscuring the central engine, lead to observable spectral changes.\nChanging-State AGNs: the continuum emission and broad emission lines appear or disappear, typically triggered by significant changes in the accretion rate of the supermassive black hole.\n\nSeveral open questions are listed in (ramosalmeidaNuclearObscurationActive2017?). One of the most intriguing question about CS-AGN is their typical timescales and their frequency of occurrence. New telescopes and surveys will help us answer it.",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 4"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps7.html",
    "href": "docs/courses/astr145/homework/ps7.html",
    "title": "Problem Set 7",
    "section": "",
    "text": "Code\nusing DrWatson\nusing Unitful: Mass, Length\ninclude(srcdir(\"astr145/main.jl\"))\n\n\nescape_velocity (generic function with 1 method)",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 7"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps7.html#the-gzk-cutoff",
    "href": "docs/courses/astr145/homework/ps7.html#the-gzk-cutoff",
    "title": "Problem Set 7",
    "section": "1 The GZK Cutoff",
    "text": "1 The GZK Cutoff\n\nAssuming a head-on collision along the x-axis, the four-momenta of the proton (assumed to be ultra-relativistic) and CMB photon are Pp = (Ep/c, pp, 0, 0) and Pγ = (Eγ/c, −Eγ/c, 0, 0), where E2 p = m2 pc4 + p2 pc2 and Pp · Pp = −m2 pc2, with mpc2 = 938.3 MeV.\n\n\n\nCode\nuconvert(u\"MeV\", Unitful.k * T_CMB)\n\n\n2.348636945931144e-10 MeV\n\n\n\n\nCode\nlet M = 1u\"Msun\", R = 10u\"km\"\n    breakup_velocity(M, R)\nend\n\n\n1.1520088541326408e8 m s⁻¹",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 7"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps7.html#how-common-are-grbs",
    "href": "docs/courses/astr145/homework/ps7.html#how-common-are-grbs",
    "title": "Problem Set 7",
    "section": "2 How Common Are GRBs?",
    "text": "2 How Common Are GRBs?\n\nThe observed rate of GRBs across the sky is roughly two per day. (a) If GRBs are two-sided jets with a typical half-opening angle of four degrees, what is the true rate of GRB events in the observable Universe? (b) GRBs are visible to distances of ∼ 10 Gpc. What is the space density of GRBs? If the star formation rate density in this same volume is ∼ \\(1(M_⊙/yr) Mpc^{−3}\\), how many GRBs occur per unit mass of stars formed? Compare this to the similar number for Type II supernovae, which is one supernova per 100 M formed. (c) The stellar mass of the Milky Way is ∼ \\(10^{11} M_⊙\\) . How many GRBs have occurred in the history of the Milky Way? How many have occurred within the last 10,000 years (i.e., may have been observed by humans, if they were pointed in the right direction)? Over this span, the star formation rate of the Milky Way was ∼ 1(M_⊙/yr).",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 7"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps7.html#the-hulse-taylor-pulsar",
    "href": "docs/courses/astr145/homework/ps7.html#the-hulse-taylor-pulsar",
    "title": "Problem Set 7",
    "section": "3 The Hulse-Taylor Pulsar",
    "text": "3 The Hulse-Taylor Pulsar\n\nHulse and Taylor were awarded the Nobel Prize in Physics in 1993 for their analysis of the binary neutron star PSR B1913+16, in which they showed that its orbit was gradually shrinking as a result of gravitational wave emission, a key prediction of Einstein’s theory of General Relativity. Let us take μ = M1M2/(M1 + M2) is the reduced mass and M = M1 + M2 is the total mass. You may assume that both masses are the same, M1 = M2 = 1.4 M⊙, and remain constant as the orbit evolves. The total angular momentum of the system, assuming circular orbits, is is \\(L = μ \\sqrt{G M a}\\), where a is the separation of the stars. General relativity predicts that the orbit will lose angular momentum due to gravitational waves at a rate: dL dt = − , (5) (You don’t need to derive this!) (a) Because the masses are constant, gravitational waves cause the orbital radius to decrease. By taking the derivative of L(t) for a binary in a circular orbit, show that dL / dt = √ ( G M_1^3 / 2) da / dt .\n\n\n\nCode\nfunction t_merge(M, a0)\n    5 * (c^5 * a0^4) / (512 * G^3 * M^3) |&gt; u\"yr\"\nend\n\n\n\"\"\"binary’s orbital period Pb\"\"\"\nfunction P_b(M, a0)\n    sqrt(4 * pi^2 * a0^3 / G / M) |&gt; u\"yr\"\nend\n\n@show t_merge(1.4u\"Msun\", 1e7u\"m\")\n\na0 = 3e9u\"m\"\n\n@show P_b(2.8u\"Msun\", a0) |&gt; u\"hr\"\n\n\nt_merge(1.4 * u\"Msun\", 1.0e7 * u\"m\") = 1.1683704968163275 yr\nP_b(2.8 * u\"Msun\", a0) |&gt; u\"hr\" = 14.87731015234723 hr\n\n\n14.87731015234723 hr\n\n\n\n\nCode\nfunction dPbdt(M, Pb)\n    -192 * pi / 2^(1 / 3) / 5 * (G * M / c^3)^(5 / 3) * (2 * pi / Pb)^(5 / 3) |&gt; upreferred\nend\n\nlet M = 1.4u\"Msun\", Pb = 8u\"hr\"\n    @show dPbdt(M, Pb)\nend\n\n\ndPbdt(M, Pb) = -1.8912371970169034e-13 s⁻¹ᐟ⁴⁵⁰³⁵⁹⁹⁶²⁷³⁷⁰⁴⁹⁶\n\n\n-1.8912371970169034e-13 s⁻¹ᐟ⁴⁵⁰³⁵⁹⁹⁶²⁷³⁷⁰⁴⁹⁶",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 7"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps7.html#gamma-ray-bursts",
    "href": "docs/courses/astr145/homework/ps7.html#gamma-ray-bursts",
    "title": "Problem Set 7",
    "section": "4 Gamma-Ray Bursts",
    "text": "4 Gamma-Ray Bursts\nThe traditional classification of gamma-ray bursts (GRBs) into short and long categories has been challenged by recent observations. Notably, GRB 230307A, a long-duration burst lasting approximately 200 seconds, was linked to the merger of two neutron stars—a phenomenon typically associated with short GRBs. This event, observed by NASA’s James Webb Space Telescope, also marked the first detection of the heavy element tellurium from such a merger, highlighting the role of these cosmic events in synthesizing heavy elements.",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 7"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps8.html",
    "href": "docs/courses/astr145/homework/ps8.html",
    "title": "Problem Set 8",
    "section": "",
    "text": "For the dipole model of pulsar emission, we found that\n\\[\nB_p^2 = \\frac{3}{2 π^2} \\frac{c^3 I}{R^6} \\dot{P} P\n\\]\nwhere \\(P\\) is the period, \\(\\dot{P}\\) is the time derivative of the period, \\(R\\) is the radius of the neutron star, and \\(I\\) is its moment of inertia.\n\nAssume that the neutron star is born with an initial period \\(P_0\\) at \\(t = 0\\). Show that\n\n\\[\nP (t) =  \\sqrt{ \\frac{4π^2 R^6}{3c^3 I} B_p^2 t + P_0^2} .\n\\]\n\nAssuming that \\(P P_0\\), show that the time since the pulsar was born is \\(\\tau = P/(2\\dot{P})\\).\nOn the last problem set, you found that a newly-formed pulsar would have \\(P_0 \\approx 3 \\text{ ms}\\) and \\(B_p \\approx 10^{12} \\text{ G}\\). Estimate how long (in years) the pulsar would take to slow down to \\(P \\approx 1 \\text{ s}\\), if it has a radius of 10 km and a moment of inertia of \\(10^{45} \\text{ g cm}^2\\). You may assume \\(\\dot{P}\\) remains constant through the evolution.",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 8"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps8.html#pulsar-ages",
    "href": "docs/courses/astr145/homework/ps8.html#pulsar-ages",
    "title": "Problem Set 8",
    "section": "",
    "text": "For the dipole model of pulsar emission, we found that\n\\[\nB_p^2 = \\frac{3}{2 π^2} \\frac{c^3 I}{R^6} \\dot{P} P\n\\]\nwhere \\(P\\) is the period, \\(\\dot{P}\\) is the time derivative of the period, \\(R\\) is the radius of the neutron star, and \\(I\\) is its moment of inertia.\n\nAssume that the neutron star is born with an initial period \\(P_0\\) at \\(t = 0\\). Show that\n\n\\[\nP (t) =  \\sqrt{ \\frac{4π^2 R^6}{3c^3 I} B_p^2 t + P_0^2} .\n\\]\n\nAssuming that \\(P P_0\\), show that the time since the pulsar was born is \\(\\tau = P/(2\\dot{P})\\).\nOn the last problem set, you found that a newly-formed pulsar would have \\(P_0 \\approx 3 \\text{ ms}\\) and \\(B_p \\approx 10^{12} \\text{ G}\\). Estimate how long (in years) the pulsar would take to slow down to \\(P \\approx 1 \\text{ s}\\), if it has a radius of 10 km and a moment of inertia of \\(10^{45} \\text{ g cm}^2\\). You may assume \\(\\dot{P}\\) remains constant through the evolution.",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 8"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps8.html#binary-evolution",
    "href": "docs/courses/astr145/homework/ps8.html#binary-evolution",
    "title": "Problem Set 8",
    "section": "2 Binary Evolution",
    "text": "2 Binary Evolution\nAs a star transfers mass to a nearby compact object, the mass ratio of the system changes, and hence the dynamics will evolve. Here you will examine how this evolution occurs in a low-mass X-ray binary. Let us consider two stars of masses m1 and m2 on circular orbits in a system in which the center of mass is the origin.\n\nA very simple approximation to the Roche lobe radius of star 1, \\(R_{L,1}\\) is\n\n\\[\nR_{L, 1} \\sim \\frac{a}{2}\\left(\\frac{m_1}{m_{\\mathrm{tot}}}\\right)^{1 / 3}\n\\]\nwhere \\(q=M_1 / M_2\\). Show that\n\\[\n\\frac{\\Delta R_{L, 1}}{R_{L, 1}} \\sim\\left(\\frac{5 / 3}{m_1}-\\frac{2}{m_2}\\right) \\Delta m_2\n\\]\nRemember that both \\(a\\) and \\(q\\) change in this situation!\n\nLow-mass stars on the main sequence have a mass-radius relation\n\n\\[\nR \\approx 0.9\\left(\\frac{M}{M_{\\odot}}\\right)^\\alpha R_{\\odot}\n\\]\nwhere \\(\\alpha \\approx 0.9\\). Show that the radius of star \\(1, R_{\\star, 1}\\), changes as\n\\[\n\\frac{\\Delta R_{\\star, 1}}{R_{\\star, 1}}=\\alpha \\frac{\\Delta m_1}{m_1}=-\\alpha \\frac{\\Delta m_2}{m_1} .\n\\]\nas it loses mass to its companion.\n\nTo avoid Roche lobe overflow, we need \\(|∆ R_{\\star, 1}| &gt; |∆ R_{L,1}|\\), so that the star shrinks more rapidly than the Roche lobe: otherwise the Roche lobe will shrink so fast that the mass transfer runs away.. Show that this requires \\(q\\le1.3\\). (With the true form of \\(R_L(q)\\), the threshold is slightly smaller.) We thus generally find that the donor star is less massive than the accreting object in X-ray binaries! This is believed to be why there are so few intermediate mass X-ray binaries: mass transfer proceeds very rapidly until the donor star is less massive than the compact object. Hint: Note that \\(∆R_{L,1} &lt; 0\\) if \\(∆m_2 &gt; 0\\); this will affect how to interpret the absolute value signs.",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 8"
    ]
  },
  {
    "objectID": "docs/courses/astr145/homework/ps8.html#black-hole-mergers",
    "href": "docs/courses/astr145/homework/ps8.html#black-hole-mergers",
    "title": "Problem Set 8",
    "section": "3 Black Hole Mergers",
    "text": "3 Black Hole Mergers\n\nIn the last decade – after many decades of hard work! – physicists have detected gravitational waves from merging stellar mass black holes. These have been quite different from the sources we expected and have raised many questions about stellar mass black holes. Read this article: https://www.quantamagazine.org/colliding-black-holes-tell-new-story-ofstars-20160906/\nSummarize the models for the formation of these systems, and weigh the evidence to determine what you think is the most likely option. (There’s no right answer, though you can find more recent discussions on the internet if you want to see what has been learned since!)\n\n\nCommon-Envelope Evolution (Classic Theory):\n\n\nFormation: A pair of massive stars begins in a wide orbit.\nBlack Hole Formation: Star A collapses into a black hole while Star B grows, further shrinking the orbit. When Star B exhausts its fuel, it also collapses into a black hole. The two black holes, now close, eventually spiral into each other and merge.\nKey Features: This process involves complex interactions with hydrogen envelopes and gas loss, which draw the stars closer.\n\n\nChemically Homogeneous Evolution (New Theory):\n\n\nFormation: Two massive stars in a tight orbit are “tidally locked”. Their rapid spinning stirs the stars, maintaining uniform chemical composition and high internal heat.\nBlack Hole Formation: Unlike most stars, which have distinct core and envelope layers, these stars fuse entirely and contract into compact black holes without shedding much material. The black holes are already close, and their merger happens as they spiral closer due to gravitational waves.\nKey Features: This model skips the envelope phase and results in direct black hole formation in a tight orbit.\n\nThe Chemically Homogeneous Evolution model seems most plausible for explaining the unexpected large masses of black holes in recent mergers. However, the Common-Envelope Evolution might still account for a broader range of scenarios. Future data could favor one model definitively, or they might work in tandem to explain different types of mergers.",
    "crumbs": [
      "Courses",
      "ASTR 145",
      "Homework",
      "Problem Set 8"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/homework/ps1.html",
    "href": "docs/courses/epss298_MHD_turbulence/homework/ps1.html",
    "title": "",
    "section": "",
    "text": "CoursesEPSS 298HomeworkSelective decay of magnetic helicity Code",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Homework",
      "Selective decay of magnetic helicity"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/homework/ps1.html#selective-decay-of-magnetic-helicity",
    "href": "docs/courses/epss298_MHD_turbulence/homework/ps1.html#selective-decay-of-magnetic-helicity",
    "title": "",
    "section": "Selective decay of magnetic helicity",
    "text": "Selective decay of magnetic helicity\n\nProve that in the limit of small resistivity, magnetic helicity\n\n\\[\nH=\\int_{\\mathcal{V}} \\vec{A} \\cdot \\vec{B} d V\n\\]\ndecays much more slowly than magnetic energy\n\\[\nE=\\int_{\\mathcal{V}}|\\vec{B}|^2 d V\n\\]\nHint: use the Schwarz inequality for \\(\\vec{J}\\) and \\(\\vec{B}\\), i.e. \\(|\\vec{J} \\cdot \\vec{B}|^2 \\leq|\\vec{J}|^2|\\vec{B}|^2\\).\nSchnack (2009)",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Homework",
      "Selective decay of magnetic helicity"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/homework/ps1.html#the-conservation-of-cross-helicity",
    "href": "docs/courses/epss298_MHD_turbulence/homework/ps1.html#the-conservation-of-cross-helicity",
    "title": "",
    "section": "The conservation of cross helicity",
    "text": "The conservation of cross helicity\n\nProve equation 2.66 of Biskamp, (without the dissipative terms):\n\n\\[\n\\frac{d H_c}{d t}=-\\int_S \\vec{F}_C \\cdot d \\vec{S}\n\\]\nwhere\n\\[\n\\vec{H}_c=\\int_{\\mathcal{V}} \\vec{v} \\cdot \\vec{B} d V\n\\]\nand\n\\[\nF_C=\\vec{v} \\times(\\vec{v} \\times \\vec{B})+\\vec{B}\\left(\\frac{\\gamma p}{(\\gamma-1) \\rho}+\\phi_g\\right) .\n\\]\n\\(\\phi_g\\) is the gravitational potential \\(\\left(-\\nabla \\phi_g\\right.\\) is the gravitational acceleration and \\(p, \\rho\\) are pressure and density. \\(\\vec{v}, \\vec{B}\\) are velocity and magnetic field. \\(S\\) is the whole surface bounding the plasma volume.",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Homework",
      "Selective decay of magnetic helicity"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/homework/ps1.html#nonlinear-term-in-fourier-space",
    "href": "docs/courses/epss298_MHD_turbulence/homework/ps1.html#nonlinear-term-in-fourier-space",
    "title": "",
    "section": "Nonlinear term in Fourier space",
    "text": "Nonlinear term in Fourier space\n\nWrite the Nonlinear Term for the evolution of Elsasser variables, in incompressible MHD, in the Fourier representation for the components\n\n\\[\n\\left(\\frac{\\partial \\vec{z}_i^{ \\pm}(\\vec{k})}{\\partial t}\\right)_{N L}=? ?\n\\]\nwhere\n\\[\n\\vec{z}_i^{ \\pm}(\\vec{k})=\\frac{1}{(2 \\pi)^3} \\int_{\\mathcal{V}} \\vec{z}_i^{ \\pm}(\\vec{x}) e^{(-i \\vec{k} \\cdot \\vec{x})} d V\n\\]",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Homework",
      "Selective decay of magnetic helicity"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/pre.html",
    "href": "docs/courses/epss298_MHD_turbulence/pre.html",
    "title": "Role of Magnetic Reconnection (Tearing Instability) in Magnetohydrodynamic Turbulence",
    "section": "",
    "text": "(boldyrevTearingInstabilityAlfven2020?)\n(loureiroRoleMagneticReconnection2017?)\n(loureiroCollisionlessReconnectionMagnetohydrodynamic2017?)\n(malletDisruptionAlfvenicTurbulence2017?)\nMallet, Schekochihin, and Chandran (2017)\n(boldyrevMagnetohydrodynamicTurbulenceMediated2017?)\n(boldyrevSpectrumMagnetohydrodynamicTurbulence2006?)\nKey questions: How does magnetic reconnection influence turbulence? What role do tearing instabilities play?\nRecent studies suggest that reconnection via tearing plays a crucial role in mediating the turbulent energy cascade.",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Role of Magnetic Reconnection (Tearing Instability) in Magnetohydrodynamic Turbulence"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/pre.html#theoretical-foundations-in-mhd-turbulence",
    "href": "docs/courses/epss298_MHD_turbulence/pre.html#theoretical-foundations-in-mhd-turbulence",
    "title": "Role of Magnetic Reconnection (Tearing Instability) in Magnetohydrodynamic Turbulence",
    "section": "Theoretical Foundations in MHD Turbulence",
    "text": "Theoretical Foundations in MHD Turbulence\nIncompressible MHD Equations & Turbulence:\n\\[\n\\begin{aligned}\n&\\partial_t \\mathbf{v}+(\\mathbf{v} \\cdot \\nabla) \\mathbf{v}=-\\nabla p+(\\nabla \\times B) \\times \\mathbf{B}+v \\nabla^2 \\mathbf{v}\\\\\n&\\partial_t \\mathbf{B}=\\nabla \\times(\\mathbf{v} \\times \\mathbf{B})+\\eta \\nabla^2 \\mathbf{B}\n\\end{aligned}\n\\]\nConservation laws in decaying MHD turbulence\n\\[\n\\begin{aligned}\n&E=\\frac{1}{2} \\int\\left(v^2+B^2\\right) d^3 x\\\\\n&H^C=\\int(\\mathbf{v} \\cdot \\mathbf{B}) d^3 x\\\\\n&H^M=\\int(\\mathbf{A} \\cdot \\mathbf{B}) d^3 x\n\\end{aligned}\n\\]\n\nMagnetic helicity is better conserved than the energy =&gt; large-scale helical magnetic structures\nCross-helicity may dissipate slower than the energ =&gt; dynamically aligned structures\n\n\nAnisotropic Turbulence Models\n\nIrosnikov & Kraichnan (1963, 1965) \\(\\tau_{IK}(λ) \\sim N λ / V_A \\sim λ / \\delta v_λ\\left(V_A / \\delta v_λ\\right)\\) (kraichnanInertialrangeSpectrumHydromagnetic1965?)\n\n\\[\nE_{IK}(k)=\\left\\langle | \\delta \\mathbf{v}(k)|^2\\right\\rangle k^2 \\propto k^{-3 / 2}\n\\]\nMHD turbulence the energy transfer occurs predominantly in the field-perpendicular direction.\n\nGoldreich & Sridhar (1995, 1997): Introduced anisotropic cascade ideas and scaling predictions for strong Alfvénic turbulence. (goldreichTheoryInterstellarTurbulence1995?)\n\n\\[\nE_{GS}(k_{\\perp}) = \\left\\langle | \\delta \\mathbf{v}(k_{\\perp})|^2\\right\\rangle k_{\\perp} \\propto k_{\\perp}^{-5 / 3}\n\\]\n\nBoldyrev (2006): Modifications, incorporating dynamic alignment effects. Eddies are also anisotropic in the plane perpendicular to the local magnetic field. (boldyrevSpectrumMagnetohydrodynamicTurbulence2006?)",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Role of Magnetic Reconnection (Tearing Instability) in Magnetohydrodynamic Turbulence"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/pre.html#tearing-instability",
    "href": "docs/courses/epss298_MHD_turbulence/pre.html#tearing-instability",
    "title": "Role of Magnetic Reconnection (Tearing Instability) in Magnetohydrodynamic Turbulence",
    "section": "Tearing instability",
    "text": "Tearing instability\nCritical scale \\(\\lambda_{cr}\\) at which the growth rate \\(γ\\) of that mode matches the eddy turn over time at that scale.\nTwo well-known regimes:\n\nFKR (small tearing mode instability parameter, \\(\\Delta^{\\prime}\\) )\nCoppi (large \\(\\Delta^{\\prime}\\) )\n\nThe \\(N=1\\) mode, related to the tearing perturbation wavenumber through \\(k / 2 \\pi=N / \\xi\\), is the most unstable mode until it transitions into the Coppi regime. This happens at the scale that satisfies\n\\[\n(\\xi / \\lambda) S_\\lambda^{-1 / 4} \\sim 1\n\\]\nyielding the transition scale for the \\(N=1\\) mode\n\\[\n\\lambda_{t r, 1} / L \\sim S_L^{-4/9}\n\\]\nIn other words, if \\(\\lambda&gt;\\lambda_{t r, 1}\\), the most unstable mode in the current sheet is an FKR mode; if the opposite is true,",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Role of Magnetic Reconnection (Tearing Instability) in Magnetohydrodynamic Turbulence"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/pre.html#spectrum-of-turbulence-below-the-reconnection-scale",
    "href": "docs/courses/epss298_MHD_turbulence/pre.html#spectrum-of-turbulence-below-the-reconnection-scale",
    "title": "Role of Magnetic Reconnection (Tearing Instability) in Magnetohydrodynamic Turbulence",
    "section": "Spectrum of turbulence below the reconnection scale",
    "text": "Spectrum of turbulence below the reconnection scale\n\n\n\nSketch of the Fourier energy spectrum (log-log scale)\n\n\n\nThese critical current sheets are the structures where ohmic and viscous dissipation is happening. It is reasonable to assume that Eq. (18) sets the dissipation scale, that is, the scale below which the reconnection interval is ultimately terminated by the dissipation. Assuming that the energy spectrum in this interval follows a power law, we write it in the form\n\n\\[\nE\\left(k_{\\perp}\\right) \\propto k_0^{-3 / 2}\\left(k_{\\perp} / k_0\\right)^{-\\alpha}\n\\]\n\\[\n-\\frac{d E}{d t}=\\eta \\int^{k_*} k_{\\perp}^2 E\\left(k_{\\perp}\\right) d k_{\\perp} \\propto S_L^{\\frac{4}{7}\\left(-\\frac{3}{2}+\\alpha\\right)+\\frac{6}{7}(3-\\alpha)-1}\n\\]\nThis defines the scaling of the energy spectrum: \\(\\alpha=5/2\\).",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Role of Magnetic Reconnection (Tearing Instability) in Magnetohydrodynamic Turbulence"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/pre.html#spectrum-of-turbulence-governed-by-the-tearing-instability",
    "href": "docs/courses/epss298_MHD_turbulence/pre.html#spectrum-of-turbulence-governed-by-the-tearing-instability",
    "title": "Role of Magnetic Reconnection (Tearing Instability) in Magnetohydrodynamic Turbulence",
    "section": "Spectrum of turbulence governed by the tearing instability",
    "text": "Spectrum of turbulence governed by the tearing instability\n(boldyrevCalculationsTheoryTearing2018?) considered the general case of an arbitrary tearing parameter, and found these parameters depend on the assumed magnetic shear profile, and they are not universal.\nReplacing the nonlinear turnover time by the tearing time \\(b_a^2 γ=\\varepsilon\\)\n\\[\nb_a \\sim \\varepsilon^{2 / 5} \\eta^{-1 / 5} a^{3 / 5}\n\\]\nand to the energy spectrum\n\\[\nE_{\\mathrm{tanh}}\\left(k_{\\perp}\\right) \\propto k_{\\perp}^{-11 / 5}\n\\]\nA similar estimate for the sine-shaped profile leads to somewhat different scaling exponent\n\\[\nb_a \\sim \\varepsilon^{7 / 18} \\eta^{-1 / 6} a^{5 / 9}\n\\]\nand\n\\[\nE_{\\mathrm{sin}}\\left(k_{\\perp}\\right) \\propto k_{\\perp}^{-19 / 9}\n\\]\n\n\n\nSketch of the tearing-mode growth rate as a function of (\\(k_0 a\\))",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Role of Magnetic Reconnection (Tearing Instability) in Magnetohydrodynamic Turbulence"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/pre.html#reconnection-with-multiple-timescales",
    "href": "docs/courses/epss298_MHD_turbulence/pre.html#reconnection-with-multiple-timescales",
    "title": "Role of Magnetic Reconnection (Tearing Instability) in Magnetohydrodynamic Turbulence",
    "section": "Reconnection with multiple timescales",
    "text": "Reconnection with multiple timescales\n(malletDisruptionAlfvenicTurbulence2017?)\nMallet, Schekochihin, and Chandran (2017)\n\nTearing instability is the initial nonlinear stage of magnetic reconnection, while the term “reconnection” is often used to describe a broader range of associated fully nonlinear phenomena, such as the X-point collapse and formation of plasmoid chains.\n\n\nFirst, there is exponential growth of the linear tearing mode until the width of the island(s) is approximately the width of the inner layer where resistivity is important, w ∼ δin ∼ [γ (kδz)−2λ2η]1/4 , (16) where γ is the linear growth rate of the tearing mode and k ∼ N/ξ is its wavenumber (N is the number of islands).\nSecondly, there may be secular “Rutherford’ growth of the islands until w ∼ 1/ ′, where ′ is the instability parameter for the tearing mode.\n\n\\[\n\\tau_{\\text {Ruth }} \\sim \\frac{1}{\\eta \\Delta^{\\prime 2}} \\sim N^2\\left(\\frac{\\hat{\\lambda}}{\\hat{\\xi}}\\right)^2 S_\\lambda \\frac{\\lambda}{\\delta z} .\n\\]\n\nNote that \\(\\tau_{\\text {Ruth }}\\) increases with \\(N\\), so if the maximum growth rate is attained for the \\(N=1\\) FKR mode, this mode will also exit the Rutherford stage and saturate first. In the FKR limit, \\(\\Delta^{\\prime} \\delta_{\\text {in }} \\ll 1\\), and so there is a well-defined Rutherford stage. For the Coppi modes, \\(\\Delta^{\\prime} \\delta_{\\text {in }} \\sim 1\\), and so there is no Rutherford stage.\n\n\nThirdly, the X-point(s) that have arisen collapse into thin sheets, which then undergo fast reconnection, leaving behind a set of magnetic islands.\n\n\\[\n\\tau_{\\mathrm{D}} \\sim \\begin{cases}\\max \\left[1 / \\gamma_{\\mathrm{FKR}}, \\tau_{\\mathrm{Ruth}}\\right] & \\text { if } \\hat{\\lambda}&gt;\\hat{\\lambda}_{\\mathrm{tr}}, \\\\ 1 / \\gamma_{\\max } & \\text { if } \\hat{\\lambda} \\leq \\hat{\\lambda}_{\\mathrm{tr}}\\end{cases}\n\\]",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Role of Magnetic Reconnection (Tearing Instability) in Magnetohydrodynamic Turbulence"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/pre.html#reconnection-mediated-turbulence-boldyrev-loureiros-contributions",
    "href": "docs/courses/epss298_MHD_turbulence/pre.html#reconnection-mediated-turbulence-boldyrev-loureiros-contributions",
    "title": "EPSS 298",
    "section": "Reconnection-Mediated Turbulence – Boldyrev & Loureiro’s Contributions",
    "text": "Reconnection-Mediated Turbulence – Boldyrev & Loureiro’s Contributions\n•   Boldyrev & Loureiro (2017):\n•   Proposed that reconnection can mediate the turbulence cascade, modifying the traditional picture.\n•   Key idea: Tearing instability within current sheets accelerates energy dissipation.\n•   Further Developments:\n•   Boldyrev & Loureiro (2018): Detailed calculations on tearing mode growth rates and nonlinear evolution.\n•   Boldyrev & Loureiro (2020): Extension of these ideas to both Alfvénic and kinetic-Alfvén turbulence, highlighting the role of tearing in different plasma regimes.\n•   Implication:\n•   Reconnection not only dissipates energy but actively shapes the turbulent spectrum.",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "EPSS 298"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/pre.html#tearing-instability-as-a-turbulence-mediator",
    "href": "docs/courses/epss298_MHD_turbulence/pre.html#tearing-instability-as-a-turbulence-mediator",
    "title": "EPSS 298",
    "section": "Tearing Instability as a Turbulence Mediator",
    "text": "Tearing Instability as a Turbulence Mediator\n\nTurbulent motions generate sheared magnetic structures where magnetic reconnection sets in, which, in turn, modifies turbulent fluctuations at the corresponding scales.\n\n\nTearing instability is the initial nonlinear stage of magnetic reconnection, while the term “reconnection” is often used to describe a broader range of associated fully nonlinear phenomena, such as the X-point collapse and formation of plasmoid chains.\n\n\nA particularly interesting feature of 3D anisotropic eddies is that they can be thought of as current sheets of thickness λ and length ξ in the field-perpendicular plane (with ξ ≫ λ)… The anisotropic, current-sheet-like eddies become the sites of magnetic reconnection before the formal Kolmogorov dissipation scale is reached.\n\n• Instability Mechanism:\n• Detailed look at how the tearing mode disrupts the current sheet, leading to fragmentation.\n• Interaction with the Turbulent Cascade:\n• Tearing-induced reconnection may modify the standard cascade by introducing new characteristic scales.\n• How this mechanism could lead to different regimes of energy dissipation.\n• Theoretical Models & Scaling:\n• Review models by researchers such as Loureiro et al. and Boldyrev & Uzdensky that discuss tearing-mediated turbulence.",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "EPSS 298"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/pre.html#numerical-simulations-observational-evidence",
    "href": "docs/courses/epss298_MHD_turbulence/pre.html#numerical-simulations-observational-evidence",
    "title": "EPSS 298",
    "section": "Numerical Simulations & Observational Evidence",
    "text": "Numerical Simulations & Observational Evidence\n• Simulation Insights:\n• Overview of 2D/3D MHD simulations that capture the onset and evolution of tearing instability in turbulent environments.\n• Discussion of resolution challenges and the importance of high-Lundquist-number simulations.\n• Observational Data:\n• Evidence from solar wind observations, magnetospheric studies, and laboratory experiments.\n• Comparison between simulation predictions and real-world measurements.\n• Key Takeaways:\n• How simulations have confirmed the role of tearing modes in enhancing reconnection rates and altering turbulent spectra.",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "EPSS 298"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/pre.html#recent-developments-critical-literature",
    "href": "docs/courses/epss298_MHD_turbulence/pre.html#recent-developments-critical-literature",
    "title": "EPSS 298",
    "section": "Recent Developments & Critical Literature",
    "text": "Recent Developments & Critical Literature\n• Key Papers & Reviews:\n• Summarize landmark studies (e.g., by Loureiro et al. on plasmoid instability, and reviews by Uzdensky, Boldyrev, Zweibel & Yamada).\n• Current Debates:\n• Discussion on the precise scaling and reconnection rates in high-Lundquist-number regimes.\n• Open questions regarding the interplay between turbulence, reconnection, and particle acceleration.\n• Future Research Directions:\n• Advances in high-resolution simulations.\n• Improved diagnostic tools in laboratory and space plasmas to validate theoretical models.",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "EPSS 298"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/pre.html#theoretical-models-and-scaling-laws",
    "href": "docs/courses/epss298_MHD_turbulence/pre.html#theoretical-models-and-scaling-laws",
    "title": "EPSS 298",
    "section": "Theoretical Models and Scaling Laws",
    "text": "Theoretical Models and Scaling Laws\n•   Current Theoretical Developments:\n•   Uzdensky & Loureiro (2016) and Loureiro & Uzdensky (2015):\n•   Models for the onset of reconnection, including the transition from the Sweet–Parker regime to plasmoid-dominated regimes.\n•   Scaling laws for tearing instability: how the growth rate and nonlinear evolution depend on key plasma parameters (e.g., Lundquist number).\n•   Collisionless vs. Collisional Regimes:\n•   Loureiro & Boldyrev (2017a): Discuss collisionless effects and their role in reconnection within turbulent plasmas.\n•   Implications for Energy Transfer:\n•   How reconnection-induced changes in current-sheet structure alter the turbulent cascade and the efficiency of energy dissipation.",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "EPSS 298"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/pre.html#summary-future-outlook",
    "href": "docs/courses/epss298_MHD_turbulence/pre.html#summary-future-outlook",
    "title": "EPSS 298",
    "section": "Summary & Future Outlook",
    "text": "Summary & Future Outlook\n• Recap of Key Points:\n• Magnetic reconnection, driven by tearing instability, plays a crucial role in mediating energy dissipation in turbulent plasmas.\n• The interplay between turbulence and reconnection leads to complex, multi-scale dynamics.\n• Open Questions:\n• How do different plasma regimes (e.g., high vs. low beta, collisional vs. collisionless) influence tearing-mediated reconnection?\n• What are the implications for energy transfer and particle acceleration in astrophysical systems?\n• Future Prospects:\n• The need for more integrated approaches combining theory, simulation, and observations.",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "EPSS 298"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/index.html",
    "href": "docs/courses/epss261/homework/index.html",
    "title": "EPSS 261 Homework",
    "section": "",
    "text": "Problem Set 1: Geomagnetic Indices, Galileo and Voyager : features retrieving and processing data from different remote sources (e.g. WDC-C in Kyoto, Kp index from GFZ Potsdam, Galileo data from Planetary Data System, and Voyager data from CDAWeb).\nProblem Set 2: Storm energy and field line resonances : features basic timeseries arithmetics, processing, and visualization and field aligned coordinate transformation using Speasy.jl.\nProblem Set 3: Minimum and Maximum Variance Analysis : features using minimum and maximum variance technique to analyze electromagnetic waves and shock crossings.\nProblem Set 4: Magnetopause crossing : features multi-spacecraft analysis (reciprocal vectors technique) to determine boundary normal and velocity, and estimate spatial gradients using Cluster spacecraft.\nProblem Set 5: A whistler mode chorus event : features Electric Field Instruments (EFI) data, wave polarization, time-frequency, and Poynting flux analysis using THEMIS spacecraft.\nProblem Set 6: Electron-scale measurements of magnetic reconnection : features plasma data, energy spectra analysis using Magnetospheric Multiscale Mission (MMS) spacecraft.\n\nNote that SpaceTools.jl has been renamed to SPEDAS.jl: Julia-based Space Physics Environment Data Analysis Software.",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "EPSS 261 Homework"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps4.html",
    "href": "docs/courses/epss261/homework/ps4.html",
    "title": "Problem Set 4",
    "section": "",
    "text": "[1] We discussed barycentric coordinates in Lecture 08, pp. 11-12, and they are covered in Ch. 14 (Chanteur) in the ISSI book pp. 350-351. They are defined based on equation: \\(\\left(\\sum_{α=1}^4 μ_α\\right) \\mathbf{r}=\\sum_{α=1}^4\\left(μ_α \\mathbf{r}_α\\right)\\) with the constraint \\(\\sum_{α=1}^4 μ_α=1\\). We said that this physically means \\(μ_α(\\mathbf{r})=1+\\mathbf{k}_α \\cdot\\left(\\mathbf{r}-\\mathbf{r}_α\\right)\\), a linear decrease of the weight with increasing distance from the vertex \\(r_α\\) of the tetrahedron, scaled according to the reciprocal vector (the inverted distance of vertex to plane across it).\n\n\nProve that \\(μ_α(\\mathbf{r})=1+\\mathbf{k}_α \\cdot\\left(\\mathbf{r}-\\mathbf{r}_α\\right)\\) by using the inverse transformation: \\(\\mathbf{μ}=\\mathbf{T}^{-1}\\left(\\mathbf{r}-\\mathbf{r}_4\\right)\\).\n\nIn barycentric coordinates we have\n\\[\n\\mathbf{r}-\\mathbf{r}_4\n    = \\sum_{α=1}^4(μ_α \\mathbf{r}_α) -  (\\sum_{α=1}^4 μ_α) \\mathbf{r}_4\n    = μ_1 \\mathbf{d}_1 + μ_2 \\mathbf{d}_2 + μ_3\\mathbf{d}_3.\n\\]\nA geometric way to see the first row of \\(T^{-1}\\) is to note that\n\\[\n\\mathbf{k}_1 = \\frac{\\mathbf{d}_2\\times\\mathbf{d}_3} {\\mathbf{d}_1\\cdot(\\mathbf{d}_2\\times\\mathbf{d}_3)}\n\\]\nis the unique “reciprocal vector” satisfying \\(\\mathbf{k}_1\\cdot\\mathbf{d}_1=1\\) and \\(\\mathbf{k}_1\\cdot\\mathbf{d}_2= \\mathbf{k}_1\\cdot\\mathbf{d}_3=0\\) .\nso\n\\[\nT^{-1} = \\left(\\begin{array}{l}\n\\mathbf{k}_1 \\\\\n\\mathbf{k}_2 \\\\\n\\mathbf{k}_3\n\\end{array}\\right)\n\\]\nwith \\(\\mathbf{k}_2,\\mathbf{k}_3\\) defined similarly by the appropriate cross products and normalization.\nTherefore from \\(\\mathbf{μ}=\\mathbf{T}^{-1}\\left(\\mathbf{r}-\\mathbf{r}_4\\right)\\), we have \\(μ_i = \\mathbf{k}_i\\cdot(\\mathbf{r}-\\mathbf{r}_{4})\\), where \\(i=1,2,3\\).\nNotice that \\(\\mathbf{r}-\\mathbf{r}_{4} = (\\mathbf{r}-\\mathbf{r}_1) + \\underbrace{(\\mathbf{r}_1-\\mathbf{r}_{4})}_{=\\mathbf{d}_1}\\) and by construction \\(\\mathbf{k}_1\\cdot\\mathbf{d}_1=1\\).\nTherefore\n\\[\nμ_1 = \\mathbf{k}_1 \\cdot(\\mathbf{r}-\\mathbf{r}_1) + \\mathbf{k}_1 \\cdot\\mathbf{d}_1\n    = 1 + \\mathbf{k}_1 \\cdot(\\mathbf{r}-\\mathbf{r}_1)\n\\]\nBy identical reasoning, \\(μ_α = 1 + \\mathbf{k}_α \\cdot (\\mathbf{r}-\\mathbf{r}_α)\\).",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "EPSS 261 Homework",
      "Problem Set 4"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps4.html#barycentric-coordinates",
    "href": "docs/courses/epss261/homework/ps4.html#barycentric-coordinates",
    "title": "Problem Set 4",
    "section": "",
    "text": "[1] We discussed barycentric coordinates in Lecture 08, pp. 11-12, and they are covered in Ch. 14 (Chanteur) in the ISSI book pp. 350-351. They are defined based on equation: \\(\\left(\\sum_{α=1}^4 μ_α\\right) \\mathbf{r}=\\sum_{α=1}^4\\left(μ_α \\mathbf{r}_α\\right)\\) with the constraint \\(\\sum_{α=1}^4 μ_α=1\\). We said that this physically means \\(μ_α(\\mathbf{r})=1+\\mathbf{k}_α \\cdot\\left(\\mathbf{r}-\\mathbf{r}_α\\right)\\), a linear decrease of the weight with increasing distance from the vertex \\(r_α\\) of the tetrahedron, scaled according to the reciprocal vector (the inverted distance of vertex to plane across it).\n\n\nProve that \\(μ_α(\\mathbf{r})=1+\\mathbf{k}_α \\cdot\\left(\\mathbf{r}-\\mathbf{r}_α\\right)\\) by using the inverse transformation: \\(\\mathbf{μ}=\\mathbf{T}^{-1}\\left(\\mathbf{r}-\\mathbf{r}_4\\right)\\).\n\nIn barycentric coordinates we have\n\\[\n\\mathbf{r}-\\mathbf{r}_4\n    = \\sum_{α=1}^4(μ_α \\mathbf{r}_α) -  (\\sum_{α=1}^4 μ_α) \\mathbf{r}_4\n    = μ_1 \\mathbf{d}_1 + μ_2 \\mathbf{d}_2 + μ_3\\mathbf{d}_3.\n\\]\nA geometric way to see the first row of \\(T^{-1}\\) is to note that\n\\[\n\\mathbf{k}_1 = \\frac{\\mathbf{d}_2\\times\\mathbf{d}_3} {\\mathbf{d}_1\\cdot(\\mathbf{d}_2\\times\\mathbf{d}_3)}\n\\]\nis the unique “reciprocal vector” satisfying \\(\\mathbf{k}_1\\cdot\\mathbf{d}_1=1\\) and \\(\\mathbf{k}_1\\cdot\\mathbf{d}_2= \\mathbf{k}_1\\cdot\\mathbf{d}_3=0\\) .\nso\n\\[\nT^{-1} = \\left(\\begin{array}{l}\n\\mathbf{k}_1 \\\\\n\\mathbf{k}_2 \\\\\n\\mathbf{k}_3\n\\end{array}\\right)\n\\]\nwith \\(\\mathbf{k}_2,\\mathbf{k}_3\\) defined similarly by the appropriate cross products and normalization.\nTherefore from \\(\\mathbf{μ}=\\mathbf{T}^{-1}\\left(\\mathbf{r}-\\mathbf{r}_4\\right)\\), we have \\(μ_i = \\mathbf{k}_i\\cdot(\\mathbf{r}-\\mathbf{r}_{4})\\), where \\(i=1,2,3\\).\nNotice that \\(\\mathbf{r}-\\mathbf{r}_{4} = (\\mathbf{r}-\\mathbf{r}_1) + \\underbrace{(\\mathbf{r}_1-\\mathbf{r}_{4})}_{=\\mathbf{d}_1}\\) and by construction \\(\\mathbf{k}_1\\cdot\\mathbf{d}_1=1\\).\nTherefore\n\\[\nμ_1 = \\mathbf{k}_1 \\cdot(\\mathbf{r}-\\mathbf{r}_1) + \\mathbf{k}_1 \\cdot\\mathbf{d}_1\n    = 1 + \\mathbf{k}_1 \\cdot(\\mathbf{r}-\\mathbf{r}_1)\n\\]\nBy identical reasoning, \\(μ_α = 1 + \\mathbf{k}_α \\cdot (\\mathbf{r}-\\mathbf{r}_α)\\).",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "EPSS 261 Homework",
      "Problem Set 4"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps4.html#cluster-magnetopause-crossing",
    "href": "docs/courses/epss261/homework/ps4.html#cluster-magnetopause-crossing",
    "title": "Problem Set 4",
    "section": "2 Cluster magnetopause crossing",
    "text": "2 Cluster magnetopause crossing\n\n[2] For a CLUSTER magnetopause crossing on 2001/06/11 other than the one in the crib…\n- compute Qsr, Elongation, Planarity and then the magnetopause normal and velocity.\n- Compute the current density, and field curvature at that location.\n- Compute the magnetopause thickness.\n- Compare with table below from Keyser et al. (original from Dunlop and Balogh, 2004).\n- Create and discuss plots of data, satellite positions, table of results from the “simple” and from either the “symmetric” or the “relative timing” methods. See next page for details.\n\n\nDetails:\n- I have released a crib sheet (Hwk04_02.pro) to help. It is not to be executed and run. Take it as a cheat-sheet: a collection of command-line steps to aid your construction of your own code. I brought over the Cluster CDFs, which you can read using IDL or Python tools or spd_gui. (The data does not exist in SPDF, I had to get it from the Cluster Active Archive. Perhaps AMDA can help you read it.). Use ChatGPT widely to help you, but review documentation when unsure.\n- The IDL code above uses helper functions for the linear gradient estimation and timing analysis which we discussed in class, and I include in the zip file. You may rewrite them in Python if you wish or use them directly in IDL (they are very simple). They are called lingradest.pro and mptiming.pro.\n\n\n\n\n\n\n\nWarning\n\n\n\nFunctions in this report are included in SpaceTools and documented in the following page: Multi-spacecraft analysis methods. However, they are experimental, not tested, and may change without notice.\n\n\n\n2.1 Loading the data\nTo load the data from CSA server, we implement a module using HAPI protocol. More details can be found in the HAPI.jl.\n\n\nCode\nusing CairoMakie\nusing HAPI\nusing Dates\nusing SpaceTools\nusing DimensionalData\nusing Unitful\nusing DataFrames\nusing SummaryTables\nusing PrettyPrinting\n\n\n\n\nCode\ntrange = timerange(\"2001-06-11T20:10:30\", \"2001-06-11T20:12:30\")\nB_vars = [\n    \"csa/C1_CP_FGM_FULL/B_vec_xyz_gse\",\n    \"csa/C2_CP_FGM_FULL/B_vec_xyz_gse\",\n    \"csa/C3_CP_FGM_FULL/B_vec_xyz_gse\",\n    \"csa/C4_CP_FGM_FULL/B_vec_xyz_gse\",\n]\npos_vars = [\n    \"csa/C1_CP_FGM_FULL/sc_pos_xyz_gse\",\n    \"csa/C2_CP_FGM_FULL/sc_pos_xyz_gse\",\n    \"csa/C3_CP_FGM_FULL/sc_pos_xyz_gse\",\n    \"csa/C4_CP_FGM_FULL/sc_pos_xyz_gse\",\n]\nB_data = get_data.(B_vars, trange)\npos_data = get_data.(pos_vars, trange) .|&gt; DimArray\n\n\n4-element Vector{DimVector{Vector{Quantity{Float64, 𝐋, Unitful.FreeUnits{(km,), 𝐋, nothing}}}, Tuple{Ti{DimensionalData.Dimensions.Lookups.Sampled{DateTime, SentinelArrays.ChainedVector{DateTime, Vector{DateTime}}, DimensionalData.Dimensions.Lookups.ForwardOrdered, DimensionalData.Dimensions.Lookups.Irregular{Tuple{Nothing, Nothing}}, DimensionalData.Dimensions.Lookups.Points, DimensionalData.Dimensions.Lookups.NoMetadata}}}, Tuple{}, Vector{Vector{Quantity{Float64, 𝐋, Unitful.FreeUnits{(km,), 𝐋, nothing}}}}, Symbol, Dict{Any, Any}}}:\n Vector{Quantity{Float64, 𝐋, Unitful.FreeUnits{(km,), 𝐋, nothing}}}[[-17192.3 km, -121540.1 km, 12485.9 km], [-17192.4 km, -121540.1 km, 12485.8 km], [-17192.4 km, -121540.1 km, 12485.8 km], [-17192.4 km, -121540.1 km, 12485.7 km], [-17192.4 km, -121540.1 km, 12485.7 km], [-17192.5 km, -121540.1 km, 12485.6 km], [-17192.5 km, -121540.1 km, 12485.6 km], [-17192.5 km, -121540.2 km, 12485.6 km], [-17192.5 km, -121540.2 km, 12485.5 km], [-17192.5 km, -121540.2 km, 12485.5 km]  …  [-17244.3 km, -121549.9 km, 12366.8 km], [-17244.3 km, -121549.9 km, 12366.8 km], [-17244.3 km, -121549.9 km, 12366.7 km], [-17244.3 km, -121549.9 km, 12366.7 km], [-17244.3 km, -121549.9 km, 12366.6 km], [-17244.3 km, -121549.9 km, 12366.6 km], [-17244.4 km, -121549.9 km, 12366.5 km], [-17244.4 km, -121549.9 km, 12366.5 km], [-17244.4 km, -121549.9 km, 12366.5 km], [-17244.4 km, -121549.9 km, 12366.4 km]]\n Vector{Quantity{Float64, 𝐋, Unitful.FreeUnits{(km,), 𝐋, nothing}}}[[-19049.1 km, -122091.8 km, 13031.5 km], [-19049.1 km, -122091.8 km, 13031.5 km], [-19049.1 km, -122091.8 km, 13031.4 km], [-19049.1 km, -122091.8 km, 13031.4 km], [-19049.1 km, -122091.8 km, 13031.4 km], [-19049.2 km, -122091.8 km, 13031.3 km], [-19049.2 km, -122091.9 km, 13031.3 km], [-19049.2 km, -122091.9 km, 13031.2 km], [-19049.2 km, -122091.9 km, 13031.2 km], [-19049.3 km, -122091.9 km, 13031.1 km]  …  [-19100.2 km, -122101.3 km, 12914.8 km], [-19100.2 km, -122101.3 km, 12914.8 km], [-19100.2 km, -122101.3 km, 12914.7 km], [-19100.2 km, -122101.3 km, 12914.7 km], [-19100.2 km, -122101.3 km, 12914.6 km], [-19100.2 km, -122101.3 km, 12914.6 km], [-19100.3 km, -122101.3 km, 12914.5 km], [-19100.3 km, -122101.3 km, 12914.5 km], [-19100.3 km, -122101.3 km, 12914.4 km], [-19100.3 km, -122101.3 km, 12914.4 km]]\n Vector{Quantity{Float64, 𝐋, Unitful.FreeUnits{(km,), 𝐋, nothing}}}[[-18506.3 km, -121999.5 km, 11157.3 km], [-18506.3 km, -121999.5 km, 11157.2 km], [-18506.3 km, -121999.5 km, 11157.2 km], [-18506.3 km, -121999.5 km, 11157.2 km], [-18506.3 km, -121999.5 km, 11157.1 km], [-18506.3 km, -121999.6 km, 11157.1 km], [-18506.4 km, -121999.6 km, 11157.0 km], [-18506.4 km, -121999.6 km, 11157.0 km], [-18506.4 km, -121999.6 km, 11156.9 km], [-18506.4 km, -121999.6 km, 11156.9 km]  …  [-18558.0 km, -122012.7 km, 11040.1 km], [-18558.0 km, -122012.7 km, 11040.0 km], [-18558.0 km, -122012.7 km, 11040.0 km], [-18558.0 km, -122012.7 km, 11040.0 km], [-18558.0 km, -122012.7 km, 11039.9 km], [-18558.1 km, -122012.7 km, 11039.9 km], [-18558.1 km, -122012.7 km, 11039.8 km], [-18558.1 km, -122012.7 km, 11039.8 km], [-18558.1 km, -122012.7 km, 11039.7 km], [-18558.2 km, -122012.8 km, 11039.7 km]]\n Vector{Quantity{Float64, 𝐋, Unitful.FreeUnits{(km,), 𝐋, nothing}}}[[-17608.1 km, -123229.0 km, 12203.8 km], [-17608.1 km, -123229.0 km, 12203.8 km], [-17608.2 km, -123229.0 km, 12203.7 km], [-17608.2 km, -123229.0 km, 12203.7 km], [-17608.2 km, -123229.0 km, 12203.6 km], [-17608.2 km, -123229.0 km, 12203.6 km], [-17608.2 km, -123229.0 km, 12203.6 km], [-17608.2 km, -123229.0 km, 12203.5 km], [-17608.3 km, -123229.0 km, 12203.5 km], [-17608.3 km, -123229.0 km, 12203.4 km]  …  [-17658.1 km, -123238.3 km, 12089.2 km], [-17658.1 km, -123238.3 km, 12089.2 km], [-17658.1 km, -123238.3 km, 12089.1 km], [-17658.1 km, -123238.3 km, 12089.1 km], [-17658.2 km, -123238.3 km, 12089.0 km], [-17658.2 km, -123238.3 km, 12089.0 km], [-17658.2 km, -123238.3 km, 12089.0 km], [-17658.2 km, -123238.3 km, 12088.9 km], [-17658.2 km, -123238.3 km, 12088.9 km], [-17658.2 km, -123238.3 km, 12088.8 km]]\n\n\n\n\nCode\n# Make start time of the field-rotation (start of By, Bz change) fiducial\nt0s = [\n    \"2001-06-11T20:11:43\",\n    \"2001-06-11T20:11:49\",\n    \"2001-06-11T20:11:55\",\n    \"2001-06-11T20:11:39\",\n] .|&gt; DateTime\nt1s = [\n    \"2001-06-11T20:11:50\",\n    \"2001-06-11T20:12:00\",\n    \"2001-06-11T20:12:04\",\n    \"2001-06-11T20:11:56\",\n] .|&gt; DateTime\n\navgtime = tmean(t0s)\n\n\n2001-06-11T20:11:46.500\n\n\n\n\nCode\nfig, axs = tplot(B_data)\ntlines!.(axs, avgtime)\ntlines!.(axs, t0s)\ntlines!.(axs, t1s)\nfig\n\n\n\n\n\n\n\n\n\n\n\n2.2 Plot sc positions relative to mesocenter\n\n\nCode\nusing Statistics\n\nRs = tinterp.(pos_data, avgtime) # Rs = getindex.(pos_data, Ti=Near(avgtime))\nR00 = mean(Rs)\nR0s = Rs .- Ref(R00)\n\n\n4-element Vector{Vector{Quantity{Float64, 𝐋, Unitful.FreeUnits{(km,), 𝐋, nothing}}}}:\n [896.0960227272735 km, 675.4250000000029 km, 264.8500000000022 km]\n [-960.0835227272728 km, 123.92500000000291 km, 812.0500000000011 km]\n [-417.60852272727425 km, 213.8249999999971 km, -1062.5499999999993 km]\n [481.5960227272735 km, -1013.1750000000029 km, -14.349999999998545 km]\n\n\n\n\nCode\nfunction plot_positions(positions::AbstractVector{&lt;:AbstractVector}; axis=(;))\n    n = length(positions)\n    theme = Theme(\n        Scatter=(\n            markersize=15,\n            cycle=Cycle([:color, :marker], covary=true)\n        )\n    )\n    base_unit = unit(positions[1][1])\n    dim1_conversion = dim2_conversion = Makie.UnitfulConversion(base_unit; units_in_label=false)\n\n    with_theme(theme) do\n        fig = Figure()\n        ax1 = Axis(fig[1, 1]; title=\"XY\", ylabel=\"y\", dim1_conversion, dim2_conversion, axis...)\n        ax2 = Axis(fig[2, 1]; title=\"XZ\", xlabel=\"x\", ylabel=\"z\", dim1_conversion, dim2_conversion, axis...)\n        ax3 = Axis(fig[2, 2]; title=\"YZ\", xlabel=\"y\", dim1_conversion, dim2_conversion, axis...)\n        axs = [ax1, ax2, ax3]\n\n        # Plot each positions\n        plots = map(positions) do pos\n            scatter!(ax1, [pos[1]], [pos[2]])\n            scatter!(ax2, [pos[1]], [pos[3]])\n            scatter!(ax3, [pos[2]], [pos[3]])\n        end\n        Legend(fig[1, 2], plots, [\"C$i\" for i in 1:n]; tellwidth=false, tellheight=false)\n        fig, axs\n    end\nend\n\nplot_positions(R0s)\n\n\n(Scene (600px, 450px):\n  0 Plots\n  4 Child Scenes:\n    ├ Scene (600px, 450px)\n    ├ Scene (600px, 450px)\n    ├ Scene (600px, 450px)\n    └ Scene (600px, 450px), Axis[Axis (4 plots), Axis (4 plots), Axis (4 plots)])\n\n\n\n\n2.3 Tetrahedron quality factors: Qsr, elongation, planarity\n\"\"\"Calculate tetrahedron quality factors\"\"\"\nfunction tetrahedron_quality(positions::AbstractVector{&lt;:AbstractVector})\n    Rvol = volumetric_tensor(positions)\n    # Calculate eigenvaluesz and eigenvectors\n    F = eigen(ustrip(Rvol), sortby=x -&gt; -abs(x)) # Note: we want descending order\n    semiaxes = sqrt.(F.values)  # sqrt of eigenvalues\n    eigenvectors = F.vectors\n    # Calculate quality parameters\n    Qsr = 0.5 * (sum(semiaxes) / semiaxes[1] - 1)\n    Elongation = 1 - (semiaxes[2] / semiaxes[1])\n    Planarity = 1 - (semiaxes[3] / semiaxes[2])\n\n    return (; det=det(Rvol), semiaxes, Qsr, Elongation, Planarity, eigenvectors)\nend\n\n\nCode\ntetrahedron_quality(R0s) |&gt; pprint\n\n\n(det = 9.491477044462083e16 km⁶,\n semiaxes = [739.1443381212663, 675.706718317148, 616.8497731211844],\n Qsr = 0.8743600030297949,\n Elongation = 0.08582575355357791,\n Planarity = 0.08710427704869828,\n eigenvectors =\n     [0.9278535982834907 0.35338946097171103 0.11917881114737737; -0.1663544954859536 0.10616487882162137 0.9803342288915573; -0.33378718067653923 0.9294325727985404 -0.1572933903159741])\n\n\n\n\n2.4 Magnetopause normal and velocity\n\"\"\"\n    CVA(positions, times)\n\nConstant Velocity Approach (CVA) for determining boundary normal and velocity.\nSolve timing equation: ``D * m = Δts``\n\nParameters:\n- positions: Positions of 4 spacecraft (4×3 array)\n- times: Times of boundary crossing for each spacecraft\n\"\"\"\nfunction CVA(positions, times)\n    # Calculate time delays relative to first spacecraft\n    Δts = times[2:end] .- times[1]\n    # Calculate position differences relative to first spacecraft\n    D = reduce(hcat, [r - positions[1] for r in positions[2:end]])'\n    m = inv(D) * Δts\n    return m2nV(m)\nend\n\n\nCode\n\"Convert timing vector ``𝐦`` to normal vector and velocity where ``𝐦 = 𝐧/V``\"\ntv_to_nv(m) = SpaceTools.m2nV(m)\n\n\"Symmetric timing method using barycenter reference\"\nfunction timing_symmetric(positions, times)\n    # Calculate times relative to average crossing time\n    Δts = times .- tmean(times)\n    R = volumetric_tensor(positions)\n\n    # Calculate sum of time-distance products (ensure column vector)\n    sum_td = sum(t .* r for (t, r) in zip(Δts, positions)) ./ length(Δts)\n\n    # Solve timing equation: R * M = sum_td\n    m = inv(R) * sum_td\n    return tv_to_nv(m)\nend\n\n\"Relative timing method using all spacecraft pairs\"\nfunction timing_relative(positions, times)\n    n = length(positions)\n\n    # Create arrays of all pairs of time differences\n    Δt_matrix = [t_j - t_i for t_i in times, t_j in times]\n\n    # Create arrays of all pairs of position differences\n    Δr_matrices = [\n        [r_j[i] - r_i[i] for r_i in positions, r_j in positions]\n        for i in 1:3  # x, y, z components\n    ]\n\n    # Calculate double sum of time-distance products (ensure column vector)\n    sum_td = [\n        sum(Δt_matrix .* Δr_matrix) for Δr_matrix in Δr_matrices\n    ] ./ (2 * n^2)\n\n    # Calculate volumetric tensor and solve timing equation: R * M = sum_td\n    R = volumetric_tensor(positions)\n    m = inv(R) * sum_td\n    return tv_to_nv(m)\nend\n\n# Example usage with your data\ntimes = t0s\n\n# Calculate using all three methods\nsimple_result = (; method=\"Simple\", CVA(Rs, times)...,)\nsymmetric_result = (; method=\"Symmetric\", timing_symmetric(Rs, times)...,)\nrelative_result = (; method=\"Relative\", timing_relative(Rs, times)...,)\n\n# Pretty Print\ndf = DataFrame([simple_result, symmetric_result, relative_result])\nround_array(x) = round.(x, digits=3)\ndf.n = round_array.(df.n)\ndf.V = round.(u\"km/s\", df.V)\nsimple_table(df)\n\n\n\n    \n    \n    \n        method\n        n\n        V\n    \n            \n        Simple\n        [-0.672, 0.518, -0.529]\n        112.0 km s⁻¹\n    \n    \n        Symmetric\n        [-0.672, 0.518, -0.529]\n        112.0 km s⁻¹\n    \n    \n        Relative\n        [-0.672, 0.518, -0.529]\n        112.0 km s⁻¹\n    \n    \n\n\n\nWithin numeric tolerance, the three methods yield the same result. The results of n are different from the table, this may be due to different coordinate systems (not implemented for now).\n\n2.4.1 Overplot magnetopause velocity\n\n\nCode\nfig, axs = plot_positions(R0s)\nres = symmetric_result\nfactor = 2e-1u\"km/s\"\narr = res.n * res.V / factor .|&gt; upreferred\narrows!(axs[1], [0.0], [0.0], arr[1:1], arr[2:2])\narrows!(axs[2], [0.0], [0.0], arr[1:1], arr[3:3])\narrows!(axs[3], [0.0], [0.0], arr[2:2], arr[3:3])\nfig\n\n\n\n\n\n\n\n\n\n\n\n\n2.5 Current density, and field curvature\nUtilizing Julia’s linear algebra library, lingradest function can be efficiently implemented in Julia with fewer than 40 lines of code.\n\"\"\"\n    lingradest(B1, B2, B3, B4, R1, R2, R3, R4)\n\nCompute spatial derivatives such as grad, div, curl and curvature using reciprocal vector technique (linear interpolation).\n\n# Arguments\n- `B1, B2, B3, B4`: 3-element vectors giving magnetic field measurements at each probe\n- `R1, R2, R3, R4`: 3-element vectors giving the probe positions\n\n# Returns\nA named tuple containing:\n  • Rbary: Barycenter position\n  • Bbc: Magnetic field at the barycenter\n  • Bmag: Magnetic field magnitude at the barycenter\n  • LGBx, LGBy, LGBz: Linear gradient estimators for each component\n  • LD: Linear divergence estimator\n  • LCB: Linear curl estimator\n  • curvature: Field‐line curvature vector\n  • R_c: Field‐line curvature radius\n\n# References\nBased on the method of Chanteur (ISSI, 1998, Ch. 11).\n- [lingradest.pro](https://github.com/spedas/bleeding_edge/blob/master/projects/mms/common/curlometer/lingradest.pro)\n- [lingradest.py](https://github.com/spedas/pyspedas/blob/master/pyspedas/analysis/lingradest.py#L5)\n\"\"\"\nfunction lingradest(B1, B2, B3, B4, R1, R2, R3, R4)\n\n    Rs = [R1, R2, R3, R4]\n    Bs = [B1, B2, B3, B4]\n    Bxs = getindex.(Bs, 1)\n    Bys = getindex.(Bs, 2)\n    Bzs = getindex.(Bs, 3)\n\n    # Barycenter of the tetrahedron\n    Rbary = (R1 .+ R2 .+ R3 .+ R4) ./ 4\n    dRs = Ref(Rbary) .- Rs\n\n    # Reciprocal vectors and μ factors\n    ks = reciprocal_vectors(R1, R2, R3, R4)\n    μs = @. 1 + dot(ks, dRs)\n\n    # Magnetic field at barycenter\n    Bbc = sum(μs .* Bs)\n    Bmag = norm(Bbc)\n\n    # Linear Gradient estimators\n    LGBx = sum(Bxs .* ks)\n    LGBy = sum(Bys .* ks)\n    LGBz = sum(Bzs .* ks)\n    LGB = [LGBx LGBy LGBz]\n    # Linear Divergence estimator\n    div = sum(dot.(ks, Bs))\n\n    # Linear Curl estimator\n    curl = sum(cross.(ks, Bs))\n    # Field-line curvature components\n    curvature = (LGB' * Bbc) / (Bmag^2)\n    R_c = 1 / norm(curvature)\n\n    return (; Rbary, Bbc, Bmag,\n        LGBx, LGBy, LGBz,\n        div, curl, curvature, R_c)\nend\n\n\nCode\nB_das = tstack.(DimArray.(B_data))\ntimes = dims(B_das[1], Ti)\nB_interp_das = tinterp.(B_das, Ref(times))\npos_interp_das = tinterp.(tstack.(pos_data), Ref(times))\nres = lingradest(B_interp_das..., pos_interp_das...)\n\n\n┌ 2459-element DimStack ┐\n├───────────────────────┴──────────────────────────────────────────────── dims ┐\n  ↓ Ti Sampled{Dates.DateTime} [2001-06-11T20:10:30.036, …, 2001-06-11T20:12:29.966] ForwardOrdered Irregular Points\n├────────────────────────────────────────────────────────────────────── layers ┤\n  :Rbary     eltype: Vector{Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(km,), 𝐋, nothing}}} dims: Ti size: 2459\n  :Bbc       eltype: Vector{Unitful.Quantity{Float64, 𝐌 𝐈⁻¹ 𝐓⁻², Unitful.FreeUnits{(nT,), 𝐌 𝐈⁻¹ 𝐓⁻², nothing}}} dims: Ti size: 2459\n  :Bmag      eltype: Unitful.Quantity{Float64, 𝐌 𝐈⁻¹ 𝐓⁻², Unitful.FreeUnits{(nT,), 𝐌 𝐈⁻¹ 𝐓⁻², nothing}} dims: Ti size: 2459\n  :LGBx      eltype: Vector{Unitful.Quantity{Float64, 𝐌 𝐈⁻¹ 𝐋⁻¹ 𝐓⁻², Unitful.FreeUnits{(km⁻¹, nT), 𝐌 𝐈⁻¹ 𝐋⁻¹ 𝐓⁻², nothing}}} dims: Ti size: 2459\n  :LGBy      eltype: Vector{Unitful.Quantity{Float64, 𝐌 𝐈⁻¹ 𝐋⁻¹ 𝐓⁻², Unitful.FreeUnits{(km⁻¹, nT), 𝐌 𝐈⁻¹ 𝐋⁻¹ 𝐓⁻², nothing}}} dims: Ti size: 2459\n  :LGBz      eltype: Vector{Unitful.Quantity{Float64, 𝐌 𝐈⁻¹ 𝐋⁻¹ 𝐓⁻², Unitful.FreeUnits{(km⁻¹, nT), 𝐌 𝐈⁻¹ 𝐋⁻¹ 𝐓⁻², nothing}}} dims: Ti size: 2459\n  :div       eltype: Unitful.Quantity{Float64, 𝐌 𝐈⁻¹ 𝐋⁻¹ 𝐓⁻², Unitful.FreeUnits{(km⁻¹, nT), 𝐌 𝐈⁻¹ 𝐋⁻¹ 𝐓⁻², nothing}} dims: Ti size: 2459\n  :curl      eltype: Vector{Unitful.Quantity{Float64, 𝐌 𝐈⁻¹ 𝐋⁻¹ 𝐓⁻², Unitful.FreeUnits{(km⁻¹, nT), 𝐌 𝐈⁻¹ 𝐋⁻¹ 𝐓⁻², nothing}}} dims: Ti size: 2459\n  :curvature eltype: Vector{Unitful.Quantity{Float64, 𝐋⁻¹, Unitful.FreeUnits{(km⁻¹,), 𝐋⁻¹, nothing}}} dims: Ti size: 2459\n  :R_c       eltype: Unitful.Quantity{Float64, 𝐋, Unitful.FreeUnits{(km,), 𝐋, nothing}} dims: Ti size: 2459\n└──────────────────────────────────────────────────────────────────────────────┘\n\n\nThe current density and field curvature at the average time are\n\n\nCode\npprint(res[Ti=Near(avgtime)])\n\n\n(Rbary = [-18121.68409090909 km, -122221.825 km, 12144.868333333334 km],\n Bbc = [7.078833838383838 nT, 8.575880808080807 nT, 8.992595959595958 nT],\n Bmag = 14.301132900522195 nT,\n LGBx = [1.3813172727203307e-5 nT km⁻¹,\n         0.003366241172121136 nT km⁻¹,\n         0.0007368641222804634 nT km⁻¹],\n LGBy = [-0.002049983588783596 nT km⁻¹,\n         0.004280815830114207 nT km⁻¹,\n         0.0007956255498070833 nT km⁻¹],\n LGBz = [-0.006685534578927632 nT km⁻¹,\n         0.004410837499235884 nT km⁻¹,\n         -0.00242034765020941 nT km⁻¹],\n div = 0.0018742813526320009 nT km⁻¹,\n curl = [0.0036152119494287996 nT km⁻¹,\n         0.007422398701208097 nT km⁻¹,\n         -0.005416224760904732 nT km⁻¹],\n curvature = [0.00017402780896923182 km⁻¹,\n              0.00014352956892380598 km⁻¹,\n              -0.00015286433126961862 km⁻¹],\n R_c = 3669.7823651585372 km)\n\n\n\n\nCode\nfig, axs = tplot(res; figure=(; size=(800, 800)))\ntlines!.(axs, avgtime)\nfig\n\n\n\n\n\n\n\n\n\n\n\n2.6 Magnetopause thickness\nThe thickness can be estimated by multiplying the duration of each center crossing by the normal velocity obtained from the preceding analysis. Since we assume that velocity is constant instead of varying, the estimated thickness is simply the mean of the product of the velocity and the duration.\n\n\nCode\ndurations = t1s .- t0s\nds = symmetric_result.V .* durations\n@info \"thickness\" ds\n@info \"mean thickness\" mean(ds)\n\n\n┌ Info: thickness\n│   ds =\n│    4-element Vector{Quantity{Float64, 𝐋, Unitful.FreeUnits{(km,), 𝐋, nothing}}}:\n│      785.0844206375767 km\n│     1233.7040895733348 km\n│     1009.3942551054557 km\n└     1906.633592976972 km\n┌ Info: mean thickness\n└   mean(ds) = 1233.7040895733348 km",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "EPSS 261 Homework",
      "Problem Set 4"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps4.html#wave-polarization",
    "href": "docs/courses/epss261/homework/ps4.html#wave-polarization",
    "title": "Problem Set 4",
    "section": "3 Wave polarization",
    "text": "3 Wave polarization\n\n[3] Show (see Lecture 09 p. 31) that in the plane of polarization of an elliptically polarized wave the ellipticity \\(ε=tan(β)\\), and direction of polarization \\(φ\\), can be obtained from the amplitudes \\({B_{x0}}', {B_{y0}}'\\) and the phase difference, \\(ψ\\), between the y’ and x’ components from the equations: \\(sin(2β)=sin(ψ) 2 {B_{x0}}' {B_{y0}}'/({B_{x0}}'^2 + {B_{y0}}'^2)\\), and: \\(tan(2φ)=cos(ψ) 2 {B_{x0}}' {B_{y0}}'/({B_{x0}}'^2 - {B_{y0}}'^2)\\) This is the origin of the wave polarization analysis using minimum variance techniques. They are used both in exploration geophysics and in space physics, so it is good to be convinced of their origin.\n\nWe drop the primes in the plane of polarization for simplicity.\nConsider the magnetic field components in the plane of polarization:\n\\[\n\\begin{aligned}\nB_{x}(t) &= B_{x0} \\cos(ω t), \\\\\nB_{y}(t) &= B_{y0} \\cos(ω t + \\psi).\n\\end{aligned}\n\\]\nEliminating \\(ω t\\) from these equations (using \\(cos^2(ωt)+sin^2(ωt)=1\\) identity) $yields the ellipse:\n\\[\n\\left(\\frac{B_{x}}{B_{x0}}\\right)^2 + \\left(\\frac{B_{y}}{B_{y0}}\\right)^2 - 2 \\left(\\frac{B_{x}B_{y}}{B_{x0}B_{y0}}\\right)\\cos\\psi = \\sin^2\\psi.\n\\]\nStokes Parameters characterize the polarization state:\n\\[\n\\begin{aligned}\nS_0 &= B_{x0}^2 + B_{y0}^2, \\\\\nS_1 &= B_{x0}^2 - B_{y0}^2, \\\\\nS_2 &= 2 B_{x0} B_{y0}\\cos\\psi, \\\\\nS_3 &= 2 B_{x0} B_{y0}\\sin\\psi.\n\\end{aligned}\n\\]\nGiven the Stokes parameters, one can solve for the spherical coordinates with the following equations:\n\\[\n\\begin{aligned}\n& 2 \\psi = \\arctan \\frac{S_2}{S_1} \\\\\n& 2 β = \\arctan \\frac{S_3}{\\sqrt{S_1^2+S_2^2}}\n\\end{aligned}\n\\]\nUsing Stokes parameters, the ellipticity \\(\\epsilon = \\tan β\\) relates to the minor-to-major axis ratio:\n\\[\n\\sin(2β) = \\sin \\arctan \\left(\\frac{S_3}{\\sqrt{S_1^2+S_2^2}}\\right) = \\frac{S_3}{S_0} = \\frac{2B_{x0}B_{y0}\\sin\\psi}{B_{x0}^2 + B_{y0}^2}.\n\\]\nThe angle \\(\\psi\\) of the major axis is given by the following equation:\n\\[\n\\tan(2\\phi) = \\frac{S_2}{S_1} = \\frac{2B_{x0}B_{y0}\\cos\\psi}{B_{x0}^2 - B_{y0}^2}.\n\\]",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "EPSS 261 Homework",
      "Problem Set 4"
    ]
  },
  {
    "objectID": "docs/courses/epss261/index.html",
    "href": "docs/courses/epss261/index.html",
    "title": "EPSS 261",
    "section": "",
    "text": "On-line Description: Topics in Magnetospheric Plasma Physics. Lectures, discussions, and exercises on specific advanced topics in magnetospheric plasma physics. Previous courses examined magnetic storms, magnetospheric substorms, ultralow frequency waves, and adiabatic particle motion in Earth’s radiation belts.",
    "crumbs": [
      "Courses",
      "EPSS 261"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps3.html",
    "href": "docs/courses/epss261/homework/ps3.html",
    "title": "Problem Set 3",
    "section": "",
    "text": "Minimize the variance \\(σ^2\\) Eq. (8.4) of Ch. 8 by writing out the derivatives with respect to the vector components. Show that the solution is given by Equation (8.7) which is an eigenvalue problem with orthogonal eigenvectors.\n\n\\[\n\\sigma^2=\\frac{1}{M} \\sum_{m=1}^M\\left|\\left(\\boldsymbol{B}^{(m)}-\\langle\\boldsymbol{B}\\rangle\\right) \\cdot \\hat{\\boldsymbol{n}}\\right|^2\n\\tag{1}\\]\n\\[\n\\sum_{\\nu=1}^3 M_{\\mu \\nu}^B n_\\nu=\\lambda n_\\mu\n\\tag{2}\\]\nExpand the dot product in components:\n\\[\n\\left(\\boldsymbol{B}^{(m)} - \\langle \\boldsymbol{B} \\rangle\\right) \\cdot \\hat{\\boldsymbol{n}} = \\sum_{\\mu=1}^3 \\left(B_\\mu^{(m)} - \\langle B_\\mu \\rangle\\right) n_\\mu,\n\\]\nso that\n\\[\n\\sigma^2 = \\frac{1}{M} \\sum_{m=1}^M \\left(\\sum_{\\mu=1}^3 \\left(B_\\mu^{(m)} - \\langle B_\\mu \\rangle\\right) n_\\mu \\right)^2 = \\sum_{\\mu,\\nu=1}^3 n_\\mu n_\\nu \\left[ \\frac{1}{M} \\sum_{m=1}^M \\left(B_\\mu^{(m)} - \\langle B_\\mu \\rangle\\right) \\left(B_\\nu^{(m)} - \\langle B_\\nu \\rangle\\right) \\right]\n\\]\nDefine the magnetic variance matrix\n\\[\nM_{\\mu\\nu}^B \\equiv \\left\\langle B_\\mu B_\\nu \\right\\rangle - \\langle B_\\mu \\rangle \\langle B_\\nu \\rangle\n\\]\nso that\n\\[\n\\sigma^2 = \\sum_{\\mu,\\nu=1}^3 n_\\mu M_{\\mu\\nu}^B n_\\nu.\n\\]\nThe Lagrangian is given by:\n\\[\nL(\\hat{\\boldsymbol{n}}, \\lambda) = \\sigma^2 - \\lambda\\left(\\sum_{\\mu=1}^3 n_\\mu^2 - 1\\right) = \\sum_{\\mu,\\nu=1}^3 n_\\mu M_{\\mu\\nu}^B n_\\nu - \\lambda\\left(\\sum_{\\mu=1}^3 n_\\mu^2 - 1\\right).\n\\]\nDifferentiate with Respect to the Components \\(n_\\alpha\\) equal to zero for each component\n\\[\n\\frac{\\partial}{\\partial n_\\alpha} \\left(\\sum_{\\mu,\\nu} n_\\mu M_{\\mu\\nu}^B n_\\nu\\right) - \\frac{\\partial}{\\partial n_\\alpha} \\left[\\lambda\\left(\\sum_{\\mu=1}^3 n_\\mu^2 - 1\\right)\\right] = 2\\sum_{\\nu=1}^3 M_{\\alpha\\nu}^B n_\\nu -  2\\lambda n_\\alpha.\n\\]\nwe get:\n\\[\n2\\sum_{\\nu=1}^3 M_{\\alpha\\nu}^B n_\\nu - 2\\lambda n_\\alpha = 0.\n\\]\nThis is exactly Equation (8.7): \\(\\sum_{\\nu=1}^3 M_{\\mu \\nu}^B n_\\nu = \\lambda n_\\mu\\). The equation is an eigenvalue problem for the symmetric \\(3\\times 3\\) matrix \\(M_{\\mu\\nu}^B\\). The eigenvalues \\(\\lambda\\) are real, and the corresponding eigenvectors \\(\\hat{\\boldsymbol{n}}\\) are orthogonal.",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "EPSS 261 Homework",
      "Problem Set 3"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps3.html#minimum-and-maximum-variance-analysis",
    "href": "docs/courses/epss261/homework/ps3.html#minimum-and-maximum-variance-analysis",
    "title": "Problem Set 3",
    "section": "",
    "text": "Minimize the variance \\(σ^2\\) Eq. (8.4) of Ch. 8 by writing out the derivatives with respect to the vector components. Show that the solution is given by Equation (8.7) which is an eigenvalue problem with orthogonal eigenvectors.\n\n\\[\n\\sigma^2=\\frac{1}{M} \\sum_{m=1}^M\\left|\\left(\\boldsymbol{B}^{(m)}-\\langle\\boldsymbol{B}\\rangle\\right) \\cdot \\hat{\\boldsymbol{n}}\\right|^2\n\\tag{1}\\]\n\\[\n\\sum_{\\nu=1}^3 M_{\\mu \\nu}^B n_\\nu=\\lambda n_\\mu\n\\tag{2}\\]\nExpand the dot product in components:\n\\[\n\\left(\\boldsymbol{B}^{(m)} - \\langle \\boldsymbol{B} \\rangle\\right) \\cdot \\hat{\\boldsymbol{n}} = \\sum_{\\mu=1}^3 \\left(B_\\mu^{(m)} - \\langle B_\\mu \\rangle\\right) n_\\mu,\n\\]\nso that\n\\[\n\\sigma^2 = \\frac{1}{M} \\sum_{m=1}^M \\left(\\sum_{\\mu=1}^3 \\left(B_\\mu^{(m)} - \\langle B_\\mu \\rangle\\right) n_\\mu \\right)^2 = \\sum_{\\mu,\\nu=1}^3 n_\\mu n_\\nu \\left[ \\frac{1}{M} \\sum_{m=1}^M \\left(B_\\mu^{(m)} - \\langle B_\\mu \\rangle\\right) \\left(B_\\nu^{(m)} - \\langle B_\\nu \\rangle\\right) \\right]\n\\]\nDefine the magnetic variance matrix\n\\[\nM_{\\mu\\nu}^B \\equiv \\left\\langle B_\\mu B_\\nu \\right\\rangle - \\langle B_\\mu \\rangle \\langle B_\\nu \\rangle\n\\]\nso that\n\\[\n\\sigma^2 = \\sum_{\\mu,\\nu=1}^3 n_\\mu M_{\\mu\\nu}^B n_\\nu.\n\\]\nThe Lagrangian is given by:\n\\[\nL(\\hat{\\boldsymbol{n}}, \\lambda) = \\sigma^2 - \\lambda\\left(\\sum_{\\mu=1}^3 n_\\mu^2 - 1\\right) = \\sum_{\\mu,\\nu=1}^3 n_\\mu M_{\\mu\\nu}^B n_\\nu - \\lambda\\left(\\sum_{\\mu=1}^3 n_\\mu^2 - 1\\right).\n\\]\nDifferentiate with Respect to the Components \\(n_\\alpha\\) equal to zero for each component\n\\[\n\\frac{\\partial}{\\partial n_\\alpha} \\left(\\sum_{\\mu,\\nu} n_\\mu M_{\\mu\\nu}^B n_\\nu\\right) - \\frac{\\partial}{\\partial n_\\alpha} \\left[\\lambda\\left(\\sum_{\\mu=1}^3 n_\\mu^2 - 1\\right)\\right] = 2\\sum_{\\nu=1}^3 M_{\\alpha\\nu}^B n_\\nu -  2\\lambda n_\\alpha.\n\\]\nwe get:\n\\[\n2\\sum_{\\nu=1}^3 M_{\\alpha\\nu}^B n_\\nu - 2\\lambda n_\\alpha = 0.\n\\]\nThis is exactly Equation (8.7): \\(\\sum_{\\nu=1}^3 M_{\\mu \\nu}^B n_\\nu = \\lambda n_\\mu\\). The equation is an eigenvalue problem for the symmetric \\(3\\times 3\\) matrix \\(M_{\\mu\\nu}^B\\). The eigenvalues \\(\\lambda\\) are real, and the corresponding eigenvectors \\(\\hat{\\boldsymbol{n}}\\) are orthogonal.",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "EPSS 261 Homework",
      "Problem Set 3"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps3.html#electromagnetic-ion-cyclotron-waves",
    "href": "docs/courses/epss261/homework/ps3.html#electromagnetic-ion-cyclotron-waves",
    "title": "Problem Set 3",
    "section": "2 Electromagnetic ion cyclotron waves",
    "text": "2 Electromagnetic ion cyclotron waves\n\nElectromagnetic ion cyclotron waves are left-hand polarized waves excited by velocity space anisotropy (perpendicular gradients in velocity distribution function). They are typically below the ion cyclotron frequency for each species (H+, He+ or O+). MMS observations on 2015 Dec. 14, show that such waves were excited after the passage of a shock.\n\n\n\nCode\nusing Speasy\nspz = speasy()\n\nusing Dates\nusing DimensionalData\nusing CairoMakie\nusing SpaceTools\nusing Unitful\nusing DSP\n\n\n    CondaPkg Found dependencies: /Users/zijin/.julia/packages/DimensionalData/M9vEC/CondaPkg.toml\n    CondaPkg Found dependencies: /Users/zijin/.julia/dev/Speasy/CondaPkg.toml\n    CondaPkg Found dependencies: /Users/zijin/.julia/packages/PythonCall/WMWY0/CondaPkg.toml\n    CondaPkg Dependencies already up to date\n\n\n\n2.1 Spectrogram with cyclotron frequencies\n\n[a] Obtain MMS 1 (or 2,3,4) data between 13:27 and 13:29 UT, from the FGM instrument in GSM coordinates, and plot the spectrogram of the X or Y component between 0-2Hz. Overlay the 3 cyclotron frequencies, as shown in Fig. 5 of the paper (for subset of time). [Note: you should create a low-pass filtered version of the average field at 5-10s window to compute the cyclotron frequencies with; for that use tsmooth2 (IDL) or pyspedas.interpol (PySPEDAS) after degap/clip/deflaging the data first].\n\nhttps://cdaweb.gsfc.nasa.gov/misc/NotesM.html#MMS1_FGM_SRVY_L2\n\n\nCode\nt0 = \"2015-12-14T13:10:00\"\nt1 = \"2015-12-14T13:50:00\"\ntvars = \"cda/MMS1_FGM_SRVY_L2/mms1_fgm_b_gsm_srvy_l2_clean\"\nda = get_data(tvars, t0, t1) |&gt; DimArray\nda = SpaceTools.modify_meta(da, long_name=\"B\")\n\n\nCan't get MMS1_FGM_SRVY_L2/mms1_fgm_b_gsm_srvy_l2_clean without web service, switching to web service\n/Users/zijin/projects/beforerr/.CondaPkg/env/lib/python3.11/site-packages/speasy/core/data_containers.py:18: UserWarning: no explicit representation of timezones available for np.datetime64\n  return np.searchsorted(time, np.datetime64(key, 'ns'), side='left')\n\n\n┌ 19199×4 DimArray{Unitful.Quantity{Float32, 𝐌 𝐈⁻¹ 𝐓⁻², Unitful.FreeUnits{(nT,), 𝐌 𝐈⁻¹ 𝐓⁻², nothing}}, 2} mms1_fgm_b_gsm_srvy_l2_clean ┐\n├──────────────────────────────────────────────────────────────────────── dims ┤\n  ↓ Ti                           Sampled{Dates.DateTime} [2015-12-14T13:10:00, …, 2015-12-14T13:49:59.783] ForwardOrdered Irregular Points,\n  → mms1_fgm_b_gsm_srvy_l2_clean Categorical{Symbol} [Symbol(\"Bx GSM\"), Symbol(\"By GSM\"), Symbol(\"Bz GSM\"), :Bt] Unordered\n├──────────────────────────────────────────────────────────────────── metadata ┤\n  Dict{Any, Any} with 19 entries:\n  \"REPRESENTATION_1\"  =&gt; \"represent_vec_tot\"\n  \"SCALETYP\"          =&gt; \"linear\"\n  \"FILLVAL\"           =&gt; Any[-1.0e31]\n  \"DEPEND_0\"          =&gt; \"Epoch\"\n  \"FIELDNAM\"          =&gt; \"Magnetic field vector in GSM plus Btotal (8 or 16 S/s…\n  \"VALIDMAX\"          =&gt; Any[17000.0, 17000.0, 17000.0, 17000.0]\n  \"SI_CONVERSION\"     =&gt; \"1.0e-9&gt;T\"\n  \"LABL_PTR_1\"        =&gt; Any[\"Bx GSM\", \"By GSM\", \"Bz GSM\", \"Bt    \"]\n  \"TENSOR_ORDER\"      =&gt; Any[1]\n  \"axes\"              =&gt; VariableAxis[Speasy.VariableAxis:…\n  \"COORDINATE_SYSTEM\" =&gt; \"GSM\"\n  \"FORMAT\"            =&gt; \"E13.5\"\n  \"VAR_TYPE\"          =&gt; \"data\"\n  \"CATDESC\"           =&gt; \"Magnetic field vector in Geocentric Solar Magnetosphe…\n  :long_name          =&gt; \"B\"\n  \"DISPLAY_TYPE\"      =&gt; \"time_series\"\n  \"VALIDMIN\"          =&gt; Any[-17000.0, -17000.0, -17000.0, 0.0]\n  \"DIM_SIZES\"         =&gt; Any[4]\n  \"UNITS\"             =&gt; \"nT\"\n└──────────────────────────────────────────────────────────────────────────────┘\n ⋮      ⋱  \n\n\n\n\nCode\nusing SignalAnalysis\nusing PlasmaFormulary\n\np = SpaceTools.pspectrum(da[:, 1])\nbegin\n    f = tplot(p; colorrange=(1e-7, 1), alpha=0.7)\n    ax = current_axis()\n    ylims!(ax, 0u\"Hz\", 2u\"Hz\")\n\n    B_ts = smooth(da, 5u\"s\")[:, 4]\n\n    ic_H = gyrofrequency.(B_ts, :\"H+\") .|&gt; ω2f\n    ic_He = gyrofrequency.(B_ts, :\"He+\") .|&gt; ω2f\n    ic_He2 = gyrofrequency.(B_ts, :\"He2+\") .|&gt; ω2f\n    ic_O = gyrofrequency.(B_ts, :\"O+\") .|&gt; ω2f\n    tplot_panel!.(current_axis(), [ic_H, ic_He, ic_He2, ic_O])\n    f\nend\n\n\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.007986138746711634)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:21\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.007986138746711634)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:21\n\n\n\n\n\n\n\n\n\n\n\n2.2 Band-pass filtered data\n\n[b] Plot the GSM time series of the band-pass filtered data between 0.2 – 2 Hz (again using tsmooth2/pyspedas.interpol to first low-pass filter the data at 0.2Hz, subtract it from the original to create the high-pass residual &gt;0.2Hz, then low-pass filter that with a 2Hz window).\n\n\n\nCode\ntime = DateTime(\"2015-12-14T13:20:00\") .. DateTime(\"2015-12-14T13:30:00\")\nsda = da[time, 1:3]\n# Band-pass filter the data between 0.2-2 Hz\n# First step: Low-pass filter at 0.2 Hz\nlp_02Hz = smooth(sda, 5u\"s\")  # 0.2 Hz ≈ 5 second window\n# High-pass by subtracting low-pass from original\nhp_02Hz = amap(-, sda, lp_02Hz)\n# Second step: Low-pass filter at 2 Hz (0.5 second window)\nbp_filtered = smooth(hp_02Hz, 0.5u\"s\")\n\ntplot([lp_02Hz, hp_02Hz, bp_filtered])\n\n\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.007984877076234697)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:21\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.007984753171800809)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:21\n\n\n\n\n\n\n\n\n\nActually, the frequency response of an \\(M\\) point moving average filter is not a perfect low-pass filter.\n\\[\nH[f]=\\frac{\\sin (\\pi f M)}{M \\sin (\\pi f)}\n\\]\n\n\nCode\nbp_filtered2 = filtfilt(sda, 0.2u\"Hz\", 2u\"Hz\").data\ntplot([hp_02Hz, bp_filtered, bp_filtered2])\ncurrent_figure()\n\n\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.007984877076234697)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:21\n\n\n\n\n\n\n\n\n\n\n\n2.3 Minimum Variance Analysis\n\n[c] Use minvar_matrix_make (IDL or pyspedas) applied on the band-pass filtered data to obtain the minimum variance matrix, on a sliding window. You can control the width and shift of the window (see keywords). Rotate the data in i,j,k (max,int,min) coord’s using tvector_rotate (in IDL / Py - SPEDAS; see how to use it from class examples, or from cribs / readthedocs). Plot the data in that coordinate system.\n\n\n\nCode\ntime = DateTime(\"2015-12-14T13:20:00\") .. DateTime(\"2015-12-14T13:30:00\")\nB_ts = bp_filtered[time, 1:3]\nB_mva_ts = mva(B_ts, B_ts)\n\nB_ts_2 = bp_filtered2[time, 1:3]\nB_mva_ts_2 = mva(B_ts_2, B_ts_2)\n\ntplot([B_ts, B_mva_ts, B_ts_2, B_mva_ts_2])\n\n\n\n\n\n\n\n\n\n\n\n2.4 Minvar direction\n\n[d] The code minvar_matrix_make allows you to output the eigenvectors and eigenvalues. Plot the eigenvalues and evaluate the confidence in the minvar direction. Plot the angle between the minvar direction and the direction of the ambient magnetic field (the 5-10s average above).\n\n\n\nCode\nusing LinearAlgebra\nusing Statistics\nusing SpaceTools\nusing Dates\n\n# Load magnetic field data around the shock crossing\nt0 = DateTime(\"2008-09-05T15:30:00\")\nt1 = DateTime(\"2008-09-05T15:40:00\")\nb_data = get_data(\"cda/THA_L2_FGM/tha_fgs_gse\", t0, t1) |&gt; DimArray\nB = b_data.data  # Get the magnetic field components\n\n# Get eigenvalues and eigenvectors\nF = mva_mat(B)\n\n# The minimum variance direction (shock normal)\nn̂ = F.vectors[:, 3]  # Third eigenvector corresponds to minimum variance\n\n# Calculate θBn (angle between B-field and shock normal)\nB_avg = mean(B, dims=1)[1, :]\nB_avg_norm = B_avg / norm(B_avg)\nθBn = acosd(abs(dot(B_avg_norm, n̂)))\n\n# Calculate Bn (shock-normal magnetic field component)\nBn = dot(B_avg, n̂)\n\nprintln(\"Results of Minimum Variance Analysis:\")\nprintln(\"Shock normal (GSE coordinates): \", round.(n̂, digits=3))\nprintln(\"θBn: \", round(θBn, digits=1), \"°\")\nprintln(\"Bn: \", Bn)\ncheck_mva_mat(F; verbose=true)\n\n\n[ Info: Cannot parse unit nT*GSE*(All*Qs)\nResults of Minimum Variance Analysis:\nShock normal (GSE coordinates): Float32[-0.215, -0.966, 0.143]\nθBn: 61.5°\nBn: 26.65665\nFloat32[0.0060435473 0.97663194 -0.21483368; 0.14459603 -0.21343324 -0.9661977; 0.9894723 0.025224842 0.14250703]\nRatio of intermediate variance to minimum variance = 1.8064607\n┌ Warning: Take the MVA result with a grain of salt!\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/cotrans/mva.jl:82\n\n\n\n\n2.5 Hodogram\n\n[e] There are several bursts of EMIC wave power in the interval. Pick one clean burst with 5-10 cycles and plot the B-field hodogram in the plane of polarization (max,int). (Bandpass filtering first will help). Is it left-hand polarized as expected? [Note that the minvar code ensures a right-hand orthogonal system, but you may have to switch vectors around if the angle to B-field is not less than 90deg].\n\n\n\n\nCode\ninterval = DateTime(\"2015-12-14T13:40:20\") .. DateTime(\"2015-12-14T13:40:40\")\nlet\n    sda = da[interval, 1:3]\n    bp_filtered = filtfilt(sda, 0.8u\"Hz\", 2u\"Hz\").data\n    B_mva_ts = mva(bp_filtered, bp_filtered)\n    f = Figure(; size=(1200, 800))\n    Bx = B_mva_ts[:, [1]]\n    By = B_mva_ts[:, [2]]\n    Bz = B_mva_ts[:, [3]]\n    tplot(f[1, 1], [sda, bp_filtered, B_mva_ts])\n    tplot(f[1, 2], [Bx, By, Bz]; link_yaxes=true)\n    time = dims(Bx, 1).val\n    color = (time .- time[1]) ./ (time[end] - time[1])\n    lines(f[1, 3], Bx[:, 1].data, By[:, 1].data, color=color)\n    f\nend\n\n\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.007949285570537276)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:21\n\n\n\n\n\n\n\n\n\nHodogram analysis indicated left handed polarization during the interval.",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "EPSS 261 Homework",
      "Problem Set 3"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps3.html#shock-crossings",
    "href": "docs/courses/epss261/homework/ps3.html#shock-crossings",
    "title": "Problem Set 3",
    "section": "3 Shock crossings",
    "text": "3 Shock crossings\n\nShock crossings were observed by ARTEMIS P1 (TH-B) in the solar wind on 2013-07-09 20:40UT and on 2014-06-09 16:58UT, both captured in Fast Survey and published in Fig. 3 (analysis results in Table 1 of Zhou et al., 202022). Pick one of the two to study.\n\n\n\nCode\nusing LinearAlgebra\nusing Statistics\nusing DataFrames, TimeSeries\n\n\n\n3.1 Shock normal\n\n[a] Determine, using minimum variance analysis, the shock normal, the angle between the B-field and the shock normal, and the shock-normal magnetic field component, Bn.\n\nThe shock angle, \\(θ_{Bn}\\), the angle between the directions of the upstream magnetic field and the shock normal;\n\n\nCode\n# Load magnetic field data around the shock crossing\nt0 = DateTime(\"2013-07-09T20:37:00\")  # Start a few minutes before the crossing\nt1 = DateTime(\"2013-07-09T20:45:00\")  # End a few minutes after\nb_data = get_data(\"cda/THB_L2_FGM/thb_fgs_gse\", t0, t1) |&gt; DimArray\ntplot(b_data; add_title=true)\n\n\n[ Info: Cannot parse unit nT*GSE*(All*Qs)\n\n\n\n\n\n\n\n\n\n\n\nCode\n# Perform MVA analysis using the built-in function\nF = mva_mat(b_data)\n\n# The minimum variance direction (shock normal)\nn̂ = F.vectors[:, 3]  # Third eigenvector corresponds to minimum variance\n\n# Calculate θBn (angle between B-field and shock normal)\nB_up = vec(mean(b_data[1:10, :].data; dims=1))\nθBn = angle(B_up, n̂)\n\n# Calculate Bn (shock-normal magnetic field component)\nBn = dot(B_up, n̂)\n\nprintln(\"Results of Minimum Variance Analysis for ARTEMIS P1 shock crossing (2013-07-09):\")\nprintln(\"Shock normal (GSE coordinates): \", round.(n̂, digits=3))\nprintln(\"θ_Bn: \", round(θBn, digits=1), \"°\")\nprintln(\"Bn: \", Bn)\ncheck_mva_mat(F, verbose=true)\n\n\nResults of Minimum Variance Analysis for ARTEMIS P1 shock crossing (2013-07-09):\nShock normal (GSE coordinates): Float32[0.923, 0.347, 0.164]\nθ_Bn: 75.4°\nBn: 2.5922403\nFloat32[-0.27282175 0.2701564 0.9233546; 0.29161265 -0.8913902 0.3469665; 0.91680443 0.36392197 0.16440956]\nRatio of intermediate variance to minimum variance = 10.369079\n[ Info: Seems to be a proper MVA attempt!\n\n\n\n\n3.2 Minimum variance direction\n\n[b] Note that there are significant waves downstream but not upstream, which is common for weak (subcritical) shocks. Starting from a small interval barely encompassing the shock (&lt;1min in length), increase the interval by ~0.5 min and recalculate. Then increase again and recalculate. Do so for ~10-20 times until you reach ~10min encompassing the shock. The solution will initially fluctuate from one to the next choice of intervals, then stabilize, then start being jittery again because you are including the waves. Plot the minimum variance direction (two angles, elevation and azimuth, in GSE) and Bn, all as a function of the interval chosen. Pick and report the best solution, based on the shortest time interval choice when the solution becomes stable.\n\n\n\nCode\nazimuth(x) = rad2deg(atan(x[2], x[1]))\nelevation(x) = rad2deg(asin(x[3]))\n\n# Central time of the shock crossing for ARTEMIS P1 (2013-07-09)\nt_start = DateTime(\"2013-07-09T20:39:00\")\ntime_shock = DateTime(\"2013-07-09T20:39:30\")\n\nn = 20\nt_ends = [time_shock + Second(30 * (i - 1)) for i in 1:n]\nb_data = get_data(\"cda/THB_L2_FGM/thb_fgs_gse\", t_start, t_ends[end]) |&gt; DimArray\nb_data.metadata[:units] = \"nT\"\n\nn̂s = map(t_ends) do t_end\n    b_data_subset = b_data[t_start..t_end, :]\n    F = mva_mat(b_data_subset)\n    F.vectors[:, 3]\nend\n\nBn = dot.(Ref(B_up), n̂s)\ndirection = DimArray(\n    [azimuth.(n̂s) elevation.(n̂s)],\n    (Ti(t_ends), Y([:azimuth, :elevation]));\n    name=:direction\n)\nBns = DimArray(Bn, Ti(t_ends); name=:Bn)\nΔBn = abs.(diff(Bns))\nΔBn = SpaceTools.rename(ΔBn, :ΔBn)\n\ntvars = [b_data, direction, [Bns, ΔBn]]\nf, axes = tplot(tvars; add_title=true)\n\n\n[ Info: Cannot parse unit nT*GSE*(All*Qs)\n\n\n\n\n\n\n\n\n\nThe solution becomes stable around “2013-07-09T20:43:00”, about 4 mins after the shock crossing. after “2013-07-09T20:45:00” the solution becomes jittery because the waves are included.\n\n\n3.3 Error estimates\n\n[c] The noise in Bn and the minimum variance directions (angular noise) are tabulated in equations 8.24 and 8.23 of Chapter 8. Plot the \\(ΔB_n\\) and \\(Δφ\\) separately. Check if they support your choice of interval.\n\nThe angular error estimates (in radians) is\n\\[\n\\begin{aligned}\n\\left|\\Delta \\varphi_{i j}\\right|=\\left|\\Delta \\varphi_{j i}\\right| & =\\left\\langle\\left\\langle\\left(\\Delta x_{i j}\\right)^2\\right\\rangle\\right\\rangle^{1 / 2}=\\left\\langle\\left\\langle\\left(\\Delta x_{j i}\\right)^2\\right\\rangle\\right\\rangle^{1 / 2} \\\\\n& =\\sqrt{\\frac{\\lambda_3}{(M-1)} \\frac{\\left(\\lambda_i+\\lambda_j-\\lambda_3\\right)}{\\left(\\lambda_i-\\lambda_j\\right)^2}}, \\quad i \\neq j\n\\end{aligned}\n\\]\nThe composite statistical error estimate for \\(\\left\\langle\\mathbf{B} \\cdot \\mathbf{x}_3\\right\\rangle\\) is\n\\[\n\\left|\\Delta\\left\\langle\\mathbf{B} \\cdot \\mathbf{x₃}\\right\\rangle\\right|=\\sqrt{\\frac{\\lambda_3}{M-1}+\\left(\\Delta \\varphi_{32}\\langle\\mathbf{B}\\rangle \\cdot \\mathbf{x}_2\\right)^2+\\left(\\Delta \\varphi_{31}\\langle\\mathbf{B}\\rangle \\cdot \\mathbf{x}_1\\right)^2}\n\\]\n\"\"\"\n    Δφij(λᵢ, λⱼ, λ₃, M)\n\nCalculate the phase error between components i and j according to:\n|Δφᵢⱼ| = |Δφⱼᵢ| = √(λ₃/(M-1) * (λᵢ + λⱼ - λ₃)/(λᵢ - λⱼ)²)\n\nParameters:\n- λᵢ: eigenvalue i\n- λⱼ: eigenvalue j\n- λ₃: smallest eigenvalue (λ₃)\n- M: number of samples\n\"\"\"\nfunction Δφij(λᵢ, λⱼ, λ₃, M)\n    return sqrt((λ₃ / (M - 1)) * (λᵢ + λⱼ - λ₃) / (λᵢ - λⱼ)^2)\nend\n\n\"\"\"\nCalculate the composite statistical error estimate for ⟨B·x₃⟩:\n|Δ⟨B·x₃⟩| = √(λ₃/(M-1) + (Δφ₃₂⟨B⟩·x₂)² + (Δφ₃₁⟨B⟩·x₁)²)\n\nParameters:\n- λ₁, λ₂, λ₃: eigenvalues in descending order\n- M: number of samples\n- B: mean magnetic field vector\n- x₁, x₂, x₃: eigenvectors\n\"\"\"\nfunction B_x3_error(λ₁, λ₂, λ₃, M, B, x₁, x₂, x₃)\n    Δφ₃₂ = Δφij(λ₃, λ₂, λ₃, M)\n    Δφ₃₁ = Δφij(λ₃, λ₁, λ₃, M)\n    B_x₂ = dot(B, x₂)\n    B_x₁ = dot(B, x₁)\n    return sqrt(λ₃ / (M - 1) + (Δφ₃₂ * B_x₂)^2 + (Δφ₃₁ * B_x₁)^2)\nend\n\nB_x3_error(F::Eigen, M, B) = \n    B_x3_error(F.values..., M, B, eachcol(F.vectors)...)\n\n\nCode\nres = map(t_ends) do t_end\n    b_data_subset = b_data[t_start..t_end, :]\n    F = mva_mat(b_data_subset)\n    M = size(b_data_subset, 1)\n    B = mean(b_data_subset.data; dims=1)\n\n    λ₁ = F.values[1]\n    λ₂ = F.values[2]\n    λ₃ = F.values[3]\n    Δφ12 = SpaceTools.Δφij(λ₁, λ₂, λ₃, M)\n    Δφ13 = SpaceTools.Δφij(λ₁, λ₃, λ₃, M)\n    Δφ23 = SpaceTools.Δφij(λ₂, λ₃, λ₃, M)\n    B_x3_err = SpaceTools.B_x3_error(F, M, B)\n    (; time=t_end, Δφ12, Δφ13, Δφ23, B_x3_err)\nend\n\nerrors = SpaceTools.nt2ds(res)\ntvars = [\n    b_data,\n    [errors.Δφ12, errors.Δφ13, errors.Δφ23],\n    errors.B_x3_err,\n]\ntplot(tvars)\n\n\n\n\n\n\n\n\n\nThe error estimates support our choice of interval.",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "EPSS 261 Homework",
      "Problem Set 3"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps5.html",
    "href": "docs/courses/epss261/homework/ps5.html",
    "title": "Problem Set 5",
    "section": "",
    "text": "Obtain and analyze DC and AC wave data for an event, including wave polarization and Poynting flux. A whistler mode chorus event observed by THEMIS, occurred on TH-E (P5) at ~10:00-10:15 UT on 2008-12-15 (referenced in the class notes in Lecture 10, p.5) taken from the paper by Li et al., JGR 2011.\n\n\nIn the overview plots (here and here), E & B wavepower is significant during significant velocity oscillations. A different whistler mode chorus event was observed by MMS on 2019-08-16 at ~09:32:00UT within a flux pileup region shown in Fig. 2 of Fu et al., GRL 2025. MMS overview plot is here. Follow the structure of Hwk05_01.pro (just an example). Work in either IDL or PySPEDAS, for either the THEMIS or the MMS event to:\n\n\n\nFig. 1. Identify the event in overview plots and point out the wave power related to it\nFig. 2. Get the Electric Field (Double-Probe) Instruments (EFI) data, remove offsets, show ExB velocity, using E*B=0 approximation\nFig. 3. Plot on-board computed spectra. Overplot fce, 1⁄2 fce\nFig. 4. Recognize (wave)burst times in the waveforms and plot them and the spectra\nFig. 5. Introduce E and B and show ground computed spectra (wavelet and Fourier)\nFig. 6. Rotate into FAC coord’s and feed waveforms into wave analysis program. Plot results. Read the section of the relevant paper and explain the role/significance of the whistler waves in their respective setting.\nFig. 7. Show the Poynting flux for the band-passed signal. Do this is time domain (process time series in real space) and in frequency domain (using the available tools).\nDeliver a report explaining what you did, and your code.\n\n\n\n\nLi et al. (2011)\n\n\n\noverview summary\n\n\nWe can clearly observe from the overview plot, specifically in the final panel, that the FBK exhibits wave activity within the frequency range of approximately 10–100 Hz. Additionally, it is evident that this wave activity is modulated with a period of roughly 10 seconds.\n\n\n\nmoms summary\n\n\nSimilarly, the pressure, magnetic field, temperature, and electron density measurements also exhibit oscillations with a comparable period.\n\n\n\n\nGet the Electric Field (Double-Probe) Instruments (EFI) data, remove offsets, show ExB velocity, using E*B=0 approximation\n\n\n\nCode\nusing Speasy\nusing CairoMakie\nusing GLMakie\nusing Dates\nusing SpaceTools\nusing SpaceTools: tplot\nusing LinearAlgebra\nusing Statistics\nusing DimensionalData\nusing Unitful\nusing PlasmaFormulary\nusing SignalAnalysis\nusing Speasy: get_data\nSpaceTools.DEFAULTS.add_title = true\n\n\ntrue\n\n\n\n\nCode\n# Define time intervals for the analysis\ntrange_plus = TimeRange(\"2008-12-15T09:45:00\", \"2008-12-15T10:30:00\")\ntrange = TimeRange(\"2008-12-15T09:55:00\", \"2008-12-15T10:20:00\")\n\n\nTimeRange{String, Intervals.Closed, Intervals.Closed}(\"2008-12-15T09:55:00\", \"2008-12-15T10:20:00\")\n\n\n\n\nCode\n\"\"\"\nReference: [SPEDAS](https://github.com/spedas/bleeding_edge/blob/master/projects/themis/spacecraft/fields/thm_load_fit.pro)\n\"\"\"\nfunction thm_load_fit(probe, timerange; vars=(\"fgs_dsl\", \"efs_dsl\", \"efs_0_dsl\", \"efs_dot0_dsl\"))\n    dataset = \"TH$(uppercase(probe))_L2_FIT\"\n    vars = \"th$(lowercase(probe))_\" .* vars\n    ids = \"cda/$dataset/\" .* vars\n    das = DimArray.(get_data(ids, timerange))\n    return NamedTuple{Tuple(Symbol.(vars))}(das)\nend\n\ndata = thm_load_fit(\"e\", trange)\n\ntplot(data)\n\n\n\n\n\nHere’s the Julia equivalent of the provided IDL code for removing offsets and calculating electric field components:\n\n\nCode\n# Get Ez (dsl) and ExB\nlet B = data.the_fgs_dsl, E = data.the_efs_dsl, angle = 20.0  # degrees\n    # First get Ex/y offsets\n    println(\"Select 2 times (Start/Stop) for obtaining Ex, Ey offsets\")\n    trange4offset = [\"2008-12-15T10:30:00\", \"2008-12-15T10:40:00\"]\n\n    data_offset = thm_load_fit(\"e\", trange4offset)\n    Eoffsets = tmean(data_offset.the_efs_dsl)\n    @info \"Eoffsets\" Eoffsets.data\n\n    # Set angle threshold\n    tanangle = tan(angle * π / 180.0)\n\n    # Calculate the condition for each data point\n    B = B[DimSelectors(E)]\n    bxy_magnitude = sqrt.(B[:, 1] .^ 2 + B[:, 2] .^ 2)\n    angle_condition = abs.(B[:, 3] ./ bxy_magnitude) .&gt;= tanangle\n    igood = findall(angle_condition)\n    ibad = findall(.!angle_condition)\n    janygood = length(igood)\n    janybad = length(ibad)\n    @info \"janygood\" janygood\n    @info \"janybad\" janybad\n    # Apply offsets to Ex and Ey components\n    E_corrected = deepcopy(E)\n    E_corrected[:, 1] .-= Eoffsets[1]\n    E_corrected[:, 2] .-= Eoffsets[2]\n\n    # Set bad data points to NaN\n    if janybad &gt;= 1\n        for i in ibad\n            E_corrected[i, :] .= NaN\n        end\n    end\n\n    if janygood &lt; 1\n        println(\"*****WARNING: NO GOOD 3D ExB data\")\n    else\n        for i in igood\n            E_corrected[i, 3] =\n                -(E_corrected[i, 1] * B[i, 1] +\n                  E_corrected[i, 2] * B[i, 2]) /\n                B[i, 3]\n        end\n    end\n\n    f = Figure()\n    tplot(f[1, 1], data_offset)\n    tplot(f[1, 2:4], [B, E, E_corrected, data.the_efs_0_dsl, data.the_efs_dot0_dsl])\n    f\nend\n\n\n\nSelect 2 times (Start/Stop) for obtaining Ex, Ey offsets\n┌ Info: Eoffsets\n│   Eoffsets.data =\n│    1×3 Matrix{Quantity{Float32, 𝐋 𝐌 𝐈⁻¹ 𝐓⁻³, Unitful.FreeUnits{(m⁻¹, mV), 𝐋 𝐌 𝐈⁻¹ 𝐓⁻³, nothing}}}:\n└     -0.90413 mV m⁻¹  0.0725118 mV m⁻¹  -25.9938 mV m⁻¹\n┌ Warning: (DimensionalData.Dimensions.Dim{:the_efs_dsl},) dims were not found in object.\n└ @ DimensionalData.Dimensions ~/.julia/packages/DimensionalData/M9vEC/src/Dimensions/primitives.jl:844\n┌ Info: janygood\n└   janygood = 489\n┌ Info: janybad\n└   janybad = 0\n\n\n\n\n\n\n\nIn the left panel, we present the data utilized for the offset analysis. In the right panel, arranged sequentially from top to bottom, we display the magnetic field data, the electric field data, the electric field data corrected using our offset analysis, and finally, the corresponding electric field data extracted from the L2 dataset efs_0_dsl and efs_dot0_dsl.\n\n\nCode\nlet E = data.the_efs_dot0_dsl, B = data.the_fgs_dsl\n    B_int = tinterp(B, E)\n    V = tcross(E, B_int) ./ tdot(B_int, B_int) .|&gt; u\"km/s\"\n    V = modify_meta(V, long_name=\"Velocity\", labels=(\"Vx\", \"Vy\", \"Vz\"))\n    tplot([B, E, V])\nend\n\n\n\n\n\nComputed \\(V= E × B/B^2\\) is shown in the last panel.\n\n\n\n\nPlot on-board computed spectra. Overplot fce, 1⁄2 fce\n\n\n\nCode\nfunction thm_load_fbk(probe, timerange; vars=(\"fb_edc12\", \"fb_scm1\"))\n    dataset = \"TH$(uppercase(probe))_L2_FBK\"\n    vars = \"th$(lowercase(probe))_\" .* vars\n    ids = \"cda/$dataset/\" .* vars\n    DimArray.(get_data(ids, timerange))\nend\n\nthm_fb_edc12, thm_fb_scm1 = thm_load_fbk(\"e\", trange) .|&gt; SpaceTools.set_colorrange\n\n\n\n[ Info: Cannot parse unit &lt;|mV/m|&gt;\n[ Info: Cannot parse unit &lt;|nT|&gt;\n\n\n\n\n2-element Vector{DimMatrix{Float32, D, Tuple{}, Matrix{Float32}, Symbol, Dict{Any, Any}} where D&lt;:Tuple}:\n Float32[0.014709114 0.0073833982 … 0.012690215 0.01730484; 0.014709114 0.020304345 … 0.009229247 0.01730484; … ; 0.014709114 0.0 … 0.008075591 0.01730484; 0.0 0.0 … 0.013843872 0.020765807]\n Float32[0.0032959487 0.00077439536 … 0.003418021 0.0085832; 0.0032959487 0.00077439536 … 0.0028839551 0.009536888; … ; 0.0032959487 0.00082780194 … 0.0023498894 0.0014305334; 0.00343328 0.00082780194 … 0.0024567025 0.0071526663]\n\n\nThe three lines in Figures represent 1 fce (blue), 0.5 fce (orange), and 0.1 fce (green).\n\n\nCode\nlet B = tnorm(data.the_fgs_dsl)\n    fce = gyrofrequency.(B, :e) .|&gt; ω2f\n    fce = modify_meta(fce, scale=log10) ./ 1u\"Hz\"\n    f = tplot([thm_fb_edc12, thm_fb_scm1]; add_title=true, alpha=0.7)\n    tplot_panel!.(f.axes, Ref([fce, fce / 2, fce / 10]))\n    f\nend\n\n\n\n┌ Warning: Automatically using edge for Makie because transform == log10 and the first edge is negative\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/methods.jl:40\n┌ Warning: Automatically using edge for Makie because transform == log10 and the first edge is negative\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/methods.jl:40\n┌ Warning: Automatically using edge for Makie because transform == log10 and the first edge is negative\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/methods.jl:40\n┌ Warning: Automatically using edge for Makie because transform == log10 and the first edge is negative\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/methods.jl:40\n┌ Warning: Automatically using edge for Makie because transform == log10 and the first edge is negative\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/methods.jl:40\n┌ Warning: Automatically using edge for Makie because transform == log10 and the first edge is negative\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/methods.jl:40\n\n\n\n\n\n\n\nffw_16_eac34 and ffp_16_eac34 ffp_16_scm3 data are not available for this event.\n\n\nCode\nfunction thm_load_fft(probe, timerange; vars=(\"ffw_16_eac34\", \"ffp_16_eac34\", \"ffp_16_scm3\"))\n    dataset = \"TH$(uppercase(probe))_L2_FFT\"\n    vars = \"th$(lowercase(probe))_\" .* vars\n    ids = \"cda/$dataset/\" .* vars\n    DimArray.(get_data(ids, timerange))\nend\n\nfft_tvars = [\n    \"cda/THE_L2_FFT/the_ffp_16_eac34\",\n    \"cda/THE_L2_FFT/the_ffp_16_scm3\",\n    \"cda/THE_L2_FFT/the_ffw_16_eac34\",\n    \"cda/THE_L2_FFT/the_ffw_16_scm3\",\n]\n\nfft_data = get_data.(fft_tvars, trange)\nall(ismissing.(fft_data)) && @warn \"Data not available\"\n\n\n\nNon compliant ISTP file: trying to load the_ffp_16_eac34_yaxis_vary as support data for the_ffp_16_eac34 but it is absent from the file\nNon compliant ISTP file: trying to load the_ffp_16_scm3_yaxis_vary as support data for the_ffp_16_scm3 but it is absent from the file\nNon compliant ISTP file: trying to load the_ffw_16_eac34_yaxis_vary as support data for the_ffw_16_eac34 but it is absent from the file\nNon compliant ISTP file: trying to load the_ffw_16_scm3_yaxis_vary as support data for the_ffw_16_scm3 but it is absent from the file\nNon compliant ISTP file: swapping DEPEND_0 with DEPEND_TIME for the_ffw_16_scm3, if you think this is a bug report it here: https://github.com/SciQLop/PyISTP/issues\n┌ Warning: Data not available\n└ @ Main.Notebook ~/projects/beforerr/docs/courses/epss261/homework/ps5.qmd:193\n\n\n\n\n\n\n\n\nRecognize (wave)burst times in the waveforms and plot them and the spectra.\n\n\n\nCode\ntvars = [\n    \"cda/THE_L2_SCM/the_scp_dsl\",\n    \"cda/THE_L2_SCM/the_scw_dsl\",\n]\n\nthm_scp_dsl, thm_scw_dsl = get_data.(tvars, trange_plus) .|&gt; DimArray\nf = Figure()\ntplot(f[1, 1], [thm_scp_dsl, thm_scw_dsl])\nf\n\n\n\n[ Info: Cannot parse unit nT*DSL\n[ Info: Cannot parse unit nT*DSL\n[ Info: Resampling array of size (228865, 3) along dimension 1 from 228865 to 6070 points\n[ Info: Resampling array of size (391173, 3) along dimension 1 from 391173 to 6070 points\n\n\n\n\n\n\n\nWe see a waveburst around 2008-12-15T10:13:10.\n\n\nCode\ntvars_wb = [\n    \"cda/THE_L2_SCM/the_scp_dsl\",\n    \"cda/THE_L2_SCM/the_scw_dsl\",\n    \"cda/THE_L2_FBK/the_fb_scm1\",\n]\ntrange_wb = TimeRange(\"2008-12-15T10:13:10\", \"2008-12-15T10:13:20\")\ntrange_wb_s = TimeRange(\"2008-12-15T10:13:10\", \"2008-12-15T10:13:17\")\ndata_wb = get_data.(tvars_wb, trange_wb) .|&gt; DimArray\ntplot(f[1, 2], data_wb)\ntlims!(trange_wb_s)\n\n\n\n[ Info: Cannot parse unit nT*DSL\n[ Info: Cannot parse unit nT*DSL\n[ Info: Cannot parse unit &lt;|nT|&gt;\n[ Info: Resampling array of size (63403, 3) along dimension 1 from 63403 to 6070 points\n┌ Warning: Automatically using edge for Makie because transform == log10 and the first edge is negative\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/methods.jl:40\n┌ Warning: Automatically using edge for Makie because transform == log10 and the first edge is negative\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/methods.jl:40\n┌ Warning: Automatically using edge for Makie because transform == log10 and the first edge is negative\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/methods.jl:40\n\n\n\n\n\n\n\n\n\n\n\nIntroduce E and B and show ground computed spectra (wavelet and Fourier)\n\nusing PySPEDAS.Projects\nthm_efi_ds = themis.efi(trange, level=\"l1\", probe=\"e\")\nthm_efw = DimArray(thm_efi_ds.the_efw)\nLoading efw data using PySPEDAS is somehow quite slow, instead we define a configuration file and load the efw data from the SPDF.\nthe_efw_l1:\n  inventory_path: spdf/THEMIS/THE/L1/EFW\n  master_cdf: https://spdf.gsfc.nasa.gov/pub/data/themis/the/l1/efw/2021/the_l1_efw_20210102_v01.cdf\n  split_frequency: daily\n  split_rule: regular\n  url_pattern: https://spdf.gsfc.nasa.gov/pub/data/themis/the/l1/efw/{Y}/the_l1_efw_{Y}{M:02d}{D:02d}_v\\d+.cdf\n  use_file_list: true\n\n\nCode\nthe_efw_l1_index = speasy.inventories.data_tree.archive.spdf.THEMIS.THE.L1.EFW.the_efw_l1\ntvars = [\n    \"cda/THE_L2_FGM/the_fgs_gsm\",\n    \"cda/THE_L2_FGM/the_fgh_gsm\",\n    \"cda/THE_L2_SCM/the_scp_dsl\",\n    \"cda/THE_L2_SCM/the_scw_dsl\"\n]\nthm_fgs_gsm, thm_fgh_gsm, thm_scp_dsl, thm_scw_dsl = get_data(tvars, trange_plus) .|&gt; DimArray\n\n\n\n[ Info: Cannot parse unit nT*GSM*(All*Qs)\n[ Info: Cannot parse unit nT*GSM*(All*Qs)\n[ Info: Cannot parse unit nT*DSL\n[ Info: Cannot parse unit nT*DSL\n\n\n\n\n4-element Vector{DimMatrix{Float32, D, Tuple{}, Matrix{Float32}, Symbol, Dict{Any, Any}} where D&lt;:Tuple}:\n Float32[-6.884452 2.770554 13.2441; -6.8816504 2.699388 13.368085; … ; -10.854679 -2.0566497 25.193708; -11.012929 -1.8605247 25.144516]\n Float32[-4.202244 1.5139444 15.179175; -4.1365685 1.664007 15.140432; … ; -8.527703 -0.975849 22.252335; -8.648017 -1.0026835 22.07751]\n Float32[-7.3053866f-6 -1.8908788f-5 -2.836187f-5; -7.3053866f-6 -1.8908788f-5 -2.836187f-5; … ; 4.3625614f-6 5.230054f-6 -9.406129f-6; 4.3625614f-6 5.230054f-6 -9.406129f-6]\n Float32[-0.000119733224 0.00037838318 -0.00024678188; -0.000119733224 0.00037838318 -0.00024678188; … ; 0.0017912713 -0.0006972916 0.0004022404; 0.0017912713 -0.0006972916 0.0004022404]\n\n\n\n\nCode\nthm_fgs_gsm_z_dpwrspc = SpaceTools.pspectrum(thm_fgs_gsm[:, 3]; nfft=64) |&gt; SpaceTools.set_colorrange\nthm_scp_dsl_z_dpwrspc = SpaceTools.pspectrum(thm_scp_dsl[:, 3]; nfft=512) |&gt; SpaceTools.set_colorrange\nthm_fgh_gsm_z_dpwrspc = SpaceTools.pspectrum(thm_fgh_gsm[:, 3]) |&gt; SpaceTools.set_colorrange\n\ntvars_wb = [\n    the_efw_l1_index.the_efw,\n    \"cda/THE_L2_SCM/the_scw_dsl\"\n]\n\nthm_efw, thm_scw_dsl = get_data.(tvars_wb, trange_wb) .|&gt; DimArray\n\nthm_scw_dsl_z_dpwrspc = SpaceTools.pspectrum(thm_scw_dsl[:, 3]) |&gt; SpaceTools.set_colorrange\nthm_efw_z_dpwrspc = SpaceTools.pspectrum(thm_efw[:, 3]) |&gt; SpaceTools.set_colorrange\n\nf = Figure()\ntplot(f[1, 1], [\n    thm_fgs_gsm, thm_fgs_gsm_z_dpwrspc,\n    thm_fgh_gsm, thm_fgh_gsm_z_dpwrspc,\n    thm_scp_dsl, thm_scp_dsl_z_dpwrspc,\n])\n\ntplot(f[1, 2], [\n    thm_scw_dsl, thm_scw_dsl_z_dpwrspc,\n    thm_efw, thm_efw_z_dpwrspc,\n])\n\n\n\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 510.99292220984336)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 511.99292220984336)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n[ Info: Cannot parse unit \n[ Info: Cannot parse unit nT*DSL\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n[ Info: Resampling array of size (228864, 3) along dimension 1 from 228864 to 6070 points\n[ Info: Resampling array of size (228865, 3) along dimension 1 from 228865 to 6070 points\n[ Info: Resampling array of size (63403, 3) along dimension 1 from 63403 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n\n\n\n\n\n\n\nDuring the interval when we have wavebursts, the whistle wave is clearly identifiable in the SCP data. However, in the higher-frequency data product, it becomes difficult to discern any distinct signatures within the spectrogram.\n\n\n\n\nRotate into FAC coord’s and feed waveforms into wave analysis program. Plot results. Read the section of the relevant paper and explain the role/significance of the whistler waves in their respective setting.\n\n\n\nCode\ntvars = [\n    \"cda/THE_L2_FGM/the_fgs_dsl\",\n    \"cda/THE_L2_FGM/the_fgh_dsl\",\n    \"cda/THE_L2_SCM/the_scp_dsl\",\n]\n_trange = [\"2008-12-15T09:59\", \"2008-12-15T10:13\"]\n\nthm_fgs_dsl, thm_fgh_dsl, thm_scp_dsl = Speasy.get_data(tvars, _trange) .|&gt; DimArray\n\nfac_mats = tfac_mat(thm_fgs_dsl)\nthm_scp_fac = select_rotate(thm_scp_dsl, fac_mats, \"FAC\")\nthm_fgh_fac = select_rotate(thm_fgh_dsl, fac_mats, \"FAC\")\n\nf = Figure()\n\ntplot(f[1, 1], [\n    thm_fgs_dsl,\n    thm_fgh_dsl,\n    thm_scp_dsl,\n])\ntplot(f[1, 2], [\n    thm_fgh_fac,\n    thm_scp_fac,\n])\n\n\n\n[ Info: Cannot parse unit nT*DSL*(All*Qs)\n[ Info: Cannot parse unit nT*DSL*(All*Qs)\n[ Info: Cannot parse unit nT*DSL\n┌ Warning: (DimensionalData.Dimensions.Dim{:the_scp_dsl},) dims were not found in object.\n└ @ DimensionalData.Dimensions ~/.julia/packages/DimensionalData/M9vEC/src/Dimensions/primitives.jl:844\n┌ Warning: (DimensionalData.Dimensions.Dim{:the_fgh_dsl},) dims were not found in object.\n└ @ DimensionalData.Dimensions ~/.julia/packages/DimensionalData/M9vEC/src/Dimensions/primitives.jl:844\n[ Info: Resampling array of size (107008, 3) along dimension 1 from 107008 to 6070 points\n[ Info: Resampling array of size (107520, 3) along dimension 1 from 107520 to 6070 points\n[ Info: Resampling array of size (107008, 3) along dimension 1 from 107008 to 6070 points\n[ Info: Resampling array of size (107520, 3) along dimension 1 from 107520 to 6070 points\n\n\n\n\n\n\n\n\n\n\n\nCode\nf = Figure(;)\ntplot(f[1, 1], thm_fgh_fac)\ntplot(f[2:6, 1], twavpol(thm_fgh_fac))\ntplot(f[1, 2], thm_scp_fac)\ntplot(f[2:6, 2], twavpol(thm_scp_fac))\n\n\n\n[ Info: Resampling array of size (107008, 3) along dimension 1 from 107008 to 6070 points\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 511.99292220984336)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n[ Info: Resampling array of size (107520, 3) along dimension 1 from 107520 to 6070 points\n\n\n\n\n\n\n\nCompressional pulsations are associated with modulations of resonant electron fluxes and chorus intensity.\nWe have developed a high-performance wave polarization program implemented in Julia, achieving a significant speedup of approximately 100 times compared to its Python counterpart. Furthermore, our implementation is more generalizable, extending the original program’s capabilities to accommodate data in n dimensions. The program is accessible via the following link:\n\nhttps://beforerr.github.io/SpaceTools.jl/dev/explanations/waves/\nhttps://beforerr.github.io/SpaceTools.jl/dev/validation/pyspedas/\n\nCore part is attached in the appendix.\n\n\n\n\n\nthm_crib_poynting_flux.pro\nthm_efi_clean_efw.pro\n\nFrom top to bottom, we present the original data, the cleaned data with spikes removed, and the filtered data.\nThe right panel provides a magnified view of the data presented in the left panel\nWe can see that removing spikes is essential for the accuracy of the filtered data.\n\n\nCode\nbegin\n    E = tclip(thm_efw, trange_wb) |&gt; standardize\n    E_clean = replace_outliers(E; window=128)\n    E_sm = tfilter(E, 64u\"Hz\")\n    E_clean_sm = tfilter(tinterp_nans(E_clean), 64u\"Hz\")\n\n    tvars = [E, E_clean, E_sm, E_clean_sm] .|&gt; timeshift\n    f = Figure()\n    tplot(f[1, 1], tvars)\n    fa2 = tplot(f[1, 2], tvars; link_yaxes=true)\n    tlims!.(fa2.axes, 3.44u\"s\", 3.48u\"s\")\n    f\nend\n\n\n\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n\n\n\n\n\n\n\n\n\nCode\nPoynting_vector(E, B) = tcross(E, B) ./ Unitful.μ0\n\nbegin\n    B = tclip(thm_scw_dsl, trange_wb)\n    E = tclip(thm_efw, trange_wb) |&gt; standardize\n    B = B[DimSelectors(E; selectors=Near())]\n\n    E_clean = replace_outliers(E; window=128)\n    B_sm = tfilter(B, 64u\"Hz\")\n    E_clean_sm = tfilter(tinterp_nans(E_clean), 64u\"Hz\")\n\n    S = Poynting_vector(B, E)\n    S_sm = Poynting_vector(B_sm, E_clean_sm)\n\n    f = Figure()\n    tplot(f[1, 1:2], [thm_scw_dsl, thm_efw])\n    tplot(f[2:4, 1], [B, E, S])\n    tplot(f[2:4, 2], [B_sm, E_clean_sm, S_sm])\n    f\nend\n\n\n\n┌ Warning: (DimensionalData.Dimensions.Dim{:the_efw},) dims were not found in object.\n└ @ DimensionalData.Dimensions ~/.julia/packages/DimensionalData/M9vEC/src/Dimensions/primitives.jl:844\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 1.0)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 1.0)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n[ Info: Resampling array of size (63403, 3) along dimension 1 from 63403 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n\n\n\n\n\n\n\n\n\nFrom top to bottom, the panels show the Poynting flux and its corresponding frequency spectra in the x, y, z directions and magnitude, respectively.\n\n\nCode\nlet S = tnorm_combine(S_sm)\n    S_dpwrspc = pspectrum(S; nfft=512) |&gt; SpaceTools.set_colorrange\n    f = tplot([\n        S,\n        eachslice(S_dpwrspc; dims=Y())...\n    ])\nend\n\n\n\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n[ Info: Resampling array of size (63915, 4) along dimension 1 from 63915 to 6070 points",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "EPSS 261 Homework",
      "Problem Set 5"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps5.html#a-whistler-mode-chorus-event",
    "href": "docs/courses/epss261/homework/ps5.html#a-whistler-mode-chorus-event",
    "title": "Problem Set 5",
    "section": "",
    "text": "Obtain and analyze DC and AC wave data for an event, including wave polarization and Poynting flux. A whistler mode chorus event observed by THEMIS, occurred on TH-E (P5) at ~10:00-10:15 UT on 2008-12-15 (referenced in the class notes in Lecture 10, p.5) taken from the paper by Li et al., JGR 2011.\n\n\nIn the overview plots (here and here), E & B wavepower is significant during significant velocity oscillations. A different whistler mode chorus event was observed by MMS on 2019-08-16 at ~09:32:00UT within a flux pileup region shown in Fig. 2 of Fu et al., GRL 2025. MMS overview plot is here. Follow the structure of Hwk05_01.pro (just an example). Work in either IDL or PySPEDAS, for either the THEMIS or the MMS event to:\n\n\n\nFig. 1. Identify the event in overview plots and point out the wave power related to it\nFig. 2. Get the Electric Field (Double-Probe) Instruments (EFI) data, remove offsets, show ExB velocity, using E*B=0 approximation\nFig. 3. Plot on-board computed spectra. Overplot fce, 1⁄2 fce\nFig. 4. Recognize (wave)burst times in the waveforms and plot them and the spectra\nFig. 5. Introduce E and B and show ground computed spectra (wavelet and Fourier)\nFig. 6. Rotate into FAC coord’s and feed waveforms into wave analysis program. Plot results. Read the section of the relevant paper and explain the role/significance of the whistler waves in their respective setting.\nFig. 7. Show the Poynting flux for the band-passed signal. Do this is time domain (process time series in real space) and in frequency domain (using the available tools).\nDeliver a report explaining what you did, and your code.\n\n\n\n\nLi et al. (2011)\n\n\n\noverview summary\n\n\nWe can clearly observe from the overview plot, specifically in the final panel, that the FBK exhibits wave activity within the frequency range of approximately 10–100 Hz. Additionally, it is evident that this wave activity is modulated with a period of roughly 10 seconds.\n\n\n\nmoms summary\n\n\nSimilarly, the pressure, magnetic field, temperature, and electron density measurements also exhibit oscillations with a comparable period.\n\n\n\n\nGet the Electric Field (Double-Probe) Instruments (EFI) data, remove offsets, show ExB velocity, using E*B=0 approximation\n\n\n\nCode\nusing Speasy\nusing CairoMakie\nusing GLMakie\nusing Dates\nusing SpaceTools\nusing SpaceTools: tplot\nusing LinearAlgebra\nusing Statistics\nusing DimensionalData\nusing Unitful\nusing PlasmaFormulary\nusing SignalAnalysis\nusing Speasy: get_data\nSpaceTools.DEFAULTS.add_title = true\n\n\ntrue\n\n\n\n\nCode\n# Define time intervals for the analysis\ntrange_plus = TimeRange(\"2008-12-15T09:45:00\", \"2008-12-15T10:30:00\")\ntrange = TimeRange(\"2008-12-15T09:55:00\", \"2008-12-15T10:20:00\")\n\n\nTimeRange{String, Intervals.Closed, Intervals.Closed}(\"2008-12-15T09:55:00\", \"2008-12-15T10:20:00\")\n\n\n\n\nCode\n\"\"\"\nReference: [SPEDAS](https://github.com/spedas/bleeding_edge/blob/master/projects/themis/spacecraft/fields/thm_load_fit.pro)\n\"\"\"\nfunction thm_load_fit(probe, timerange; vars=(\"fgs_dsl\", \"efs_dsl\", \"efs_0_dsl\", \"efs_dot0_dsl\"))\n    dataset = \"TH$(uppercase(probe))_L2_FIT\"\n    vars = \"th$(lowercase(probe))_\" .* vars\n    ids = \"cda/$dataset/\" .* vars\n    das = DimArray.(get_data(ids, timerange))\n    return NamedTuple{Tuple(Symbol.(vars))}(das)\nend\n\ndata = thm_load_fit(\"e\", trange)\n\ntplot(data)\n\n\n\n\n\nHere’s the Julia equivalent of the provided IDL code for removing offsets and calculating electric field components:\n\n\nCode\n# Get Ez (dsl) and ExB\nlet B = data.the_fgs_dsl, E = data.the_efs_dsl, angle = 20.0  # degrees\n    # First get Ex/y offsets\n    println(\"Select 2 times (Start/Stop) for obtaining Ex, Ey offsets\")\n    trange4offset = [\"2008-12-15T10:30:00\", \"2008-12-15T10:40:00\"]\n\n    data_offset = thm_load_fit(\"e\", trange4offset)\n    Eoffsets = tmean(data_offset.the_efs_dsl)\n    @info \"Eoffsets\" Eoffsets.data\n\n    # Set angle threshold\n    tanangle = tan(angle * π / 180.0)\n\n    # Calculate the condition for each data point\n    B = B[DimSelectors(E)]\n    bxy_magnitude = sqrt.(B[:, 1] .^ 2 + B[:, 2] .^ 2)\n    angle_condition = abs.(B[:, 3] ./ bxy_magnitude) .&gt;= tanangle\n    igood = findall(angle_condition)\n    ibad = findall(.!angle_condition)\n    janygood = length(igood)\n    janybad = length(ibad)\n    @info \"janygood\" janygood\n    @info \"janybad\" janybad\n    # Apply offsets to Ex and Ey components\n    E_corrected = deepcopy(E)\n    E_corrected[:, 1] .-= Eoffsets[1]\n    E_corrected[:, 2] .-= Eoffsets[2]\n\n    # Set bad data points to NaN\n    if janybad &gt;= 1\n        for i in ibad\n            E_corrected[i, :] .= NaN\n        end\n    end\n\n    if janygood &lt; 1\n        println(\"*****WARNING: NO GOOD 3D ExB data\")\n    else\n        for i in igood\n            E_corrected[i, 3] =\n                -(E_corrected[i, 1] * B[i, 1] +\n                  E_corrected[i, 2] * B[i, 2]) /\n                B[i, 3]\n        end\n    end\n\n    f = Figure()\n    tplot(f[1, 1], data_offset)\n    tplot(f[1, 2:4], [B, E, E_corrected, data.the_efs_0_dsl, data.the_efs_dot0_dsl])\n    f\nend\n\n\n\nSelect 2 times (Start/Stop) for obtaining Ex, Ey offsets\n┌ Info: Eoffsets\n│   Eoffsets.data =\n│    1×3 Matrix{Quantity{Float32, 𝐋 𝐌 𝐈⁻¹ 𝐓⁻³, Unitful.FreeUnits{(m⁻¹, mV), 𝐋 𝐌 𝐈⁻¹ 𝐓⁻³, nothing}}}:\n└     -0.90413 mV m⁻¹  0.0725118 mV m⁻¹  -25.9938 mV m⁻¹\n┌ Warning: (DimensionalData.Dimensions.Dim{:the_efs_dsl},) dims were not found in object.\n└ @ DimensionalData.Dimensions ~/.julia/packages/DimensionalData/M9vEC/src/Dimensions/primitives.jl:844\n┌ Info: janygood\n└   janygood = 489\n┌ Info: janybad\n└   janybad = 0\n\n\n\n\n\n\n\nIn the left panel, we present the data utilized for the offset analysis. In the right panel, arranged sequentially from top to bottom, we display the magnetic field data, the electric field data, the electric field data corrected using our offset analysis, and finally, the corresponding electric field data extracted from the L2 dataset efs_0_dsl and efs_dot0_dsl.\n\n\nCode\nlet E = data.the_efs_dot0_dsl, B = data.the_fgs_dsl\n    B_int = tinterp(B, E)\n    V = tcross(E, B_int) ./ tdot(B_int, B_int) .|&gt; u\"km/s\"\n    V = modify_meta(V, long_name=\"Velocity\", labels=(\"Vx\", \"Vy\", \"Vz\"))\n    tplot([B, E, V])\nend\n\n\n\n\n\nComputed \\(V= E × B/B^2\\) is shown in the last panel.\n\n\n\n\nPlot on-board computed spectra. Overplot fce, 1⁄2 fce\n\n\n\nCode\nfunction thm_load_fbk(probe, timerange; vars=(\"fb_edc12\", \"fb_scm1\"))\n    dataset = \"TH$(uppercase(probe))_L2_FBK\"\n    vars = \"th$(lowercase(probe))_\" .* vars\n    ids = \"cda/$dataset/\" .* vars\n    DimArray.(get_data(ids, timerange))\nend\n\nthm_fb_edc12, thm_fb_scm1 = thm_load_fbk(\"e\", trange) .|&gt; SpaceTools.set_colorrange\n\n\n\n[ Info: Cannot parse unit &lt;|mV/m|&gt;\n[ Info: Cannot parse unit &lt;|nT|&gt;\n\n\n\n\n2-element Vector{DimMatrix{Float32, D, Tuple{}, Matrix{Float32}, Symbol, Dict{Any, Any}} where D&lt;:Tuple}:\n Float32[0.014709114 0.0073833982 … 0.012690215 0.01730484; 0.014709114 0.020304345 … 0.009229247 0.01730484; … ; 0.014709114 0.0 … 0.008075591 0.01730484; 0.0 0.0 … 0.013843872 0.020765807]\n Float32[0.0032959487 0.00077439536 … 0.003418021 0.0085832; 0.0032959487 0.00077439536 … 0.0028839551 0.009536888; … ; 0.0032959487 0.00082780194 … 0.0023498894 0.0014305334; 0.00343328 0.00082780194 … 0.0024567025 0.0071526663]\n\n\nThe three lines in Figures represent 1 fce (blue), 0.5 fce (orange), and 0.1 fce (green).\n\n\nCode\nlet B = tnorm(data.the_fgs_dsl)\n    fce = gyrofrequency.(B, :e) .|&gt; ω2f\n    fce = modify_meta(fce, scale=log10) ./ 1u\"Hz\"\n    f = tplot([thm_fb_edc12, thm_fb_scm1]; add_title=true, alpha=0.7)\n    tplot_panel!.(f.axes, Ref([fce, fce / 2, fce / 10]))\n    f\nend\n\n\n\n┌ Warning: Automatically using edge for Makie because transform == log10 and the first edge is negative\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/methods.jl:40\n┌ Warning: Automatically using edge for Makie because transform == log10 and the first edge is negative\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/methods.jl:40\n┌ Warning: Automatically using edge for Makie because transform == log10 and the first edge is negative\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/methods.jl:40\n┌ Warning: Automatically using edge for Makie because transform == log10 and the first edge is negative\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/methods.jl:40\n┌ Warning: Automatically using edge for Makie because transform == log10 and the first edge is negative\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/methods.jl:40\n┌ Warning: Automatically using edge for Makie because transform == log10 and the first edge is negative\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/methods.jl:40\n\n\n\n\n\n\n\nffw_16_eac34 and ffp_16_eac34 ffp_16_scm3 data are not available for this event.\n\n\nCode\nfunction thm_load_fft(probe, timerange; vars=(\"ffw_16_eac34\", \"ffp_16_eac34\", \"ffp_16_scm3\"))\n    dataset = \"TH$(uppercase(probe))_L2_FFT\"\n    vars = \"th$(lowercase(probe))_\" .* vars\n    ids = \"cda/$dataset/\" .* vars\n    DimArray.(get_data(ids, timerange))\nend\n\nfft_tvars = [\n    \"cda/THE_L2_FFT/the_ffp_16_eac34\",\n    \"cda/THE_L2_FFT/the_ffp_16_scm3\",\n    \"cda/THE_L2_FFT/the_ffw_16_eac34\",\n    \"cda/THE_L2_FFT/the_ffw_16_scm3\",\n]\n\nfft_data = get_data.(fft_tvars, trange)\nall(ismissing.(fft_data)) && @warn \"Data not available\"\n\n\n\nNon compliant ISTP file: trying to load the_ffp_16_eac34_yaxis_vary as support data for the_ffp_16_eac34 but it is absent from the file\nNon compliant ISTP file: trying to load the_ffp_16_scm3_yaxis_vary as support data for the_ffp_16_scm3 but it is absent from the file\nNon compliant ISTP file: trying to load the_ffw_16_eac34_yaxis_vary as support data for the_ffw_16_eac34 but it is absent from the file\nNon compliant ISTP file: trying to load the_ffw_16_scm3_yaxis_vary as support data for the_ffw_16_scm3 but it is absent from the file\nNon compliant ISTP file: swapping DEPEND_0 with DEPEND_TIME for the_ffw_16_scm3, if you think this is a bug report it here: https://github.com/SciQLop/PyISTP/issues\n┌ Warning: Data not available\n└ @ Main.Notebook ~/projects/beforerr/docs/courses/epss261/homework/ps5.qmd:193\n\n\n\n\n\n\n\n\nRecognize (wave)burst times in the waveforms and plot them and the spectra.\n\n\n\nCode\ntvars = [\n    \"cda/THE_L2_SCM/the_scp_dsl\",\n    \"cda/THE_L2_SCM/the_scw_dsl\",\n]\n\nthm_scp_dsl, thm_scw_dsl = get_data.(tvars, trange_plus) .|&gt; DimArray\nf = Figure()\ntplot(f[1, 1], [thm_scp_dsl, thm_scw_dsl])\nf\n\n\n\n[ Info: Cannot parse unit nT*DSL\n[ Info: Cannot parse unit nT*DSL\n[ Info: Resampling array of size (228865, 3) along dimension 1 from 228865 to 6070 points\n[ Info: Resampling array of size (391173, 3) along dimension 1 from 391173 to 6070 points\n\n\n\n\n\n\n\nWe see a waveburst around 2008-12-15T10:13:10.\n\n\nCode\ntvars_wb = [\n    \"cda/THE_L2_SCM/the_scp_dsl\",\n    \"cda/THE_L2_SCM/the_scw_dsl\",\n    \"cda/THE_L2_FBK/the_fb_scm1\",\n]\ntrange_wb = TimeRange(\"2008-12-15T10:13:10\", \"2008-12-15T10:13:20\")\ntrange_wb_s = TimeRange(\"2008-12-15T10:13:10\", \"2008-12-15T10:13:17\")\ndata_wb = get_data.(tvars_wb, trange_wb) .|&gt; DimArray\ntplot(f[1, 2], data_wb)\ntlims!(trange_wb_s)\n\n\n\n[ Info: Cannot parse unit nT*DSL\n[ Info: Cannot parse unit nT*DSL\n[ Info: Cannot parse unit &lt;|nT|&gt;\n[ Info: Resampling array of size (63403, 3) along dimension 1 from 63403 to 6070 points\n┌ Warning: Automatically using edge for Makie because transform == log10 and the first edge is negative\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/methods.jl:40\n┌ Warning: Automatically using edge for Makie because transform == log10 and the first edge is negative\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/methods.jl:40\n┌ Warning: Automatically using edge for Makie because transform == log10 and the first edge is negative\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/methods.jl:40\n\n\n\n\n\n\n\n\n\n\n\nIntroduce E and B and show ground computed spectra (wavelet and Fourier)\n\nusing PySPEDAS.Projects\nthm_efi_ds = themis.efi(trange, level=\"l1\", probe=\"e\")\nthm_efw = DimArray(thm_efi_ds.the_efw)\nLoading efw data using PySPEDAS is somehow quite slow, instead we define a configuration file and load the efw data from the SPDF.\nthe_efw_l1:\n  inventory_path: spdf/THEMIS/THE/L1/EFW\n  master_cdf: https://spdf.gsfc.nasa.gov/pub/data/themis/the/l1/efw/2021/the_l1_efw_20210102_v01.cdf\n  split_frequency: daily\n  split_rule: regular\n  url_pattern: https://spdf.gsfc.nasa.gov/pub/data/themis/the/l1/efw/{Y}/the_l1_efw_{Y}{M:02d}{D:02d}_v\\d+.cdf\n  use_file_list: true\n\n\nCode\nthe_efw_l1_index = speasy.inventories.data_tree.archive.spdf.THEMIS.THE.L1.EFW.the_efw_l1\ntvars = [\n    \"cda/THE_L2_FGM/the_fgs_gsm\",\n    \"cda/THE_L2_FGM/the_fgh_gsm\",\n    \"cda/THE_L2_SCM/the_scp_dsl\",\n    \"cda/THE_L2_SCM/the_scw_dsl\"\n]\nthm_fgs_gsm, thm_fgh_gsm, thm_scp_dsl, thm_scw_dsl = get_data(tvars, trange_plus) .|&gt; DimArray\n\n\n\n[ Info: Cannot parse unit nT*GSM*(All*Qs)\n[ Info: Cannot parse unit nT*GSM*(All*Qs)\n[ Info: Cannot parse unit nT*DSL\n[ Info: Cannot parse unit nT*DSL\n\n\n\n\n4-element Vector{DimMatrix{Float32, D, Tuple{}, Matrix{Float32}, Symbol, Dict{Any, Any}} where D&lt;:Tuple}:\n Float32[-6.884452 2.770554 13.2441; -6.8816504 2.699388 13.368085; … ; -10.854679 -2.0566497 25.193708; -11.012929 -1.8605247 25.144516]\n Float32[-4.202244 1.5139444 15.179175; -4.1365685 1.664007 15.140432; … ; -8.527703 -0.975849 22.252335; -8.648017 -1.0026835 22.07751]\n Float32[-7.3053866f-6 -1.8908788f-5 -2.836187f-5; -7.3053866f-6 -1.8908788f-5 -2.836187f-5; … ; 4.3625614f-6 5.230054f-6 -9.406129f-6; 4.3625614f-6 5.230054f-6 -9.406129f-6]\n Float32[-0.000119733224 0.00037838318 -0.00024678188; -0.000119733224 0.00037838318 -0.00024678188; … ; 0.0017912713 -0.0006972916 0.0004022404; 0.0017912713 -0.0006972916 0.0004022404]\n\n\n\n\nCode\nthm_fgs_gsm_z_dpwrspc = SpaceTools.pspectrum(thm_fgs_gsm[:, 3]; nfft=64) |&gt; SpaceTools.set_colorrange\nthm_scp_dsl_z_dpwrspc = SpaceTools.pspectrum(thm_scp_dsl[:, 3]; nfft=512) |&gt; SpaceTools.set_colorrange\nthm_fgh_gsm_z_dpwrspc = SpaceTools.pspectrum(thm_fgh_gsm[:, 3]) |&gt; SpaceTools.set_colorrange\n\ntvars_wb = [\n    the_efw_l1_index.the_efw,\n    \"cda/THE_L2_SCM/the_scw_dsl\"\n]\n\nthm_efw, thm_scw_dsl = get_data.(tvars_wb, trange_wb) .|&gt; DimArray\n\nthm_scw_dsl_z_dpwrspc = SpaceTools.pspectrum(thm_scw_dsl[:, 3]) |&gt; SpaceTools.set_colorrange\nthm_efw_z_dpwrspc = SpaceTools.pspectrum(thm_efw[:, 3]) |&gt; SpaceTools.set_colorrange\n\nf = Figure()\ntplot(f[1, 1], [\n    thm_fgs_gsm, thm_fgs_gsm_z_dpwrspc,\n    thm_fgh_gsm, thm_fgh_gsm_z_dpwrspc,\n    thm_scp_dsl, thm_scp_dsl_z_dpwrspc,\n])\n\ntplot(f[1, 2], [\n    thm_scw_dsl, thm_scw_dsl_z_dpwrspc,\n    thm_efw, thm_efw_z_dpwrspc,\n])\n\n\n\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 510.99292220984336)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 511.99292220984336)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n[ Info: Cannot parse unit \n[ Info: Cannot parse unit nT*DSL\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n[ Info: Resampling array of size (228864, 3) along dimension 1 from 228864 to 6070 points\n[ Info: Resampling array of size (228865, 3) along dimension 1 from 228865 to 6070 points\n[ Info: Resampling array of size (63403, 3) along dimension 1 from 63403 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n\n\n\n\n\n\n\nDuring the interval when we have wavebursts, the whistle wave is clearly identifiable in the SCP data. However, in the higher-frequency data product, it becomes difficult to discern any distinct signatures within the spectrogram.\n\n\n\n\nRotate into FAC coord’s and feed waveforms into wave analysis program. Plot results. Read the section of the relevant paper and explain the role/significance of the whistler waves in their respective setting.\n\n\n\nCode\ntvars = [\n    \"cda/THE_L2_FGM/the_fgs_dsl\",\n    \"cda/THE_L2_FGM/the_fgh_dsl\",\n    \"cda/THE_L2_SCM/the_scp_dsl\",\n]\n_trange = [\"2008-12-15T09:59\", \"2008-12-15T10:13\"]\n\nthm_fgs_dsl, thm_fgh_dsl, thm_scp_dsl = Speasy.get_data(tvars, _trange) .|&gt; DimArray\n\nfac_mats = tfac_mat(thm_fgs_dsl)\nthm_scp_fac = select_rotate(thm_scp_dsl, fac_mats, \"FAC\")\nthm_fgh_fac = select_rotate(thm_fgh_dsl, fac_mats, \"FAC\")\n\nf = Figure()\n\ntplot(f[1, 1], [\n    thm_fgs_dsl,\n    thm_fgh_dsl,\n    thm_scp_dsl,\n])\ntplot(f[1, 2], [\n    thm_fgh_fac,\n    thm_scp_fac,\n])\n\n\n\n[ Info: Cannot parse unit nT*DSL*(All*Qs)\n[ Info: Cannot parse unit nT*DSL*(All*Qs)\n[ Info: Cannot parse unit nT*DSL\n┌ Warning: (DimensionalData.Dimensions.Dim{:the_scp_dsl},) dims were not found in object.\n└ @ DimensionalData.Dimensions ~/.julia/packages/DimensionalData/M9vEC/src/Dimensions/primitives.jl:844\n┌ Warning: (DimensionalData.Dimensions.Dim{:the_fgh_dsl},) dims were not found in object.\n└ @ DimensionalData.Dimensions ~/.julia/packages/DimensionalData/M9vEC/src/Dimensions/primitives.jl:844\n[ Info: Resampling array of size (107008, 3) along dimension 1 from 107008 to 6070 points\n[ Info: Resampling array of size (107520, 3) along dimension 1 from 107520 to 6070 points\n[ Info: Resampling array of size (107008, 3) along dimension 1 from 107008 to 6070 points\n[ Info: Resampling array of size (107520, 3) along dimension 1 from 107520 to 6070 points\n\n\n\n\n\n\n\n\n\n\n\nCode\nf = Figure(;)\ntplot(f[1, 1], thm_fgh_fac)\ntplot(f[2:6, 1], twavpol(thm_fgh_fac))\ntplot(f[1, 2], thm_scp_fac)\ntplot(f[2:6, 2], twavpol(thm_scp_fac))\n\n\n\n[ Info: Resampling array of size (107008, 3) along dimension 1 from 107008 to 6070 points\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 511.99292220984336)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n[ Info: Resampling array of size (107520, 3) along dimension 1 from 107520 to 6070 points\n\n\n\n\n\n\n\nCompressional pulsations are associated with modulations of resonant electron fluxes and chorus intensity.\nWe have developed a high-performance wave polarization program implemented in Julia, achieving a significant speedup of approximately 100 times compared to its Python counterpart. Furthermore, our implementation is more generalizable, extending the original program’s capabilities to accommodate data in n dimensions. The program is accessible via the following link:\n\nhttps://beforerr.github.io/SpaceTools.jl/dev/explanations/waves/\nhttps://beforerr.github.io/SpaceTools.jl/dev/validation/pyspedas/\n\nCore part is attached in the appendix.\n\n\n\n\n\nthm_crib_poynting_flux.pro\nthm_efi_clean_efw.pro\n\nFrom top to bottom, we present the original data, the cleaned data with spikes removed, and the filtered data.\nThe right panel provides a magnified view of the data presented in the left panel\nWe can see that removing spikes is essential for the accuracy of the filtered data.\n\n\nCode\nbegin\n    E = tclip(thm_efw, trange_wb) |&gt; standardize\n    E_clean = replace_outliers(E; window=128)\n    E_sm = tfilter(E, 64u\"Hz\")\n    E_clean_sm = tfilter(tinterp_nans(E_clean), 64u\"Hz\")\n\n    tvars = [E, E_clean, E_sm, E_clean_sm] .|&gt; timeshift\n    f = Figure()\n    tplot(f[1, 1], tvars)\n    fa2 = tplot(f[1, 2], tvars; link_yaxes=true)\n    tlims!.(fa2.axes, 3.44u\"s\", 3.48u\"s\")\n    f\nend\n\n\n\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n\n\n\n\n\n\n\n\n\nCode\nPoynting_vector(E, B) = tcross(E, B) ./ Unitful.μ0\n\nbegin\n    B = tclip(thm_scw_dsl, trange_wb)\n    E = tclip(thm_efw, trange_wb) |&gt; standardize\n    B = B[DimSelectors(E; selectors=Near())]\n\n    E_clean = replace_outliers(E; window=128)\n    B_sm = tfilter(B, 64u\"Hz\")\n    E_clean_sm = tfilter(tinterp_nans(E_clean), 64u\"Hz\")\n\n    S = Poynting_vector(B, E)\n    S_sm = Poynting_vector(B_sm, E_clean_sm)\n\n    f = Figure()\n    tplot(f[1, 1:2], [thm_scw_dsl, thm_efw])\n    tplot(f[2:4, 1], [B, E, S])\n    tplot(f[2:4, 2], [B_sm, E_clean_sm, S_sm])\n    f\nend\n\n\n\n┌ Warning: (DimensionalData.Dimensions.Dim{:the_efw},) dims were not found in object.\n└ @ DimensionalData.Dimensions ~/.julia/packages/DimensionalData/M9vEC/src/Dimensions/primitives.jl:844\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 1.0)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 1.0)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n[ Info: Resampling array of size (63403, 3) along dimension 1 from 63403 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n[ Info: Resampling array of size (63915, 3) along dimension 1 from 63915 to 6070 points\n\n\n\n\n\n\n\n\n\nFrom top to bottom, the panels show the Poynting flux and its corresponding frequency spectra in the x, y, z directions and magnitude, respectively.\n\n\nCode\nlet S = tnorm_combine(S_sm)\n    S_dpwrspc = pspectrum(S; nfft=512) |&gt; SpaceTools.set_colorrange\n    f = tplot([\n        S,\n        eachslice(S_dpwrspc; dims=Y())...\n    ])\nend\n\n\n\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n┌ Warning: Time resolution is is not approximately constant (relerr ≈ 0.0020964360587002098)\n└ @ SpaceTools ~/.julia/dev/SpaceTools/src/timeseries.jl:23\n[ Info: Resampling array of size (63915, 4) along dimension 1 from 63915 to 6070 points",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "EPSS 261 Homework",
      "Problem Set 5"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps5.html#appendix",
    "href": "docs/courses/epss261/homework/ps5.html#appendix",
    "title": "Problem Set 5",
    "section": "2 Appendix",
    "text": "2 Appendix\nCore codes is pasted here for reference (which is readable to some extent:).\n\"\"\"\n    spectral_matrix(X, window)\n\"\"\"\nfunction spectral_matrix(X::AbstractMatrix, window::AbstractVector=ones(size(X, 1)))\n    n_samples, n = size(X)\n\n    # Apply the window to each component\n    Xw = X .* window\n\n    # Compute FFTs and normalize\n    Xf = fft(Xw, 1) ./ sqrt(n_samples)\n\n    # Only keep the positive frequencies\n    Nfreq = div(n_samples, 2)\n    Xf = Xf[1:Nfreq, :]\n\n    S = Array{ComplexF64,3}(undef, Nfreq, n, n)\n    for i in 1:n, j in 1:n\n        @. S[:, i, j] = Xf[:, i] * conj(Xf[:, j])\n    end\n\n    return S\nend\n\n\"\"\"\n    wavpol(ct, X; nfft=256, noverlap=nfft÷2, bin_freq=3)\n\nPerform polarization analysis of `n`-component time series data.\n\nAssumes the data are in a right-handed, field-aligned coordinate system \n(with Z along the ambient magnetic field).\n\nFor each FFT window (with specified overlap), the routine:\n  1. Computes the FFT and constructs the spectral matrix ``S(f)``.\n  2. Applies frequency smoothing using a window (of length `bin_freq`).\n  3. Computes the wave power, degree of polarization, wave normal angle,\n     ellipticity, and helicity.\n\n# Returns\nA tuple: where each parameter (except `freqline`) is an array with one row per FFT window.\n\"\"\"\nfunction wavpol(ct, X; nfft=256, noverlap=div(nfft, 2), bin_freq=3)\n    # Ensure the smoothing window length is odd.\n    iseven(bin_freq) && (bin_freq += 1)\n\n    N = size(X, 1)\n    samp_freq = samplingrate(ct)\n    Nfreq = div(nfft, 2)\n    fs = (samp_freq / nfft) * (0:(Nfreq-1))\n\n    # Define the number of FFT windows and times (center time of each window)\n    nsteps = floor(Int, (N - nfft) / noverlap) + 1\n    times = similar(ct, nsteps)\n\n    # Define the FFT window (here a smooth window similar to Hanning)\n    window = 0.08 .+ 0.46 .* (1 .- cos.(2π .* (0:(nfft-1)) ./ nfft))\n    half = div(nfft, 2)\n    # Use a Hamming window for frequency smoothing.\n    smooth_win = 0.54 .- 0.46 * cos.(2π .* (0:(bin_freq-1)) ./ (bin_freq - 1))\n    smooth_win = smooth_win / sum(smooth_win)\n\n    # Preallocate arrays for the results.\n    power = zeros(Float64, nsteps, Nfreq)\n    degpol = zeros(Float64, nsteps, Nfreq)\n    waveangle = zeros(Float64, nsteps, Nfreq)\n    ellipticity = zeros(Float64, nsteps, Nfreq)\n    helicity = zeros(Float64, nsteps, Nfreq)\n\n    # Process each FFT window.\n    Threads.@threads for j in 1:nsteps\n        start_idx = 1 + (j - 1) * noverlap\n        end_idx = start_idx + nfft - 1\n        if end_idx &gt; N\n            continue\n        end\n        S = spectral_matrix(@view(X[start_idx:end_idx, :]), window)\n        S_smooth = smooth_spectral_matrix(S, smooth_win)\n        params = compute_polarization_parameters(S_smooth)\n\n        # Store the results.\n        power[j, :] = params.power\n        degpol[j, :] = params.degpol\n        waveangle[j, :] = params.waveangle\n        ellipticity[j, :] = params.ellipticity\n        helicity[j, :] = params.helicity\n        times[j] = ct[start_idx+half] # Set the times at the center of the FFT window.\n    end\n    return (; times, fs, power, degpol, waveangle, ellipticity, helicity)\nend\nfunction wpol_helicity(S::AbstractMatrix{ComplexF64}, waveangle::Number)\n    # Preallocate arrays for 3 polarization components\n    helicity_comps = zeros(Float64, 3)\n    ellip_comps = zeros(Float64, 3)\n\n    for comp in 1:3\n        # Build state vector λ_u for this polarization component\n        alph = sqrt(real(S[comp, comp]))\n        alph == 0.0 && continue\n        if comp == 1\n            lam_u = [\n                alph,\n                (real(S[1, 2]) / alph) + im * (-imag(S[1, 2]) / alph),\n                (real(S[1, 3]) / alph) + im * (-imag(S[1, 3]) / alph)\n            ]\n        elseif comp == 2\n            lam_u = [\n                (real(S[2, 1]) / alph) + im * (-imag(S[2, 1]) / alph),\n                alph,\n                (real(S[2, 3]) / alph) + im * (-imag(S[2, 3]) / alph)\n            ]\n        else\n            lam_u = [\n                (real(S[3, 1]) / alph) + im * (-imag(S[3, 1]) / alph),\n                (real(S[3, 2]) / alph) + im * (-imag(S[3, 2]) / alph),\n                alph\n            ]\n        end\n\n        # Compute the phase rotation (gammay) for this state vector\n        lam_y = phase_factor(lam_u) * lam_u\n\n        # Helicity: ratio of the norm of the imaginary part to the real part\n        norm_real = norm(real(lam_y))\n        norm_imag = norm(imag(lam_y))\n        helicity_comps[comp] = (norm_imag != 0) ? norm_imag / norm_real : NaN\n\n        # For ellipticity, use only the first two components\n        u1 = lam_y[1]\n        u2 = lam_y[2]\n\n        # TODO: why there is no 2 in front of uppere?\n        uppere = imag(u1) * real(u1) + imag(u2) * real(u2)\n        lowere = (-imag(u1)^2 + real(u1)^2 - imag(u2)^2 + real(u2)^2)\n        gammarot = atan(uppere, lowere)\n        lam_urot = exp(-1im * 0.5 * gammarot) * [u1, u2]\n\n        num = norm(imag(lam_urot))\n        den = norm(real(lam_urot))\n        ellip_val = (den != 0) ? num / den : NaN\n        # Adjust sign using the off-diagonal of ematspec and the wave normal angle\n        sign_factor = sign(imag(S[1, 2]) * sin(waveangle))\n        ellip_comps[comp] = ellip_val * sign_factor\n    end\n\n    # Average the three computed values\n    helicity = mean(helicity_comps)\n    ellipticity = mean(ellip_comps)\n\n    return helicity, ellipticity\nend",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "EPSS 261 Homework",
      "Problem Set 5"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps5.html#references",
    "href": "docs/courses/epss261/homework/ps5.html#references",
    "title": "Problem Set 5",
    "section": "3 References",
    "text": "3 References\nSearch Coil Magnetometer (SCM) science data\n\nWB waveforms (scw) [8192 S/s]\nhttps://themis.igpp.ucla.edu/scm_dataflow.shtml\n\nElectric Field Instruments (EFI) science data\n\nPB waveforms (efp, vap) [128 S/s; Allocation ~ 1.2h]\n\nWB waveforms (efw, vaw) [8192 S/s; Allocation ~ 43s]\nhttps://themis.ssl.berkeley.edu/instrument_efi.shtml",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "EPSS 261 Homework",
      "Problem Set 5"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps6.html",
    "href": "docs/courses/epss261/homework/ps6.html",
    "title": "Problem Set 6",
    "section": "",
    "text": "Obtain and analyze plasma data, including spectra, for the first MMS Science event (Burch et al., Science 2016, link here) showing magnetopause reconnection at the electron diffusion region on 2016/10/16 13:07:02.2 UT. Start by using Hwk06_mpause_RX.pro, provided. The objective of this exercise is to introduce plasma distributions from MMS (electrons and ions) and create burst spectra. In the process also create plasma moments and the plasma current and plot these along E and B. You are requested to create Figure 2 of Burch et al. plus the 3 bottom (electron) spectrograms from Figure 3 of the same paper (panels 3G, 3H and 3I). Your figure should look like the one shown on the next page, but using burst mode data in order to make it look like in Burch et al. You are requested to plot this figure at 2 time scales: the overview (2 min) timescale as in Fig. 2 of Burch et al. [‘13:05:30’,’13:07:30’] and the zoom-in (3 sec) timescale as in Fig. 3 of Burch et al. [‘13:07:00.5’,‘13:07:03.5’]. Notice that the clean and fast m’pause crossing was at 13:05:40UT, and this is used to determine N. In Fig. 2K of Burch et al. (the right-hand side of Fig. 2, the pictorial view of the MMS trajectory for the 2min interval) this initial m’pause crossing was near the start of the trajectory. The trajectory crosses the X-point at the 3 seconds of the zoom-in interval.\n\n\n\nCode\nusing Speasy\nusing DimensionalData\nusing SPEDAS\nusing SPEDAS.MMS\nusing SPEDAS: dimarrayify\n# using GLMakie\nusing Unitful\nusing CairoMakie\n\nupdate_theme!(colormap=:rainbow1)\nSPEDAS.DEFAULTS.add_title = true;\n\n\n\n\n\n\n\n\nCode\ntrange = (\"2015-10-16T13:05:35\", \"2015-10-16T13:07:25\")\ntr_mpause = (\"2015-10-16T13:05:40\", \"2015-10-16T13:06:09\")\n\nprobe = 2\n\ntvars = [\n    \"cda/MMS2_FGM_SRVY_L2/mms2_fgm_b_gse_srvy_l2_clean\",\n    \"cda/MMS2_EDP_FAST_L2_DCE/mms2_edp_dce_gse_fast_l2\",\n]\nB_gse, edp_dce_gse = get_data(tvars, trange) .|&gt; DimArray\nrotMat = mva_mat(tclip(B_gse[:, 1:3], tr_mpause))\nB_LMN = rotate(B_gse[:, 1:3], rotMat) |&gt; set_coord(\"LMN\") |&gt; set_coord(\"Boundary-normal coordinates\"; old_coords=[\"Geocentric Solar Ecliptic\"])\nE_LMN = rotate(edp_dce_gse, rotMat) |&gt; set_coord(\"LMN\")\n\nrotMat\n\n\nCan't get MMS2_FGM_SRVY_L2/mms2_fgm_b_gse_srvy_l2_clean without web service, switching to web service\n\n\nLinearAlgebra.Eigen{Float32, Quantity{Float32, 𝐌² 𝐈⁻² 𝐓⁻⁴, Unitful.FreeUnits{(nT²,), 𝐌² 𝐈⁻² 𝐓⁻⁴, nothing}}, Matrix{Float32}, Vector{Quantity{Float32, 𝐌² 𝐈⁻² 𝐓⁻⁴, Unitful.FreeUnits{(nT²,), 𝐌² 𝐈⁻² 𝐓⁻⁴, nothing}}}}\nvalues:\n3-element Vector{Quantity{Float32, 𝐌² 𝐈⁻² 𝐓⁻⁴, Unitful.FreeUnits{(nT²,), 𝐌² 𝐈⁻² 𝐓⁻⁴, nothing}}}:\n 501.50833f0 nT²\n  32.28409f0 nT²\n  13.2533245f0 nT²\nvectors:\n3×3 Matrix{Float32}:\n  0.368873   0.571604   0.73294\n -0.122903  -0.75163    0.648034\n  0.921318  -0.329122  -0.207004\n\n\nThe direction obtained from the Minimum Variance Analysis (MVA) in our study closely aligns with the direction reported in the literature.\n\nThe (x, y, z) GSE components of the L, M, and N axes are L = (0.3665, –0.1201, 0.9226) GSE, M = (0.5694, –0.7553, –0.3245) GSE, and N = (0.7358, 0.6443, –0.2084) GSE\n\n\n\n\n\n\nCode\ndata_rate = \"brst\"\nfpi_des_ds = FPIDataSet(; probe, data_rate, data_type=\"des\")\nfpi_dis_ds = FPIDataSet(; probe, data_rate, data_type=\"dis\")\n\ndes_data = get_data(NamedTuple, fpi_des_ds, trange) |&gt; dimarrayify\ndis_data = get_data(NamedTuple, fpi_dis_ds, trange) |&gt; dimarrayify\n\ndes_n = modify_meta(des_data.numberdensity[:, 1], label=\"Ne\")\ndis_bulkv_lmn = rotate(dis_data.bulkv_gse, rotMat) |&gt; set_coord(\"LMN\")\ndes_bulkv_lmn = rotate(des_data.bulkv_gse, rotMat) |&gt; set_coord(\"LMN\")\ndis_n = modify_meta(dis_data.numberdensity[:, 1], label=\"Ni\")\n\n\n\n┌ 733-element DimArray{Unitful.Quantity{Float32, 𝐋⁻³, Unitful.FreeUnits{(cm⁻³,), 𝐋⁻³, nothing}}, 1} mms2_dis_numberdensity_brst ┐\n├──────────────────────────────────────────────────────────────────────── dims ┤\n  ↓ Ti Sampled{NanoDates.NanoDate} [2015-10-16T13:05:35.144103, …, 2015-10-16T13:07:24.945661] ForwardOrdered Irregular Points\n├──────────────────────────────────────────────────────────────────── metadata ┤\n  Dict{Any, Any} with 17 entries:\n  \"SCALETYP\"        =&gt; \"linear\"\n  \"FILLVAL\"         =&gt; Any[-1.0e31]\n  \"DEPEND_0\"        =&gt; \"Epoch\"\n  \"FIELDNAM\"        =&gt; \"MMS2 FPI/DIS number density\"\n  \"SI_CONVERSION\"   =&gt; \"1e6&gt;m^-3\"\n  \"VALIDMAX\"        =&gt; Any[100000.0]\n  \"axes\"            =&gt; VariableAxis[Speasy.VariableAxis(time, Units: ns, Shape:…\n  :label            =&gt; \"Ni\"\n  \"DELTA_MINUS_VAR\" =&gt; \"mms2_dis_numberdensity_err_brst\"\n  \"FORMAT\"          =&gt; \"E12.2\"\n  \"VAR_TYPE\"        =&gt; \"data\"\n  \"CATDESC\"         =&gt; \"MMS2 FPI/DIS ion number density during this burst\"\n  \"LABLAXIS\"        =&gt; \"N\"\n  \"DELTA_PLUS_VAR\"  =&gt; \"mms2_dis_numberdensity_err_brst\"\n  \"DISPLAY_TYPE\"    =&gt; \"time_series\"\n  \"VALIDMIN\"        =&gt; Any[0.001]\n  \"UNITS\"           =&gt; \"cm^-3\"\n└──────────────────────────────────────────────────────────────────────────────┘\n ⋮      ⋱  \n\n\n\n\n\n\n\n\nCode\nVi_perp_mag, Ve_perp_mag = let Vi = dis_data.bulkv_gse, Ve = des_data.bulkv_gse, B = B_gse\n    Vi_clip = tclip(Vi, B)\n    Ve_clip = tclip(Ve, B)\n\n    B_int_Vi = tinterp(B, Vi_clip)[:, 1:3]\n    B_int_Ve = tinterp(B, Ve_clip)[:, 1:3]\n    Vi_perp_mag = toproj(Vi_clip, B_int_Vi) |&gt; tnorm\n    Ve_perp_mag = toproj(Ve_clip, B_int_Ve) |&gt; tnorm\n\n    modify_meta(Vi_perp_mag, ylabel=\"Viper_t\"),\n    modify_meta(Ve_perp_mag, ylabel=\"Veper_t\")\nend\n\n\n(Quantity{Float32, 𝐋 𝐓⁻¹, Unitful.FreeUnits{(km, s⁻¹), 𝐋 𝐓⁻¹, nothing}}[16.370079f0 km s⁻¹, 39.085266f0 km s⁻¹, 18.779638f0 km s⁻¹, 36.385616f0 km s⁻¹, 28.834595f0 km s⁻¹, 31.232655f0 km s⁻¹, 21.860336f0 km s⁻¹, 25.042305f0 km s⁻¹, 19.904325f0 km s⁻¹, 3.4641075f0 km s⁻¹  …  54.85829f0 km s⁻¹, 52.70736f0 km s⁻¹, 43.587467f0 km s⁻¹, 37.50158f0 km s⁻¹, 32.17601f0 km s⁻¹, 29.35025f0 km s⁻¹, 22.573784f0 km s⁻¹, 23.164637f0 km s⁻¹, 26.775894f0 km s⁻¹, 33.856136f0 km s⁻¹], Quantity{Float32, 𝐋 𝐓⁻¹, Unitful.FreeUnits{(km, s⁻¹), 𝐋 𝐓⁻¹, nothing}}[179.42912f0 km s⁻¹, 65.0223f0 km s⁻¹, 95.883736f0 km s⁻¹, 80.23359f0 km s⁻¹, 31.386843f0 km s⁻¹, 176.10416f0 km s⁻¹, 21.706324f0 km s⁻¹, 53.19559f0 km s⁻¹, 126.49119f0 km s⁻¹, 102.77765f0 km s⁻¹  …  42.916084f0 km s⁻¹, 72.56186f0 km s⁻¹, 39.36531f0 km s⁻¹, 40.899796f0 km s⁻¹, 34.341866f0 km s⁻¹, 35.257183f0 km s⁻¹, 31.910067f0 km s⁻¹, 45.77481f0 km s⁻¹, 69.921875f0 km s⁻¹, 93.31721f0 km s⁻¹])\n\n\n\n\n\n\n\nCode\nJ = begin\n    Vi = dis_bulkv_lmn\n    Ve = des_bulkv_lmn\n    n = dis_n\n    Ve_clip = tclip(Ve, Vi)\n    Vi_interp = tinterp(Vi, Ve_clip)\n    n_interp = tinterp(n, Ve_clip)\n    J = mapslices(Vi_interp - Ve_clip; dims=Ti) do V_diff_i\n        @. Unitful.q * V_diff_i * n_interp |&gt; u\"μA*m^-2\"\n    end\n    modify_meta(J, labels=[\"j_L\", \"j_M\", \"j_N\"])\nend\n\n\n\n┌ 3661×3 DimArray{Unitful.Quantity{Float64, 𝐈 𝐋⁻², Unitful.FreeUnits{(μA, m⁻²), 𝐈 𝐋⁻², nothing}}, 2} ┐\n├──────────────────────────────────────────────────────────────────────── dims ┤\n  ↓ Ti      Sampled{NanoDates.NanoDate} [2015-10-16T13:05:35.144103, …, 2015-10-16T13:07:24.945661] ForwardOrdered Irregular Points,\n  → AnonDim Sampled{Int64} [1, 2, 3] ForwardOrdered Irregular Points\n├──────────────────────────────────────────────────────────────────── metadata ┤\n  Dict{Any, Any} with 20 entries:\n  \"UNITS\"             =&gt; \"km/s\"\n  \"SCALETYP\"          =&gt; \"linear\"\n  \"FILLVAL\"           =&gt; Any[-1.0e31]\n  \"DEPEND_0\"          =&gt; \"Epoch\"\n  \"FIELDNAM\"          =&gt; \"MMS2 FPI/DIS LMN bulk v\"\n  \"SI_CONVERSION\"     =&gt; \"1.0e3&gt;m s^-1\"\n  \"VALIDMAX\"          =&gt; Any[110000.0]\n  \"LABL_PTR_1\"        =&gt; [\"Vx_LMN\", \"Vy_LMN\", \"Vz_LMN\"]\n  \"TENSOR_ORDER\"      =&gt; Any[1]\n  \"axes\"              =&gt; VariableAxis[Speasy.VariableAxis(time, Units: ns, Shap…\n  \"COORDINATE_SYSTEM\" =&gt; \"LMN\"\n  \"DELTA_MINUS_VAR\"   =&gt; \"mms2_dis_bulkv_err_brst\"\n  \"FORMAT\"            =&gt; \"E12.2\"\n  \"VAR_TYPE\"          =&gt; \"data\"\n  \"CATDESC\"           =&gt; \"MMS2 FPI/DIS ion bulk-velocity LMN vector during this…\n  :labels             =&gt; [\"j_L\", \"j_M\", \"j_N\"]\n  \"DELTA_PLUS_VAR\"    =&gt; \"mms2_dis_bulkv_err_brst\"\n  \"DISPLAY_TYPE\"      =&gt; \"time_series\"\n  \"VALIDMIN\"          =&gt; Any[-110000.0]\n  \"REPRESENTATION_1\"  =&gt; \"mms2_dis_cartrep_brst\"\n└──────────────────────────────────────────────────────────────────────────────┘\n ⋮      ⋱  \n\n\n\n\n\n\n\n\nCode\ndes_energyspectr_tvars = [\n    \"cda/MMS2_FPI_BRST_L2_DES-MOMS/mms$(probe)_des_energyspectr_par_$(data_rate)\",\n    \"cda/MMS2_FPI_BRST_L2_DES-MOMS/mms$(probe)_des_energyspectr_perp_$(data_rate)\",\n    \"cda/MMS2_FPI_BRST_L2_DES-MOMS/mms$(probe)_des_energyspectr_anti_$(data_rate)\"\n]\n\ndes_energyspectr = get_data(des_energyspectr_tvars, trange) .|&gt; DimArray\ndes_energyspectr = replace.(des_energyspectr, 0 =&gt; NaN)\ndes_energyspectr_ratio = des_energyspectr[1] ./ des_energyspectr[2]\ndes_energyspectr = modify_meta.(des_energyspectr, colorrange=(1e5, 1e9))\ndes_energyspectr_ratio = modify_meta(des_energyspectr_ratio,\n    colorrange=(1e-1, 1e1), title=\"Ratio (Para/Perp)\"\n)\n\n\n\n[ Info: Cannot parse unit \n[ Info: Cannot parse unit \n[ Info: Cannot parse unit \n\n\n\n\n\n┌ 3666×32 DimArray{Float64, 2} ┐\n├──────────────────────────────┴───────────────────────────────────────── dims ┐\n  ↓ Ti Sampled{NanoDates.NanoDate} [2015-10-16T13:05:35.024103, …, 2015-10-16T13:07:24.975661] ForwardOrdered Irregular Points,\n  → Y  Sampled{Int64} 1:32 ForwardOrdered Regular Points\n├──────────────────────────────────────────────────────────────────── metadata ┤\n  Dict{Any, Any} with 19 entries:\n  \"VAR_NOTES\"    =&gt; \"Counts, summed within 30 degrees parallel bentPipe magneti…\n  \"SCALETYP\"     =&gt; \"log\"\n  \"FILLVAL\"      =&gt; Any[-1.0e31]\n  \"DEPEND_0\"     =&gt; \"Epoch\"\n  \"FIELDNAM\"     =&gt; \"MMS2 FPI/DES energySpectr_par\"\n  \"VALIDMAX\"     =&gt; Any[1.0e30]\n  \"axes\"         =&gt; VariableAxis[Speasy.VariableAxis(time, Units: ns, Shape: (3…\n  :colorrange    =&gt; (0.1, 10.0)\n  \"DEPEND_1\"     =&gt; \"mms2_des_energy_brst\"\n  :yscale        =&gt; \"log\"\n  \"FORMAT\"       =&gt; \"E12.2\"\n  :ylabel        =&gt; \"energy\"\n  \"VAR_TYPE\"     =&gt; \"data\"\n  \"CATDESC\"      =&gt; \"MMS2 FPI/DES electron energy parallel spectrum 30 degrees …\n  \"LABLAXIS\"     =&gt; \"FPI1/DES EnSpectr, Parallel\"\n  :title         =&gt; \"Ratio (Para/Perp)\"\n  \"DISPLAY_TYPE\" =&gt; \"spectrogram\"\n  \"VALIDMIN\"     =&gt; Any[-1.0e30]\n  :yunit         =&gt; \"eV\"\n└──────────────────────────────────────────────────────────────────────────────┘\n ⋮      ⋱  \n\n\n\n\n\n\n\nIn 1 paragraph (10 lines) explain what each panel represents for this reconnection interval.\n\nFrom top to bottom, the panels represent the following:\n1. the magnetic field vectors in LMN coordinate system;\n2. energy times spectrogram of ion energy flux;\n3. energy times spectrogram of electron energy flux;\n4. plasma density (ion and electron);\n5. ion flow velocity vectors in LMN coordinate system;\n6. magnitudes of electron and ion convection velocities;\n7. current density;\n8. electron parallel and perpendicular temperatures;\n9. electric field vectors in LMN coordinate system;\n10-12. electron spectrograms (parallel, perpendicular, anti-parallel);\n13. electron spectrogram ratio (para/perp).\n\n\nCode\ntvars2plot = [\n    B_LMN,\n    [dis_n, des_n],\n    dis_data.energyspectr_omni,\n    des_data.energyspectr_omni,\n    dis_bulkv_lmn,\n    [Vi_perp_mag, Ve_perp_mag],\n    E_LMN,\n    des_energyspectr...,\n    des_energyspectr_ratio\n]\nfaxes = tplot(tvars2plot)\ntlines!(faxes, \"2015-10-16T13:05:52\")\ntlines!(faxes, [\"2015-10-16T13:05:44\", \"2015-10-16T13:06:00\"])\ntlines!(faxes, [\"2015-10-16T13:06:46\", \"2015-10-16T13:07:12\"])\nylims!.(faxes.axes[end-3:end], 1e1, 1e3)\nfaxes\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nExplain in 1 paragraph what the perpendicular electrons show.\n\nZoom in on the electron spectrograms\n\n\nCode\ntBurchFig4 = (\"2015-10-16T13:07:00.5\", \"2015-10-16T13:07:03.5\")\ntlims!(tBurchFig4)\n\n\n\n\n\n\n\n\n\nThe electron flow speed perpendicular to the magnetic field significantly exceeds the ion flow speed in the vicinity of the X-line, leading to a much stronger current near the X-line compared to the exhaust region. In contrast, the current closely follows the perpendicular ion speed within the magnetosheath and exhaust regions.\nFurthermore, as illustrated in the figure below, reconnection dissipation is driven by the intense negative \\(J_M\\) current and negative \\(E_M\\) electric field, both perpendicular to the magnetic field \\(B\\) in the dissipation region. This condition preferentially accelerates electrons in the perpendicular direction, thereby reducing the ratio of electron parallel-to-perpendicular temperature. This effect is clearly demonstrated in the bottom panel of the figure above (compared to the magnetosheath and exhaust regions)\n\n\n\n\n\nCode\nB_interp = tinterp(B_LMN, J)\nE_LMN_interp = tinterp(E_LMN, J)\nJ_dot_E = tdot(J, E_LMN_interp) |&gt; modify_meta(label=\"j ⋅ E\")\nE_parp = tsproj(E_LMN_interp, B_interp) |&gt; modify_meta(label=\"E∥\")\nJ_parp = tsproj(J, B_interp)\nJ_dot_E_para = tdot(J_parp, E_parp) |&gt; modify_meta(label=\"j∥ ⋅ E∥\")\nJ_dot_E_perp = tdot(toproj(J, B_interp), toproj(E_LMN_interp, B_interp)) |&gt; modify_meta(label=\"j⊥ ⋅ E⊥\")\n\n\n\n┌ 3661-element DimArray{Unitful.Quantity{Float64, 𝐌 𝐋⁻¹ 𝐓⁻³, Unitful.FreeUnits{(μA, m⁻³, mV), 𝐌 𝐋⁻¹ 𝐓⁻³, nothing}}, 1} ┐\n├──────────────────────────────────────────────────────────────────────── dims ┤\n  ↓ Ti Sampled{NanoDates.NanoDate} [2015-10-16T13:05:35.144103, …, 2015-10-16T13:07:24.945661] ForwardOrdered Irregular Points\n├──────────────────────────────────────────────────────────────────── metadata ┤\n  Dict{Any, Any} with 1 entry:\n  :label =&gt; \"j⊥ ⋅ E⊥\"\n└──────────────────────────────────────────────────────────────────────────────┘\n 2015-10-16T13:05:35.144103  -0.0151287 μA mV m⁻³\n 2015-10-16T13:05:35.174103  -0.00870461 μA mV m⁻³\n 2015-10-16T13:05:35.204103   0.0100068 μA mV m⁻³\n 2015-10-16T13:05:35.234103  -0.0133396 μA mV m⁻³\n ⋮                           \n 2015-10-16T13:07:24.885661   0.00910274 μA mV m⁻³\n 2015-10-16T13:07:24.915661   0.0203747 μA mV m⁻³\n 2015-10-16T13:07:24.945661   0.0440117 μA mV m⁻³\n\n\n\nJ · E is the total energy transfer (energy conversion) rate, which is a key quantity in reconnection studies. Since reconnection is known to be a dissipative process that converts magnetic energy to heat and particle kinetic energy, the dissipation quantity could help identify a physically relevant, small-scale region surrounding the reconnection.\n\n\nCode\ntvars2plot = [\n    B_interp,\n    J,\n    E_LMN,\n    E_parp,\n    [J_dot_E, J_dot_E_para, J_dot_E_perp],\n]\nfaxes = tplot(tvars2plot)\ntlines!(faxes, \"2015-10-16T13:05:52\")\ntlines!(faxes, [\"2015-10-16T13:05:44\", \"2015-10-16T13:06:00\"])\ntlines!(faxes, [\"2015-10-16T13:06:46\", \"2015-10-16T13:07:12\"])\nfaxes\n\n\n\n\n\n\n\n\n\nZoom-in on the dissipation region\n\n\nCode\ntlims!(tBurchFig4)",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "EPSS 261 Homework",
      "Problem Set 6"
    ]
  },
  {
    "objectID": "docs/courses/epss261/homework/ps6.html#mms-science-event-magnetopause-reconnection-at-the-electron-diffusion-region",
    "href": "docs/courses/epss261/homework/ps6.html#mms-science-event-magnetopause-reconnection-at-the-electron-diffusion-region",
    "title": "Problem Set 6",
    "section": "",
    "text": "Obtain and analyze plasma data, including spectra, for the first MMS Science event (Burch et al., Science 2016, link here) showing magnetopause reconnection at the electron diffusion region on 2016/10/16 13:07:02.2 UT. Start by using Hwk06_mpause_RX.pro, provided. The objective of this exercise is to introduce plasma distributions from MMS (electrons and ions) and create burst spectra. In the process also create plasma moments and the plasma current and plot these along E and B. You are requested to create Figure 2 of Burch et al. plus the 3 bottom (electron) spectrograms from Figure 3 of the same paper (panels 3G, 3H and 3I). Your figure should look like the one shown on the next page, but using burst mode data in order to make it look like in Burch et al. You are requested to plot this figure at 2 time scales: the overview (2 min) timescale as in Fig. 2 of Burch et al. [‘13:05:30’,’13:07:30’] and the zoom-in (3 sec) timescale as in Fig. 3 of Burch et al. [‘13:07:00.5’,‘13:07:03.5’]. Notice that the clean and fast m’pause crossing was at 13:05:40UT, and this is used to determine N. In Fig. 2K of Burch et al. (the right-hand side of Fig. 2, the pictorial view of the MMS trajectory for the 2min interval) this initial m’pause crossing was near the start of the trajectory. The trajectory crosses the X-point at the 3 seconds of the zoom-in interval.\n\n\n\nCode\nusing Speasy\nusing DimensionalData\nusing SPEDAS\nusing SPEDAS.MMS\nusing SPEDAS: dimarrayify\n# using GLMakie\nusing Unitful\nusing CairoMakie\n\nupdate_theme!(colormap=:rainbow1)\nSPEDAS.DEFAULTS.add_title = true;\n\n\n\n\n\n\n\n\nCode\ntrange = (\"2015-10-16T13:05:35\", \"2015-10-16T13:07:25\")\ntr_mpause = (\"2015-10-16T13:05:40\", \"2015-10-16T13:06:09\")\n\nprobe = 2\n\ntvars = [\n    \"cda/MMS2_FGM_SRVY_L2/mms2_fgm_b_gse_srvy_l2_clean\",\n    \"cda/MMS2_EDP_FAST_L2_DCE/mms2_edp_dce_gse_fast_l2\",\n]\nB_gse, edp_dce_gse = get_data(tvars, trange) .|&gt; DimArray\nrotMat = mva_mat(tclip(B_gse[:, 1:3], tr_mpause))\nB_LMN = rotate(B_gse[:, 1:3], rotMat) |&gt; set_coord(\"LMN\") |&gt; set_coord(\"Boundary-normal coordinates\"; old_coords=[\"Geocentric Solar Ecliptic\"])\nE_LMN = rotate(edp_dce_gse, rotMat) |&gt; set_coord(\"LMN\")\n\nrotMat\n\n\nCan't get MMS2_FGM_SRVY_L2/mms2_fgm_b_gse_srvy_l2_clean without web service, switching to web service\n\n\nLinearAlgebra.Eigen{Float32, Quantity{Float32, 𝐌² 𝐈⁻² 𝐓⁻⁴, Unitful.FreeUnits{(nT²,), 𝐌² 𝐈⁻² 𝐓⁻⁴, nothing}}, Matrix{Float32}, Vector{Quantity{Float32, 𝐌² 𝐈⁻² 𝐓⁻⁴, Unitful.FreeUnits{(nT²,), 𝐌² 𝐈⁻² 𝐓⁻⁴, nothing}}}}\nvalues:\n3-element Vector{Quantity{Float32, 𝐌² 𝐈⁻² 𝐓⁻⁴, Unitful.FreeUnits{(nT²,), 𝐌² 𝐈⁻² 𝐓⁻⁴, nothing}}}:\n 501.50833f0 nT²\n  32.28409f0 nT²\n  13.2533245f0 nT²\nvectors:\n3×3 Matrix{Float32}:\n  0.368873   0.571604   0.73294\n -0.122903  -0.75163    0.648034\n  0.921318  -0.329122  -0.207004\n\n\nThe direction obtained from the Minimum Variance Analysis (MVA) in our study closely aligns with the direction reported in the literature.\n\nThe (x, y, z) GSE components of the L, M, and N axes are L = (0.3665, –0.1201, 0.9226) GSE, M = (0.5694, –0.7553, –0.3245) GSE, and N = (0.7358, 0.6443, –0.2084) GSE\n\n\n\n\n\n\nCode\ndata_rate = \"brst\"\nfpi_des_ds = FPIDataSet(; probe, data_rate, data_type=\"des\")\nfpi_dis_ds = FPIDataSet(; probe, data_rate, data_type=\"dis\")\n\ndes_data = get_data(NamedTuple, fpi_des_ds, trange) |&gt; dimarrayify\ndis_data = get_data(NamedTuple, fpi_dis_ds, trange) |&gt; dimarrayify\n\ndes_n = modify_meta(des_data.numberdensity[:, 1], label=\"Ne\")\ndis_bulkv_lmn = rotate(dis_data.bulkv_gse, rotMat) |&gt; set_coord(\"LMN\")\ndes_bulkv_lmn = rotate(des_data.bulkv_gse, rotMat) |&gt; set_coord(\"LMN\")\ndis_n = modify_meta(dis_data.numberdensity[:, 1], label=\"Ni\")\n\n\n\n┌ 733-element DimArray{Unitful.Quantity{Float32, 𝐋⁻³, Unitful.FreeUnits{(cm⁻³,), 𝐋⁻³, nothing}}, 1} mms2_dis_numberdensity_brst ┐\n├──────────────────────────────────────────────────────────────────────── dims ┤\n  ↓ Ti Sampled{NanoDates.NanoDate} [2015-10-16T13:05:35.144103, …, 2015-10-16T13:07:24.945661] ForwardOrdered Irregular Points\n├──────────────────────────────────────────────────────────────────── metadata ┤\n  Dict{Any, Any} with 17 entries:\n  \"SCALETYP\"        =&gt; \"linear\"\n  \"FILLVAL\"         =&gt; Any[-1.0e31]\n  \"DEPEND_0\"        =&gt; \"Epoch\"\n  \"FIELDNAM\"        =&gt; \"MMS2 FPI/DIS number density\"\n  \"SI_CONVERSION\"   =&gt; \"1e6&gt;m^-3\"\n  \"VALIDMAX\"        =&gt; Any[100000.0]\n  \"axes\"            =&gt; VariableAxis[Speasy.VariableAxis(time, Units: ns, Shape:…\n  :label            =&gt; \"Ni\"\n  \"DELTA_MINUS_VAR\" =&gt; \"mms2_dis_numberdensity_err_brst\"\n  \"FORMAT\"          =&gt; \"E12.2\"\n  \"VAR_TYPE\"        =&gt; \"data\"\n  \"CATDESC\"         =&gt; \"MMS2 FPI/DIS ion number density during this burst\"\n  \"LABLAXIS\"        =&gt; \"N\"\n  \"DELTA_PLUS_VAR\"  =&gt; \"mms2_dis_numberdensity_err_brst\"\n  \"DISPLAY_TYPE\"    =&gt; \"time_series\"\n  \"VALIDMIN\"        =&gt; Any[0.001]\n  \"UNITS\"           =&gt; \"cm^-3\"\n└──────────────────────────────────────────────────────────────────────────────┘\n ⋮      ⋱  \n\n\n\n\n\n\n\n\nCode\nVi_perp_mag, Ve_perp_mag = let Vi = dis_data.bulkv_gse, Ve = des_data.bulkv_gse, B = B_gse\n    Vi_clip = tclip(Vi, B)\n    Ve_clip = tclip(Ve, B)\n\n    B_int_Vi = tinterp(B, Vi_clip)[:, 1:3]\n    B_int_Ve = tinterp(B, Ve_clip)[:, 1:3]\n    Vi_perp_mag = toproj(Vi_clip, B_int_Vi) |&gt; tnorm\n    Ve_perp_mag = toproj(Ve_clip, B_int_Ve) |&gt; tnorm\n\n    modify_meta(Vi_perp_mag, ylabel=\"Viper_t\"),\n    modify_meta(Ve_perp_mag, ylabel=\"Veper_t\")\nend\n\n\n(Quantity{Float32, 𝐋 𝐓⁻¹, Unitful.FreeUnits{(km, s⁻¹), 𝐋 𝐓⁻¹, nothing}}[16.370079f0 km s⁻¹, 39.085266f0 km s⁻¹, 18.779638f0 km s⁻¹, 36.385616f0 km s⁻¹, 28.834595f0 km s⁻¹, 31.232655f0 km s⁻¹, 21.860336f0 km s⁻¹, 25.042305f0 km s⁻¹, 19.904325f0 km s⁻¹, 3.4641075f0 km s⁻¹  …  54.85829f0 km s⁻¹, 52.70736f0 km s⁻¹, 43.587467f0 km s⁻¹, 37.50158f0 km s⁻¹, 32.17601f0 km s⁻¹, 29.35025f0 km s⁻¹, 22.573784f0 km s⁻¹, 23.164637f0 km s⁻¹, 26.775894f0 km s⁻¹, 33.856136f0 km s⁻¹], Quantity{Float32, 𝐋 𝐓⁻¹, Unitful.FreeUnits{(km, s⁻¹), 𝐋 𝐓⁻¹, nothing}}[179.42912f0 km s⁻¹, 65.0223f0 km s⁻¹, 95.883736f0 km s⁻¹, 80.23359f0 km s⁻¹, 31.386843f0 km s⁻¹, 176.10416f0 km s⁻¹, 21.706324f0 km s⁻¹, 53.19559f0 km s⁻¹, 126.49119f0 km s⁻¹, 102.77765f0 km s⁻¹  …  42.916084f0 km s⁻¹, 72.56186f0 km s⁻¹, 39.36531f0 km s⁻¹, 40.899796f0 km s⁻¹, 34.341866f0 km s⁻¹, 35.257183f0 km s⁻¹, 31.910067f0 km s⁻¹, 45.77481f0 km s⁻¹, 69.921875f0 km s⁻¹, 93.31721f0 km s⁻¹])\n\n\n\n\n\n\n\nCode\nJ = begin\n    Vi = dis_bulkv_lmn\n    Ve = des_bulkv_lmn\n    n = dis_n\n    Ve_clip = tclip(Ve, Vi)\n    Vi_interp = tinterp(Vi, Ve_clip)\n    n_interp = tinterp(n, Ve_clip)\n    J = mapslices(Vi_interp - Ve_clip; dims=Ti) do V_diff_i\n        @. Unitful.q * V_diff_i * n_interp |&gt; u\"μA*m^-2\"\n    end\n    modify_meta(J, labels=[\"j_L\", \"j_M\", \"j_N\"])\nend\n\n\n\n┌ 3661×3 DimArray{Unitful.Quantity{Float64, 𝐈 𝐋⁻², Unitful.FreeUnits{(μA, m⁻²), 𝐈 𝐋⁻², nothing}}, 2} ┐\n├──────────────────────────────────────────────────────────────────────── dims ┤\n  ↓ Ti      Sampled{NanoDates.NanoDate} [2015-10-16T13:05:35.144103, …, 2015-10-16T13:07:24.945661] ForwardOrdered Irregular Points,\n  → AnonDim Sampled{Int64} [1, 2, 3] ForwardOrdered Irregular Points\n├──────────────────────────────────────────────────────────────────── metadata ┤\n  Dict{Any, Any} with 20 entries:\n  \"UNITS\"             =&gt; \"km/s\"\n  \"SCALETYP\"          =&gt; \"linear\"\n  \"FILLVAL\"           =&gt; Any[-1.0e31]\n  \"DEPEND_0\"          =&gt; \"Epoch\"\n  \"FIELDNAM\"          =&gt; \"MMS2 FPI/DIS LMN bulk v\"\n  \"SI_CONVERSION\"     =&gt; \"1.0e3&gt;m s^-1\"\n  \"VALIDMAX\"          =&gt; Any[110000.0]\n  \"LABL_PTR_1\"        =&gt; [\"Vx_LMN\", \"Vy_LMN\", \"Vz_LMN\"]\n  \"TENSOR_ORDER\"      =&gt; Any[1]\n  \"axes\"              =&gt; VariableAxis[Speasy.VariableAxis(time, Units: ns, Shap…\n  \"COORDINATE_SYSTEM\" =&gt; \"LMN\"\n  \"DELTA_MINUS_VAR\"   =&gt; \"mms2_dis_bulkv_err_brst\"\n  \"FORMAT\"            =&gt; \"E12.2\"\n  \"VAR_TYPE\"          =&gt; \"data\"\n  \"CATDESC\"           =&gt; \"MMS2 FPI/DIS ion bulk-velocity LMN vector during this…\n  :labels             =&gt; [\"j_L\", \"j_M\", \"j_N\"]\n  \"DELTA_PLUS_VAR\"    =&gt; \"mms2_dis_bulkv_err_brst\"\n  \"DISPLAY_TYPE\"      =&gt; \"time_series\"\n  \"VALIDMIN\"          =&gt; Any[-110000.0]\n  \"REPRESENTATION_1\"  =&gt; \"mms2_dis_cartrep_brst\"\n└──────────────────────────────────────────────────────────────────────────────┘\n ⋮      ⋱  \n\n\n\n\n\n\n\n\nCode\ndes_energyspectr_tvars = [\n    \"cda/MMS2_FPI_BRST_L2_DES-MOMS/mms$(probe)_des_energyspectr_par_$(data_rate)\",\n    \"cda/MMS2_FPI_BRST_L2_DES-MOMS/mms$(probe)_des_energyspectr_perp_$(data_rate)\",\n    \"cda/MMS2_FPI_BRST_L2_DES-MOMS/mms$(probe)_des_energyspectr_anti_$(data_rate)\"\n]\n\ndes_energyspectr = get_data(des_energyspectr_tvars, trange) .|&gt; DimArray\ndes_energyspectr = replace.(des_energyspectr, 0 =&gt; NaN)\ndes_energyspectr_ratio = des_energyspectr[1] ./ des_energyspectr[2]\ndes_energyspectr = modify_meta.(des_energyspectr, colorrange=(1e5, 1e9))\ndes_energyspectr_ratio = modify_meta(des_energyspectr_ratio,\n    colorrange=(1e-1, 1e1), title=\"Ratio (Para/Perp)\"\n)\n\n\n\n[ Info: Cannot parse unit \n[ Info: Cannot parse unit \n[ Info: Cannot parse unit \n\n\n\n\n\n┌ 3666×32 DimArray{Float64, 2} ┐\n├──────────────────────────────┴───────────────────────────────────────── dims ┐\n  ↓ Ti Sampled{NanoDates.NanoDate} [2015-10-16T13:05:35.024103, …, 2015-10-16T13:07:24.975661] ForwardOrdered Irregular Points,\n  → Y  Sampled{Int64} 1:32 ForwardOrdered Regular Points\n├──────────────────────────────────────────────────────────────────── metadata ┤\n  Dict{Any, Any} with 19 entries:\n  \"VAR_NOTES\"    =&gt; \"Counts, summed within 30 degrees parallel bentPipe magneti…\n  \"SCALETYP\"     =&gt; \"log\"\n  \"FILLVAL\"      =&gt; Any[-1.0e31]\n  \"DEPEND_0\"     =&gt; \"Epoch\"\n  \"FIELDNAM\"     =&gt; \"MMS2 FPI/DES energySpectr_par\"\n  \"VALIDMAX\"     =&gt; Any[1.0e30]\n  \"axes\"         =&gt; VariableAxis[Speasy.VariableAxis(time, Units: ns, Shape: (3…\n  :colorrange    =&gt; (0.1, 10.0)\n  \"DEPEND_1\"     =&gt; \"mms2_des_energy_brst\"\n  :yscale        =&gt; \"log\"\n  \"FORMAT\"       =&gt; \"E12.2\"\n  :ylabel        =&gt; \"energy\"\n  \"VAR_TYPE\"     =&gt; \"data\"\n  \"CATDESC\"      =&gt; \"MMS2 FPI/DES electron energy parallel spectrum 30 degrees …\n  \"LABLAXIS\"     =&gt; \"FPI1/DES EnSpectr, Parallel\"\n  :title         =&gt; \"Ratio (Para/Perp)\"\n  \"DISPLAY_TYPE\" =&gt; \"spectrogram\"\n  \"VALIDMIN\"     =&gt; Any[-1.0e30]\n  :yunit         =&gt; \"eV\"\n└──────────────────────────────────────────────────────────────────────────────┘\n ⋮      ⋱  \n\n\n\n\n\n\n\nIn 1 paragraph (10 lines) explain what each panel represents for this reconnection interval.\n\nFrom top to bottom, the panels represent the following:\n1. the magnetic field vectors in LMN coordinate system;\n2. energy times spectrogram of ion energy flux;\n3. energy times spectrogram of electron energy flux;\n4. plasma density (ion and electron);\n5. ion flow velocity vectors in LMN coordinate system;\n6. magnitudes of electron and ion convection velocities;\n7. current density;\n8. electron parallel and perpendicular temperatures;\n9. electric field vectors in LMN coordinate system;\n10-12. electron spectrograms (parallel, perpendicular, anti-parallel);\n13. electron spectrogram ratio (para/perp).\n\n\nCode\ntvars2plot = [\n    B_LMN,\n    [dis_n, des_n],\n    dis_data.energyspectr_omni,\n    des_data.energyspectr_omni,\n    dis_bulkv_lmn,\n    [Vi_perp_mag, Ve_perp_mag],\n    E_LMN,\n    des_energyspectr...,\n    des_energyspectr_ratio\n]\nfaxes = tplot(tvars2plot)\ntlines!(faxes, \"2015-10-16T13:05:52\")\ntlines!(faxes, [\"2015-10-16T13:05:44\", \"2015-10-16T13:06:00\"])\ntlines!(faxes, [\"2015-10-16T13:06:46\", \"2015-10-16T13:07:12\"])\nylims!.(faxes.axes[end-3:end], 1e1, 1e3)\nfaxes\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nExplain in 1 paragraph what the perpendicular electrons show.\n\nZoom in on the electron spectrograms\n\n\nCode\ntBurchFig4 = (\"2015-10-16T13:07:00.5\", \"2015-10-16T13:07:03.5\")\ntlims!(tBurchFig4)\n\n\n\n\n\n\n\n\n\nThe electron flow speed perpendicular to the magnetic field significantly exceeds the ion flow speed in the vicinity of the X-line, leading to a much stronger current near the X-line compared to the exhaust region. In contrast, the current closely follows the perpendicular ion speed within the magnetosheath and exhaust regions.\nFurthermore, as illustrated in the figure below, reconnection dissipation is driven by the intense negative \\(J_M\\) current and negative \\(E_M\\) electric field, both perpendicular to the magnetic field \\(B\\) in the dissipation region. This condition preferentially accelerates electrons in the perpendicular direction, thereby reducing the ratio of electron parallel-to-perpendicular temperature. This effect is clearly demonstrated in the bottom panel of the figure above (compared to the magnetosheath and exhaust regions)\n\n\n\n\n\nCode\nB_interp = tinterp(B_LMN, J)\nE_LMN_interp = tinterp(E_LMN, J)\nJ_dot_E = tdot(J, E_LMN_interp) |&gt; modify_meta(label=\"j ⋅ E\")\nE_parp = tsproj(E_LMN_interp, B_interp) |&gt; modify_meta(label=\"E∥\")\nJ_parp = tsproj(J, B_interp)\nJ_dot_E_para = tdot(J_parp, E_parp) |&gt; modify_meta(label=\"j∥ ⋅ E∥\")\nJ_dot_E_perp = tdot(toproj(J, B_interp), toproj(E_LMN_interp, B_interp)) |&gt; modify_meta(label=\"j⊥ ⋅ E⊥\")\n\n\n\n┌ 3661-element DimArray{Unitful.Quantity{Float64, 𝐌 𝐋⁻¹ 𝐓⁻³, Unitful.FreeUnits{(μA, m⁻³, mV), 𝐌 𝐋⁻¹ 𝐓⁻³, nothing}}, 1} ┐\n├──────────────────────────────────────────────────────────────────────── dims ┤\n  ↓ Ti Sampled{NanoDates.NanoDate} [2015-10-16T13:05:35.144103, …, 2015-10-16T13:07:24.945661] ForwardOrdered Irregular Points\n├──────────────────────────────────────────────────────────────────── metadata ┤\n  Dict{Any, Any} with 1 entry:\n  :label =&gt; \"j⊥ ⋅ E⊥\"\n└──────────────────────────────────────────────────────────────────────────────┘\n 2015-10-16T13:05:35.144103  -0.0151287 μA mV m⁻³\n 2015-10-16T13:05:35.174103  -0.00870461 μA mV m⁻³\n 2015-10-16T13:05:35.204103   0.0100068 μA mV m⁻³\n 2015-10-16T13:05:35.234103  -0.0133396 μA mV m⁻³\n ⋮                           \n 2015-10-16T13:07:24.885661   0.00910274 μA mV m⁻³\n 2015-10-16T13:07:24.915661   0.0203747 μA mV m⁻³\n 2015-10-16T13:07:24.945661   0.0440117 μA mV m⁻³\n\n\n\nJ · E is the total energy transfer (energy conversion) rate, which is a key quantity in reconnection studies. Since reconnection is known to be a dissipative process that converts magnetic energy to heat and particle kinetic energy, the dissipation quantity could help identify a physically relevant, small-scale region surrounding the reconnection.\n\n\nCode\ntvars2plot = [\n    B_interp,\n    J,\n    E_LMN,\n    E_parp,\n    [J_dot_E, J_dot_E_para, J_dot_E_perp],\n]\nfaxes = tplot(tvars2plot)\ntlines!(faxes, \"2015-10-16T13:05:52\")\ntlines!(faxes, [\"2015-10-16T13:05:44\", \"2015-10-16T13:06:00\"])\ntlines!(faxes, [\"2015-10-16T13:06:46\", \"2015-10-16T13:07:12\"])\nfaxes\n\n\n\n\n\n\n\n\n\nZoom-in on the dissipation region\n\n\nCode\ntlims!(tBurchFig4)",
    "crumbs": [
      "Courses",
      "EPSS 261",
      "EPSS 261 Homework",
      "Problem Set 6"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/index.html",
    "href": "docs/courses/epss298_MHD_turbulence/index.html",
    "title": "EPSS 298",
    "section": "",
    "text": "This is an advanced course for graduate students already familiar with space and plasma physics. It is intended for students who have taken an introductory plasma course and have a good background in classical mechanics and electrodynamics.\nTextbooks:\n\nBiskamp, MHD Turbulence;\nLandau Lifschitz Vol. 6; Landau Lifschitz Vol 8;\nBiskamp, Magnetic reconnection;\nSchnack, Lectures in Magnetohydrodynamics;\nFrisch, Turbulence, the legacy of A. N. Komogorov.\n\nAnd some of the original papers on MHD and resistive MHD stability that we will distribute in class.\nApplications will be discussed throughout the course (mainly the Sun, Solar corona, Solar and stellar winds, the Earth’s magnetosphere and some astrophysical applications).\nGrading will be based on weekly/biweekly HW assignments and a final presentation on contemporary research.\nTopics (details to be adapted according to the audience):\n\nHydrodynamics; Invariants in Hydrodynamics;\nMagnetohydrodynamics (MHD); Invariants in ideal MHD;\nHydrodynamic and MHD Stability (energy principle and instabilities in ideal and resistive MHD);\nMagnetic reconnection; Resistive instabilities;\nTransition to turbulence in hydrodynamics;\nExperimental laws of fully developed turbulence;\nThe Kolmogorov 1941 theory; Intermittency;\nMHD Turbulence; Isotropy, anisotropy, and weak vs strong MHD turbulence;\nMagnetic field generation and self-organization;\nMHD turbulence and reconnection in the solar wind;\nReconnection observations and theoretical advances in magnetospheric dynamics;\nDissipation range of MHD turbulence: kinetic scales and particle heating and acceleration.\n\n\\[\n\\frac{\\partial z^{\\pm}}{\\partial t}+z^{\\mp} \\cdot \\nabla z^{\\pm}=-\\nabla P\n\\]",
    "crumbs": [
      "Courses",
      "EPSS 298"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/pre.html#eddy-scales",
    "href": "docs/courses/epss298_MHD_turbulence/pre.html#eddy-scales",
    "title": "Role of Magnetic Reconnection (Tearing Instability) in Magnetohydrodynamic Turbulence",
    "section": "Eddy scales",
    "text": "Eddy scales\n\n\\[\n\\begin{aligned}\n\\xi & \\sim L(\\lambda / L)^{3 / 4}, \\\\\n\\ell & \\sim L(\\lambda / L)^{1 / 2}, \\\\\nb_\\lambda & \\sim B_0(\\lambda / L)^{1 / 4}, \\\\\nv_\\lambda & \\sim V_0(\\lambda / L)^{1 / 4}, \\\\\n\\tau & \\sim \\ell / V_{A, 0} \\sim \\lambda^{1 / 2} L^{1 / 2} / V_{A, 0}, \\\\\nV_{A, \\lambda} & \\sim V_{A, 0}(\\lambda / L)^{1 / 4},\n\\end{aligned}\n\\]\nAspect ratio of an eddy in the perpendicular direction increases as \\(λ → 0\\).\n\\[\nξ/λ ∼ (L/λ)^{1/4}\n\\]\nIn the perpendicular plane, eddies become ever more elongated current sheets as λ gets smaller.\n\nTurbulent motions generate sheared magnetic structures where magnetic reconnection sets in, which, in turn, modifies turbulent fluctuations at the corresponding scales.\nA particularly interesting feature of 3D anisotropic eddies is that they can be thought of as current sheets of thickness λ and length ξ in the field-perpendicular plane (with ξ ≫ λ)… The anisotropic, current-sheet-like eddies become the sites of magnetic reconnection before the formal Kolmogorov dissipation scale is reached.\n\nAt what scale (i.e., aspect ratio) does reconnection of these current sheets (eddies) become an important effect?\nWhat would be the rate of a linear tearing instability triggered by its magnetic profile?",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Role of Magnetic Reconnection (Tearing Instability) in Magnetohydrodynamic Turbulence"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/pre.html#upper-limit-of-critical-current-sheets-dissipation",
    "href": "docs/courses/epss298_MHD_turbulence/pre.html#upper-limit-of-critical-current-sheets-dissipation",
    "title": "Role of Magnetic Reconnection (Tearing Instability) in Magnetohydrodynamic Turbulence",
    "section": "Upper limit of critical current sheets (dissipation)",
    "text": "Upper limit of critical current sheets (dissipation)\n\nWe first note that we expect such plasmoids of many different sizes to be separated from each other by Sweet-Parker current sheets of a length, \\(L_c\\), such that their aspect ratio is marginally stable to plasmoid formation, \\(\\sim S_c^{1 / 2}[49]\\), where \\(S_c=L_c V_{A, \\lambda_{c r}^{\\text {Coppi }}} / \\eta\\) is the critical Lundquist number, \\(S_c \\sim 10^4\\).\n\n\nCurrent sheets longer than \\(L_c\\) are unstable to plasmoid formation; if, on the other hand, they are shorter than \\(L_c\\), they will be stretched to that length by differential background flows.\n\nThe thickness of these critical current sheets is estimated as:\n\\[\n\\delta_c \\sim L_c S_c^{-1 / 2} \\sim \\lambda_{c r}^{\\mathrm{Coppi}} S_{\\lambda_{c r}^{\\mathrm{Coppi}}}^{-1} S_c^{1 / 2}\n\\]\nwhere \\(S_{\\lambda_{c r}^{\\mathrm{Coppi}}}=\\lambda_{c r}^{\\mathrm{Coppi}} V_{A, \\lambda_{c r}^{\\mathrm{Coppi}}} / \\eta\\). We thus obtain\n\\[\n\\delta_c / L \\sim S_c^{1 / 2} S_L^{-6 / 7}\n\\]",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Role of Magnetic Reconnection (Tearing Instability) in Magnetohydrodynamic Turbulence"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/pre.html#tearing-instability-fkr-regime",
    "href": "docs/courses/epss298_MHD_turbulence/pre.html#tearing-instability-fkr-regime",
    "title": "Role of Magnetic Reconnection (Tearing Instability) in Magnetohydrodynamic Turbulence",
    "section": "Tearing instability (FKR regime)",
    "text": "Tearing instability (FKR regime)\nFor the \\(N=1\\) mode, the growth rate is\n\\[\nγ_1^{\\mathrm{FKR}} \\sim \\xi^{2 / 5} V_{A, \\lambda}^{2 / 5} \\lambda^{-2} \\eta^{3 / 5}\n\\]\nThe equation \\(γ_1^{\\mathrm{FKR}} \\tau \\sim 1\\) therefore yields\n\\[\n\\lambda_{c r, 1} / L \\sim S_L^{-6 / 11}\n\\]\nWe see that \\(\\lambda_{c r, 1}&lt;\\lambda_{t r, 1}\\), implying that the modes that will become critical are not FKR modes, but rather Coppi modes.",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Role of Magnetic Reconnection (Tearing Instability) in Magnetohydrodynamic Turbulence"
    ]
  },
  {
    "objectID": "docs/courses/epss298_MHD_turbulence/pre.html#tearing-instability-coppi-regime",
    "href": "docs/courses/epss298_MHD_turbulence/pre.html#tearing-instability-coppi-regime",
    "title": "Role of Magnetic Reconnection (Tearing Instability) in Magnetohydrodynamic Turbulence",
    "section": "Tearing instability (Coppi regime)",
    "text": "Tearing instability (Coppi regime)\nThe largest growth rate is\n\\[\nγ_{\\max }^{\\mathrm{Coppi}} \\sim \\tau_{A, \\lambda}^{-1} S_\\lambda^{-1 / 2}\n\\]\nwhere \\(\\tau_{A, \\lambda} \\equiv \\lambda / V_{A, \\lambda}\\), corresponding to a mode number \\(N_{\\text {max }}^{\\text {Coppi }} \\sim \\xi / \\lambda S_\\lambda^{-1 / 4}\\).\nThe criticality condition now yields\n\\[\n\\lambda_{c r}^{\\mathrm{Coppi}} / L \\sim S_L^{-4 / 7}\n\\]\n\nAs the scale \\(\\lambda\\) decreases, the rate of the corresponding tearing instability increases faster than the eddy turnover rate.",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Role of Magnetic Reconnection (Tearing Instability) in Magnetohydrodynamic Turbulence"
    ]
  },
  {
    "objectID": "docs/research/index.html#topics",
    "href": "docs/research/index.html#topics",
    "title": "Research",
    "section": "Topics",
    "text": "Topics\n\n\n\n\n\n\n\n\n\n\nSolar wind\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSolar wind discontinuities\n\n\n\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "docs/blog/journal_club/2025-04-16_kink_instability/index.html",
    "href": "docs/blog/journal_club/2025-04-16_kink_instability/index.html",
    "title": "Efficient Nonthermal Particle Acceleration",
    "section": "",
    "text": "Hubble Space Telescope Images of HST-1 in M87 (Credit: NASA)\n\n\nExtragalactic jets from active galactic nuclei (AGNs) carry relativistic magnetized plasma and produce nonthermal electrons/positrons that radiate from radio to TeV energies."
  },
  {
    "objectID": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#scientific-context---agn-jets-as-cosmic-accelerators",
    "href": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#scientific-context---agn-jets-as-cosmic-accelerators",
    "title": "Efficient Nonthermal Particle Acceleration",
    "section": "",
    "text": "Hubble Space Telescope Images of HST-1 in M87 (Credit: NASA)\n\n\nExtragalactic jets from active galactic nuclei (AGNs) carry relativistic magnetized plasma and produce nonthermal electrons/positrons that radiate from radio to TeV energies."
  },
  {
    "objectID": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#scientific-context---agn-jets-as-cosmic-accelerators-1",
    "href": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#scientific-context---agn-jets-as-cosmic-accelerators-1",
    "title": "Efficient Nonthermal Particle Acceleration",
    "section": "Scientific Context - AGN jets as cosmic accelerators",
    "text": "Scientific Context - AGN jets as cosmic accelerators\nAGN jets are also candidate sources of ultrahigh-energy cosmic rays (UHECRs; E &gt; 10²⁰ eV), bolstered by recent neutrino–γ coincidences (e.g., TXS 0506+056)\n\n\n\nChandra X-ray image of the M87 jet (Harris et al. (2003))"
  },
  {
    "objectID": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#acceleration-puzzle",
    "href": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#acceleration-puzzle",
    "title": "Efficient Nonthermal Particle Acceleration",
    "section": "Acceleration Puzzle",
    "text": "Acceleration Puzzle\nOpen question: How do jets convert magnetic energy into nonthermal particles so efficiently?\nStandard shock acceleration struggles in magnetically dominated flows, showing low efficiency in PIC studies\nAlternative: Tap jet’s magnetic free energy via instabilities."
  },
  {
    "objectID": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#stability-of-jets",
    "href": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#stability-of-jets",
    "title": "Efficient Nonthermal Particle Acceleration",
    "section": "Stability of Jets",
    "text": "Stability of Jets\n\nUnstable: magnetized jets are strongly unstable to current-driven instabilities in non-relativistic jets\n\nQuestion: magnetized jets are unable to break out of the star, a necessary condition to form a GRB.\n\nStable: half of the energy remains locked in the magnetic form\n\nQuestion: it would be difficult to explain the high-energy emission radiated from them\n\n\nSolution: A local current-driven instability in a mildly unstable jet?"
  },
  {
    "objectID": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#kink-instability-ki",
    "href": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#kink-instability-ki",
    "title": "Efficient Nonthermal Particle Acceleration",
    "section": "Kink Instability (KI)",
    "text": "Kink Instability (KI)\n\\[\n\\mathbf{\\xi}(\\mathbf{r})=\\mathbf{\\xi}(r) e^{i(m \\theta+k z)}\n\\]\n\\[\n\\mathbf{B} \\cdot \\nabla=\\frac{i m}{r} B_\\theta+i k B_z\n\\]\n\n\n\nDisplacements of the plasma"
  },
  {
    "objectID": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#kink-instability-ki---two-stages",
    "href": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#kink-instability-ki---two-stages",
    "title": "Efficient Nonthermal Particle Acceleration",
    "section": "Kink Instability (KI) - Two stages",
    "text": "Kink Instability (KI) - Two stages\n\nInternal kink (First): grows internally in the jet without affecting the overall jet morphology. It converts the magnetic energy into thermal energy via magnetic reconnection. As a result, the toroidal magnetic field decays, and the jet finds itself in a stable configuration that inhibits further growth of the internal kink\nExternal kink (Second): kink modes can still grow externally on the periphery of the jet and perturb the entire jet body. Such an external kink instability grows over longer time-scales and typically affects the outer parts of the jet, near the jet head."
  },
  {
    "objectID": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#internal-instability---two-stages",
    "href": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#internal-instability---two-stages",
    "title": "Efficient Nonthermal Particle Acceleration",
    "section": "Internal instability - two stages",
    "text": "Internal instability - two stages\n\n\n\nSchematic illustration of the formation of a coherent inductive electric field along jet axis."
  },
  {
    "objectID": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#simulation-setup",
    "href": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#simulation-setup",
    "title": "Efficient Nonthermal Particle Acceleration",
    "section": "Simulation Setup",
    "text": "Simulation Setup\n\nApproach: 3D PIC simulations with OSIRIS 3.0, tracking both MHD scales (jet radius R₀) and kinetic scales (gyroradius ρ)\nParameters:\n\nElectron‑positron plasma in hydromagnetic equilibrium.\nToroidal B‑field, magnetization \\(σ ≡ B₀²/(4πnmc²)\\) up to σ = 25.\nPlasma current density \\(J= c/4π ∇ × B\\) supported by symmetrically streaming electrons and positrons.\nDomain size ~ (10–20) R₀, resolving ρ with ≳10 cells.\nUp to 5.5×10¹¹ particles tracked."
  },
  {
    "objectID": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#simulation-results",
    "href": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#simulation-results",
    "title": "Efficient Nonthermal Particle Acceleration",
    "section": "Simulation results",
    "text": "Simulation results\n\n\nVideo\nEvolution of the jet structure subject to the kink instability"
  },
  {
    "objectID": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#simulation-results-1",
    "href": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#simulation-results-1",
    "title": "Efficient Nonthermal Particle Acceleration",
    "section": "Simulation results",
    "text": "Simulation results\n\n\n\nEvolution of the jet structure subject to the kink instability"
  },
  {
    "objectID": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#simulation-results---temporal-evolution-of-energies-and-particle-energy-spectrum",
    "href": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#simulation-results---temporal-evolution-of-energies-and-particle-energy-spectrum",
    "title": "Efficient Nonthermal Particle Acceleration",
    "section": "Simulation results - Temporal evolution of energies and particle energy spectrum",
    "text": "Simulation results - Temporal evolution of energies and particle energy spectrum\n\n\n\nTemporal evolution of energies and particle energy spectrum"
  },
  {
    "objectID": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#acceleration-mechanism",
    "href": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#acceleration-mechanism",
    "title": "Efficient Nonthermal Particle Acceleration",
    "section": "Acceleration mechanism",
    "text": "Acceleration mechanism\n\n\n\n(a) Evolution of particle energy ε and (b) relative magnitude of E and B\n\n\nInductive electric field accompanied by guiding center curvature drift\n\\[\n\\mathbf{E}=-\\mathbf{v} \\times \\mathbf{B} \\simeq E_z \\hat{\\mathbf{z}}\n\\]\n\\[\n\\mathbf{v}_{\\text {curv }}=\\gamma m v_{\\|}^2 c \\mathbf{B} \\times \\mathbf{κ} / e B^2\n\\]\n\nThese drifts allow particles to gain energy from the inductive electric field, with the instantaneous rate of energy gain being connected to the spatial and temporal distribution of the magnetic field curvature. Figure 3(c) illustrates the energy evolution of particles that start highly magnetized and reach the confinement energy. These particles experience fast energy gains by encountering regions where the field curvature radius κ−1 is only a few times their gyroradius. Once they are accelerated to a large fraction (0.2–0.3) of the confinement energy, the guiding center approximation breaks down [Fig. 3(c)], and particles become effectively unmagnetized, moving with vz ∼ c along the jet axis. The acceleration stops when the particles either escape the jet spine in the transverse direction or when the electric field decays as the instability subsides."
  },
  {
    "objectID": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#acceleration-mechanism-1",
    "href": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#acceleration-mechanism-1",
    "title": "Efficient Nonthermal Particle Acceleration",
    "section": "Acceleration mechanism",
    "text": "Acceleration mechanism\n\n\n\nEvolution of the power spectrum of magnetic field fluctuations\n\n\nA large-scale (∼Rc) inductive electric field acting in concert with a magnetic field that is tangled over a range of scales that extends down to \\(ρ_g\\)."
  },
  {
    "objectID": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#astrophysical-implications",
    "href": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#astrophysical-implications",
    "title": "Efficient Nonthermal Particle Acceleration",
    "section": "Astrophysical Implications",
    "text": "Astrophysical Implications\nExtrapolated to astrophysical systems, where the enormous scale separation implies huge energy gains.\n\n\n\n(a) Final particle spectra for different system sizes; (b) Scaling law of maximum particle energy gain with system size and magnetic field magnitude."
  },
  {
    "objectID": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#strengths-limitations",
    "href": "docs/blog/journal_club/2025-04-16_kink_instability/index.html#strengths-limitations",
    "title": "Efficient Nonthermal Particle Acceleration",
    "section": "Strengths & Limitations",
    "text": "Strengths & Limitations\nStrengths:\n\nFully kinetic, 3D, self‑consistent; captures both MHD and particle scales.\nRobust across parameter scans (σ, B‑profile, system size).\nDetailed acceleration mechanism analysis.\n\nLimitations & open questions:\n\nElectron‑positron plasma with large gyroradius.\nRadiative cooling and pair production not included.\nConnection to global jet dynamics and external kink instability."
  },
  {
    "objectID": "docs/courses/epss298_DataAnalysis/homework/ps1.html",
    "href": "docs/courses/epss298_DataAnalysis/homework/ps1.html",
    "title": "Problem Set 1",
    "section": "",
    "text": "The attached file contains experimental data showing a spectral line observed in a laboratory. Your task is to perform a Bayesian analysis on a grid to adjust the amplitude A of the spectral line and the background flux B. Assume that the spectral line has a Gaussian shape. For physical reasons, the value of A is constrained to be between 0 and 1000 a priori. The value of B is constrained to be between 0 and 3000 a priori. Use a uniform “prior” on A and B on a linear scale.",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Homework",
      "Problem Set 1"
    ]
  },
  {
    "objectID": "docs/courses/epss298_DataAnalysis/homework/ps1.html#exercise-2",
    "href": "docs/courses/epss298_DataAnalysis/homework/ps1.html#exercise-2",
    "title": "Problem Set 1",
    "section": "1 Exercise 2",
    "text": "1 Exercise 2\n\nTest the function provided to you for the physics model of the spectral line. What is the\nvector of return values for A=200, B=1860? Copy the values into your document.\n\n\n\nCode\nusing Distributions\nusing CairoMakie\n\n# Define the model function\nfunction model(A, B, x; xpos=10)\n    d = Normal(xpos, 1.0)\n    return B .+ A .* pdf.(d, x)\nend\n\n# Define the data\ndata = [1837.00283015, 1811.76260793, 1877.0602172, 1923.04345098,\n    1810.09024628, 1898.42037995, 1784.35363285, 1866.72588538,\n    1826.22446702, 1896.58934977, 2043.89952533, 1946.20171261,\n    1842.25394544, 1803.83175398, 1803.74949885, 1844.61491832,\n    1828.0670997, 1816.13580618, 1885.88536203, 1846.00959492]\n\n# Set up the x values\nl = length(data)\nx = 0:(l-1)\n\n# Test the model function with A=200, B=1860\nA = 200\nB = 1860\nmodel_values = model(A, B, x)\nprintln(\"Model values for A=200, B=1860:\")\nprintln(model_values)\n\n# Plot the data and model\nf = Figure()\nax = Axis(f[1, 1], xlabel=\"Pixel\", ylabel=\"Photons Collected\")\nstairs!(ax, x, data, label=\"Data\")\nstairs!(ax, x, model_values, label=\"Model (A=$(A), B=$(B))\")\nf\n\n\nModel values for A=200, B=1860:\n[1860.0, 1860.0, 1860.000000000001, 1860.000000001827, 1860.0000012151766, 1860.000297343903, 1860.026766045153, 1860.8863696823876, 1870.7981933026376, 1908.3941449038286, 1939.7884560802866, 1908.3941449038286, 1870.7981933026376, 1860.8863696823876, 1860.026766045153, 1860.000297343903, 1860.0000012151766, 1860.000000001827, 1860.000000000001, 1860.0]\n\n\n\n\n\n\n\n\n\n\nCode a function “prior” returning prior pdf p(A,B|I) for a given set of parameters (A, B). What is the return value for A=200, B=1860? Ideally, write the function in a vectorized form that can return the likelihood values with A and B values given on 2D grids.\n\n\n\nCode\n# Define the prior function\nfunction prior(A, B)\n    if 0 &lt;= A &lt;= 1000 && 0 &lt;= B &lt;= 3000\n        return 1.0 / (1000 * 3000)  # Normalized uniform prior\n    else\n        return 0.0\n    end\nend\n\nprior_value = prior(A, B)\nprintln(\"Prior value for A=200, B=1860: \", prior_value)\n\n\nPrior value for A=200, B=1860: 3.3333333333333335e-7\n\n\n\nCode a function “like” returning the likelihood function p(data|A,B,I) for a given set of parameters. What is the return value for A=200, B=1860? Ideally, write the function in a vectorized form that can return the likelihood values with A and B values given on 2D grids.\n\n\n\nCode\n# Define the likelihood function\nfunction like(A, B, data, x; xpos=10, sigma=30.0)\n    # Calculate the model prediction\n    m = model(A, B, x, xpos=xpos)\n    # Calculate the likelihood assuming Gaussian errors\n    probs = @. pdf(Normal(m, sigma), data)\n    return prod(probs)\nend\n\n# Test the likelihood function with A=200, B=1860\nlikelihood_value = like(A, B, data, x)\nprintln(\"Likelihood value for A=200, B=1860: \", likelihood_value)\n\n\nLikelihood value for A=200, B=1860: 1.6409575671741215e-48\n\n\n\nCode a function “like_times_prior” returning the products of the values of the likelihood and prior for a given set of parameters. That is the numerator of Bayes’ Law. What is the return value for A=200, B=1860?\n\n\n\nCode\n# Define the function for the numerator of Bayes' Law\nfunction like_times_prior(A, B, data, x; xpos=10, sigma=30.0)\n    return like(A, B, data, x, xpos=xpos, sigma=sigma) * prior(A, B)\nend\n\n# Test the function with A=200, B=1860\nposterior_numerator = like_times_prior(A, B, data, x)\nprintln(\"Posterior numerator for A=200, B=1860: \", posterior_numerator)\n\n\nPosterior numerator for A=200, B=1860: 5.469858557247072e-55",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Homework",
      "Problem Set 1"
    ]
  },
  {
    "objectID": "docs/courses/epss298_DataAnalysis/homework/ps1.html#exercise-3",
    "href": "docs/courses/epss298_DataAnalysis/homework/ps1.html#exercise-3",
    "title": "Problem Set 1",
    "section": "2 Exercise 3:",
    "text": "2 Exercise 3:\n\nAdd to the code to calculate the joint posterior probability density p(A,B|data,I) of A and B on a 300x300 grid spanning A and B. Note: Use np.meshgrid to generate a 2D grid for the values of A and B.\n\n\n\nCode\n# Create a grid of A and B values\nf = Figure()\nA_values = range(0, 900, length=200) |&gt; collect\nB_values = range(1780, 1940, length=300) |&gt; collect\n\n# Calculate the posterior (unnormalized) for each grid point\nposterior_grid = zeros(length(A_values), length(B_values))\nfor (i, A) in enumerate(A_values)\n    for (j, B) in enumerate(B_values)\n        posterior_grid[i, j] = like_times_prior(A, B, data, x)\n    end\nend\n\nposterior_grid = posterior_grid ./ sum(posterior_grid)\n\n# Find the maximum posterior and its location\nmax_posterior = maximum(posterior_grid)\nmax_idx = argmax(posterior_grid)\nmax_A = A_values[max_idx[1]]\nmax_B = B_values[max_idx[2]]\n\nprintln(\"Maximum posterior value: \", max_posterior)\nprintln(\"Maximum posterior at A = \", max_A, \", B = \", max_B)\n\n# Plot the posterior\nax = Axis(f[1, 1], xlabel=\"Amplitude (A)\", ylabel=\"Background (B)\", title=\"Posterior Probability\")\nhm = heatmap!(ax, A_values, B_values, (posterior_grid))\nColorbar(f[1, 1][1, 2], hm)\nf\n\n\nMaximum posterior value: 0.0009218105353821632\nMaximum posterior at A = 434.1708542713568, B = 1837.7926421404682\n\n\n\n\n\n\n\n\n\n\nMake a graph of the posterior distribution in 2D using ax.pcolormesh(). Label the axes. Use a\n300x300 grid over the entire parameter space. Label the axes. Include a color bar with the label.\nDraw the same graph as in a) but use a 300x300 grid spanning only the non-zero probability\nregion. Label the axes. Include a color bar with the label.\nShow the point of maximum probability with a star symbol (marker=“*”) on the posterior of\n2c). Include a color bar with the label.\nMake a new graph identical to the one in Step 1 and show the best fit by superimposing the best\nfit model on the data. Write down the maximum probability values of A and B.",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Homework",
      "Problem Set 1"
    ]
  },
  {
    "objectID": "docs/courses/epss298_DataAnalysis/projects/proj1.html",
    "href": "docs/courses/epss298_DataAnalysis/projects/proj1.html",
    "title": "Project 1",
    "section": "",
    "text": "Your team detected a planet candidate in the data from the Transiting Exoplanet Survey Satellite (TESS). The data is very noisy, but you are relatively confident the planet is there.\nBased on the TESS data, you can predict that the center of the next transit will be between the time t = 1.212 days and t = 1.362 days [Note: t is measured relative to an arbitrary reference time]. The TESS data also tell you that the radius of the planet is between 1% and 10% the radius of the star. Unfortunately, you don’t know where the planet crosses the star, i.e. the impact parameter is unconstrained between 0 and 1. Assume that the orbital period is exactly known to be 3.0 days.\nYou wrote a proposal and successfully convinced the time allocation committee of the James Webb Space Telescope (JWST) to obtain new very precise data for you. YAY!!!\nYou receive the data in Project1_JWST_data.csv. The errors are 10-4=0.01% on each data point in the light curve.\nFrom these data, you want to determine new estimates with uncertainties for the transit time, the planet-to-star radius ratio, and the impact parameter.\nJulia packages:",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Projects",
      "Project 1"
    ]
  },
  {
    "objectID": "docs/courses/epss298_DataAnalysis/projects/proj1.html#part-a",
    "href": "docs/courses/epss298_DataAnalysis/projects/proj1.html#part-a",
    "title": "Project 1",
    "section": "Part A",
    "text": "Part A\n\nStep 1: Define the physical model\n\nWrite a function for your physical “forward” model that takes in a vector with these three parameters:\n\n\n\nCode\ninc(a, b) = acosd(b / a)\n\na_i = 15\nu_i = [0.3, 0.3]\nper_i = 3\n\nrp_i = 0.01\nb_i = 0.1\nt0_i = 1.311544\ninc_i = acosd(b_i / a_i)\n\nflux = let rp = rp_i, t0 = t0_i, b = b_i, a = a_i, u = u_i, per = per_i\n    inc = acosd(b / a)\n    light_curve(data.time; t0, per, rp, a, inc, u)\nend\nplot(f[2, 1], data.time, flux)\nf\n\n\n\n\n\n\n\n\n\n\n\nStep 2: Define the Bayesian analysis\n\n\nWrite the given prior information as a log-prior function\nWrite a log-likelihood function\nWrite a log-probability function\n\n\n\n\nCode\n# Transit time between 1.212 and 1.362 days\n# Planet radius between 1% and 10% of star radius\n# Impact parameter between 0 and 1\nfunction log_prior(t0, rp, b)\n    if 1.212 &lt;= t0 &lt;= 1.362 && 0.01 &lt;= rp &lt;= 0.10 && 0 &lt;= b &lt;= 1\n        0.0  # Log of 1, uniform prior within constraints\n    else\n        -Inf  # Log of 0, zero probability outside constraints\n    end\nend\n\nlog_prior(params) = log_prior(params...)\n\nfunction log_likelihood(params, time, obs, error;\n    per=3.0, # Period in days\n    a=15.0, # Semi-major axis in stellar radii\n    u=[0.3, 0.3] # Limb darkening coefficients\n)\n    t0, rp, b = params\n    inc = acosd(b / a)  # Inclination in degrees\n    model_flux = light_curve(time; t0, per, rp, a, inc, u)\n\n    # Calculate log-likelihood (assuming Gaussian errors)\n    residuals = obs .- model_flux\n    chi_squared = sum((residuals ./ error) .^ 2)\n    -0.5 * chi_squared\nend\n\nfunction log_probability(params, time, obs, error)\n    log_prior(params) + log_likelihood(params, time, obs, error)\nend\n\n\nlog_probability (generic function with 1 method)\n\n\n\n\nStep 3: Demonstrate solution on a grid\n\nDetermine new estimates with uncertainties of the planet-to-star radius ratio and the impact parameter. Fix the transit mid-time to t0 = 1.311544 days. Make a 50x50 grid that explores planet-to-star radius ratios between 0.05275 and 0.53505 as well as impact parameters between 0 and 0.3.\n\n\n1. Plot the joint posterior distribution with and mark the best fit with a marker\n\n\nCode\nusing LinearAlgebra  # For eigen decomposition and other matrix operations\nusing Statistics     # For statistical functions\nusing StatsBase\n\n# Fix transit mid-time to t0 = 1.311544 days\nfixed_t0 = 1.311544\n\n# Create a 50x50 grid for rp and b\nn_grid = 50\nrp_grid = range(0.05275, 0.053505, length=n_grid)\nb_grid = range(0.0, 0.3, length=n_grid - 10)\n\n# Calculate the log posterior for each grid point\nlog_posterior_grid = [\n    log_probability([fixed_t0, rp, b], data.time, data.flux, 1e-4)\n    for rp in rp_grid, b in b_grid\n]\n\nposterior_grid = exp.(log_posterior_grid .- maximum(log_posterior_grid)) # (subtract max to avoid numerical issues)\nposterior_grid = posterior_grid ./ sum(posterior_grid) # Normalize the posterior\n\n# Find the maximum posterior point\nmax_idx = argmax(posterior_grid)\nbest_rp = rp_grid[max_idx[1]]\nbest_b = b_grid[max_idx[2]]\nprintln(\"Best fit values: rp = $(best_rp), b = $(best_b)\")\n\n\nb_label = \"Impact parameter (b)\"\nrp_label = \"Planet-to-star radius ratio (rp)\"\nfig = Figure(size=(1000, 800))\nax1 = Axis(fig[1, 1], xlabel=rp_label, ylabel=b_label, title=\"Joint Posterior Distribution\")\n\nhm = heatmap!(ax1, rp_grid, b_grid, posterior_grid)\nscatter!(ax1, [best_rp], [best_b], color=:red, markersize=15)\nColorbar(fig[1, 1, Right()], hm, label=\"Posterior Probability\")\nfig\n\n\nBest fit values: rp = 0.053150612244897956, b = 0.2076923076923077\n\n\n\n\n\n\n\n\n\n\n\n2. Marginalized posterior distributions\n\nPlot the marginalized posterior distributions for the planet-to-star radius ratio and the impact parameters.\n\n\n\nCode\nrp_posterior = vec(sum(posterior_grid, dims=2))\nrp_posterior = weights(rp_posterior ./ sum(rp_posterior))  # Normalize\n\nb_posterior = vec(sum(posterior_grid, dims=1))\nb_posterior = weights(b_posterior ./ sum(b_posterior))  # Normalize\n\nax2 = Axis(fig[2, 1], xlabel=rp_label, ylabel=\"Probability\")\nlines!(ax2, rp_grid, rp_posterior)\nax3 = Axis(fig[1, 2], xlabel=b_label, ylabel=\"Probability\")\nlines!(ax3, b_grid, b_posterior)\nfig\n\n\n\n\n\n\n\n\n\n\n\n3. Best estimates and uncertainties\n\nCalculate the mean and +/-1 sigma uncertainties for both parameters. Mark the mean value with a solid vertical line in the figure created in Step 3.2. Make the +/-1 sigma uncertainties with dashed vertical lines. Report the best estimates (mean and uncertainty) for both parameters quantitatively.\n\n\n\nCode\n# For rp\nrp_mean = mean(rp_grid, rp_posterior)\nrp_std = std(rp_grid, rp_posterior)\n\n# For b\nb_mean = mean(b_grid, b_posterior)\nb_std = std(b_grid, b_posterior)\n\n# Add mean and +/- 1 sigma to the marginalized plots\nvlines!(ax2, [rp_mean], color=:black, linewidth=2)\nvlines!(ax2, [rp_mean - rp_std, rp_mean + rp_std], color=:black, linestyle=:dash)\n\nvlines!(ax3, [b_mean], color=:black, linewidth=2)\nvlines!(ax3, [b_mean - b_std, b_mean + b_std], color=:black, linestyle=:dash)\n\n# Print the results\nprintln(\"Planet-to-star radius ratio (rp):\")\nprintln(\"Mean: $(rp_mean), Uncertainty: ±$(rp_std)\")\nprintln(\"Impact parameter (b):\")\nprintln(\"Mean: $(b_mean), Uncertainty: ±$(b_std)\")\nfig\n\n\nPlanet-to-star radius ratio (rp):\nMean: 0.05313398853620246, Uncertainty: ±0.00011072698866302457\nImpact parameter (b):\nMean: 0.2039876597230059, Uncertainty: ±0.00894400281537162\n\n\n\n\n\n\n\n\n\n\n\n4. Covariance matrix and confidence regions\n\nCalculate the covariance matrix that best represents the joint posterior distribution. What is the correlation coefficient between the planet-to-star radius ratios and the impact parameter? Plot the 68% and 95% confidence regions onto the figure created in Step 3.1.\n\n\n\nCode\n\"\"\"Calculate covariance matrix elements\"\"\"\nfunction covariance_matrix(p, x, y)\n    x_2d = repeat(x, 1, length(y))\n    y_2d = repeat(y', length(x), 1)\n    wp = weights(p)\n    x_mean = mean(x_2d, wp)\n    y_mean = mean(y_2d, wp)\n\n    # Calculate covariance matrix elements\n    cov_x_x = mean((x_2d .- x_mean) .^ 2, wp)\n    cov_y_y = mean((y_2d .- y_mean) .^ 2, wp)\n    cov_x_y = mean((x_2d .- x_mean) .* (y_2d .- y_mean), wp)\n    return [cov_x_x cov_x_y; cov_x_y cov_y_y]\nend\n\ncov_matrix = covariance_matrix(posterior_grid, rp_grid, b_grid)\n@info \"Covariance matrix:\" cov_matrix\n\n# Calculate correlation coefficient\ncorr_coef = cov_matrix[1, 2] / (sqrt(cov_matrix[1, 1]) * sqrt(cov_matrix[2, 2]))\n@info \"Correlation coefficient:\" corr_coef\n\n\n\n┌ Info: Covariance matrix:\n│   cov_matrix =\n│    2×2 Matrix{Float64}:\n│     1.22605e-8  3.77026e-7\n└     3.77026e-7  7.99952e-5\n┌ Info: Correlation coefficient:\n└   corr_coef = 0.38070264831558437\n\n\n\n\n\n\nCode\nusing Distributions\n\nfunction getellipsepoints(cx, cy, rx, ry, θ; length=100)\n    t = range(0, 2π; length)\n    ellipse_x_r = @. rx * cos(t)\n    ellipse_y_r = @. ry * sin(t)\n    R = [cos(θ) sin(θ); -sin(θ) cos(θ)]\n    r_ellipse = [ellipse_x_r ellipse_y_r] * R\n    x = @. cx + r_ellipse[:, 1]\n    y = @. cy + r_ellipse[:, 2]\n    (x, y)\nend\n\nfunction getellipsepoints(μ, Σ, confidence=0.95)\n    quant = quantile(Chisq(2), confidence) |&gt; sqrt\n\n    egvs = eigvals(Σ)\n    if egvs[1] &gt; egvs[2]\n        idxmax = 1\n        largestegv = egvs[1]\n        smallesttegv = egvs[2]\n    else\n        idxmax = 2\n        largestegv = egvs[2]\n        smallesttegv = egvs[1]\n    end\n\n    rx = quant * sqrt(largestegv)\n    ry = quant * sqrt(smallesttegv)\n\n    eigvecmax = eigvecs(Σ)[:, idxmax]\n    θ = atan(eigvecmax[2] / eigvecmax[1])\n    if θ &lt; 0\n        θ += 2π\n    end\n    getellipsepoints(μ..., rx, ry, θ)\nend\n\n\ngetellipsepoints (generic function with 3 methods)\n\n\n\n\nCode\nμ = [rp_mean, b_mean]\nΣ = cov_matrix\n\nlines!(ax1, getellipsepoints(μ, Σ)..., label=\"95% confidence interval\")\nlines!(ax1, getellipsepoints(μ, Σ, 0.5)..., label=\"50% confidence interval\")\nfig",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Projects",
      "Project 1"
    ]
  },
  {
    "objectID": "docs/courses/epss298_DataAnalysis/projects/proj1.html#part-b",
    "href": "docs/courses/epss298_DataAnalysis/projects/proj1.html#part-b",
    "title": "Project 1",
    "section": "Part B",
    "text": "Part B\n\nStep 4: Solve the full problem using MCMC and Nested Sampling\n\nDetermine new estimates with uncertainties of the transit time, the planet-to-star radius ratio, and the impact parameter.\n1. Using Emcee. Make all possible plots and quantitative assessments to convince the reviewer that your results are converged\n2. Using Dynesty. Make all possible plots and quantitative assessments to convince the reviewer that your results are converged\n\nHere we use Turing.jl to sample the posterior distribution instead.\n\n\nCode\nusing Turing\n\n\n\n\nCode\ninc(p::Py, b) = inc(pyconvert(Any, p.a), b)\n\n@model function transit_model(time, flux, params, trans_model=TransitModel(params, data.time); error=1e-4)\n    # Priors\n    t0 ~ Uniform(1.212, 1.362)\n    rp ~ Uniform(0.01, 0.10)\n    b ~ Uniform(0.0, 1.0)\n    params = set_params!(params; t0, rp, inc=inc(params, b))\n    model_flux = light_curve(trans_model, params)\n    return flux ~ MvNormal(model_flux, error)\nend\n\nparams = TransitParams(; rp=rp_i, t0=t0_i, per=3.0, a=a_i, u=u_i, inc=inc_i)\nmodel = transit_model(data.time, data.flux, params)\nchain = sample(model, Emcee(16), 2000; progress=false)\n\n\n\nChains MCMC chain (2000×4×16 Array{Float64, 3}):\n\nIterations        = 1:1:2000\nNumber of chains  = 16\nSamples per chain = 2000\nparameters        = t0, rp, b\ninternals         = lp\n\nSummary Statistics\n  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯\n      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯\n\n          t0    1.3049    0.0257    0.0030   194.0728    81.9104    1.1879     ⋯\n          rp    0.0508    0.0101    0.0011   211.5593    97.8626    1.1631     ⋯\n           b    0.2674    0.2065    0.0242   184.4921    81.9305    1.1913     ⋯\n                                                                1 column omitted\n\nQuantiles\n  parameters      2.5%     25.0%     50.0%     75.0%     97.5% \n      Symbol   Float64   Float64   Float64   Float64   Float64 \n\n          t0    1.2120    1.3115    1.3115    1.3116    1.3118\n          rp    0.0163    0.0530    0.0531    0.0532    0.0541\n           b    0.1845    0.1986    0.2057    0.2140    0.9994\n\n\n\n\n\n\nCode\nusing StatsPlots\n# Plot the traces and posterior distributions\nStatsPlots.plot(chain)\n\n\n\n\n\n  \n    \n  \n\n\n\n  \n    \n  \n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nStep 5: Investigate whether you model is a good fit to the data\n\nInvestigate the residuals. What do you think? Quantitatively and graphically assess whether your model is a good fit to the data.\n\n\n\nStep 6: Refine your physical model\n\n\nWhat could explain your findings in Part 4? Tip: When a distant observer sees a transit of the Earth in front of the sun, would it only be the Earth that is transiting at that time?\n\n\n\n\nCode a new physical “forward” model and log-likelihood function that better explains the data.\n\nUse Dynesty to find the constraints of both objects. Treat the moon like another body transiting shortly before or after. Use the same prior for the moon. That makes six parameters.\nMake plots to convince the reviewer that your results are converged\n\nDetermine quantitatively whether the model justifies applying this more complex model? How confident are you that you detected a moon?\nSummarize your results for the parameters for each object?\nWhy do you get a multi-modal solution? What could you do to avoid this in this simple example?\n\n\n\n\nStep 7:\n\nDescribe in a few sentences one example for a problem or data set that you could analogously solve in your research domain?",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Projects",
      "Project 1"
    ]
  },
  {
    "objectID": "docs/courses/epss298_DataAnalysis/projects/proj1.html#reference",
    "href": "docs/courses/epss298_DataAnalysis/projects/proj1.html#reference",
    "title": "Project 1",
    "section": "Reference",
    "text": "Reference\n\nDACE tutorial on photometry\nDynamic Hamiltonian Monte Carlo (HMC)\n\ntpapp/DynamicHMC.jl: Implementation of robust dynamic Hamiltonian Monte Carlo methods (NUTS) in Julia",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Projects",
      "Project 1"
    ]
  },
  {
    "objectID": "docs/courses/epss298_DataAnalysis/index.html",
    "href": "docs/courses/epss298_DataAnalysis/index.html",
    "title": "EPSS 298",
    "section": "",
    "text": "Instructor: Prof. Björn Benneke",
    "crumbs": [
      "Courses",
      "EPSS 298"
    ]
  },
  {
    "objectID": "docs/courses/epss298_DataAnalysis/lectures/mcmc.html",
    "href": "docs/courses/epss298_DataAnalysis/lectures/mcmc.html",
    "title": "Lecture lab",
    "section": "",
    "text": "We will follow the steps described in the excellent article in introduction to the MCMC of David W. Hogg and Daniel Foreman-Mackey, available here.\nSection 3 will be particularly useful for this example.",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Lectures",
      "Lecture lab"
    ]
  },
  {
    "objectID": "docs/courses/epss298_DataAnalysis/lectures/mcmc.html#one-dimensional-density-function-problems-2-and-3-of-the-article",
    "href": "docs/courses/epss298_DataAnalysis/lectures/mcmc.html#one-dimensional-density-function-problems-2-and-3-of-the-article",
    "title": "Lecture lab",
    "section": "One-dimensional density function (Problems 2 and 3 of the article)",
    "text": "One-dimensional density function (Problems 2 and 3 of the article)\n\nGaussian density\nFor this first exercise, we will implement the Metropolis algorithm and apply it to a unidimensional normal distribution.\nUse the following information:\n\nThe density function \\(P(\\Theta)\\) is a Gaussian with a dimension with average of $μ = 2 $ and a variance $σ^2 = 2 $.\nThe distribution of proposal $q (θ’ | ) $ is a Gaussian for \\(θ'\\) with an average $μ = $ and a standard deviation \\(σ = 1\\).\nThe initial point of the MCMC is $ = 0 $.\nThe MCMC must perform $10^4 $ iterations.\n\nThe equation of normal distribution is\n\\[\np(θ) = \\frac{1}{\\sqrt{2 \\pi σ^2}} \\exp\\left[ -\\frac{(θ - μ)^2}{2 σ^2}\\right].\n\\]\nHowever, to avoid digital errors, you use your logarithm. Code directly a function for \\(\\ln p(θ)\\).\n\n\nCode\nfunction log_gaussian(x, μ, σ)\n    -0.5 * ((x - μ) / σ)^2 + log(1 / (sqrt(2 * π) * σ))\nend\n\n\nlog_gaussian (generic function with 1 method)\n\n\nWe can now implement the Metropolis algorithm.\nWe want our algorithm to be applicable to any density of (log-) probability which accepts an argument $  Theta $ scalar. We can therefore give log_Density (our above probability function) in the function argument.\n\n\nCode\n\"\"\"\nMetropolis MCMC algorithm for sampling from a probability distribution.\n\nArguments:\n- log_density: log-density function, accepts a theta argument\n- θ₀: initial value of theta for the MCMC\n- n: number of steps to take in the MCMC\n- q_scale: standard deviation of the proposal distribution.\n\"\"\"\nfunction mcmc_metropolis(log_density, θ₀, n, q_scale=1.0, verbose=false)\n    chain = zeros(n + 1)\n    chain[1] = θ₀\n    p_c = log_density(θ₀)\n\n    n_accepted = 0\n    for i in 1:n\n        proposal = chain[i] + q_scale * randn()\n        p_i = log_density(proposal)\n        log_alpha = p_i - p_c\n\n        if log(rand()) &lt; log_alpha # Accept the proposal\n            chain[i+1] = proposal\n            p_c = p_i\n            n_accepted += 1\n        else # Reject the proposal, stay at current position\n            chain[i+1] = chain[i]\n        end\n    end\n\n    # Print acceptance rate for diagnostics\n    verbose && println(\"Acceptance rate: $(n_accepted / n)\")\n\n    return chain\nend\n\n\nMain.Notebook.mcmc_metropolis\n\n\nApply the algorithm to obtain 10,000 samples.\nThen display a histogram and compare it with the analytical PDF.\nThen display the temporal evolution (\\(Θ\\) vs \\(k\\)) of the MCMC.\n\n\nCode\nusing CairoMakie\n\nμ = 2.0\nσ = sqrt(2.0)\nlog_density(θ) = log_gaussian(θ, μ, σ)\n\n# Initial conditions\nθ₀ = 0.0\nnsteps = 10000\nq_scale = 1.0\n\n# Run the MCMC algorithm\nsamples = mcmc_metropolis(log_density, θ₀, nsteps, q_scale)\n\n# Create a figure for the histogram and analytical PDF comparison\nf = Figure()\nax1 = Axis(f[1, 1], xlabel=\"θ\", ylabel=\"Density\", title=\"MCMC Sampling vs Analytical PDF\")\n\nhist!(ax1, samples, bins=50, normalization=:pdf, color=(:blue, 0.5), label=\"MCMC Samples\")\n\n# Overlay the analytical PDF\nθ_range = range(extrema(samples)..., length=1000)\nanalytical_pdf = [exp(log_density(θ)) for θ in θ_range]\nlines!(ax1, θ_range, analytical_pdf, color=:red, linewidth=2, label=\"Analytical PDF\")\n\naxislegend(ax1)\nf\n\n\n\n\n\n\n\n\n\n\n\nCode\nax2 = Axis(f[2, 1], xlabel=\"Iteration (k)\", ylabel=\"θ\", title=\"MCMC Trace Plot\")\nlines!(ax2, 0:nsteps, samples)\nf",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Lectures",
      "Lecture lab"
    ]
  },
  {
    "objectID": "docs/courses/epss298_DataAnalysis/projects/proj1.html#introduction",
    "href": "docs/courses/epss298_DataAnalysis/projects/proj1.html#introduction",
    "title": "Project 1",
    "section": "Introduction",
    "text": "Introduction\n\n\nCode\ndir = \"docs/courses/epss298_DataAnalysis\"\nif isdir(dir)\n    cd(dir)\n    Pkg.activate(\".\")\n    Pkg.instantiate()\n    cd(\"projects\")\nend\n\n\n\n\nCode\nusing CSV, DataFrames\nusing CairoMakie\npath = \"./Project1_JWST_data.csv\"\ndata = CSV.read(path, DataFrame)\n\nf = Figure()\nplot(f[1, 1], data.time, data.flux)\nf\n\n\n\n\n\n\n\n\n\n\nJulia interface to Python and Batman\n\n\nCode\nusing CondaPkg\nusing PythonCall\nimport PythonCall: Py\npkg = \"batman-package\"\ndeps = CondaPkg.read_deps()[\"deps\"]\nhaskey(deps, pkg) || CondaPkg.add(pkg)\n\nconst batman = pyimport(\"batman\")\n\n\n\n\nCode\nusing DrWatson: @dict\n\nfunction set_params!(params; kwargs...)\n    for (key, value) in kwargs\n        setproperty!(params, key, value)\n    end\n    return params\nend\n\n\"\"\"Like `batman.TransitParams` in Python, but with some keyword arguments for convenience.\"\"\"\nfunction TransitParams(; ecc=0.0, w=0.0, limb_dark=\"quadratic\", kwargs...)\n    params = batman.TransitParams()\n    set_params!(params; ecc, w, limb_dark)\n    set_params!(params; kwargs...)\n    return params\nend\n\nTransitModel(params, time) = batman.TransitModel(params, Py(time).to_numpy())\n\nlight_curve(model::Py, params::Py) = PyArray(model.light_curve(params))\nfunction light_curve(params, time)\n    m = TransitModel(params, time)\n    return light_curve(m, params)\nend\nlight_curve(time; kwargs...) = light_curve(TransitParams(; kwargs...), time)\n\n\nlight_curve (generic function with 3 methods)",
    "crumbs": [
      "Courses",
      "EPSS 298",
      "Projects",
      "Project 1"
    ]
  }
]